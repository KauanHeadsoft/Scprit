[
    {
        "caminho": "HeadSoft.txt",
        "conteudo": "tela para assistir os vídeos para treinamento do sistema.\nhttps://ajuda.headsoft.com.br/wp-admin/index.php\n-------------------------##-------------------------------\n\ntela para acompanhar os chamados dos clientes.\nhttps://suporte.headsoft.com.br/index.php\n-------------------------##-------------------------------\n\npág para criar dados temporários quando abrir ele se destruído, no caso para e-mail e senhas.\nhttps://privnote.com/\n-------------------------##-------------------------------\n\ntabela para verificar banco de dados SQL server.\nfile:///C:/Users/Usuario/Documents/Dicionario%202025.pdf\n-------------------------##-------------------------------\n\n*Atalhos: (ALT+ESPAÇO) (SHIFT + CTRL + HOMNE (END) para pode copiar tudo)    *\n\nColocar inputs de campos (estilo VBA), CRM, OPERACIONAL e COMERCIAL.\nGrupo de campo livre, codigo e nome e confirmar.\n-------------------------##-------------------------------\n\n*Configurar sistema HeadCargo na máquina do usuário e criação de um novo usuário no sistema do cliente.*\n--Begin Tran Teste  \nSET NOCOUNT ON  \nDeclare  \n  @Usuario_Origem NomeCurto,  \n  @Usuario_Destino NomeCurto,  \n  @Copiar_Consultas Boleano,  \n  @Copiar_Modulos Boleano,  \n  @Copiar_Papeis Boleano,  \n  @Copiar_Persistencias Boleano  \n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */  \nSet @Usuario_Origem = 'flauvi.headsoft'  \nSet @Usuario_Destino = 'vitor.headsoft'  \nSet @Copiar_Consultas = 1  \nSet @Copiar_Modulos = 1  \nSet @Copiar_Papeis = 1  \nSet @Copiar_Persistencias = 0  \n/* FINAL */  \nDeclare  \n  @IdUsuario_Origem IdCurto,  \n  @IdUsuario_Destino IdCurto,  \n  @Max IdCurto\n\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)  \nIf @IdUsuario_Origem Is Null  \nBegin  \n  Print 'Usuário origem não encontrado para a cópia.'  \n  Return  \nEnd\n\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)  \nIf @IdUsuario_Destino Is Null  \nBegin  \n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)  \n  Begin  \n    Print 'É necessário especificar um nome de usuário destino para a cópia.'  \n    Return  \n  End\n\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1  \n  Insert Into sys_Usuario (  \n    IdUsuario,  \n    Nome,  \n    Senha,  \n    Data_Criacao,  \n    Ativo  \n  )  \n  Values (  \n    @IdUsuario_Destino,  \n    @Usuario_Destino,  \n    LOWER(CONVERT(VARCHAR(32), HashBytes('MD5', (LOWER(SUBSTRING(@Usuario_Destino, 1,1)+SUBSTRING(@Usuario_Destino, (CASE WHEN CHARINDEX('.', @Usuario_Destino) != 0 THEN CHARINDEX('.', @Usuario_Destino)+1 WHEN CHARINDEX(' ', @Usuario_Destino) != 0 THEN CHARINDEX(' ', @Usuario_Destino)+1 ELSE -1 END) , 1)+CAST(YEAR(GETDATE()) as VARCHAR(10))))), 2)),  \n    GetDate(),  \n    1  \n  )\n\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n\n  print 'Usuário criado.'  \nEnd\n\nIf @Copiar_Consultas = 1  \nBegin  \n  Delete From sys_Consulta_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Consulta_Usuario (  \n    IdConsulta,  \n    IdUsuario,  \n    Permissao_Imprimir,  \n    Permissao_Exportar  \n  )  \n  Select  \n    IdConsulta,  \n    @IdUsuario_Destino,  \n    Permissao_Imprimir,  \n    Permissao_Exportar  \n  From  \n    sys_Consulta_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Origem\n\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))  \nEnd\n\nIf @Copiar_Modulos = 1  \nBegin  \n  Delete From sys_Modulo_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Modulo_Usuario (  \n    IdModulo,  \n    IdUsuario  \n  )  \n  Select  \n    IdModulo,  \n    @IdUsuario_Destino as IdUsuario  \n  From  \n    sys_Modulo_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Origem  \n  and  \n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n\n  print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))  \nEnd\n\nIf @Copiar_Papeis = 1  \nBegin  \n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\n  Delete From sys_Papel_Membro  \n  Where  \n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Papel_Membro (  \n    IdPapel_Membro,  \n    IdPapel_Superior,  \n    IdUsuario,  \n    IdPapel  \n  )  \n  Select  \n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,  \n    IdPapel_Superior,  \n    @IdUsuario_Destino as IdUsuario,  \n    IdPapel  \n  From  \n    sys_Papel_Membro  \n  Where  \n    IdUsuario = @IdUsuario_Origem  \n  and  \n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n  If @@ROWCOUNT > 0  \n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'  \nEnd\n\nIf @Copiar_Persistencias = 1  \nBegin  \n  Update Dst Set  \n    Dados = Src.Dados  \n  From  \n    sys_Persistencia Src  \n  Join  \n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia  \n  and  \n    Dst.IdUsuario = @IdUsuario_Destino  \n  Where    \n    Src.IdUsuario = @IdUsuario_Origem\n\n  if @@ROWCOUNT > 0  \n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n  Insert Into sys_Persistencia (  \n    IdPersistencia,  \n    IdUsuario,  \n    Dados  \n  )  \n  Select  \n    IdPersistencia,  \n    @IdUsuario_Destino as IdUsuario,  \n    Dados  \n  From  \n    sys_Persistencia  \n  Where  \n    IdUsuario = @IdUsuario_Origem  \n  and  \n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n\n  If @@ROWCOUNT > 0  \n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))  \nEnd\n\nSET NOCOUNT OFF\n\n--Rollback Tran Teste\nCriar usuario, entra no banco de dados do cliente e utiliza o script. (origem é o user que vai ser copiado e o destino é o novo user).\nToda vez que criar um user novo precisa criar um funcionário. (cria um funcionario colocando informações como nome e email e telefone).\nPara fazer a configuração do e-mail, vai em conta e-mail e cria um novo com o nome de user, e-mail e configura as informações, quando for outlook apenas coloca o email e a senha, agora quando é gmail precisa apenas configura e pede para o user dps fazer a configuraçao dentro do gmail e colocar a senha que é gerada pelo google chamada (MFA).\n\nParte instalação no sistema:(appdata\\local\\'criar pasta Headsoft') para evitar bloqueio do windows defender (copia local da pasta- gerenciar configurações ->exclusoes -> adicionar uma exclusão e cola o caminho)\nApós enviar a pasta do sistema do cliente, já está pronto e apenas precisa pegar o \"desktop\" o executavel e enviar para a área de trabalho e renomear para \"HeadCargo\".\n\n\n\n\n\n\n\n\n\n"
    },
    {
        "caminho": "LINHA BASE - EXTRAIDA DO SISTEMA PARA FATURAMENTO.chd",
        "conteudo": "[Consulta]\nCampos=91\nLocates=0\nCommandTextHash=ad5d69e25365e9b73678a355060ff1df\nCommandText=\"SELECT \",\"  Tst.Numero_Processo,\",\"  Tst.Responsavel_Operacional,\",\"  Tst.Cliente,\",\"  Tst.Exportador,\",\"  Tst.Despachante,\",\"  Tst.Referencia_Cliente,\",\"  Tst.Consignatario,\",\"  Tst.Booking,\",\"  Tst.Conf,\",\"  Tst.Data_Retirada_Container,\",\"  Tst.Local_Retirada_Container,\",\"  Tst.Local_Entrega_Container,\",\"  Tst.Numero_Container,\",\"  Tst.Deadline_Draft,\",\"  '' as Dummy_1,\",\"  Tst.Envio_Draft_BL,\",\"  Tst.Liberacao_BL,\",\"  Tst.Deadline_VGM,\",\"  '' as Dummy_2,\",\"  Tst.Envio_VGM,\",\"  Tst.Deadline_Carga,\",\"  '' as Dummy_3,\",\"  Tst.Data_Deposito_Container,\",\"  Tst.Numero_MBL,\",\"  Tst.Numero_HBL,\",\"  Tst.Mercadoria,\",\"  Tst.Navio,\",\"  Tst.Viagem_Navio,\",\"  Tst.Origem,\",\"  Tst.Destino,\",\"  Tst.Pais_Destino,\",\"  Tst.Via,\",\"  Tst.Data_Saida,\",\"  Tst.Fatura_Frete_Compra,\",\"  Tst.Fatura_Locais_Compra,\",\"  Tst.Dias_Em_Aberto_C,\",\"  Tst.Fatura_Frete_Venda,\",\"  Tst.Fatura_Locais_Venda,\",\"  Tst.Data_Chegada,\",\"  Tst.Data_Previsao_Desembarque as Data_Previsao_Chegada,\",\"  Tst.Aviso_Chegada,\",\"  Tst.Companhia_Transporte,\",\"  Tst.Dias_Em_Aberto_V,\",\"  Tst.Agente_Internacional,\",\"  Tst.Valor_Compra_Unitario,\",\"  Tst.Valor_Compra_Total,\",\"  Tst.Free_Detention_Compra,\",\"  Tst.PP_CC_PA,\",\"  Tst.Valor_Venda_Unitaria,\",\"  Tst.Valor_Venda_Total,\",\"  Tst.Free_Dentention_Venda,\",\"  Tst.Qtde_Cntr,\",\"  Tst.Dias_Detention,\",\"  Tst.Profit_USD,\",\"  Tst.Equipamento,\",\"  Tst.Frete_Agente_Pgto,\",\"  Tst.BL_BRL_Pagamento,\",\"  Tst.THC_Pagamento,\",\"  Tst.Total_THC_Pagamento,\",\"  Tst.Taxas_BRL_Pagamento,\",\"  Tst.Taxas_USD_Pagamento,\",\"  Tst.Taxas_EUR_Pagamento,\",\"  Tst.Total_Detention_Pgto,\",\"  Tst.Taxa_Cambio_USD_Pgto,\",\"  Tst.Total_BRL_Pagamento,\",\"  Tst.Data_Pagamento,\",\"  Tst.Frete_Agente_Rcbto,\",\"  Tst.BL_BRL_Recebimento,\",\"  Tst.THC_Recebimento,\",\"  Tst.Total_THC_Recebimento,\",\"  Tst.Taxas_BRL_Recebimento,\",\"  /*Tst.Taxas_USD_Recebimento,\",\"  Tst.Taxas_EUR_Recebimento,*/\",\"  Tst.Total_Detention_Rcbto,\",\"  Tst.Taxa_Cambio_USD_Rcbto,\",\"  Tst.Outras_Taxas_BRL,\",\"  Tst.Total_BRL_Recebimento,\",\"  Tst.Data_Recebimento,\",\"  Tst.Frete_C,\",\"  Tst.Locais_C,\",\"  Tst.Fatura,\",\"  Tst.Vencimento_C,\",\"  Tst.Frete_V,\",\"  Tst.Locais_V,\",\"  Tst.Taxas_Banco,\",\"  Tst.Profit_Liquido,\",\"  Tst.Fatura_Cliente,\",\"  Tst.Vencimento_V,\",\"  Tst.Vendedor,\",\"  Tst.Data_Reserva,\",\"  Tst.Observaçoes\",\"FROM \",\"(SELECT \",\"  Lhs.Data_Abertura_Processo,\",\"  Lhs.Numero_Processo,\",\"  Rsp.Nome AS Responsavel_Operacional,\",\"  Cli.Nome AS Cliente,\",\"  Exp.Nome AS Exportador,\",\"  Dpc.Nome AS Despachante,\",\"  Lhs.Referencia_Cliente,\",\"  Imp.Nome AS Consignatario,\",\"  Lms.Numero_Reserva AS Booking,\",\"  CASE WHEN Lms.Numero_Reserva IS NULL THEN 'NÃO' ELSE 'SIM' END Conf,\",\"  Lmc.Data_Retirada_Container,\",\"  Trr.Nome AS Local_Retirada_Container,\",\"  Tra.Nome AS Local_Entrega_Container,\",\"  Lmc.Numero_Container,\",\"  Drc.Valor_Data as Deadline_Draft,\",\"  '' AS Envio_Draft_BL,\",\"  CASE \",\"    WHEN Lhs.Local_Emissao = 1 THEN 'Destino' \",\"    WHEN Lhs.Local_Emissao = 2 THEN 'Express release' \",\"    WHEN Lhs.Local_Emissao = 3 THEN 'Origem' \",\"    WHEN Lhs.Local_Emissao = 4 THEN 'Sea waybill' \",\"    WHEN Lhs.Local_Emissao = 5 THEN 'Outro' \",\"  END AS Liberacao_BL,\",\"  '' AS Deadline_VGM,\",\"  '' AS Envio_VGM,\",\"  '' AS Deadline_Carga,\",\"  Lmc.Data_Deposito_Container,\",\"  Lms.Numero_Conhecimento AS Numero_MBL,\",\"  Lhs.Conhecimentos AS Numero_HBL,\",\"  Mer.Nome AS Mercadoria,\",\"  Nav.Nome AS Navio,\",\"  Lmm.Viagem_Navio,\",\"  Org.Nome AS Origem,\",\"  Dst.Nome AS Destino,\",\"  Pdt.Nome AS Pais_Destino,\",\"  Ult.Nome AS Via,\",\"  Lms.Data_Embarque AS Data_Saida,\",\"  '' AS Fatura_Frete_Compra,\",\"  '' AS Fatura_Locais_Compra,\",\"  '' AS Dias_Em_Aberto_C,\",\"  '' AS Fatura_Frete_Venda,\",\"  '' AS Fatura_Locais_Venda,\",\"  Lms.Data_Desembarque AS Data_Chegada,\",\"  Lms.Data_Previsao_Desembarque, /*campo adicionado*/\",\"  Lms.Transit_Time AS Aviso_Chegada,\",\"  Cia.Nome AS Companhia_Transporte,\",\"  '' AS Dias_Em_Aberto_V, \",\"  Agd.Nome AS Agente_Internacional,\",\"  Vlp.Valor_Pagamento_Unitario AS Valor_Compra_Unitario,\",\"  Vlt.Valor_Compra_Total,\",\"  Lmc.Free_Detention_Compra,\",\"  CASE \",\"    WHEN Lms.Modalidade_Pagamento = 1 THEN 'Collect/Prepaid'\",\"    WHEN Lms.Modalidade_Pagamento = 2 THEN 'Collect'\",\"    WHEN Lms.Modalidade_Pagamento = 3 THEN 'Prepaid'\",\"    WHEN Lms.Modalidade_Pagamento = 4 THEN 'Prepaid abroad'\",\"  END AS PP_CC_PA,\",\"  Vlp.Valor_Recebimento_Unitario AS Valor_Venda_Unitaria,\",\"  Vlt.Valor_Venda_Total,\",\"  Lmc.Free_Dentention_Venda,\",\"  Cnt.Qtde_Cntr,\",\"  Lmc.Dias_Detention,\",\"  (Vlt.Valor_Venda_Total - Vlt.Valor_Compra_Total) AS Profit_USD,\",\"  Eqm.Descricao AS Equipamento,\",\"  Fra.Valor_Compra_Total AS Frete_Agente_Pgto,\",\"  Lib.Valor_Compra_Total AS BL_BRL_Pagamento,\",\"  Thc.Valor_Pagamento_Unitario AS THC_Pagamento,\",\"  Thc.Valor_Compra_Total AS Total_THC_Pagamento,\",\"  Txs.Taxas_BRL_Pagamento,\",\"  Txu.Taxas_USD_Pagamento,\",\"  Txe.Taxas_EUR_Pagamento,\",\"  Lmc.Total_Detention_Pagamento AS Total_Detention_Pgto,\",\"  '' AS Taxa_Cambio_USD_Pgto,\",\"  Ttb.Total_BRL_Pagamento,\",\"  '' AS Data_Pagamento,\",\"  Frv.Valor_Venda_Total AS Frete_Agente_Rcbto,\",\"  Lir.Valor_Venda_Total AS BL_BRL_Recebimento,\",\"  Thr.Valor_Recebimento_Unitario AS THC_Recebimento,\",\"  Thr.Valor_Venda_Total AS Total_THC_Recebimento,\",\"  Txr.Taxas_BRL_Recebimento, \",\"  /*Tru.Taxas_USD_Recebimento,\",\"  Tre.Taxas_EUR_Recebimento,*/\",\"  Lmc.Total_Detention_Recebimento AS Total_Detention_Rcbto,\",\"  '' AS Taxa_Cambio_USD_Rcbto,\",\"  '' AS Outras_Taxas_BRL,\",\"  Trc.Total_BRL_Recebimento,\",\"  '' AS Data_Recebimento,\",\"  '' AS Frete_C,\",\"  '' AS Locais_C, \",\"  '' AS Fatura,\",\"  '' AS Vencimento_C,\",\"  '' AS Frete_V,\",\"  '' AS Locais_V, \",\"  '' AS Taxas_Banco,\",\"  (Trc.Total_BRL_Recebimento - Ttb.Total_BRL_Pagamento) AS Profit_Liquido,\",\"  '' AS Fatura_Cliente,\",\"  '' AS Vencimento_V,\",\"  Vnd.Nome AS Vendedor,\",\"  '' AS Data_Reserva,\",\"  Ctf.Numero_Contrato AS Observaçoes \",\"FROM \",\"  mov_Logistica_House Lhs \",\"LEFT OUTER JOIN \",\"  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",\"LEFT OUTER JOIN \",\"  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\",\"LEFT OUTER JOIN \",\"  cad_Navio Nav on Nav.IdNavio = Lmm.IdNavio\",\"LEFT OUTER JOIN \",\"  vis_Bill_Lading Bil on Bil.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN \",\"  mov_Contrato_Frete Ctf on Ctf.IdContrato_Frete = Lhs.IdContrato_Frete\",\"LEFT OUTER JOIN\",\"  mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Lhs.IdProjeto_Atividade\",\"LEFT OUTER JOIN\",\"  mov_Projeto_Atividade_Responsavel Par on Par.IdProjeto_Atividade = Pat.IdProjeto_Atividade And Par.IdPapel_Projeto = 2 /*OPERACIONAL*/\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Rsp on Rsp.IdPessoa = Par.IdResponsavel\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Cli on Cli.IdPessoa = Lhs.IdCliente\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Exp on Exp.IdPessoa = Lhs.IdExportador\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Dpc on Dpc.IdPessoa = Lhs.IdDespachante_Aduaneiro\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador /*Consignatário*/\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    ROW_NUMBER() OVER(PARTITION BY Lmc.IdLogistica_House ORDER BY Lmc.IdLogistica_Maritima_Container DESC) AS Indice,\",\"    Lmc.IdLogistica_House,\",\"    Lmc.Data_Descarga_Retirada AS Data_Retirada_Container,\",\"    Lmc.Number AS Numero_Container,\",\"    Lmc.Data_Devolucao AS Data_Deposito_Container,\",\"    Lmc.Free_Time_Master AS Free_Detention_Compra,\",\"    Lmc.Free_Time_House AS Free_Dentention_Venda,\",\"    DATEDIFF(DAY, Lmc.Data_Descarga_Retirada, Lmc.Data_Devolucao) + 1 AS Dias_Detention,\",\"    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Pagamento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_Master) AS Total_Detention_Pagamento,\",\"    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Recebimento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_House) AS Total_Detention_Recebimento\",\"  FROM\",\"    mov_Logistica_Maritima_Container Lmc) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House AND Lmc.Indice = 1   \",\"LEFT OUTER JOIN \",\"  cad_Pessoa Tra on Tra.IdPessoa = Lmm.IdTerminal_Atracacao\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Trr on Trr.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\",\"LEFT OUTER JOIN \",\"  vis_Logistica_Prazo Drc On (Drc.IdLogistica_House = Lhs.IdLogistica_House) And (Drc.Identificador Like 'DEADLINE_DRAFT_CLIENTE')\",\"LEFT OUTER JOIN \",\"  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino \",\"LEFT OUTER JOIN \",\"  cad_Pais Pdt on Pdt.IdPais = Dst.IdPais\",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Lms.IdDestino_Final\",\"LEFT OUTER JOIN \",\"  mov_Logistica_Viagem Lvg on Lvg.IdLogistica_House = Lhs.IdLogistica_House AND Lvg.Ultima_Viagem = 1 \",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Ult on Ult.IdOrigem_Destino = Lvg.IdOrigem\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Cia on Cia.IdPessoa = Lms.IdCompanhia_Transporte\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\",\"/*VALOR UNITARIO DA TAXA DO FRETE*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    Tle.Nome As Taxa,\",\"    /*PAGAMENTO*/\",\"    Mpg.Sigla AS Moeda_Frete_Pagamento,\",\"    Ltx.Valor_Pagamento_Unitario,\",\"    Ltx.Valor_Pagamento_Total,\",\"    /*RECEBIMENTO*/\",\"    Mrc.Sigla AS Moead_Frete_Recebimento,\",\"    Ltx.Valor_Recebimento_Unitario,\",\"    Ltx.Valor_Recebimento_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  LEFT OUTER JOIN \",\"    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\",\"  WHERE \",\"    Tle.IdTaxa_Logistica_Exibicao = 2 /*FRETE MARITIMO*/) Vlp on Vlp.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN\",\"   (SELECT \",\"    Ltx.IdLogistica_House,\",\"    /*PAGAMENTO*/\",\"    SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total,\",\"    /*RECEBIMENTO*/\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  LEFT OUTER JOIN \",\"    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\",\"  WHERE \",\"    Ltx.Origem_Taxa = 1 /*Frete*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Vlt on Vlt.IdLogistica_House = Lhs.IdLogistica_House\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"     Lmc.IdLogistica_House,\",\"     COUNT(Lmc.IdLogistica_Maritima_Container) AS Qtde_Cntr\",\"   FROM \",\"     mov_Logistica_Maritima_Container Lmc \",\"   GROUP BY \",\"     Lmc.IdLogistica_House) Cnt on Cnt.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN  \",\"  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN \",\"  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Pagar_Para = 3 /*AGENTE NO DESTINO*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Fra on Fra.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE PAGAMENTO PARA O AGENTE NO DESTINO*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lib on Lib.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA LIBERAÇÃO DE BL*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  Ltx.Valor_Pagamento_Unitario,\",\"  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thc on Thc.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA THC ORIGEM*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_BRL_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"  AND Ltx.IdMoeda_Pagamento = 20 /*BRL*/\",\"  AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Txs on Txs.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM BRL*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_USD_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"  AND Ltx.IdMoeda_Pagamento = 141 /*USD*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Txu on Txu.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM USD*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_EUR_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"  /*AND Ltx.IdMoeda_Pagamento = 43 /*EUR*/ REQ #45683*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Txe on Txe.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM EUR*/\",\"LEFT OUTER JOIN\",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Corrente) AS Total_BRL_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Ttb on Ttb.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Receber_De = 2 /*AGENTE NO DESTINO*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Frv on Frv.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE RECEBIMENTO PARA O AGENTE NO DESTINO*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lir on Lir.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA LIBERAÇÃO DE BL*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    Ltx.Valor_Recebimento_Unitario,\",\"    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thr on Thr.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA THC ORIGEM*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_BRL_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"    AND Ltx.IdMoeda_Recebimento = 20 /*BRL*/\",\"    AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Txr on Txr.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM BRL*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_USD_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"    AND Ltx.IdMoeda_Recebimento = 141 /*USD*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Tru on Tru.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM USD*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_EUR_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"    /*AND Ltx.IdMoeda_Recebimento = 43 /*EUR*/ REQ #45683*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Tre on Tre.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIEMNTO DAS TAXAS DE ORIGEM EM EUR*/\",\"LEFT OUTER JOIN\",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Corrente) AS Total_BRL_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Trc on Trc.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\",\"  WHERE \",\"    Lms.Data_Embarque >= DATEADD(DAY, -30, GETDATE())\",\") Tst\",/*WHERE*/\n\n[FieldDefs]\nCount=89\nItems[0].Name=Numero_Processo\nItems[0].DataType=ftString\nItems[0].Precision=0\nItems[0].Size=25\nItems[1].Name=Responsavel_Operacional\nItems[1].DataType=ftString\nItems[1].Precision=0\nItems[1].Size=75\nItems[2].Name=Cliente\nItems[2].DataType=ftString\nItems[2].Precision=0\nItems[2].Size=75\nItems[3].Name=Exportador\nItems[3].DataType=ftString\nItems[3].Precision=0\nItems[3].Size=75\nItems[4].Name=Despachante\nItems[4].DataType=ftString\nItems[4].Precision=0\nItems[4].Size=75\nItems[5].Name=Referencia_Cliente\nItems[5].DataType=ftString\nItems[5].Precision=0\nItems[5].Size=400\nItems[6].Name=Consignatario\nItems[6].DataType=ftString\nItems[6].Precision=0\nItems[6].Size=75\nItems[7].Name=Booking\nItems[7].DataType=ftString\nItems[7].Precision=0\nItems[7].Size=25\nItems[8].Name=Conf\nItems[8].DataType=ftString\nItems[8].Precision=0\nItems[8].Size=3\nItems[9].Name=Data_Retirada_Container\nItems[9].DataType=ftDateTime\nItems[9].Precision=0\nItems[9].Size=0\nItems[10].Name=Local_Retirada_Container\nItems[10].DataType=ftString\nItems[10].Precision=0\nItems[10].Size=75\nItems[11].Name=Local_Entrega_Container\nItems[11].DataType=ftString\nItems[11].Precision=0\nItems[11].Size=75\nItems[12].Name=Numero_Container\nItems[12].DataType=ftString\nItems[12].Precision=0\nItems[12].Size=50\nItems[13].Name=Deadline_Draft\nItems[13].DataType=ftDateTime\nItems[13].Precision=0\nItems[13].Size=0\nItems[14].Name=Dummy_1\nItems[14].DataType=ftString\nItems[14].Precision=0\nItems[14].Size=1\nItems[15].Name=Envio_Draft_BL\nItems[15].DataType=ftString\nItems[15].Precision=0\nItems[15].Size=1\nItems[16].Name=Liberacao_BL\nItems[16].DataType=ftString\nItems[16].Precision=0\nItems[16].Size=15\nItems[17].Name=Deadline_VGM\nItems[17].DataType=ftString\nItems[17].Precision=0\nItems[17].Size=1\nItems[18].Name=Dummy_2\nItems[18].DataType=ftString\nItems[18].Precision=0\nItems[18].Size=1\nItems[19].Name=Envio_VGM\nItems[19].DataType=ftString\nItems[19].Precision=0\nItems[19].Size=1\nItems[20].Name=Deadline_Carga\nItems[20].DataType=ftString\nItems[20].Precision=0\nItems[20].Size=1\nItems[21].Name=Dummy_3\nItems[21].DataType=ftString\nItems[21].Precision=0\nItems[21].Size=1\nItems[22].Name=Data_Deposito_Container\nItems[22].DataType=ftDateTime\nItems[22].Precision=0\nItems[22].Size=0\nItems[23].Name=Numero_MBL\nItems[23].DataType=ftString\nItems[23].Precision=0\nItems[23].Size=50\nItems[24].Name=Numero_HBL\nItems[24].DataType=ftMemo\nItems[24].Precision=0\nItems[24].Size=0\nItems[25].Name=Mercadoria\nItems[25].DataType=ftString\nItems[25].Precision=0\nItems[25].Size=50\nItems[26].Name=Navio\nItems[26].DataType=ftString\nItems[26].Precision=0\nItems[26].Size=50\nItems[27].Name=Viagem_Navio\nItems[27].DataType=ftString\nItems[27].Precision=0\nItems[27].Size=25\nItems[28].Name=Origem\nItems[28].DataType=ftString\nItems[28].Precision=0\nItems[28].Size=50\nItems[29].Name=Destino\nItems[29].DataType=ftString\nItems[29].Precision=0\nItems[29].Size=50\nItems[30].Name=Pais_Destino\nItems[30].DataType=ftString\nItems[30].Precision=0\nItems[30].Size=50\nItems[31].Name=Via\nItems[31].DataType=ftString\nItems[31].Precision=0\nItems[31].Size=50\nItems[32].Name=Data_Saida\nItems[32].DataType=ftDateTime\nItems[32].Precision=0\nItems[32].Size=0\nItems[33].Name=Fatura_Frete_Compra\nItems[33].DataType=ftString\nItems[33].Precision=0\nItems[33].Size=1\nItems[34].Name=Fatura_Locais_Compra\nItems[34].DataType=ftString\nItems[34].Precision=0\nItems[34].Size=1\nItems[35].Name=Dias_Em_Aberto_C\nItems[35].DataType=ftString\nItems[35].Precision=0\nItems[35].Size=1\nItems[36].Name=Fatura_Frete_Venda\nItems[36].DataType=ftString\nItems[36].Precision=0\nItems[36].Size=1\nItems[37].Name=Fatura_Locais_Venda\nItems[37].DataType=ftString\nItems[37].Precision=0\nItems[37].Size=1\nItems[38].Name=Data_Chegada\nItems[38].DataType=ftDateTime\nItems[38].Precision=0\nItems[38].Size=0\nItems[39].Name=Data_Previsao_Chegada\nItems[39].DataType=ftDateTime\nItems[39].Precision=0\nItems[39].Size=0\nItems[40].Name=Aviso_Chegada\nItems[40].DataType=ftSmallint\nItems[40].Precision=0\nItems[40].Size=0\nItems[41].Name=Companhia_Transporte\nItems[41].DataType=ftString\nItems[41].Precision=0\nItems[41].Size=75\nItems[42].Name=Dias_Em_Aberto_V\nItems[42].DataType=ftString\nItems[42].Precision=0\nItems[42].Size=1\nItems[43].Name=Agente_Internacional\nItems[43].DataType=ftString\nItems[43].Precision=0\nItems[43].Size=75\nItems[44].Name=Valor_Compra_Unitario\nItems[44].DataType=ftBCD\nItems[44].Precision=19\nItems[44].Size=2\nItems[45].Name=Valor_Compra_Total\nItems[45].DataType=ftBCD\nItems[45].Precision=38\nItems[45].Size=2\nItems[46].Name=Free_Detention_Compra\nItems[46].DataType=ftSmallint\nItems[46].Precision=0\nItems[46].Size=0\nItems[47].Name=PP_CC_PA\nItems[47].DataType=ftString\nItems[47].Precision=0\nItems[47].Size=15\nItems[48].Name=Valor_Venda_Unitaria\nItems[48].DataType=ftBCD\nItems[48].Precision=19\nItems[48].Size=2\nItems[49].Name=Valor_Venda_Total\nItems[49].DataType=ftBCD\nItems[49].Precision=38\nItems[49].Size=2\nItems[50].Name=Free_Dentention_Venda\nItems[50].DataType=ftSmallint\nItems[50].Precision=0\nItems[50].Size=0\nItems[51].Name=Qtde_Cntr\nItems[51].DataType=ftInteger\nItems[51].Precision=0\nItems[51].Size=0\nItems[52].Name=Dias_Detention\nItems[52].DataType=ftInteger\nItems[52].Precision=0\nItems[52].Size=0\nItems[53].Name=Profit_USD\nItems[53].DataType=ftBCD\nItems[53].Precision=38\nItems[53].Size=2\nItems[54].Name=Equipamento\nItems[54].DataType=ftString\nItems[54].Precision=0\nItems[54].Size=200\nItems[55].Name=Frete_Agente_Pgto\nItems[55].DataType=ftBCD\nItems[55].Precision=38\nItems[55].Size=2\nItems[56].Name=BL_BRL_Pagamento\nItems[56].DataType=ftBCD\nItems[56].Precision=19\nItems[56].Size=2\nItems[57].Name=THC_Pagamento\nItems[57].DataType=ftBCD\nItems[57].Precision=19\nItems[57].Size=2\nItems[58].Name=Total_THC_Pagamento\nItems[58].DataType=ftBCD\nItems[58].Precision=19\nItems[58].Size=2\nItems[59].Name=Taxas_BRL_Pagamento\nItems[59].DataType=ftBCD\nItems[59].Precision=38\nItems[59].Size=2\nItems[60].Name=Taxas_USD_Pagamento\nItems[60].DataType=ftBCD\nItems[60].Precision=38\nItems[60].Size=2\nItems[61].Name=Taxas_EUR_Pagamento\nItems[61].DataType=ftBCD\nItems[61].Precision=38\nItems[61].Size=2\nItems[62].Name=Total_Detention_Pgto\nItems[62].DataType=ftInteger\nItems[62].Precision=0\nItems[62].Size=0\nItems[63].Name=Taxa_Cambio_USD_Pgto\nItems[63].DataType=ftString\nItems[63].Precision=0\nItems[63].Size=1\nItems[64].Name=Total_BRL_Pagamento\nItems[64].DataType=ftBCD\nItems[64].Precision=38\nItems[64].Size=7\nItems[65].Name=Data_Pagamento\nItems[65].DataType=ftString\nItems[65].Precision=0\nItems[65].Size=1\nItems[66].Name=Frete_Agente_Rcbto\nItems[66].DataType=ftBCD\nItems[66].Precision=38\nItems[66].Size=2\nItems[67].Name=BL_BRL_Recebimento\nItems[67].DataType=ftBCD\nItems[67].Precision=19\nItems[67].Size=2\nItems[68].Name=THC_Recebimento\nItems[68].DataType=ftBCD\nItems[68].Precision=19\nItems[68].Size=2\nItems[69].Name=Total_THC_Recebimento\nItems[69].DataType=ftBCD\nItems[69].Precision=19\nItems[69].Size=2\nItems[70].Name=Taxas_BRL_Recebimento\nItems[70].DataType=ftBCD\nItems[70].Precision=38\nItems[70].Size=2\nItems[71].Name=Total_Detention_Rcbto\nItems[71].DataType=ftInteger\nItems[71].Precision=0\nItems[71].Size=0\nItems[72].Name=Taxa_Cambio_USD_Rcbto\nItems[72].DataType=ftString\nItems[72].Precision=0\nItems[72].Size=1\nItems[73].Name=Outras_Taxas_BRL\nItems[73].DataType=ftString\nItems[73].Precision=0\nItems[73].Size=1\nItems[74].Name=Total_BRL_Recebimento\nItems[74].DataType=ftBCD\nItems[74].Precision=38\nItems[74].Size=7\nItems[75].Name=Data_Recebimento\nItems[75].DataType=ftString\nItems[75].Precision=0\nItems[75].Size=1\nItems[76].Name=Frete_C\nItems[76].DataType=ftString\nItems[76].Precision=0\nItems[76].Size=1\nItems[77].Name=Locais_C\nItems[77].DataType=ftString\nItems[77].Precision=0\nItems[77].Size=1\nItems[78].Name=Fatura\nItems[78].DataType=ftString\nItems[78].Precision=0\nItems[78].Size=1\nItems[79].Name=Vencimento_C\nItems[79].DataType=ftString\nItems[79].Precision=0\nItems[79].Size=1\nItems[80].Name=Frete_V\nItems[80].DataType=ftString\nItems[80].Precision=0\nItems[80].Size=1\nItems[81].Name=Locais_V\nItems[81].DataType=ftString\nItems[81].Precision=0\nItems[81].Size=1\nItems[82].Name=Taxas_Banco\nItems[82].DataType=ftString\nItems[82].Precision=0\nItems[82].Size=1\nItems[83].Name=Profit_Liquido\nItems[83].DataType=ftBCD\nItems[83].Precision=38\nItems[83].Size=7\nItems[84].Name=Fatura_Cliente\nItems[84].DataType=ftString\nItems[84].Precision=0\nItems[84].Size=1\nItems[85].Name=Vencimento_V\nItems[85].DataType=ftString\nItems[85].Precision=0\nItems[85].Size=1\nItems[86].Name=Vendedor\nItems[86].DataType=ftString\nItems[86].Precision=0\nItems[86].Size=75\nItems[87].Name=Data_Reserva\nItems[87].DataType=ftString\nItems[87].Precision=0\nItems[87].Size=1\nItems[88].Name=Observaçoes\nItems[88].DataType=ftString\nItems[88].Precision=0\nItems[88].Size=50\n\n[Campos]\nCampo[0].FieldName=Numero_Processo\nCampo[0].DisplayLabel=N° Processo\nCampo[0].Origin=Tst.Numero_Processo\nCampo[0].Width=100\nCampo[1].FieldName=Responsavel_Operacional\nCampo[1].DisplayLabel=Responsável Operacional\nCampo[1].Origin=Tst.Responsavel_Operacional\nCampo[1].Width=120\nCampo[2].FieldName=Cliente\nCampo[2].DisplayLabel=Cliente\nCampo[2].Origin=Tst.Cliente\nCampo[2].Width=120\nCampo[3].FieldName=Exportador\nCampo[3].DisplayLabel=Exportador\nCampo[3].Origin=Tst.Exportador\nCampo[3].Width=120\nCampo[4].FieldName=Despachante\nCampo[4].DisplayLabel=Despachante\nCampo[4].Origin=Tst.Despachante\nCampo[4].Width=100\nCampo[5].FieldName=Referencia_Cliente\nCampo[5].DisplayLabel=Referência Cliente\nCampo[5].Origin=Tst.Referencia_Cliente\nCampo[5].Width=100\nCampo[6].FieldName=Consignatario\nCampo[6].DisplayLabel=Consignatario\nCampo[6].Origin=Tst.Consignatario\nCampo[6].Width=100\nCampo[7].FieldName=Booking\nCampo[7].DisplayLabel=Booking\nCampo[7].Origin=Tst.Booking\nCampo[7].Width=110\nCampo[8].FieldName=Conf\nCampo[8].DisplayLabel=Conferido\nCampo[8].Origin=Tst.Conf\nCampo[8].Width=40\nCampo[9].FieldName=Data_Retirada_Container\nCampo[9].DisplayLabel=Data Retirada Container\nCampo[9].Origin=Tst.Data_Retirada_Container\nCampo[9].Width=120\nCampo[9].DisplayFormat=dd/MM/yyyy\nCampo[10].FieldName=Local_Retirada_Container\nCampo[10].DisplayLabel=Local Retirada Container\nCampo[10].Origin=Tst.Local_Retirada_Container\nCampo[10].Width=150\nCampo[11].FieldName=Local_Entrega_Container\nCampo[11].DisplayLabel=Local Entrega Container\nCampo[11].Origin=Tst.Local_Entrega_Container\nCampo[11].Width=120\nCampo[12].FieldName=Numero_Container\nCampo[12].DisplayLabel=N° Container\nCampo[12].Origin=Tst.Numero_Container\nCampo[12].Width=120\nCampo[13].FieldName=Deadline_Draft\nCampo[13].DisplayLabel=Deadline Draft\nCampo[13].Origin=Tst.Deadline_Draft\nCampo[13].Width=100\nCampo[13].DisplayFormat=dd/MM/yyyy\nCampo[14].FieldName=Dummy_1\nCampo[14].DisplayLabel=Dummy 1\nCampo[14].Origin=Dummy_1\nCampo[14].Width=80\nCampo[15].FieldName=Envio_Draft_BL\nCampo[15].DisplayLabel=Envio Draft BL\nCampo[15].Origin=Tst.Envio_Draft_BL\nCampo[15].Width=50\nCampo[16].FieldName=Liberacao_BL\nCampo[16].DisplayLabel=Liberação BL\nCampo[16].Origin=Tst.Liberacao_BL\nCampo[16].Width=100\nCampo[17].FieldName=Deadline_VGM\nCampo[17].DisplayLabel=Deadline VGM\nCampo[17].Origin=Tst.Deadline_VGM\nCampo[17].Width=80\nCampo[18].FieldName=Dummy_2\nCampo[18].DisplayLabel=Dummy 2\nCampo[18].Origin=Dummy_2\nCampo[18].Width=80\nCampo[19].FieldName=Envio_VGM\nCampo[19].DisplayLabel=Envio VGM\nCampo[19].Origin=Tst.Envio_VGM\nCampo[19].Width=50\nCampo[20].FieldName=Deadline_Carga\nCampo[20].DisplayLabel=Deadline Carga\nCampo[20].Origin=Tst.Deadline_Carga\nCampo[20].Width=80\nCampo[21].FieldName=Dummy_3\nCampo[21].DisplayLabel=Dummy 3\nCampo[21].Origin=Dummy_3\nCampo[21].Width=80\nCampo[22].FieldName=Data_Deposito_Container\nCampo[22].DisplayLabel=Data Deposito Container\nCampo[22].Origin=Tst.Data_Deposito_Container\nCampo[22].Width=100\nCampo[22].DisplayFormat=dd/MM/yyyy\nCampo[23].FieldName=Numero_MBL\nCampo[23].DisplayLabel=Número MBL\nCampo[23].Origin=Tst.Numero_MBL\nCampo[23].Width=110\nCampo[24].FieldName=Numero_HBL\nCampo[24].DisplayLabel=Número HBL\nCampo[24].Origin=Tst.Numero_HBL\nCampo[24].Width=110\nCampo[25].FieldName=Mercadoria\nCampo[25].DisplayLabel=Mercadoria\nCampo[25].Origin=Tst.Mercadoria\nCampo[25].Width=120\nCampo[26].FieldName=Navio\nCampo[26].DisplayLabel=Navio\nCampo[26].Origin=Tst.Navio\nCampo[26].Width=100\nCampo[27].FieldName=Viagem_Navio\nCampo[27].DisplayLabel=Viagem Navio\nCampo[27].Origin=Tst.Viagem_Navio\nCampo[27].Width=100\nCampo[28].FieldName=Origem\nCampo[28].DisplayLabel=Origem\nCampo[28].Origin=Tst.Origem\nCampo[28].Width=100\nCampo[29].FieldName=Destino\nCampo[29].DisplayLabel=Destino\nCampo[29].Origin=Tst.Destino\nCampo[29].Width=100\nCampo[30].FieldName=Pais_Destino\nCampo[30].DisplayLabel=Pais Destino\nCampo[30].Origin=Tst.Pais_Destino\nCampo[30].Width=100\nCampo[31].FieldName=Via\nCampo[31].DisplayLabel=Via\nCampo[31].Origin=Tst.Via\nCampo[31].Width=100\nCampo[32].FieldName=Data_Saida\nCampo[32].DisplayLabel=Data Saída\nCampo[32].Origin=Tst.Data_Saida\nCampo[32].Width=100\nCampo[32].DisplayFormat=dd/MM/yyyy\nCampo[33].FieldName=Fatura_Frete_Compra\nCampo[33].DisplayLabel=Fatura Frete Compra\nCampo[33].Origin=Tst.Fatura_Frete_Compra\nCampo[33].Width=80\nCampo[34].FieldName=Fatura_Locais_Compra\nCampo[34].DisplayLabel=Fatura Locais Compra\nCampo[34].Origin=Tst.Fatura_Locais_Compra\nCampo[34].Width=80\nCampo[35].FieldName=Dias_Em_Aberto_C\nCampo[35].DisplayLabel=Dias Em Aberto Compra\nCampo[35].Origin=Tst.Dias_Em_Aberto_C\nCampo[35].Width=80\nCampo[36].FieldName=Fatura_Frete_Venda\nCampo[36].DisplayLabel=Fatura Frete Venda\nCampo[36].Origin=Tst.Fatura_Frete_Venda\nCampo[36].Width=80\nCampo[37].FieldName=Fatura_Locais_Venda\nCampo[37].DisplayLabel=Fatura Locais Venda\nCampo[37].Origin=Tst.Fatura_Locais_Venda\nCampo[37].Width=80\nCampo[38].FieldName=Data_Previsao_Chegada\nCampo[38].DisplayLabel=Data_Previsao_Chegada\nCampo[38].Origin=Tst.Data_Previsao_Desembarque\nCampo[38].Width=100\nCampo[38].DisplayFormat=dd/MM/yyyy\nCampo[39].FieldName=Data_Chegada\nCampo[39].DisplayLabel=Data_Chegada\nCampo[39].Origin=Tst.Data_Chegada\nCampo[39].Width=100\nCampo[39].DisplayFormat=dd/MM/yyyy\nCampo[40].FieldName=Aviso_Chegada\nCampo[40].DisplayLabel=Aviso Chegada\nCampo[40].Origin=Tst.Aviso_Chegada\nCampo[40].Width=50\nCampo[41].FieldName=Companhia_Transporte\nCampo[41].DisplayLabel=Companhia Transporte\nCampo[41].Origin=Tst.Companhia_Transporte\nCampo[41].Width=100\nCampo[42].FieldName=Dias_Em_Aberto_V\nCampo[42].DisplayLabel=Dias Em Aberto Venda\nCampo[42].Origin=Tst.Dias_Em_Aberto_V\nCampo[42].Width=80\nCampo[43].FieldName=Agente_Internacional\nCampo[43].DisplayLabel=Agente Internacional\nCampo[43].Origin=Tst.Agente_Internacional\nCampo[43].Width=110\nCampo[44].FieldName=Valor_Compra_Unitario\nCampo[44].DisplayLabel=Valor Compra Unitário\nCampo[44].Origin=Tst.Valor_Compra_Unitario\nCampo[44].Width=100\nCampo[44].DisplayFormat=#0.00\nCampo[45].FieldName=Valor_Compra_Total\nCampo[45].DisplayLabel=Valor Compra Total\nCampo[45].Origin=Tst.Valor_Compra_Total\nCampo[45].Width=100\nCampo[45].DisplayFormat=#0.00\nCampo[46].FieldName=Free_Detention_Compra\nCampo[46].DisplayLabel=Free Detention Compra\nCampo[46].Origin=Tst.Free_Detention_Compra\nCampo[46].Width=50\nCampo[47].FieldName=PP_CC_PA\nCampo[47].DisplayLabel=PP CC PA\nCampo[47].Origin=Tst.PP_CC_PA\nCampo[47].Width=100\nCampo[48].FieldName=Valor_Venda_Unitaria\nCampo[48].DisplayLabel=Valor Venda Unitária\nCampo[48].Origin=Tst.Valor_Venda_Unitaria\nCampo[48].Width=100\nCampo[48].DisplayFormat=#,0.00\nCampo[49].FieldName=Valor_Venda_Total\nCampo[49].DisplayLabel=Valor Venda Total\nCampo[49].Origin=Tst.Valor_Venda_Total\nCampo[49].Width=100\nCampo[49].DisplayFormat=#,0.00\nCampo[50].FieldName=Free_Dentention_Venda\nCampo[50].DisplayLabel=Free Dentention Venda\nCampo[50].Origin=Tst.Free_Dentention_Venda\nCampo[50].Width=50\nCampo[51].FieldName=Qtde_Cntr\nCampo[51].DisplayLabel=Quantidade Container\nCampo[51].Origin=Tst.Qtde_Cntr\nCampo[51].Width=50\nCampo[52].FieldName=Dias_Detention\nCampo[52].DisplayLabel=Dias Detention\nCampo[52].Origin=Tst.Dias_Detention\nCampo[52].Width=50\nCampo[53].FieldName=Profit_USD\nCampo[53].DisplayLabel=Profit USD\nCampo[53].Origin=Tst.Profit_USD\nCampo[53].Width=100\nCampo[53].DisplayFormat=USD#,#0.00\nCampo[54].FieldName=Equipamento\nCampo[54].DisplayLabel=Equipamento\nCampo[54].Origin=Tst.Equipamento\nCampo[54].Width=100\nCampo[55].FieldName=Frete_Agente_Pgto\nCampo[55].DisplayLabel=Frete Agente Pagamento\nCampo[55].Origin=Tst.Frete_Agente_Pgto\nCampo[55].Width=100\nCampo[55].DisplayFormat=#,0.00\nCampo[56].FieldName=BL_BRL_Pagamento\nCampo[56].DisplayLabel=BL BRL Pagamento\nCampo[56].Origin=Tst.BL_BRL_Pagamento\nCampo[56].Width=100\nCampo[56].DisplayFormat=#,0.00\nCampo[57].FieldName=THC_Pagamento\nCampo[57].DisplayLabel=THC Pagamento\nCampo[57].Origin=Tst.THC_Pagamento\nCampo[57].Width=100\nCampo[57].DisplayFormat=#,0.00\nCampo[58].FieldName=Total_THC_Pagamento\nCampo[58].DisplayLabel=Total THC Pagamento\nCampo[58].Origin=Tst.Total_THC_Pagamento\nCampo[58].Width=100\nCampo[58].DisplayFormat=#,0.00\nCampo[59].FieldName=Taxas_BRL_Pagamento\nCampo[59].DisplayLabel=Taxas BRL Pagamento\nCampo[59].Origin=Tst.Taxas_BRL_Pagamento\nCampo[59].Width=100\nCampo[59].DisplayFormat=#,0.00\nCampo[60].FieldName=Taxas_USD_Pagamento\nCampo[60].DisplayLabel=Taxas USD Pagamento\nCampo[60].Origin=Tst.Taxas_USD_Pagamento\nCampo[60].Width=100\nCampo[60].DisplayFormat=USD#,#0.00\nCampo[61].FieldName=Taxas_EUR_Pagamento\nCampo[61].DisplayLabel=Outras Taxas Pagamento\nCampo[61].Origin=Tst.Taxas_EUR_Pagamento\nCampo[61].Width=100\nCampo[61].DisplayFormat=#,#0.00\nCampo[62].FieldName=Total_Detention_Pgto\nCampo[62].DisplayLabel=Total Detention Pagamento\nCampo[62].Origin=Tst.Total_Detention_Pgto\nCampo[62].Width=100\nCampo[62].DisplayFormat=50\nCampo[63].FieldName=Taxa_Cambio_USD_Pgto\nCampo[63].DisplayLabel=Taxa_Cambio_USD_Pagamento\nCampo[63].Origin=Tst.Taxa_Cambio_USD_Pgto\nCampo[63].Width=100\nCampo[64].FieldName=Total_BRL_Pagamento\nCampo[64].DisplayLabel=Total BRL Pagamento\nCampo[64].Origin=Tst.Total_BRL_Pagamento\nCampo[64].Width=100\nCampo[64].DisplayFormat=#,0.00\nCampo[65].FieldName=Data_Pagamento\nCampo[65].DisplayLabel=Data Pagamento\nCampo[65].Origin=Tst.Data_Pagamento\nCampo[65].Width=80\nCampo[66].FieldName=Frete_Agente_Rcbto\nCampo[66].DisplayLabel=Frete Agente Recebimento\nCampo[66].Origin=Tst.Frete_Agente_Rcbto\nCampo[66].Width=100\nCampo[66].DisplayFormat=#,0.00\nCampo[67].FieldName=BL_BRL_Recebimento\nCampo[67].DisplayLabel=BL BRL Recebimento\nCampo[67].Origin=Tst.BL_BRL_Recebimento\nCampo[67].Width=100\nCampo[67].DisplayFormat=#,0.00\nCampo[68].FieldName=THC_Recebimento\nCampo[68].DisplayLabel=THC Recebimento\nCampo[68].Origin=Tst.THC_Recebimento\nCampo[68].Width=100\nCampo[68].DisplayFormat=#,0.00\nCampo[69].FieldName=Total_THC_Recebimento\nCampo[69].DisplayLabel=Total THC Recebimento\nCampo[69].Origin=Tst.Total_THC_Recebimento\nCampo[69].Width=100\nCampo[69].DisplayFormat=#,0.00\nCampo[70].FieldName=Taxas_BRL_Recebimento\nCampo[70].DisplayLabel=Taxas BRL Recebimento\nCampo[70].Origin=Tst.Taxas_BRL_Recebimento\nCampo[70].Width=100\nCampo[70].DisplayFormat=#,0.00\nCampo[71].FieldName=Taxas_USD_Recebimento\nCampo[71].DisplayLabel=Taxas USD Recebimento\nCampo[71].Origin=Tst.Taxas_USD_Recebimento\nCampo[71].Width=100\nCampo[71].DisplayFormat=USD#,#0.00\nCampo[72].FieldName=Taxas_EUR_Recebimento\nCampo[72].DisplayLabel=Outras Taxas Recebimento\nCampo[72].Origin=Tst.Taxas_EUR_Recebimento\nCampo[72].Width=100\nCampo[72].DisplayFormat=#,#0.00\nCampo[73].FieldName=Total_Detention_Rcbto\nCampo[73].DisplayLabel=Total Detention Recebimento\nCampo[73].Origin=Tst.Total_Detention_Rcbto\nCampo[73].Width=100\nCampo[74].FieldName=Taxa_Cambio_USD_Rcbto\nCampo[74].DisplayLabel=Taxa Cambio USD Recebimento\nCampo[74].Origin=Tst.Taxa_Cambio_USD_Rcbto\nCampo[74].Width=100\nCampo[75].FieldName=Outras_Taxas_BRL\nCampo[75].DisplayLabel=Outras taxas BRL\nCampo[75].Origin=Tst.Outras_Taxas_BRL\nCampo[75].Width=80\nCampo[76].FieldName=Total_BRL_Recebimento\nCampo[76].DisplayLabel=Total BRL Recebimento\nCampo[76].Origin=Tst.Total_BRL_Recebimento\nCampo[76].Width=100\nCampo[76].DisplayFormat=#,0.00\nCampo[77].FieldName=Data_Recebimento\nCampo[77].DisplayLabel=Data Recebimento\nCampo[77].Origin=Tst.Data_Recebimento\nCampo[77].Width=80\nCampo[78].FieldName=Frete_C\nCampo[78].DisplayLabel=Frete C\nCampo[78].Origin=Tst.Frete_C\nCampo[78].Width=80\nCampo[79].FieldName=Locais_C\nCampo[79].DisplayLabel=Locais C\nCampo[79].Origin=Tst.Locais_C\nCampo[79].Width=80\nCampo[80].FieldName=Fatura\nCampo[80].DisplayLabel=Fatura\nCampo[80].Origin=Tst.Fatura\nCampo[80].Width=80\nCampo[81].FieldName=Vencimento_C\nCampo[81].DisplayLabel=Vencimento C\nCampo[81].Origin=Tst.Vencimento_C\nCampo[81].Width=80\nCampo[82].FieldName=Frete_V\nCampo[82].DisplayLabel=Frete V\nCampo[82].Origin=Tst.Frete_V\nCampo[82].Width=80\nCampo[83].FieldName=Locais_V\nCampo[83].DisplayLabel=Locais V\nCampo[83].Origin=Tst.Locais_V\nCampo[83].Width=80\nCampo[84].FieldName=Taxas_Banco\nCampo[84].DisplayLabel=Taxas Banco\nCampo[84].Origin=Tst.Taxas_Banco\nCampo[84].Width=80\nCampo[85].FieldName=Profit_Liquido\nCampo[85].DisplayLabel=Profit Liquido\nCampo[85].Origin=Tst.Profit_Liquido\nCampo[85].Width=100\nCampo[85].DisplayFormat=#,0.00\nCampo[86].FieldName=Fatura_Cliente\nCampo[86].DisplayLabel=Fatura Cliente\nCampo[86].Origin=Tst.Fatura_Cliente\nCampo[86].Width=80\nCampo[87].FieldName=Vencimento_V\nCampo[87].DisplayLabel=Vencimento V\nCampo[87].Origin=Tst.Vencimento_V\nCampo[87].Width=80\nCampo[88].FieldName=Vendedor\nCampo[88].DisplayLabel=Vendedor\nCampo[88].Origin=Tst.Vendedor\nCampo[88].Width=120\nCampo[89].FieldName=Data_Reserva\nCampo[89].DisplayLabel=Data Reserva\nCampo[89].Origin=Tst.Data_Reserva\nCampo[89].Width=80\nCampo[90].FieldName=Observaçoes\nCampo[90].DisplayLabel=Observações\nCampo[90].Origin=Tst.Observaçoes\nCampo[90].Width=120\n\n"
    },
    {
        "caminho": "NSL - 3.0.255.0       abaixo 234 at.txt",
        "conteudo": "NSL - 3.0.255.0       \nAgendado às 17:30h 'ok' 'ok'\n\nFIRST UTILE - 3.0.257.0\nAgendado às 18h 'ok' 'OK'\n\nBR PARTNERS: - 3.0.284.0\nAgendado às 18h 'ok' 'ok'\n\nSYNDEX - 3.0.206.0 \nAgendado às 18h 'ok\n\n\nabaixo 234 atualizar."
    },
    {
        "caminho": "Reh\\admin-clientes.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#1f2937\">\n    <title>Gestão de Clientes | Admin</title>\n    \n    <!-- FAVICON -->\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n    \n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- FIREBASE -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES -->\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        // Configuração do Tailwind (Mesma do projeto)\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { sans: ['DM Sans', 'sans-serif'], serif: ['Playfair Display', 'serif'] },\n                    colors: { \n                        brand: { 50: '#fff1f2', 100: '#ffe4e6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d' } \n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        /* Estilos Personalizados */\n        ::-webkit-scrollbar { width: 6px; height: 6px; }\n        ::-webkit-scrollbar-track { background: #f1f1f1; }\n        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }\n        .glass-header { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0,0,0,0.05); }\n        .pb-safe-area { padding-bottom: env(safe-area-inset-bottom); }\n    </style>\n\n    <script>\n        // --- FIREBASE CONFIG ---\n        const firebaseConfig = {\n            apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n            authDomain: \"renata-26079.firebaseapp.com\",\n            projectId: \"renata-26079\",\n            storageBucket: \"renata-26079.firebasestorage.app\",\n            messagingSenderId: \"995787482442\",\n            appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n        };\n\n        firebase.initializeApp(firebaseConfig);\n        const db = firebase.firestore();\n        const auth = firebase.auth();\n\n        // --- ESTADO ---\n        let clientesCache = [];\n        let editandoId = null;\n\n        // --- LIFECYCLE ---\n        document.addEventListener('DOMContentLoaded', () => {\n            auth.onAuthStateChanged(user => { if (!user) auth.signInAnonymously(); });\n            \n            carregarClientes();\n\n            // Listeners\n            document.getElementById('search-input').addEventListener('input', filtrarClientes);\n            document.getElementById('form-cliente').addEventListener('submit', salvarCliente);\n\n            // Máscara de Telefone no Input\n            const inputFone = document.getElementById('telefone');\n            inputFone.addEventListener('input', (e) => {\n                let v = e.target.value.replace(/\\D/g, '');\n                v = v.replace(/^(\\d{2})(\\d)/g, '($1) $2');\n                v = v.replace(/(\\d)(\\d{4})$/, '$1-$2');\n                e.target.value = v;\n            });\n        });\n\n        // --- FUNÇÕES DE DADOS ---\n        function carregarClientes() {\n            const grid = document.getElementById('grid-clientes');\n            grid.innerHTML = '<div class=\"col-span-full text-center py-10 text-gray-400 animate-pulse\">Carregando clientes...</div>';\n\n            // Escuta em tempo real\n            db.collection('clientes').orderBy('nome').onSnapshot(snap => {\n                clientesCache = [];\n                snap.forEach(doc => {\n                    clientesCache.push({ id: doc.id, ...doc.data() });\n                });\n                renderizarGrid(clientesCache);\n                atualizarStats(clientesCache);\n            });\n        }\n\n        function renderizarGrid(lista) {\n            const grid = document.getElementById('grid-clientes');\n            grid.innerHTML = '';\n\n            if (lista.length === 0) {\n                grid.innerHTML = `\n                    <div class=\"col-span-full flex flex-col items-center justify-center py-20 text-gray-400\">\n                        <svg class=\"w-16 h-16 mb-4 opacity-20\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" /></svg>\n                        <p>Nenhum cliente encontrado.</p>\n                    </div>`;\n                return;\n            }\n\n            // Layout Grid Responsivo\n            grid.className = 'grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 pb-20';\n\n            lista.forEach(c => {\n                const dadosJson = encodeURIComponent(JSON.stringify(c));\n                const dataCad = c.data_cadastro ? new Date(c.data_cadastro).toLocaleDateString('pt-BR') : '--/--/----';\n                const ultimoAcesso = c.ultimo_acesso ? new Date(c.ultimo_acesso).toLocaleDateString('pt-BR') : 'Nunca';\n\n                grid.innerHTML += `\n                <div class=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-shadow flex items-center gap-4 group\">\n                    <!-- Avatar com Inicial -->\n                    <div class=\"w-12 h-12 rounded-full bg-brand-50 text-brand-600 flex items-center justify-center font-bold text-xl flex-shrink-0 border border-brand-100\">\n                        ${c.nome.charAt(0).toUpperCase()}\n                    </div>\n\n                    <!-- Info -->\n                    <div class=\"flex-grow min-w-0\">\n                        <h3 class=\"font-bold text-gray-800 text-lg truncate\">${c.nome}</h3>\n                        <div class=\"flex items-center gap-1 text-gray-500 text-sm\">\n                            <svg class=\"w-3 h-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\"/></svg>\n                            <span>${c.telefone || 'Sem fone'}</span>\n                        </div>\n                        <p class=\"text-xs text-gray-400 mt-1\">Acesso: ${ultimoAcesso}</p>\n                    </div>\n\n                    <!-- Ações -->\n                    <div class=\"flex flex-col gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity\">\n                        <button onclick=\"abrirDrawer('${dadosJson}')\" class=\"p-2 bg-gray-50 text-blue-600 rounded-lg hover:bg-blue-50 transition\" title=\"Editar\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"/></svg>\n                        </button>\n                        <button onclick=\"deletarCliente('${c.id}')\" class=\"p-2 bg-gray-50 text-red-500 rounded-lg hover:bg-red-50 transition\" title=\"Excluir\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/></svg>\n                        </button>\n                    </div>\n                </div>`;\n            });\n        }\n\n        function filtrarClientes() {\n            const termo = document.getElementById('search-input').value.toLowerCase();\n            const filtrados = clientesCache.filter(c => \n                c.nome.toLowerCase().includes(termo) || \n                (c.telefone && c.telefone.includes(termo))\n            );\n            renderizarGrid(filtrados);\n        }\n\n        // --- DRAWER (Formulário) ---\n        function abrirDrawer(dadosJson = null) {\n            const drawer = document.getElementById('drawer-form');\n            const overlay = document.getElementById('drawer-overlay');\n            const titulo = document.getElementById('drawer-title');\n            \n            limparFormulario();\n\n            if (dadosJson) {\n                const c = JSON.parse(decodeURIComponent(dadosJson));\n                editandoId = c.id;\n                titulo.innerText = \"Editar Cliente\";\n                document.getElementById('nome').value = c.nome || '';\n                document.getElementById('telefone').value = c.telefone || '';\n            } else {\n                editandoId = null;\n                titulo.innerText = \"Novo Cliente\";\n            }\n\n            drawer.classList.remove('hidden');\n            overlay.classList.remove('hidden');\n            setTimeout(() => {\n                overlay.classList.remove('opacity-0');\n                drawer.style.transform = 'none';\n            }, 10);\n        }\n\n        function fecharDrawer() {\n            const drawer = document.getElementById('drawer-form');\n            const overlay = document.getElementById('drawer-overlay');\n            drawer.style.transform = ''; \n            overlay.classList.add('opacity-0');\n            setTimeout(() => {\n                drawer.classList.add('hidden');\n                overlay.classList.add('hidden');\n            }, 300);\n        }\n\n        function limparFormulario() {\n            document.getElementById('form-cliente').reset();\n            editandoId = null;\n        }\n\n        async function salvarCliente(e) {\n            e.preventDefault();\n            const btn = document.getElementById('btn-salvar');\n            const originalText = btn.innerText;\n            btn.innerText = 'Salvando...';\n            btn.disabled = true;\n\n            try {\n                const nome = document.getElementById('nome').value.trim();\n                const telefone = document.getElementById('telefone').value.trim();\n                const telefoneLimpo = telefone.replace(/\\D/g, '');\n\n                if (nome.length < 3) throw new Error(\"Nome muito curto.\");\n                if (telefoneLimpo.length < 10) throw new Error(\"Telefone inválido.\");\n\n                const dados = {\n                    nome,\n                    telefone,\n                    telefone_limpo: telefoneLimpo,\n                    ultimo_acesso: new Date().toISOString()\n                };\n\n                if (editandoId) {\n                    await db.collection('clientes').doc(editandoId).update(dados);\n                    mostrarToast(\"Cliente atualizado!\", \"sucesso\");\n                } else {\n                    dados.data_cadastro = new Date().toISOString();\n                    // Verifica duplicidade\n                    const check = await db.collection('clientes').where('telefone_limpo', '==', telefoneLimpo).get();\n                    if (!check.empty) throw new Error(\"Já existe um cliente com este telefone.\");\n                    \n                    await db.collection('clientes').add(dados);\n                    mostrarToast(\"Cliente cadastrado!\", \"sucesso\");\n                }\n                fecharDrawer();\n\n            } catch (erro) {\n                alert(erro.message);\n            } finally {\n                btn.innerText = originalText;\n                btn.disabled = false;\n            }\n        }\n\n        async function deletarCliente(id) {\n            if(confirm(\"Tem certeza que deseja excluir este cliente? O histórico de acesso será perdido.\")) {\n                try {\n                    await db.collection('clientes').doc(id).delete();\n                    mostrarToast(\"Cliente removido.\", \"erro\");\n                } catch(e) { alert(\"Erro: \" + e.message); }\n            }\n        }\n\n        function atualizarStats(lista) {\n            document.getElementById('total-clientes').innerText = lista.length;\n        }\n\n        function mostrarToast(msg, tipo = 'sucesso') {\n            const t = document.getElementById('toast');\n            const cor = tipo === 'sucesso' ? 'bg-gray-900' : 'bg-red-600';\n            t.className = `fixed bottom-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-full text-white font-bold shadow-2xl z-[100] transition-all duration-500 translate-y-20 opacity-0 ${cor}`;\n            t.innerHTML = `<span>${tipo === 'sucesso' ? '✓' : '🗑️'}</span> ${msg}`;\n            t.classList.remove('translate-y-20', 'opacity-0');\n            setTimeout(() => t.classList.add('translate-y-20', 'opacity-0'), 3000);\n        }\n    </script>\n</head>\n<body class=\"bg-gray-50 font-sans text-gray-800 h-screen flex flex-col overflow-hidden\">\n\n    <!-- HEADER -->\n    <header class=\"glass-header h-16 flex items-center justify-between px-4 md:px-8 z-30 flex-shrink-0\">\n        <div class=\"flex items-center gap-3\">\n            <div class=\"bg-brand-600 text-white p-1.5 rounded-lg\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\" /></svg>\n            </div>\n            <h1 class=\"font-bold text-gray-800 text-lg tracking-tight\">Admin <span class=\"text-gray-400 mx-1\">/</span> Clientes</h1>\n        </div>\n\n        <nav class=\"flex gap-2 md:gap-4\">\n            <!-- LINKS DE NAVEGAÇÃO (Sem target=\"_blank\") -->\n            <a href=\"admin-pedidos.html\" class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Pedidos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"/></svg>\n            </a>\n            <a href=\"admin-produtos.html\" class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Produtos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" /></svg>\n            </a>\n            <a href=\"admin-custos.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Custos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n            <!-- Link para a Loja continua com target=\"_blank\" para não fechar o admin -->\n            <a href=\"index.html\" target=\"_blank\" class=\"hidden md:flex px-3 py-2 text-sm font-bold text-brand-600 bg-brand-50 border border-brand-100 rounded-lg hover:bg-brand-100 transition items-center gap-2\">\n                <span>Ver Loja</span>\n                <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"/></svg>\n            </a>\n        </nav>\n    </header>\n\n    <!-- TOOLBAR -->\n    <div class=\"bg-white border-b border-gray-200 px-4 md:px-8 pt-4 pb-4 flex flex-col md:flex-row gap-4 justify-between items-center flex-shrink-0\">\n        <div class=\"flex gap-4 items-center w-full md:w-auto\">\n            <div class=\"bg-gray-100 px-3 py-1 rounded-lg border border-gray-200\">\n                <span class=\"text-xs font-bold text-gray-400 uppercase\">Total</span>\n                <span id=\"total-clientes\" class=\"ml-1 font-black text-gray-800\">0</span>\n            </div>\n        </div>\n\n        <div class=\"flex w-full md:w-auto gap-3\">\n            <div class=\"relative flex-grow md:w-64\">\n                <svg class=\"absolute left-3 top-3.5 w-5 h-5 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/></svg>\n                <input type=\"text\" id=\"search-input\" placeholder=\"Buscar cliente...\" class=\"w-full pl-10 pr-4 py-3 bg-gray-100 border-transparent focus:bg-white focus:border-brand-500 focus:ring-0 rounded-xl text-sm transition font-medium\">\n            </div>\n            <button onclick=\"abrirDrawer()\" class=\"bg-brand-600 text-white px-4 py-3 rounded-xl font-bold text-sm hover:bg-brand-700 shadow-lg shadow-brand-200 transition active:scale-95 flex-shrink-0\">\n                + Novo\n            </button>\n        </div>\n    </div>\n\n    <!-- GRID -->\n    <main class=\"flex-grow overflow-y-auto p-4 md:p-8 bg-gray-50\">\n        <div id=\"grid-clientes\">\n            <!-- Renderizado via JS -->\n        </div>\n    </main>\n\n    <!-- DRAWER (FORMULÁRIO) -->\n    <div id=\"drawer-overlay\" onclick=\"fecharDrawer()\" class=\"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300\"></div>\n    \n    <div id=\"drawer-form\" class=\"fixed z-50 bg-white shadow-2xl transition-transform duration-300 flex flex-col hidden\n        bottom-0 left-0 right-0 w-full h-[80vh] rounded-t-2xl md:h-full\n        md:inset-y-0 md:right-0 md:left-auto md:w-[400px] md:rounded-l-2xl md:rounded-tr-none translate-y-full md:translate-x-full\">\n        \n        <div class=\"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-white flex-shrink-0\">\n            <h2 id=\"drawer-title\" class=\"text-xl font-serif font-bold text-gray-900\">Cliente</h2>\n            <button onclick=\"fecharDrawer()\" class=\"p-2 text-gray-400 hover:text-gray-600 bg-gray-50 rounded-full transition\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/></svg>\n            </button>\n        </div>\n\n        <div class=\"flex-grow overflow-y-auto p-6 space-y-6\">\n            <form id=\"form-cliente\" class=\"space-y-4\">\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Nome Completo</label>\n                    <input type=\"text\" id=\"nome\" required class=\"w-full p-3 border border-gray-200 rounded-xl focus:border-brand-500 focus:ring-0 outline-none font-bold text-gray-800\" placeholder=\"Ex: Maria Silva\">\n                </div>\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Celular / WhatsApp</label>\n                    <input type=\"tel\" id=\"telefone\" required class=\"w-full p-3 border border-gray-200 rounded-xl focus:border-brand-500 focus:ring-0 outline-none font-bold text-gray-800\" placeholder=\"(00) 00000-0000\" maxlength=\"15\">\n                </div>\n            </form>\n        </div>\n\n        <div class=\"p-6 border-t border-gray-100 bg-white pb-safe-area flex-shrink-0\">\n            <button form=\"form-cliente\" type=\"submit\" id=\"btn-salvar\" class=\"w-full bg-brand-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-brand-200 hover:bg-brand-700 active:scale-95 transition\">\n                Salvar Cliente\n            </button>\n        </div>\n    </div>\n\n    <!-- TOAST -->\n    <div id=\"toast\"></div>\n\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\admin-custos.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#1f2937\">\n    <title>Gestão de Custos | Admin</title>\n\n    <!-- FAVICON -->\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n\n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- FIREBASE (SDKs) -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES & ÍCONES -->\n    <link\n        href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\"\n        rel=\"stylesheet\">\n    <link href=\"https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { sans: ['DM Sans', 'sans-serif'], serif: ['Playfair Display', 'serif'] },\n                    colors: {\n                        brand: { 50: '#fff1f2', 100: '#ffe4e6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d', 900: '#831843' }\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        /* Ajustes Visuais */\n        body {\n            -webkit-tap-highlight-color: transparent;\n            background-color: #f9fafb;\n        }\n\n        ::-webkit-scrollbar {\n            width: 4px;\n        }\n\n        ::-webkit-scrollbar-track {\n            background: transparent;\n        }\n\n        ::-webkit-scrollbar-thumb {\n            background: #cbd5e1;\n            border-radius: 10px;\n        }\n\n        .glass-header {\n            background: rgba(255, 255, 255, 0.98);\n            border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n        }\n\n        .pb-safe {\n            padding-bottom: env(safe-area-inset-bottom);\n        }\n\n        /* Animações */\n        .slide-in-right {\n            animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;\n        }\n\n        .fade-in {\n            animation: fadeIn 0.3s ease-out;\n        }\n\n        .spin {\n            animation: spin 1s linear infinite;\n        }\n\n        @keyframes slideInRight {\n            from {\n                transform: translateX(100%);\n            }\n\n            to {\n                transform: translateX(0);\n            }\n        }\n\n        @keyframes fadeIn {\n            from {\n                opacity: 0;\n            }\n\n            to {\n                opacity: 1;\n            }\n        }\n\n        @keyframes spin {\n            100% {\n                transform: rotate(360deg);\n            }\n        }\n    </style>\n</head>\n\n<body class=\"h-screen flex flex-col overflow-hidden\">\n\n    <!-- TELA 1: LISTA (PADRÃO ADMIN) -->\n    <div id=\"screen-list\" class=\"flex-grow flex flex-col h-full bg-gray-50\">\n\n        <!-- HEADER -->\n        <header class=\"glass-header h-16 flex items-center justify-between px-4 z-30 flex-shrink-0\">\n            <div class=\"flex items-center gap-3\">\n                <div\n                    class=\"bg-brand-600 text-white w-8 h-8 rounded-lg flex items-center justify-center shadow-brand-200 shadow-md\">\n                    <i class=\"ri-calculator-line text-lg\"></i>\n                </div>\n                <h1 class=\"font-bold text-gray-800 text-lg tracking-tight\">Custos</h1>\n            </div>\n            <nav class=\"flex gap-3\">\n                <a href=\"admin-produtos.html\" class=\"text-sm font-bold text-gray-500 hover:text-brand-600\">Produtos</a>\n                <a href=\"admin-pedidos.html\" class=\"text-sm font-bold text-gray-500 hover:text-brand-600\">Pedidos</a>\n                <a href=\"index.html\" target=\"_blank\"\n                    class=\"w-8 h-8 bg-brand-50 text-brand-600 rounded-full flex items-center justify-center\">\n                    <i class=\"ri-store-2-line\"></i>\n                </a>\n                <a href=\"guia-custos.html\" target=\"_blank\"\n                    class=\"w-8 h-8 bg-brand-50 text-brand-600 rounded-full flex items-center justify-center\"\n                    title=\"Ajuda\">\n                    <i class=\"ri-question-line\"></i>\n                </a>\n\n            </nav>\n        </header>\n\n        <!-- SEARCH -->\n        <div class=\"px-4 py-3 bg-white border-b border-gray-100 flex-shrink-0 z-20\">\n            <div class=\"relative\">\n                <i class=\"ri-search-line absolute left-3 top-3 text-gray-400\"></i>\n                <input type=\"text\" id=\"search-input\" placeholder=\"Buscar produto para calcular...\"\n                    class=\"w-full pl-10 pr-4 py-2.5 bg-gray-100 border-transparent focus:bg-white focus:border-brand-500 focus:ring-1 ring-brand-200 rounded-xl text-sm font-bold transition-all outline-none\">\n            </div>\n            <div class=\"flex justify-between items-center mt-2 px-1\">\n                <span class=\"text-[10px] font-bold text-gray-400 uppercase\">Produtos Cadastrados</span>\n                <span id=\"total-produtos\"\n                    class=\"bg-gray-100 text-gray-600 px-2 py-0.5 rounded text-xs font-black\">0</span>\n            </div>\n        </div>\n\n        <!-- LISTA DE PRODUTOS -->\n        <main id=\"lista-produtos\" class=\"flex-grow overflow-y-auto p-4 space-y-3 pb-safe\">\n            <!-- Renderizado via JS -->\n        </main>\n    </div>\n\n    <!-- TELA 2: CALCULADORA (OVERLAY) -->\n    <div id=\"screen-detail\" class=\"fixed inset-0 bg-gray-100 z-50 flex flex-col hidden\">\n\n        <!-- TOP BAR -->\n        <div\n            class=\"bg-white px-4 h-16 border-b border-gray-200 flex justify-between items-center shadow-sm flex-shrink-0 z-30\">\n            <button onclick=\"fecharCalculadora()\"\n                class=\"w-10 h-10 -ml-2 flex items-center justify-center text-gray-500 hover:text-brand-600\">\n                <i class=\"ri-arrow-left-s-line text-2xl\"></i>\n            </button>\n            <span class=\"font-bold text-gray-800\">Calculadora de Lucro</span>\n            <button id=\"btn-salvar\" onclick=\"salvarFichaTecnica()\"\n                class=\"bg-gray-900 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-lg flex items-center gap-2 active:scale-95 transition-transform\">\n                <i class=\"ri-save-line\"></i> Salvar\n            </button>\n        </div>\n\n        <!-- CONTEÚDO SCROLL -->\n        <div id=\"scroll-content\" class=\"flex-grow overflow-y-auto pb-32\">\n\n            <!-- INFO PRODUTO & SIMULADOR -->\n            <div class=\"bg-white p-6 border-b border-gray-200 shadow-sm mb-4 relative\">\n                <div class=\"flex gap-4 items-center\">\n                    <img id=\"detail-img\" src=\"\"\n                        class=\"w-16 h-16 rounded-xl bg-gray-100 object-cover border border-gray-200 shadow-sm\">\n                    <div class=\"flex-1\">\n                        <h2 id=\"detail-nome\" class=\"font-serif font-black text-xl text-gray-900 leading-tight mb-1\">Nome\n                            Produto</h2>\n                        <div\n                            class=\"flex items-center gap-2 bg-gray-50 w-fit px-2 py-1 rounded-lg border border-gray-200\">\n                            <span class=\"text-[10px] font-bold text-gray-400 uppercase\">Venda (R$)</span>\n                            <input type=\"number\" id=\"input-preco-simulado\" oninput=\"atualizarPrecoSimulado(this.value)\"\n                                class=\"bg-transparent w-20 font-black text-gray-800 outline-none border-b border-dashed border-gray-300 focus:border-brand-500 text-sm\">\n                            <i class=\"ri-edit-line text-gray-300 text-xs\"></i>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Dica Simulador -->\n                <div class=\"mt-3 flex items-start gap-2 bg-blue-50 p-2 rounded-lg border border-blue-100\">\n                    <i class=\"ri-lightbulb-flash-line text-blue-500 mt-0.5\"></i>\n                    <p class=\"text-[10px] text-blue-700 leading-tight\"><strong>Dica:</strong> Altere o preço de venda\n                        acima para simular cenários. Isso não muda o preço na loja, apenas aqui para cálculo.</p>\n                </div>\n            </div>\n\n            <div class=\"px-4 space-y-6\">\n\n                <!-- SEÇÃO 1: INGREDIENTES -->\n                <div>\n                    <div class=\"flex justify-between items-end mb-3 px-1\">\n                        <h3 class=\"font-bold text-gray-800 text-sm flex items-center gap-2\">\n                            <span\n                                class=\"w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs\">1</span>\n                            Ingredientes\n                        </h3>\n                        <button onclick=\"toggleTooltip('tip-ing')\" class=\"text-gray-400 text-xs hover:text-brand-500\"><i\n                                class=\"ri-question-line\"></i> Ajuda</button>\n                    </div>\n\n                    <!-- Tooltip -->\n                    <div id=\"tip-ing\"\n                        class=\"hidden mb-3 bg-gray-800 text-white p-3 rounded-xl text-xs shadow-lg animate-fade-in\">\n                        Liste tudo que vai na receita. O sistema calcula o custo proporcional. Ex: Se comprou 1kg de\n                        Farinha por R$5,00 e usou 200g, o custo é R$1,00.\n                    </div>\n\n                    <div id=\"lista-ingredientes\">\n                        <!-- Injetado via JS -->\n                    </div>\n\n                    <button onclick=\"adicionarIngrediente()\"\n                        class=\"w-full py-3 border-2 border-dashed border-gray-300 text-gray-500 rounded-xl font-bold text-xs hover:border-brand-400 hover:text-brand-600 hover:bg-brand-50 transition-colors flex items-center justify-center gap-2\">\n                        <i class=\"ri-add-circle-line text-lg\"></i> Adicionar Ingrediente\n                    </button>\n                </div>\n\n                <!-- SEÇÃO 2: CUSTOS EXTRAS -->\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n\n                    <!-- Custos Fixos (R$) -->\n                    <div class=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200\">\n                        <div class=\"flex justify-between items-center mb-3\">\n                            <h3 class=\"font-bold text-gray-700 text-xs uppercase flex items-center gap-2\">\n                                <i class=\"ri-money-dollar-box-line text-brand-500\"></i> Custos Extras (R$)\n                            </h3>\n                            <button onclick=\"addExtra('fixos')\"\n                                class=\"text-[10px] bg-gray-100 hover:bg-brand-100 text-gray-600 hover:text-brand-600 px-2 py-1 rounded font-bold transition\">+\n                                Add</button>\n                        </div>\n                        <div id=\"lista-custos-fixos\" class=\"space-y-1 min-h-[40px]\"></div>\n                        <p class=\"text-[10px] text-gray-400 mt-2 italic\">Ex: Embalagem, Adesivo, Estimativa de Gás/Luz\n                            por unidade.</p>\n                    </div>\n\n                    <!-- Taxas (%) -->\n                    <div class=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200\">\n                        <div class=\"flex justify-between items-center mb-3\">\n                            <h3 class=\"font-bold text-gray-700 text-xs uppercase flex items-center gap-2\">\n                                <i class=\"ri-percent-line text-purple-500\"></i> Taxas de Venda (%)\n                            </h3>\n                            <button onclick=\"addExtra('taxas')\"\n                                class=\"text-[10px] bg-gray-100 hover:bg-purple-100 text-gray-600 hover:text-purple-600 px-2 py-1 rounded font-bold transition\">+\n                                Add</button>\n                        </div>\n                        <div id=\"lista-taxas-venda\" class=\"space-y-1 min-h-[40px]\"></div>\n                        <p class=\"text-[10px] text-gray-400 mt-2 italic\">Ex: Taxa do iFood (12%), Maquininha (2-5%),\n                            Imposto.</p>\n                    </div>\n                </div>\n\n                <!-- SEÇÃO 3: RESULTADO FINAL -->\n                <div id=\"card-resultado\"\n                    class=\"bg-gray-900 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden mb-6 transition-colors duration-500\">\n                    <!-- Background Decoration -->\n                    <div\n                        class=\"absolute right-0 top-0 w-32 h-32 bg-white opacity-5 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none\">\n                    </div>\n\n                    <div class=\"flex justify-between items-start mb-4 relative z-10\">\n                        <div>\n                            <p class=\"text-gray-400 text-[10px] font-bold uppercase tracking-wider mb-1\">Seu Lucro\n                                Líquido</p>\n                            <p id=\"resultado-lucro\" class=\"text-3xl font-black tracking-tight\">R$ 0,00</p>\n                        </div>\n                        <div id=\"status-lucro\"\n                            class=\"bg-white/10 backdrop-blur-md px-3 py-1 rounded-lg text-xs font-bold border border-white/10\">\n                            Calculando...\n                        </div>\n                    </div>\n\n                    <div class=\"space-y-1 text-xs text-gray-400 border-t border-white/10 pt-3 relative z-10\">\n                        <div class=\"flex justify-between\">\n                            <span>(-) Ingredientes</span>\n                            <span id=\"resumo-ingredientes\" class=\"text-white font-mono\">R$ 0,00</span>\n                        </div>\n                        <div class=\"flex justify-between\">\n                            <span>(-) Custos Fixos (Emb/Gás)</span>\n                            <span id=\"resumo-fixos\" class=\"text-white font-mono\">R$ 0,00</span>\n                        </div>\n                        <div class=\"flex justify-between\">\n                            <span>(-) Taxas (Apps/Cartão)</span>\n                            <span id=\"resumo-taxas\" class=\"text-white font-mono\">R$ 0,00</span>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n    </div>\n\n    <!-- LÓGICA (NOVO ARQUIVO) -->\n    <script src=\"admin-custos.js\"></script>\n\n</body>\n\n</html>"
    },
    {
        "caminho": "Reh\\admin-custos.js",
        "conteudo": "// --- CONFIGURAÇÃO DO FIREBASE ---\nconst firebaseConfig = {\n    apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n    authDomain: \"renata-26079.firebaseapp.com\",\n    projectId: \"renata-26079\",\n    storageBucket: \"renata-26079.firebasestorage.app\",\n    messagingSenderId: \"995787482442\",\n    appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n};\n\n// Inicializa o Firebase\nif (!firebase.apps.length) {\n    firebase.initializeApp(firebaseConfig);\n}\nconst db = firebase.firestore();\nconst auth = firebase.auth();\n\n// --- VARIÁVEIS GLOBAIS ---\nlet produtoAtual = null;\nlet fichaTecnica = {\n    ingredientes: [],\n    custos_fixos: [],\n    taxas_venda: []\n};\n\n// Padrões iniciais (para produtos novos)\nlet configPadrao = {\n    custos_fixos: [\n        { nome: 'Embalagem', valor: 1.50 },\n        { nome: 'Adesivo/Fita', valor: 0.30 },\n        { nome: 'Gás/Luz (Estimado)', valor: 0.50 }\n    ],\n    taxas_venda: [\n        { nome: 'Taxa iFood', valor: 12 }, // %\n        { nome: 'Maquininha', valor: 4 },  // %\n        { nome: 'Impostos', valor: 0 }\n    ]\n};\n\nlet precoSimulado = 0;\nlet produtosCache = [];\n\n// --- INICIALIZAÇÃO SEGURA (CORREÇÃO DO PROBLEMA) ---\ndocument.addEventListener('DOMContentLoaded', () => {\n    // Listener de Autenticação\n    // Só carrega os dados DEPOIS que confirmar que o usuário está logado\n    auth.onAuthStateChanged(user => {\n        if (user) {\n            console.log(\"Usuário autenticado:\", user.uid);\n            carregarConfiguracoesGlobais();\n            carregarListaProdutos();\n        } else {\n            console.log(\"Fazendo login anônimo...\");\n            auth.signInAnonymously().catch(erro => {\n                console.error(\"Erro no login:\", erro);\n                alert(\"Erro ao conectar com o servidor. Verifique sua internet.\");\n            });\n        }\n    });\n\n    // Configura a busca\n    const searchInput = document.getElementById('search-input');\n    if (searchInput) {\n        searchInput.addEventListener('input', filtrarProdutos);\n    }\n});\n\n// --- 1. CARREGAR DADOS ---\n\nfunction carregarConfiguracoesGlobais() {\n    db.collection('config').doc('custos_padrao').get()\n        .then(doc => {\n            if (doc.exists) {\n                configPadrao = doc.data();\n            }\n        })\n        .catch(erro => console.log(\"Usando configuração padrão local.\"));\n}\n\nfunction carregarListaProdutos() {\n    const listaEl = document.getElementById('lista-produtos');\n    listaEl.innerHTML = `\n        <div class=\"flex flex-col items-center justify-center h-64 text-gray-400 animate-pulse\">\n            <i class=\"ri-loader-4-line text-3xl mb-2 spin\"></i>\n            <p>Buscando seus produtos...</p>\n        </div>`;\n\n    // Busca em tempo real\n    db.collection('produtos').orderBy('nome').onSnapshot(snap => {\n        produtosCache = [];\n        listaEl.innerHTML = '';\n\n        if (snap.empty) {\n            listaEl.innerHTML = `\n                <div class=\"text-center py-12 px-6\">\n                    <div class=\"bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4\">\n                        <i class=\"ri-shopping-bag-3-line text-2xl text-gray-400\"></i>\n                    </div>\n                    <h3 class=\"text-gray-600 font-bold\">Nenhum produto encontrado</h3>\n                    <p class=\"text-xs text-gray-400 mt-1\">Cadastre produtos na aba \"Produtos\" primeiro.</p>\n                </div>`;\n            return;\n        }\n\n        snap.forEach(doc => {\n            produtosCache.push({ id: doc.id, ...doc.data() });\n        });\n\n        renderizarLista(produtosCache);\n    }, erro => {\n        console.error(\"Erro ao buscar produtos:\", erro);\n        listaEl.innerHTML = `<div class=\"p-4 text-center text-red-500\">Erro ao carregar produtos: ${erro.message}</div>`;\n    });\n}\n\nfunction renderizarLista(lista) {\n    const listaEl = document.getElementById('lista-produtos');\n    listaEl.innerHTML = '';\n\n    lista.forEach(p => {\n        const div = document.createElement('div');\n        div.className = \"bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex items-center gap-3 active:bg-gray-50 transition-colors cursor-pointer mb-3 group\";\n        div.onclick = () => abrirCalculadora(p);\n        div.innerHTML = `\n            <div class=\"w-12 h-12 rounded-lg bg-gray-100 overflow-hidden border border-gray-200 flex-shrink-0 relative\">\n                <img src=\"${p.imagem}\" class=\"w-full h-full object-cover\" onerror=\"this.src='https://placehold.co/100?text=Foto'\">\n            </div>\n            <div class=\"flex-1 min-w-0\">\n                <h4 class=\"font-bold text-gray-800 truncate text-sm group-hover:text-brand-600 transition-colors\">${p.nome}</h4>\n                <p class=\"text-xs text-gray-400\">Venda atual: <span class=\"font-bold text-gray-600\">${formatarMoeda(p.preco)}</span></p>\n            </div>\n            <div class=\"text-gray-300 group-hover:text-brand-500 transition-colors\">\n                <i class=\"ri-arrow-right-s-line text-xl\"></i>\n            </div>\n        `;\n        listaEl.appendChild(div);\n    });\n\n    const totalEl = document.getElementById('total-produtos');\n    if (totalEl) totalEl.innerText = lista.length;\n}\n\nfunction filtrarProdutos() {\n    const termo = document.getElementById('search-input').value.toLowerCase();\n    const filtrados = produtosCache.filter(p => p.nome.toLowerCase().includes(termo));\n    renderizarLista(filtrados);\n}\n\n// --- 2. CALCULADORA (LÓGICA) ---\n\nasync function abrirCalculadora(produto) {\n    produtoAtual = produto;\n    precoSimulado = produto.preco || 0;\n\n    // Transição de Tela\n    document.getElementById('screen-list').classList.add('hidden');\n    document.getElementById('screen-detail').classList.remove('hidden');\n    document.getElementById('screen-detail').classList.add('slide-in-right');\n\n    // Reseta Scroll\n    document.getElementById('scroll-content').scrollTop = 0;\n\n    // Preenche Header\n    document.getElementById('detail-img').src = produto.imagem || 'https://placehold.co/100';\n    document.getElementById('detail-nome').innerText = produto.nome;\n    document.getElementById('input-preco-simulado').value = produto.preco;\n\n    // Reseta Dados Locais\n    fichaTecnica = { ingredientes: [], custos_fixos: [], taxas_venda: [] };\n\n    // Tenta buscar ficha existente no Firestore\n    try {\n        const doc = await db.collection('fichas_tecnicas').doc(produto.id).get();\n\n        if (doc.exists) {\n            const data = doc.data();\n            fichaTecnica.ingredientes = data.ingredientes || [];\n            // Se não tiver custos salvos, usa o padrão global\n            fichaTecnica.custos_fixos = data.custos_fixos || JSON.parse(JSON.stringify(configPadrao.custos_fixos));\n            fichaTecnica.taxas_venda = data.taxas_venda || JSON.parse(JSON.stringify(configPadrao.taxas_venda));\n        } else {\n            // Ficha nova: Usa padrões\n            fichaTecnica.custos_fixos = JSON.parse(JSON.stringify(configPadrao.custos_fixos));\n            fichaTecnica.taxas_venda = JSON.parse(JSON.stringify(configPadrao.taxas_venda));\n            adicionarIngrediente(false); // Adiciona um vazio pra começar\n        }\n\n        renderizarIngredientes();\n        renderizarCustosExtras();\n        calcularResultados();\n\n    } catch (erro) {\n        console.error(\"Erro ao abrir calculadora:\", erro);\n        alert(\"Erro ao carregar detalhes do produto.\");\n    }\n}\n\nfunction fecharCalculadora() {\n    const screenDetail = document.getElementById('screen-detail');\n    screenDetail.classList.remove('slide-in-right');\n    screenDetail.classList.add('hidden');\n    document.getElementById('screen-list').classList.remove('hidden');\n}\n\n// --- 3. GESTÃO DE INGREDIENTES ---\n\nfunction adicionarIngrediente(render = true) {\n    fichaTecnica.ingredientes.push({\n        nome: '',\n        qtd_compra: 1,\n        unidade_compra: 'kg',\n        preco_compra: 0,\n        qtd_uso: 0,\n        unidade_uso: 'g'\n    });\n\n    if (render) {\n        renderizarIngredientes();\n        // Rola para o novo item\n        setTimeout(() => {\n            const list = document.getElementById('lista-ingredientes');\n            if (list.lastElementChild) {\n                list.lastElementChild.scrollIntoView({ behavior: 'smooth', block: 'center' });\n            }\n        }, 100);\n    }\n}\n\nfunction removerIngrediente(idx) {\n    if (confirm(\"Remover este ingrediente?\")) {\n        fichaTecnica.ingredientes.splice(idx, 1);\n        renderizarIngredientes();\n        calcularResultados();\n    }\n}\n\nfunction renderizarIngredientes() {\n    const container = document.getElementById('lista-ingredientes');\n    container.innerHTML = '';\n\n    fichaTecnica.ingredientes.forEach((ing, idx) => {\n        const custo = calcularCustoItem(ing);\n\n        const el = document.createElement('div');\n        el.className = \"bg-white p-4 rounded-xl border border-gray-200 shadow-sm mb-3 relative group fade-in\";\n        el.innerHTML = `\n            <button onclick=\"removerIngrediente(${idx})\" class=\"absolute -top-2 -right-2 bg-red-100 text-red-500 w-6 h-6 rounded-full flex items-center justify-center shadow-sm z-10\">\n                <i class=\"ri-close-line\"></i>\n            </button>\n            \n            <div class=\"mb-3\">\n                <input type=\"text\" value=\"${ing.nome}\" onchange=\"atualizarIng(${idx}, 'nome', this.value)\" \n                    class=\"w-full font-bold text-gray-800 border-b border-gray-200 focus:border-brand-500 outline-none pb-1 placeholder-gray-300 text-sm\" \n                    placeholder=\"Nome do Ingrediente (ex: Farinha)\">\n            </div>\n\n            <div class=\"grid grid-cols-2 gap-3 text-xs\">\n                <!-- Compra -->\n                <div class=\"bg-gray-50 p-2 rounded-lg border border-gray-100\">\n                    <p class=\"text-gray-400 uppercase font-bold mb-1 text-[10px]\">Compra (Emb.)</p>\n                    <div class=\"flex items-center gap-2 mb-2\">\n                        <span class=\"text-gray-400\">R$</span>\n                        <input type=\"number\" step=\"0.01\" value=\"${ing.preco_compra}\" onchange=\"atualizarIng(${idx}, 'preco_compra', this.value)\" class=\"w-full bg-transparent border-b border-gray-200 font-bold outline-none\" placeholder=\"0.00\">\n                    </div>\n                    <div class=\"flex gap-1\">\n                        <input type=\"number\" value=\"${ing.qtd_compra}\" onchange=\"atualizarIng(${idx}, 'qtd_compra', this.value)\" class=\"w-1/2 bg-white border rounded px-1 py-0.5 text-center\" placeholder=\"Qtd\">\n                        <select onchange=\"atualizarIng(${idx}, 'unidade_compra', this.value)\" class=\"w-1/2 bg-white border rounded px-1 py-0.5\">\n                            <option value=\"kg\" ${ing.unidade_compra === 'kg' ? 'selected' : ''}>Kg</option>\n                            <option value=\"g\" ${ing.unidade_compra === 'g' ? 'selected' : ''}>g</option>\n                            <option value=\"l\" ${ing.unidade_compra === 'l' ? 'selected' : ''}>L</option>\n                            <option value=\"ml\" ${ing.unidade_compra === 'ml' ? 'selected' : ''}>ml</option>\n                            <option value=\"un\" ${ing.unidade_compra === 'un' ? 'selected' : ''}>Un</option>\n                        </select>\n                    </div>\n                </div>\n\n                <!-- Uso -->\n                <div class=\"bg-brand-50/50 p-2 rounded-lg border border-brand-100\">\n                    <p class=\"text-brand-400 uppercase font-bold mb-1 text-[10px]\">Uso na Receita</p>\n                    <div class=\"flex gap-1 mt-4\">\n                        <input type=\"number\" value=\"${ing.qtd_uso}\" onchange=\"atualizarIng(${idx}, 'qtd_uso', this.value)\" class=\"w-1/2 bg-white border border-brand-200 rounded px-1 py-0.5 text-center font-bold text-brand-700\" placeholder=\"Qtd\">\n                        <select onchange=\"atualizarIng(${idx}, 'unidade_uso', this.value)\" class=\"w-1/2 bg-white border border-brand-200 rounded px-1 py-0.5 text-brand-700 font-bold\">\n                            <option value=\"kg\" ${ing.unidade_uso === 'kg' ? 'selected' : ''}>Kg</option>\n                            <option value=\"g\" ${ing.unidade_uso === 'g' ? 'selected' : ''}>g</option>\n                            <option value=\"l\" ${ing.unidade_uso === 'l' ? 'selected' : ''}>L</option>\n                            <option value=\"ml\" ${ing.unidade_uso === 'ml' ? 'selected' : ''}>ml</option>\n                            <option value=\"un\" ${ing.unidade_uso === 'un' ? 'selected' : ''}>Un</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"mt-2 pt-2 border-t border-gray-50 flex justify-between items-center\">\n                <span class=\"text-[10px] text-gray-400 font-bold uppercase\">Custo Proporcional</span>\n                <span class=\"text-sm font-black text-gray-800\">${formatarMoeda(custo)}</span>\n            </div>\n        `;\n        container.appendChild(el);\n    });\n}\n\nfunction atualizarIng(idx, campo, valor) {\n    if (['preco_compra', 'qtd_compra', 'qtd_uso'].includes(campo)) {\n        fichaTecnica.ingredientes[idx][campo] = parseFloat(valor) || 0;\n    } else {\n        fichaTecnica.ingredientes[idx][campo] = valor;\n    }\n    // Não re-renderiza tudo para não perder foco do input, apenas recalcula\n    const custo = calcularCustoItem(fichaTecnica.ingredientes[idx]);\n    // Atualiza visualmente o custo desse item específico se necessário, \n    // mas o calcularResultados atualiza o total geral\n    calcularResultados();\n}\n\nfunction calcularCustoItem(ing) {\n    const fatores = { 'kg': 1000, 'g': 1, 'l': 1000, 'ml': 1, 'un': 1 };\n    const baseCompra = ing.qtd_compra * (fatores[ing.unidade_compra] || 1);\n    const baseUso = ing.qtd_uso * (fatores[ing.unidade_uso] || 1);\n\n    if (baseCompra <= 0) return 0;\n    return (ing.preco_compra / baseCompra) * baseUso;\n}\n\n// --- 4. CUSTOS EXTRAS ---\n\nfunction renderizarCustosExtras() {\n    // Fixos (R$)\n    const listaFixos = document.getElementById('lista-custos-fixos');\n    listaFixos.innerHTML = '';\n    fichaTecnica.custos_fixos.forEach((item, idx) => {\n        listaFixos.innerHTML += `\n            <div class=\"flex items-center gap-2 mb-2\">\n                <button onclick=\"removerExtra('fixos', ${idx})\" class=\"text-red-400 hover:text-red-600\"><i class=\"ri-close-circle-line\"></i></button>\n                <input type=\"text\" value=\"${item.nome}\" onchange=\"atualizarExtra('fixos', ${idx}, 'nome', this.value)\" class=\"flex-1 bg-transparent border-b border-gray-200 text-xs py-1 text-gray-600 outline-none focus:border-brand-500\">\n                <div class=\"flex items-center w-20\">\n                    <span class=\"text-xs text-gray-400 mr-1\">R$</span>\n                    <input type=\"number\" step=\"0.01\" value=\"${item.valor}\" onchange=\"atualizarExtra('fixos', ${idx}, 'valor', this.value)\" class=\"w-full bg-gray-50 rounded p-1 text-xs font-bold text-right outline-none focus:bg-white focus:ring-1 ring-brand-200\">\n                </div>\n            </div>`;\n    });\n\n    // Taxas (%)\n    const listaTaxas = document.getElementById('lista-taxas-venda');\n    listaTaxas.innerHTML = '';\n    fichaTecnica.taxas_venda.forEach((item, idx) => {\n        listaTaxas.innerHTML += `\n            <div class=\"flex items-center gap-2 mb-2\">\n                <button onclick=\"removerExtra('taxas', ${idx})\" class=\"text-red-400 hover:text-red-600\"><i class=\"ri-close-circle-line\"></i></button>\n                <input type=\"text\" value=\"${item.nome}\" onchange=\"atualizarExtra('taxas', ${idx}, 'nome', this.value)\" class=\"flex-1 bg-transparent border-b border-gray-200 text-xs py-1 text-gray-600 outline-none focus:border-brand-500\">\n                <div class=\"flex items-center w-16\">\n                    <input type=\"number\" step=\"0.1\" value=\"${item.valor}\" onchange=\"atualizarExtra('taxas', ${idx}, 'valor', this.value)\" class=\"w-full bg-gray-50 rounded p-1 text-xs font-bold text-right outline-none focus:bg-white focus:ring-1 ring-brand-200\">\n                    <span class=\"text-xs text-gray-400 ml-1\">%</span>\n                </div>\n            </div>`;\n    });\n}\n\nfunction addExtra(tipo) {\n    if (tipo === 'fixos') fichaTecnica.custos_fixos.push({ nome: 'Novo Custo', valor: 0 });\n    if (tipo === 'taxas') fichaTecnica.taxas_venda.push({ nome: 'Nova Taxa', valor: 0 });\n    renderizarCustosExtras();\n    calcularResultados();\n}\n\nfunction removerExtra(tipo, idx) {\n    if (tipo === 'fixos') fichaTecnica.custos_fixos.splice(idx, 1);\n    if (tipo === 'taxas') fichaTecnica.taxas_venda.splice(idx, 1);\n    renderizarCustosExtras();\n    calcularResultados();\n}\n\nfunction atualizarExtra(tipo, idx, campo, valor) {\n    const target = tipo === 'fixos' ? fichaTecnica.custos_fixos : fichaTecnica.taxas_venda;\n    target[idx][campo] = campo === 'valor' ? (parseFloat(valor) || 0) : valor;\n    calcularResultados();\n}\n\n// --- 5. CÁLCULO DE LUCRO ---\n\nfunction atualizarPrecoSimulado(val) {\n    precoSimulado = parseFloat(val) || 0;\n    calcularResultados();\n}\n\nfunction calcularResultados() {\n    // 1. Ingredientes\n    let custoIngredientes = 0;\n    fichaTecnica.ingredientes.forEach(ing => custoIngredientes += calcularCustoItem(ing));\n\n    // 2. Custos Fixos\n    let custoFixos = 0;\n    fichaTecnica.custos_fixos.forEach(item => custoFixos += item.valor);\n\n    // 3. Taxas (%)\n    let percentualTaxas = 0;\n    fichaTecnica.taxas_venda.forEach(item => percentualTaxas += item.valor);\n    const valorTaxas = precoSimulado * (percentualTaxas / 100);\n\n    // 4. Resultado\n    const custoTotal = custoIngredientes + custoFixos + valorTaxas;\n    const lucro = precoSimulado - custoTotal;\n    const margem = precoSimulado > 0 ? (lucro / precoSimulado) * 100 : 0;\n\n    // --- Atualizar Tela ---\n    document.getElementById('resumo-ingredientes').innerText = formatarMoeda(custoIngredientes);\n    document.getElementById('resumo-fixos').innerText = formatarMoeda(custoFixos);\n    document.getElementById('resumo-taxas').innerText = `- ${formatarMoeda(valorTaxas)}`;\n\n    const elLucro = document.getElementById('resultado-lucro');\n    const elCard = document.getElementById('card-resultado');\n    const elStatus = document.getElementById('status-lucro');\n\n    elLucro.innerText = formatarMoeda(lucro);\n\n    if (lucro > 0) {\n        elCard.className = \"bg-gray-900 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden transition-colors duration-500\";\n        elLucro.className = \"text-3xl font-black text-green-400\";\n        elStatus.innerHTML = `<i class=\"ri-thumb-up-line text-green-400 mr-1\"></i> Lucrativo (${margem.toFixed(1)}%)`;\n    } else {\n        elCard.className = \"bg-red-900 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden transition-colors duration-500\";\n        elLucro.className = \"text-3xl font-black text-white\";\n        elStatus.innerHTML = `<i class=\"ri-alert-line text-yellow-400 mr-1\"></i> Prejuízo! Aumente o preço.`;\n    }\n}\n\n// --- 6. SALVAR NO BANCO ---\n\nasync function salvarFichaTecnica() {\n    const btn = document.getElementById('btn-salvar');\n    const originalHtml = btn.innerHTML;\n    btn.innerHTML = '<i class=\"ri-loader-4-line spin\"></i>';\n    btn.disabled = true;\n\n    try {\n        const dadosSalvar = {\n            produto_id: produtoAtual.id,\n            nome_produto: produtoAtual.nome,\n            imagem_produto: produtoAtual.imagem,\n            ingredientes: fichaTecnica.ingredientes,\n            custos_fixos: fichaTecnica.custos_fixos,\n            taxas_venda: fichaTecnica.taxas_venda,\n            ultima_atualizacao: new Date().toISOString()\n        };\n\n        await db.collection('fichas_tecnicas').doc(produtoAtual.id).set(dadosSalvar);\n\n        btn.innerHTML = '<i class=\"ri-check-line\"></i> Salvo!';\n        btn.classList.add('bg-green-600', 'border-green-600');\n\n        setTimeout(() => {\n            btn.innerHTML = originalHtml;\n            btn.classList.remove('bg-green-600', 'border-green-600');\n            btn.disabled = false;\n        }, 2000);\n\n    } catch (e) {\n        console.error(e);\n        alert('Erro ao salvar: ' + e.message);\n        btn.innerHTML = originalHtml;\n        btn.disabled = false;\n    }\n}\n\n// --- UTILITÁRIOS ---\n\nfunction formatarMoeda(v) {\n    return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v || 0);\n}\n\nfunction toggleTooltip(id) {\n    const el = document.getElementById(id);\n    el.classList.toggle('hidden');\n    if (!el.classList.contains('hidden')) setTimeout(() => el.classList.add('hidden'), 5000);\n}"
    },
    {
        "caminho": "Reh\\admin-pedidos.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#1f2937\">\n    <title>Gestão de Pedidos | Cozinha</title>\n    \n    <!-- FAVICON -->\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n\n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- FIREBASE -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES -->\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { sans: ['DM Sans', 'sans-serif'], serif: ['Playfair Display', 'serif'] },\n                    colors: { \n                        brand: { 50: '#fff1f2', 100: '#ffe4e6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d' } \n                    },\n                    animation: {\n                        'bounce-slow': 'bounce 2s infinite',\n                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        ::-webkit-scrollbar { width: 6px; height: 6px; }\n        ::-webkit-scrollbar-track { background: #f1f1f1; }\n        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }\n        .glass-header { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0,0,0,0.05); }\n        .pb-safe-area { padding-bottom: env(safe-area-inset-bottom); }\n        \n        /* Badge Pulsante */\n        .badge-pulse {\n            box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);\n            animation: pulse-red 2s infinite;\n        }\n        @keyframes pulse-red {\n            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }\n            70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(239, 68, 68, 0); }\n            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }\n        }\n    </style>\n\n    <script>\n        // --- FIREBASE CONFIG ---\n        const firebaseConfig = {\n            apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n            authDomain: \"renata-26079.firebaseapp.com\",\n            projectId: \"renata-26079\",\n            storageBucket: \"renata-26079.firebasestorage.app\",\n            messagingSenderId: \"995787482442\",\n            appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n        };\n\n        firebase.initializeApp(firebaseConfig);\n        const db = firebase.firestore();\n        const auth = firebase.auth();\n\n        // --- VARIÁVEIS GLOBAIS ---\n        const formatarMoeda = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v);\n        let configuracaoGlobal = { status: 'Fechada', horario_abertura: '18:00', horario_fechamento: '23:00', dias: 'Seg-Sab' };\n        let pedidoParaRecusar = null;\n        \n        // Variáveis de controle de áudio\n        let audioAlert = null;\n        let primeiraCargaDelivery = true;\n        let primeiraCargaEncomenda = true;\n        \n        // --- LIFECYCLE ---\n        document.addEventListener('DOMContentLoaded', () => {\n            auth.onAuthStateChanged(user => { if (!user) auth.signInAnonymously(); });\n\n            // Inicializa Áudio\n            audioAlert = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3');\n\n            // Listeners\n            initDeliveryListener();\n            initEncomendasListener();\n            carregarConfiguracoes();\n            \n            mostrarPainel('pedidos');\n\n            // Navegação\n            document.getElementById('nav-pedidos').addEventListener('click', () => mostrarPainel('pedidos'));\n            document.getElementById('nav-encomendas').addEventListener('click', () => mostrarPainel('encomendas'));\n            document.getElementById('nav-relatorios').addEventListener('click', () => mostrarPainel('relatorios'));\n\n            // Config Loja\n            document.getElementById('form-config').addEventListener('submit', salvarConfiguracoes);\n            document.getElementById('btn-toggle-status').addEventListener('click', toggleStatusLoja);\n\n            // Relatórios\n            document.getElementById('btn-filtrar-relatorio').addEventListener('click', gerarRelatorio);\n            const hoje = new Date().toISOString().split('T')[0];\n            document.getElementById('data-inicio').value = hoje;\n            document.getElementById('data-fim').value = hoje;\n            gerarRelatorio();\n\n            // Habilitar som no primeiro clique (política dos navegadores)\n            document.body.addEventListener('click', habilitarAudio, { once: true });\n        });\n\n        function habilitarAudio() {\n            // Tenta tocar e pausar rapidinho só para \"desbloquear\" o áudio no navegador\n            audioAlert.play().then(() => {\n                audioAlert.pause();\n                audioAlert.currentTime = 0;\n            }).catch(e => console.log(\"Aguardando interação para áudio\"));\n        }\n\n        function tocarAlerta() {\n            if(audioAlert) {\n                audioAlert.currentTime = 0;\n                audioAlert.play().catch(e => console.log(\"Erro ao tocar som: \", e));\n            }\n        }\n\n        function mostrarAlertaVisual(msg, tipo = 'novo') {\n            const alerta = document.getElementById('alerta-novo-pedido');\n            const texto = document.getElementById('texto-alerta');\n            \n            texto.innerText = msg;\n            alerta.classList.remove('translate-y-[-150%]', 'opacity-0');\n            \n            // Toca som\n            tocarAlerta();\n\n            // Remove após 10s se não fechar manual\n            setTimeout(() => {\n                alerta.classList.add('translate-y-[-150%]', 'opacity-0');\n            }, 10000);\n        }\n\n        // --- NAVEGAÇÃO PAINÉIS ---\n        function mostrarPainel(painel) {\n            document.getElementById('painel-pedidos').classList.add('hidden');\n            document.getElementById('painel-encomendas').classList.add('hidden');\n            document.getElementById('painel-relatorios').classList.add('hidden');\n            \n            // Reset estilos abas\n            ['nav-pedidos', 'nav-encomendas', 'nav-relatorios'].forEach(id => {\n                const el = document.getElementById(id);\n                el.classList.remove('text-brand-600', 'border-brand-600');\n                el.classList.add('text-gray-400', 'border-transparent');\n            });\n\n            // Ativa selecionado\n            const navAtiva = document.getElementById(`nav-${painel}`);\n            navAtiva.classList.remove('text-gray-400', 'border-transparent');\n            navAtiva.classList.add('text-brand-600', 'border-brand-600');\n            \n            document.getElementById(`painel-${painel}`).classList.remove('hidden');\n        }\n\n        // --- DELIVERY ---\n        function initDeliveryListener() {\n            db.collection('pedidos').orderBy('data', 'desc').limit(50).onSnapshot(snapshot => {\n                const novos = document.getElementById('col-novos');\n                const prep = document.getElementById('col-prep');\n                const prontos = document.getElementById('col-prontos');\n                let cNovos = 0, cPrep = 0, cProntos = 0;\n\n                novos.innerHTML = prep.innerHTML = prontos.innerHTML = '';\n\n                // Detectar mudanças para alertas\n                if (!primeiraCargaDelivery) {\n                    snapshot.docChanges().forEach(change => {\n                        if (change.type === 'added') {\n                            const p = change.doc.data();\n                            if (p.status === 'Enviado') {\n                                mostrarAlertaVisual(`🔔 Novo Pedido Delivery: ${p.cliente_nome}`);\n                            }\n                        }\n                    });\n                }\n\n                snapshot.forEach(doc => {\n                    const p = { id_doc: doc.id, ...doc.data() };\n                    const card = criarCardDelivery(p);\n                    \n                    if (p.status === 'Enviado') { novos.innerHTML += card; cNovos++; }\n                    else if (p.status === 'Produzindo') { prep.innerHTML += card; cPrep++; }\n                    else if (p.status === 'Finalizado' || p.status === 'Cancelado') { prontos.innerHTML += card; cProntos++; }\n                });\n\n                // Atualiza contadores das colunas\n                document.getElementById('count-novos').innerText = cNovos;\n                document.getElementById('count-prep').innerText = cPrep;\n                document.getElementById('count-prontos').innerText = cProntos;\n\n                // Atualiza Badge da Aba (Novos + Preparando)\n                atualizarBadgeAba('badge-aba-delivery', cNovos + cPrep);\n\n                primeiraCargaDelivery = false;\n            });\n        }\n\n        function criarCardDelivery(p) {\n            const hora = new Date(p.data).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n            const dadosSafe = encodeURIComponent(JSON.stringify(p));\n            \n            let borderClass = 'border-l-4 ';\n            if (p.status === 'Enviado') borderClass += 'border-yellow-400';\n            else if (p.status === 'Produzindo') borderClass += 'border-blue-500';\n            else if (p.status === 'Finalizado') borderClass += 'border-green-500';\n            else if (p.status === 'Cancelado') borderClass += 'border-red-400 opacity-60';\n\n            // Animação para pedidos novos\n            const animateClass = p.status === 'Enviado' ? 'animate-bounce-slow' : '';\n\n            let botoes = '';\n            if (p.status === 'Enviado') {\n                botoes = `\n                    <div class=\"grid grid-cols-2 gap-2 mt-3\">\n                        <button onclick=\"abrirModalRecusa('${p.id_doc}', '${dadosSafe}', 'pedidos')\" class=\"py-2 bg-red-50 text-red-600 text-xs font-bold rounded-lg hover:bg-red-100\">Recusar</button>\n                        <button onclick=\"mudarStatusDelivery('${p.id_doc}', 'Produzindo', '${dadosSafe}')\" class=\"py-2 bg-blue-600 text-white text-xs font-bold rounded-lg hover:bg-blue-700 shadow-sm\">Aceitar</button>\n                    </div>`;\n            } else if (p.status === 'Produzindo') {\n                botoes = `\n                    <button onclick=\"mudarStatusDelivery('${p.id_doc}', 'Finalizado', '${dadosSafe}')\" class=\"w-full mt-3 py-2 bg-green-600 text-white text-xs font-bold rounded-lg hover:bg-green-700 shadow-sm\">\n                        Finalizar Pedido ✓\n                    </button>`;\n            } else if (p.status === 'Cancelado') {\n                botoes = `<div class=\"mt-2 text-[10px] text-red-500 font-bold bg-red-50 p-1 rounded text-center\">Cancelado: ${p.motivo_cancelamento || '-'}</div>`;\n            }\n\n            const itensHtml = p.itens.map(i => `<li class=\"flex justify-between\"><span class=\"font-bold text-gray-800\">${i.qtd}x</span> <span class=\"text-gray-600 truncate ml-2 flex-1\">${i.nome}</span></li>`).join('');\n\n            return `\n            <div class=\"bg-white rounded-xl p-4 shadow-sm border border-gray-100 mb-3 relative ${borderClass} hover:shadow-md ${animateClass}\">\n                <div class=\"flex justify-between items-start mb-2\">\n                    <span class=\"bg-gray-100 text-gray-600 font-mono text-xs font-bold px-2 py-0.5 rounded\">${p.id_visual}</span>\n                    <span class=\"text-[10px] font-bold text-gray-400\">${hora}</span>\n                </div>\n                <h4 class=\"font-bold text-gray-900 text-sm mb-2 truncate\">${p.cliente_nome}</h4>\n                <ul class=\"text-xs space-y-1 bg-gray-50 p-2 rounded-lg mb-2\">${itensHtml}</ul>\n                ${p.itens.some(i => i.obs) ? '<div class=\"text-[10px] text-orange-600 bg-orange-50 p-1 rounded mb-2 font-bold\">⚠️ Ver observações</div>' : ''}\n                <div class=\"flex justify-between items-center border-t border-gray-50 pt-2\">\n                    <span class=\"text-xs font-bold text-gray-400 uppercase\">Total</span>\n                    <span class=\"text-base font-black text-gray-800\">${formatarMoeda(p.total)}</span>\n                </div>\n                ${botoes}\n            </div>`;\n        }\n\n        // --- ENCOMENDAS ---\n        function initEncomendasListener() {\n            db.collection('encomendas').orderBy('data_solicitacao', 'desc').limit(50).onSnapshot(snapshot => {\n                const lista = document.getElementById('lista-encomendas');\n                lista.innerHTML = '';\n\n                let pendentesCount = 0;\n\n                // Detectar encomendas novas\n                if (!primeiraCargaEncomenda) {\n                    snapshot.docChanges().forEach(change => {\n                        if (change.type === 'added') {\n                            const p = change.doc.data();\n                            if (p.status === 'Pendente Aprovação') {\n                                mostrarAlertaVisual(`🎉 Nova Encomenda: ${p.cliente_nome}`, 'encomenda');\n                            }\n                        }\n                    });\n                }\n\n                if(snapshot.empty) {\n                    lista.innerHTML = '<div class=\"col-span-full text-center text-gray-400 py-10\">Nenhuma solicitação de encomenda.</div>';\n                } else {\n                    snapshot.forEach(doc => {\n                        const p = { id_doc: doc.id, ...doc.data() };\n                        if (p.status === 'Pendente Aprovação') pendentesCount++;\n                        lista.innerHTML += criarCardEncomenda(p);\n                    });\n                }\n\n                // Atualiza Badge da Aba (Apenas Pendentes)\n                atualizarBadgeAba('badge-aba-encomendas', pendentesCount);\n\n                primeiraCargaEncomenda = false;\n            });\n        }\n\n        function criarCardEncomenda(p) {\n            const dataSolic = new Date(p.data_solicitacao).toLocaleDateString('pt-BR');\n            const dataEvento = p.detalhes.data_evento.split('-').reverse().join('/');\n            const dadosSafe = encodeURIComponent(JSON.stringify(p));\n\n            // Status Colors\n            let statusColor = 'bg-gray-100 text-gray-600';\n            if (p.status === 'Pendente Aprovação') statusColor = 'bg-purple-100 text-purple-700 animate-pulse';\n            else if (p.status === 'Aprovado') statusColor = 'bg-green-100 text-green-700';\n            else if (p.status === 'Recusado') statusColor = 'bg-red-100 text-red-700';\n\n            let botoes = '';\n            if (p.status === 'Pendente Aprovação') {\n                botoes = `\n                    <div class=\"flex gap-2 mt-4 pt-4 border-t border-gray-100\">\n                        <button onclick=\"abrirModalRecusa('${p.id_doc}', '${dadosSafe}', 'encomendas')\" class=\"flex-1 py-2 bg-white border border-gray-200 text-gray-600 text-xs font-bold rounded-lg hover:bg-gray-50\">Recusar</button>\n                        <button onclick=\"aprovarEncomenda('${p.id_doc}', '${dadosSafe}')\" class=\"flex-1 py-2 bg-brand-600 text-white text-xs font-bold rounded-lg hover:bg-brand-700 shadow-md\">Aprovar</button>\n                    </div>`;\n            } else if (p.status === 'Aprovado') {\n                botoes = `<div class=\"mt-4 pt-2 border-t border-gray-100 text-center text-xs text-green-600 font-bold\">✅ Encomenda Aprovada</div>`;\n            } else {\n                botoes = `<div class=\"mt-4 pt-2 border-t border-gray-100 text-center text-xs text-red-500 font-bold\">❌ Recusado: ${p.motivo_recusa || '-'}</div>`;\n            }\n\n            return `\n            <div class=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow\">\n                <div class=\"flex justify-between items-start mb-4\">\n                    <div>\n                        <span class=\"${statusColor} px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide\">${p.status}</span>\n                        <p class=\"text-xs text-gray-400 mt-1\">Solicitado em: ${dataSolic}</p>\n                    </div>\n                    <div class=\"text-right\">\n                        <p class=\"text-xs font-bold text-gray-400 uppercase\">Evento</p>\n                        <p class=\"text-sm font-bold text-gray-800\">${dataEvento}</p>\n                    </div>\n                </div>\n\n                <h3 class=\"font-serif font-bold text-lg text-gray-900 mb-1\">${p.cliente_nome}</h3>\n                <div class=\"flex items-center gap-1 text-sm text-gray-500 mb-4\">\n                    <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\"/></svg>\n                    ${p.cliente_telefone}\n                </div>\n\n                <div class=\"bg-gray-50 rounded-lg p-3 space-y-2\">\n                    <p class=\"text-xs text-gray-500\"><strong class=\"text-gray-700\">Convidados:</strong> ${p.detalhes.qtd_pessoas || 'Não informado'}</p>\n                    <p class=\"text-xs text-gray-500\"><strong class=\"text-gray-700\">Itens:</strong> ${p.detalhes.tipos_itens.join(', ')}</p>\n                    <div class=\"text-xs text-gray-600 italic mt-2 border-t border-gray-200 pt-2\">\"${p.detalhes.descricao}\"</div>\n                </div>\n                \n                ${botoes}\n            </div>`;\n        }\n\n        // --- FUNÇÕES AUXILIARES ---\n        function atualizarBadgeAba(idElemento, quantidade) {\n            const badge = document.getElementById(idElemento);\n            badge.innerText = quantidade;\n            if (quantidade > 0) {\n                badge.classList.remove('hidden');\n                badge.classList.add('badge-pulse'); // Efeito pulsante se tiver pendências\n            } else {\n                badge.classList.add('hidden');\n                badge.classList.remove('badge-pulse');\n            }\n        }\n\n        window.mudarStatusDelivery = (id, novoStatus, dadosJson) => {\n            const p = JSON.parse(decodeURIComponent(dadosJson));\n            db.collection('pedidos').doc(id).update({ status: novoStatus })\n                .then(() => {\n                    if (['Produzindo', 'Finalizado'].includes(novoStatus)) {\n                        const fone = p.cliente_telefone_limpo || p.cliente_telefone.replace(/\\D/g, '');\n                        let msg = `Olá ${p.cliente_nome}! (${p.id_visual})\\n\\n`;\n                        if (novoStatus === 'Produzindo') msg += `🔥 Seu pedido começou a ser preparado!\\nTotal: ${formatarMoeda(p.total)}`;\n                        else msg += `✅ Seu pedido está PRONTO!\\nTotal: ${formatarMoeda(p.total)}`;\n                        window.open(`https://wa.me/55${fone}?text=${encodeURIComponent(msg)}`, '_blank');\n                    }\n                });\n        }\n\n        window.aprovarEncomenda = (id, dadosJson) => {\n            const p = JSON.parse(decodeURIComponent(dadosJson));\n            const fone = p.cliente_telefone_limpo || p.cliente_telefone.replace(/\\D/g, '');\n            db.collection('encomendas').doc(id).update({ status: 'Aprovado' });\n            const msg = `Olá ${p.cliente_nome}!\\n\\nRecebemos sua solicitação de encomenda para o dia ${p.detalhes.data_evento.split('-').reverse().join('/')}.\\n\\n*Podemos conversar sobre o orçamento?*`;\n            window.open(`https://wa.me/55${fone}?text=${encodeURIComponent(msg)}`, '_blank');\n        }\n\n        window.abrirModalRecusa = (id, dadosJson, colecao) => {\n            pedidoParaRecusar = { id, dados: JSON.parse(decodeURIComponent(dadosJson)), colecao };\n            toggleModal('modal-recusa', true);\n        }\n\n        window.confirmarRecusa = async () => {\n            const motivo = document.getElementById('motivo-recusa').value.trim();\n            if (!motivo) return alert(\"Digite um motivo.\");\n            const { id, dados, colecao } = pedidoParaRecusar;\n            const campoMotivo = colecao === 'pedidos' ? 'motivo_cancelamento' : 'motivo_recusa';\n            const statusFinal = colecao === 'pedidos' ? 'Cancelado' : 'Recusado';\n            await db.collection(colecao).doc(id).update({ status: statusFinal, [campoMotivo]: motivo });\n            const fone = dados.cliente_telefone_limpo || dados.cliente_telefone.replace(/\\D/g, '');\n            const msg = `Olá ${dados.cliente_nome}.\\nInfelizmente não poderemos atender seu pedido.\\nMotivo: ${motivo}`;\n            window.open(`https://wa.me/55${fone}?text=${encodeURIComponent(msg)}`, '_blank');\n            toggleModal('modal-recusa', false);\n            document.getElementById('motivo-recusa').value = '';\n        }\n\n        function toggleModal(id, show) {\n            const el = document.getElementById(id);\n            if (show) {\n                el.classList.remove('hidden');\n                setTimeout(() => el.querySelector('.modal-box').classList.remove('scale-95', 'opacity-0'), 10);\n            } else {\n                el.querySelector('.modal-box').classList.add('scale-95', 'opacity-0');\n                setTimeout(() => el.classList.add('hidden'), 300);\n            }\n        }\n\n        function carregarConfiguracoes() {\n            db.collection('config').doc('loja').onSnapshot(doc => {\n                if (doc.exists) {\n                    configuracaoGlobal = doc.data();\n                    document.getElementById('horario-abertura').value = configuracaoGlobal.horario_abertura || '18:00';\n                    document.getElementById('horario-fechamento').value = configuracaoGlobal.horario_fechamento || '23:00';\n                    document.getElementById('dias-funcionamento').value = configuracaoGlobal.dias || 'Seg-Sab';\n                    atualizarUIStatus();\n                }\n            });\n        }\n\n        function atualizarUIStatus() {\n            const btn = document.getElementById('btn-toggle-status');\n            const statusLabel = document.getElementById('status-label');\n            const statusDot = document.getElementById('status-dot');\n            if (configuracaoGlobal.status === 'Aberta') {\n                btn.innerHTML = 'Fechar Loja';\n                btn.className = 'bg-red-50 text-red-600 border border-red-200 px-4 py-2 rounded-lg text-xs font-bold hover:bg-red-100 transition';\n                statusLabel.innerText = 'LOJA ABERTA';\n                statusLabel.className = 'text-xs font-black text-green-600 tracking-wide';\n                statusDot.className = 'w-2 h-2 rounded-full bg-green-500 animate-pulse';\n            } else {\n                btn.innerHTML = 'Abrir Loja';\n                btn.className = 'bg-green-50 text-green-600 border border-green-200 px-4 py-2 rounded-lg text-xs font-bold hover:bg-green-100 transition';\n                statusLabel.innerText = 'LOJA FECHADA';\n                statusLabel.className = 'text-xs font-black text-red-600 tracking-wide';\n                statusDot.className = 'w-2 h-2 rounded-full bg-red-500';\n            }\n        }\n\n        function toggleStatusLoja() {\n            const novoStatus = configuracaoGlobal.status === 'Aberta' ? 'Fechada' : 'Aberta';\n            db.collection('config').doc('loja').update({ status: novoStatus });\n        }\n\n        function salvarConfiguracoes(e) {\n            e.preventDefault();\n            const novoHorario = {\n                horario_abertura: document.getElementById('horario-abertura').value,\n                horario_fechamento: document.getElementById('horario-fechamento').value,\n                dias: document.getElementById('dias-funcionamento').value,\n                status: configuracaoGlobal.status\n            };\n            db.collection('config').doc('loja').set(novoHorario, { merge: true });\n            toggleModal('modal-config', false);\n        }\n        \n        function gerarRelatorio() { /* Lógica de relatório existente */ }\n    </script>\n</head>\n<body class=\"bg-gray-50 font-sans text-gray-800 h-screen flex flex-col overflow-hidden\">\n\n    <!-- ALERTA VISUAL FLUTUANTE (TOAST) -->\n    <div id=\"alerta-novo-pedido\" class=\"fixed top-4 left-1/2 transform -translate-x-1/2 z-[100] w-[90%] max-w-md transition-all duration-500 translate-y-[-150%] opacity-0\">\n        <div class=\"bg-gray-900 text-white p-4 rounded-2xl shadow-2xl flex items-center justify-between border border-gray-700\">\n            <div class=\"flex items-center gap-3\">\n                <div class=\"w-10 h-10 bg-brand-600 rounded-full flex items-center justify-center animate-bounce\">\n                    <svg class=\"w-5 h-5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\"/></svg>\n                </div>\n                <div>\n                    <p class=\"font-bold text-sm\">Atenção Cozinha!</p>\n                    <p id=\"texto-alerta\" class=\"text-xs text-gray-300\">Novo pedido recebido</p>\n                </div>\n            </div>\n            <button onclick=\"document.getElementById('alerta-novo-pedido').classList.add('translate-y-[-150%]', 'opacity-0')\" class=\"bg-white/10 p-2 rounded-full hover:bg-white/20\">\n                <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/></svg>\n            </button>\n        </div>\n    </div>\n\n    <!-- HEADER -->\n    <header class=\"glass-header h-16 flex items-center justify-between px-4 md:px-8 z-30 flex-shrink-0\">\n        <div class=\"flex items-center gap-3\">\n            <div class=\"bg-brand-600 text-white p-1.5 rounded-lg\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"/></svg>\n            </div>\n            <h1 class=\"font-bold text-gray-800 text-lg tracking-tight\">Admin <span class=\"text-gray-400 mx-1\">/</span> Pedidos</h1>\n        </div>\n        \n        <div class=\"flex items-center gap-3\">\n             <!-- Status Loja -->\n            <div class=\"hidden md:flex items-center gap-3 mr-4\">\n                <div id=\"status-dot\" class=\"w-2 h-2 rounded-full bg-gray-300\"></div>\n                <span id=\"status-label\" class=\"text-xs font-black text-gray-400 tracking-wide\">CARREGANDO...</span>\n                <button id=\"btn-toggle-status\" class=\"bg-gray-100 text-gray-400 px-4 py-2 rounded-lg text-xs font-bold\">...</button>\n            </div>\n            \n            <a href=\"index.html\" target=\"_blank\" class=\"px-3 py-2 text-sm font-bold text-brand-600 bg-brand-50 border border-brand-100 rounded-lg hover:bg-brand-100 transition flex items-center gap-2\">\n                <span>Loja</span>\n                <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"/></svg>\n            </a>\n            <a href=\"admin-produtos.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Produtos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n            <a href=\"admin-clientes.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Clientes</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n            <a href=\"admin-custos.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Custos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n        </div>\n        \n    </header>\n\n    <!-- NAVEGAÇÃO INTERNA (COM BADGES) -->\n    <div class=\"bg-white border-b border-gray-200 px-4 flex gap-6 flex-shrink-0\">\n        <button id=\"nav-pedidos\" class=\"relative px-4 py-3 text-sm font-bold text-brand-600 border-b-2 border-brand-600 transition flex items-center\">\n            Delivery (Hoje)\n            <!-- BADGE DELIVERY -->\n            <span id=\"badge-aba-delivery\" class=\"hidden ml-2 bg-red-600 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-sm\">0</span>\n        </button>\n        \n        <button id=\"nav-encomendas\" class=\"relative px-4 py-3 text-sm font-bold text-gray-400 hover:text-gray-600 transition border-b-2 border-transparent flex items-center\">\n            Encomendas (Futuro)\n            <!-- BADGE ENCOMENDAS -->\n            <span id=\"badge-aba-encomendas\" class=\"hidden ml-2 bg-purple-600 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-sm\">0</span>\n        </button>\n\n        <button id=\"nav-relatorios\" class=\"px-4 py-3 text-sm font-bold text-gray-400 hover:text-gray-600 transition border-b-2 border-transparent\">Relatórios</button>\n    </div>\n\n    <!-- MAIN: PAINEL PEDIDOS (DELIVERY) -->\n    <main id=\"painel-pedidos\" class=\"flex-grow overflow-y-auto p-4 md:p-6 bg-gray-50\">\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6 h-full\">\n            \n            <!-- Coluna Novos -->\n            <div class=\"flex flex-col h-auto md:h-full\">\n                <div class=\"flex items-center justify-between mb-3 px-1\">\n                    <h3 class=\"font-bold text-gray-700 flex items-center gap-2\"><span class=\"w-2 h-2 rounded-full bg-yellow-400\"></span> Novos</h3>\n                    <span id=\"count-novos\" class=\"bg-white border border-gray-200 text-xs font-bold px-2 py-0.5 rounded-full text-gray-500\">0</span>\n                </div>\n                <div id=\"col-novos\" class=\"flex-1 md:overflow-y-auto md:pr-2 pb-4 space-y-3\"></div>\n            </div>\n\n            <!-- Coluna Preparando -->\n            <div class=\"flex flex-col h-auto md:h-full\">\n                <div class=\"flex items-center justify-between mb-3 px-1\">\n                    <h3 class=\"font-bold text-gray-700 flex items-center gap-2\"><span class=\"w-2 h-2 rounded-full bg-blue-500\"></span> Preparando</h3>\n                    <span id=\"count-prep\" class=\"bg-white border border-gray-200 text-xs font-bold px-2 py-0.5 rounded-full text-gray-500\">0</span>\n                </div>\n                <div id=\"col-prep\" class=\"flex-1 md:overflow-y-auto md:pr-2 pb-4 space-y-3\"></div>\n            </div>\n\n            <!-- Coluna Prontos -->\n            <div class=\"flex flex-col h-auto md:h-full\">\n                <div class=\"flex items-center justify-between mb-3 px-1\">\n                    <h3 class=\"font-bold text-gray-700 flex items-center gap-2\"><span class=\"w-2 h-2 rounded-full bg-green-500\"></span> Prontos</h3>\n                    <span id=\"count-prontos\" class=\"bg-white border border-gray-200 text-xs font-bold px-2 py-0.5 rounded-full text-gray-500\">0</span>\n                </div>\n                <div id=\"col-prontos\" class=\"flex-1 md:overflow-y-auto md:pr-2 pb-20 space-y-3\"></div>\n            </div>\n\n        </div>\n    </main>\n\n    <!-- MAIN: PAINEL ENCOMENDAS -->\n    <main id=\"painel-encomendas\" class=\"hidden flex-grow overflow-y-auto p-4 md:p-8 bg-gray-50\">\n        <div class=\"max-w-5xl mx-auto\">\n            <div class=\"mb-6 flex justify-between items-center\">\n                <div>\n                    <h2 class=\"text-xl font-serif font-bold text-gray-900\">Solicitações de Orçamento</h2>\n                    <p class=\"text-sm text-gray-500\">Aprove pedidos futuros e entre em contato para combinar o pagamento.</p>\n                </div>\n            </div>\n            \n            <div id=\"lista-encomendas\" class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20\">\n                <!-- Injetado via JS -->\n            </div>\n        </div>\n    </main>\n\n    <!-- MAIN: PAINEL RELATÓRIOS -->\n    <main id=\"painel-relatorios\" class=\"hidden flex-grow overflow-y-auto p-4 md:p-8 bg-gray-50\">\n        <div class=\"max-w-2xl mx-auto bg-white rounded-2xl shadow-sm border border-gray-100 p-6\">\n            <h2 class=\"text-lg font-bold text-gray-800 mb-4\">Relatórios</h2>\n            <div class=\"flex gap-3 mb-6 items-end bg-gray-50 p-4 rounded-xl border border-gray-100\">\n                <div class=\"flex-1\">\n                    <label class=\"text-[10px] font-bold text-gray-400 uppercase\">Início</label>\n                    <input type=\"date\" id=\"data-inicio\" class=\"w-full bg-white border border-gray-200 rounded-lg p-2 text-sm font-bold\">\n                </div>\n                <div class=\"flex-1\">\n                    <label class=\"text-[10px] font-bold text-gray-400 uppercase\">Fim</label>\n                    <input type=\"date\" id=\"data-fim\" class=\"w-full bg-white border border-gray-200 rounded-lg p-2 text-sm font-bold\">\n                </div>\n                <button id=\"btn-filtrar-relatorio\" class=\"bg-gray-900 text-white px-4 py-2.5 rounded-lg font-bold text-sm hover:bg-black\">Filtrar</button>\n            </div>\n            <div id=\"lista-relatorios\" class=\"space-y-1 text-center text-gray-400 text-sm\">Selecione um período</div>\n        </div>\n    </main>\n\n    <!-- MODAL RECUSA -->\n    <div id=\"modal-recusa\" class=\"fixed inset-0 z-50 hidden flex items-center justify-center bg-black/40 backdrop-blur-sm\">\n        <div class=\"modal-box bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl transform scale-95 opacity-0 transition-all duration-300\">\n            <div class=\"w-12 h-12 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-4 mx-auto\">\n                <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/></svg>\n            </div>\n            <h3 class=\"font-bold text-lg text-center mb-2\">Recusar Solicitação</h3>\n            <p class=\"text-sm text-gray-500 text-center mb-4\">O cliente será avisado pelo WhatsApp.</p>\n            <textarea id=\"motivo-recusa\" class=\"w-full border border-gray-200 rounded-xl p-3 text-sm mb-4 focus:border-red-500 outline-none\" rows=\"3\" placeholder=\"Motivo (Ex: Agenda lotada)\"></textarea>\n            <div class=\"flex gap-2\">\n                <button onclick=\"toggleModal('modal-recusa', false)\" class=\"flex-1 py-3 text-gray-500 font-bold bg-gray-50 rounded-xl hover:bg-gray-100\">Voltar</button>\n                <button onclick=\"confirmarRecusa()\" class=\"flex-1 py-3 text-white font-bold bg-red-600 rounded-xl hover:bg-red-700 shadow-lg shadow-red-200\">Recusar</button>\n            </div>\n        </div>\n    </div>\n\n    <!-- MODAL CONFIG -->\n    <div id=\"modal-config\" class=\"fixed inset-0 z-50 hidden flex items-center justify-center bg-black/40 backdrop-blur-sm\">\n        <div class=\"modal-box bg-white w-full max-w-xs rounded-2xl p-6 shadow-2xl transform scale-95 opacity-0 transition-all duration-300\">\n            <h3 class=\"font-bold text-lg mb-4\">Configurar Loja</h3>\n            <form id=\"form-config\" class=\"space-y-4\">\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Abertura</label>\n                    <input type=\"time\" id=\"horario-abertura\" class=\"w-full border border-gray-200 rounded-lg p-2\">\n                </div>\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Fechamento</label>\n                    <input type=\"time\" id=\"horario-fechamento\" class=\"w-full border border-gray-200 rounded-lg p-2\">\n                </div>\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Dias</label>\n                    <input type=\"text\" id=\"dias-funcionamento\" class=\"w-full border border-gray-200 rounded-lg p-2\" placeholder=\"Ex: Seg-Sab\">\n                </div>\n                <div class=\"flex gap-2 pt-2\">\n                    <button type=\"button\" onclick=\"toggleModal('modal-config', false)\" class=\"flex-1 py-3 text-gray-500 font-bold bg-gray-50 rounded-xl\">Cancelar</button>\n                    <button type=\"submit\" class=\"flex-1 py-3 text-white font-bold bg-gray-900 rounded-xl\">Salvar</button>\n                </div>\n            </form>\n        </div>\n    </div>\n\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\admin-produtos.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#1f2937\">\n    <meta name=\"mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black-translucent\">\n    <title>Gestão de Produtos | Admin</title>\n\n    <!-- FAVICON -->\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n\n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- FIREBASE -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES -->\n    <link\n        href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\"\n        rel=\"stylesheet\">\n\n    <script>\n        // Configuração do Tailwind CSS\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { sans: ['DM Sans', 'sans-serif'], serif: ['Playfair Display', 'serif'] },\n                    colors: {\n                        brand: { 50: '#fff1f2', 100: '#ffe4e6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d' }\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        /* Estilos Personalizados */\n        ::-webkit-scrollbar {\n            width: 6px;\n            height: 6px;\n        }\n\n        ::-webkit-scrollbar-track {\n            background: #f1f1f1;\n        }\n\n        ::-webkit-scrollbar-thumb {\n            background: #cbd5e1;\n            border-radius: 10px;\n        }\n\n        ::-webkit-scrollbar-thumb:hover {\n            background: #94a3b8;\n        }\n\n        .glass-header {\n            background: rgba(255, 255, 255, 0.95);\n            backdrop-filter: blur(10px);\n            border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n        }\n\n        .pb-safe-area {\n            padding-bottom: env(safe-area-inset-bottom);\n        }\n\n        /* Toggle Switch Animado */\n        .toggle-checkbox:checked {\n            right: 0;\n            border-color: #10B981;\n        }\n\n        .toggle-checkbox:checked+.toggle-label {\n            background-color: #10B981;\n        }\n\n        /* Estilo do Prompt PWA */\n        #pwa-prompt {\n            transition: transform 0.3s ease-out;\n            transform: translateY(100%);\n        }\n\n        #pwa-prompt.visible {\n            transform: translateY(0);\n        }\n\n        @media (min-width: 768px) {\n            #pwa-prompt {\n                display: none !important;\n            }\n        }\n    </style>\n\n    <script>\n        // --- FIREBASE CONFIGURAÇÃO (Configurações da sua loja) ---\n        const firebaseConfig = {\n            apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n            authDomain: \"renata-26079.firebaseapp.com\",\n            projectId: \"renata-26079\",\n            storageBucket: \"renata-26079.firebasestorage.app\",\n            messagingSenderId: \"995787482442\",\n            appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n        };\n\n        firebase.initializeApp(firebaseConfig);\n        const db = firebase.firestore();\n        const auth = firebase.auth();\n\n        // --- VARIÁVEIS DE ESTADO ---\n        let produtosCache = []; // Cache de todos os produtos\n        let editandoId = null;  // ID do produto em edição\n\n        // --- UTILIDADES ---\n        const formatarMoeda = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v);\n\n        // --- LIFECYCLE ---\n        document.addEventListener('DOMContentLoaded', () => {\n            // Login Anônimo para Admin (melhorar autenticação em produção)\n            auth.onAuthStateChanged(user => { if (!user) auth.signInAnonymously(); });\n\n            carregarProdutos();\n\n            // Event Listeners\n            document.getElementById('search-input').addEventListener('input', filtrarProdutos);\n            document.getElementById('categoria-select').addEventListener('change', toggleNovaCategoria);\n            document.getElementById('form-produto').addEventListener('submit', salvarProduto);\n\n            // Preview de Imagem no Form\n            document.getElementById('imagem').addEventListener('input', (e) => {\n                const img = document.getElementById('preview-img');\n                img.src = e.target.value || 'https://placehold.co/400?text=Sem+Imagem';\n            });\n\n            // NOVO: Verifica e solicita instalação PWA\n            checkAndPromptPWA();\n        });\n\n        // --- LÓGICA PWA ---\n        function checkAndPromptPWA() {\n            const isMobile = window.innerWidth < 768;\n            const isInstalled = (window.matchMedia('(display-mode: standalone)').matches || navigator.standalone);\n            const dismissed = localStorage.getItem('pwaPromptAdminProdutosDismissed');\n            const prompt = document.getElementById('pwa-prompt');\n            const closeBtn = document.getElementById('pwa-close');\n\n            if (isMobile && !isInstalled && !dismissed) {\n                prompt.classList.remove('hidden');\n\n                setTimeout(() => {\n                    prompt.classList.add('visible');\n                }, 100);\n\n                const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);\n                const installInstructions = document.getElementById('install-instructions');\n\n                if (isIOS) {\n                    installInstructions.innerHTML = 'Toque no ícone <svg class=\"w-4 h-4 inline-block transform translate-y-[2px]\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12\"/></svg> e selecione \"Adicionar à Tela de Início\".';\n                } else {\n                    installInstructions.innerHTML = 'Toque no menu <span class=\"font-black text-lg align-top\">...</span> ou <span class=\"font-black text-lg align-top\">⁝</span> e selecione \"Instalar Aplicativo\".';\n                }\n\n                closeBtn.onclick = () => {\n                    prompt.classList.remove('visible');\n                    localStorage.setItem('pwaPromptAdminProdutosDismissed', 'true');\n                    setTimeout(() => prompt.classList.add('hidden'), 300);\n                };\n            }\n        }\n        // --- FIM LÓGICA PWA ---\n\n\n        // --- LÓGICA DE DADOS E RENDERIZAÇÃO ---\n        function carregarProdutos() {\n            const grid = document.getElementById('grid-produtos');\n            grid.innerHTML = '<div class=\"col-span-full text-center py-10 text-gray-400 animate-pulse\">Carregando estoque...</div>';\n\n            db.collection('produtos').orderBy('categoria').onSnapshot(snap => {\n                produtosCache = [];\n                const categoriasSet = new Set();\n\n                snap.forEach(doc => {\n                    const p = doc.data();\n                    p.id = doc.id;\n                    produtosCache.push(p);\n                    if (p.categoria) categoriasSet.add(p.categoria); // Adiciona categorias, verifica se existe\n                });\n\n                atualizarSelectCategorias(categoriasSet);\n                renderizarGrid(produtosCache);\n                atualizarStats(produtosCache);\n            });\n        }\n\n        function renderizarGrid(lista) {\n            const grid = document.getElementById('grid-produtos');\n            grid.innerHTML = '';\n\n            if (lista.length === 0) {\n                grid.innerHTML = `\n                    <div class=\"col-span-full flex flex-col items-center justify-center py-20 text-gray-400\">\n                        <svg class=\"w-16 h-16 mb-4 opacity-20\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4\"/></svg>\n                        <p>Nenhum produto encontrado.</p>\n                        <button onclick=\"abrirDrawer()\" class=\"mt-4 bg-brand-600 text-white px-4 py-2 rounded-lg font-bold shadow-lg hover:bg-brand-700\">Criar Primeiro Produto</button>\n                    </div>`;\n                return;\n            }\n\n            // Garante que o grid use 1 coluna no mobile e 2+ no desktop\n            grid.classList.add('grid', 'grid-cols-1', 'sm:grid-cols-2', 'lg:grid-cols-3', 'xl:grid-cols-4', 'gap-6', 'pb-20');\n\n            lista.forEach(p => {\n                const dadosJson = encodeURIComponent(JSON.stringify(p));\n                const statusColor = p.ativo ? 'bg-green-100 text-green-700 border-green-200' : 'bg-red-50 text-red-600 border-red-100';\n                const statusText = p.ativo ? 'Ativo' : 'Inativo';\n                const estoqueBaixo = (p.estoque_atual !== undefined && p.estoque_atual < 5 && p.estoque_atual > 0) ? 'text-orange-600 font-bold' : (p.estoque_atual === 0 ? 'text-red-600 font-bold' : 'text-gray-600');\n                const estoqueTexto = p.estoque_atual !== undefined ? p.estoque_atual : 0;\n                const precoDisplay = p.preco_promo && p.preco_promo > 0 ? formatarMoeda(p.preco_promo) : formatarMoeda(p.preco);\n                const precoOriginal = p.preco_promo && p.preco_promo > 0 ? `<span class=\"text-xs text-gray-400 line-through mr-1\">${formatarMoeda(p.preco)}</span>` : '';\n\n                let tags = '';\n                if (p.tag_especial === 'do_dia') tags += '<span class=\"text-[10px] font-bold bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full border border-yellow-200\">🌞 Dia</span>';\n                if (p.tag_especial === 'promo') tags += '<span class=\"text-[10px] font-bold bg-red-50 text-red-600 px-2 py-0.5 rounded-full border border-red-100\">🏷️ Promoção</span>';\n                if (p.destaque) tags += '<span class=\"text-[10px] font-bold bg-purple-50 text-purple-600 px-2 py-0.5 rounded-full border border-purple-100\">⭐ Destaque</span>';\n\n                grid.innerHTML += `\n                <div class=\"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow group flex flex-col relative transform hover:scale-[1.01] duration-300\">\n                    \n                    <!-- Imagem e Badge Status -->\n                    <div class=\"relative h-48 bg-gray-100 overflow-hidden\">\n                        <img src=\"${p.imagem}\" class=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\" onerror=\"this.src='https://placehold.co/400x192?text=Sem+Imagem+Cadastrada'\">\n                        <div class=\"absolute top-2 right-2 px-2 py-1 rounded-md text-[10px] font-bold uppercase border ${statusColor} shadow-sm backdrop-blur-sm bg-opacity-90\">\n                            ${statusText}\n                        </div>\n                        <div class=\"absolute bottom-0 left-0 w-full p-2 flex gap-1 flex-wrap\">\n                            ${tags}\n                        </div>\n                    </div>\n\n                    <!-- Corpo do Card -->\n                    <div class=\"p-4 flex-grow flex flex-col\">\n                        <div class=\"flex justify-between items-start mb-1\">\n                            <span class=\"text-xs font-bold text-gray-400 uppercase tracking-wide\">${p.categoria || 'Sem Categoria'}</span>\n                            <span class=\"text-xs font-mono text-gray-300\">#${p.id.substring(0, 4)}</span>\n                        </div>\n                        <h3 class=\"font-bold text-gray-900 text-xl leading-tight mb-2 line-clamp-1\" title=\"${p.nome}\">${p.nome}</h3>\n                        <p class=\"text-sm text-gray-500 line-clamp-2 flex-grow\">${p.descricao}</p>\n                        \n                        <!-- Rodapé Card: Preço e Estoque -->\n                        <div class=\"flex items-end justify-between border-t border-gray-50 pt-3 mt-auto\">\n                            <div>\n                                <p class=\"text-xs text-gray-400 font-medium mb-0.5\">Preço</p>\n                                <p class=\"text-2xl font-black text-brand-600\">${precoOriginal} ${precoDisplay}</p>\n                            </div>\n                            <div class=\"text-right\">\n                                <p class=\"text-xs text-gray-400 font-medium mb-0.5\">Estoque</p>\n                                <p class=\"text-sm ${estoqueBaixo}\">${estoqueTexto} <span class=\"text-[10px] font-normal text-gray-400\">unid.</span></p>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Ações -->\n                    <div class=\"bg-gray-50 border-t border-gray-100 p-2 flex gap-2\">\n                        <button onclick=\"abrirDrawer('${dadosJson}')\" class=\"flex-1 bg-white border border-gray-200 text-gray-700 py-3 rounded-lg text-sm font-bold hover:bg-brand-50 hover:text-brand-600 hover:border-brand-200 transition shadow-sm flex items-center justify-center gap-2\">\n                            <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"/></svg>\n                            Editar\n                        </button>\n                        <button onclick=\"deletarProduto('${p.id}')\" class=\"w-12 flex items-center justify-center bg-white border border-gray-200 text-red-500 rounded-lg hover:bg-red-50 hover:border-red-200 transition shadow-sm\" title=\"Excluir\">\n                            <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/></svg>\n                        </button>\n                    </div>\n                </div>`;\n            });\n        }\n\n        function filtrarProdutos() {\n            const termo = document.getElementById('search-input').value.toLowerCase();\n            const filtrados = produtosCache.filter(p =>\n                p.nome.toLowerCase().includes(termo) ||\n                (p.categoria && p.categoria.toLowerCase().includes(termo))\n            );\n            renderizarGrid(filtrados);\n        }\n\n        function atualizarSelectCategorias(setCategorias) {\n            const select = document.getElementById('categoria-select');\n            const valorAtual = select.value;\n\n            let html = `<option value=\"\" disabled selected>Selecione uma categoria...</option>`;\n            setCategorias.forEach(cat => {\n                html += `<option value=\"${cat}\">${cat}</option>`;\n            });\n            html += `<option value=\"nova\" class=\"font-bold text-brand-600 bg-brand-50\">+ Criar Nova Categoria</option>`;\n\n            select.innerHTML = html;\n            if (valorAtual && valorAtual !== 'nova' && setCategorias.has(valorAtual)) {\n                select.value = valorAtual;\n            }\n        }\n\n        function toggleNovaCategoria() {\n            const select = document.getElementById('categoria-select');\n            const input = document.getElementById('categoria-nova-container');\n            if (select.value === 'nova') {\n                input.classList.remove('hidden');\n                document.getElementById('categoria-nova').focus();\n            } else {\n                input.classList.add('hidden');\n            }\n        }\n\n        // --- DRAWER (Formulário Lateral/Inferior) ---\n\n        function abrirDrawer(dadosJson = null) {\n            const drawer = document.getElementById('drawer-form');\n            const overlay = document.getElementById('drawer-overlay');\n            const titulo = document.getElementById('drawer-title');\n\n            limparFormulario();\n\n            if (dadosJson) {\n                const p = JSON.parse(decodeURIComponent(dadosJson));\n                editandoId = p.id;\n                titulo.innerText = \"Editar Produto\";\n\n                // Preencher campos\n                document.getElementById('nome').value = p.nome || '';\n                document.getElementById('descricao').value = p.descricao || '';\n                document.getElementById('preco').value = p.preco || 0;\n                document.getElementById('preco-promo').value = p.preco_promo || '';\n                document.getElementById('imagem').value = p.imagem || '';\n                document.getElementById('preview-img').src = p.imagem || 'https://placehold.co/400?text=Preview';\n                document.getElementById('estoque-atual').value = p.estoque_atual !== undefined ? p.estoque_atual : 0;\n                document.getElementById('tag-especial').value = p.tag_especial || 'normal';\n                document.getElementById('ativo').checked = p.ativo !== undefined ? p.ativo : true;\n                document.getElementById('destaque').checked = p.destaque || false;\n\n                // Categoria\n                const select = document.getElementById('categoria-select');\n                let options = Array.from(select.options).map(o => o.value);\n                if (!options.includes(p.categoria)) {\n                    const opt = document.createElement('option');\n                    opt.value = p.categoria; opt.text = p.categoria;\n                    select.add(opt, 1);\n                }\n                select.value = p.categoria || '';\n                toggleNovaCategoria(); // Esconde o campo \"nova categoria\" se uma for selecionada\n            } else {\n                editandoId = null;\n                titulo.innerText = \"Novo Produto\";\n                document.getElementById('ativo').checked = true; // Padrão ativo\n                document.getElementById('preview-img').src = 'https://placehold.co/400?text=Preview';\n            }\n\n            // Animação Entrada (Visível)\n            drawer.classList.remove('hidden');\n            overlay.classList.remove('hidden');\n\n            setTimeout(() => {\n                overlay.classList.remove('opacity-0');\n                drawer.style.transform = 'none'; // Reseta a translação para exibir\n            }, 10);\n        }\n\n        function fecharDrawer() {\n            const drawer = document.getElementById('drawer-form');\n            const overlay = document.getElementById('drawer-overlay');\n\n            // Animação Saída (Volta para o estado escondido, definido no CSS)\n            drawer.style.transform = '';\n            overlay.classList.add('opacity-0');\n\n            setTimeout(() => {\n                drawer.classList.add('hidden');\n                overlay.classList.add('hidden');\n            }, 300);\n        }\n\n        function limparFormulario() {\n            document.getElementById('form-produto').reset();\n            document.getElementById('categoria-nova-container').classList.add('hidden');\n            document.getElementById('categoria-select').value = ''; // Limpa a seleção\n            editandoId = null;\n        }\n\n        async function salvarProduto(e) {\n            e.preventDefault();\n            const btn = document.getElementById('btn-salvar');\n            const txtOriginal = btn.innerHTML;\n            btn.innerHTML = `<svg class=\"animate-spin h-5 w-5 text-white\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle><path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path></svg>`;\n            btn.disabled = true;\n\n            try {\n                // Lógica de Categoria\n                let categoria = document.getElementById('categoria-select').value;\n                if (categoria === 'nova') {\n                    const novaCat = document.getElementById('categoria-nova').value.trim();\n                    if (!novaCat) throw new Error(\"Digite o nome da nova categoria.\");\n                    categoria = novaCat.charAt(0).toUpperCase() + novaCat.slice(1); // Capitaliza\n                }\n                if (!categoria) throw new Error(\"Selecione uma categoria.\");\n\n                const preco = parseFloat(document.getElementById('preco').value) || 0;\n                if (preco <= 0) throw new Error(\"O preço deve ser maior que zero.\");\n\n                const produto = {\n                    nome: document.getElementById('nome').value.trim(),\n                    descricao: document.getElementById('descricao').value.trim(),\n                    categoria: categoria,\n                    preco: preco,\n                    preco_promo: parseFloat(document.getElementById('preco-promo').value) || 0,\n                    estoque_atual: parseInt(document.getElementById('estoque-atual').value) || 0,\n                    imagem: document.getElementById('imagem').value || 'https://placehold.co/400x192?text=Sem+Imagem+Cadastrada',\n                    tag_especial: document.getElementById('tag-especial').value,\n                    ativo: document.getElementById('ativo').checked,\n                    destaque: document.getElementById('destaque').checked,\n                    data_atualizacao: new Date().toISOString()\n                };\n\n                if (editandoId) {\n                    await db.collection('produtos').doc(editandoId).update(produto);\n                    mostrarToast(\"Produto atualizado!\", \"sucesso\");\n                } else {\n                    produto.data_criacao = new Date().toISOString();\n                    await db.collection('produtos').add(produto);\n                    mostrarToast(\"Produto criado!\", \"sucesso\");\n                }\n                fecharDrawer();\n\n            } catch (erro) {\n                alert(\"Erro ao salvar: \" + erro.message);\n            } finally {\n                btn.innerHTML = txtOriginal;\n                btn.disabled = false;\n            }\n        }\n\n        async function deletarProduto(id) {\n            if (confirm(\"ATENÇÃO: Tem certeza que deseja excluir este produto permanentemente?\")) {\n                try {\n                    await db.collection('produtos').doc(id).delete();\n                    mostrarToast(\"Produto removido.\", \"erro\");\n                } catch (e) { alert(\"Erro ao deletar: \" + e.message); }\n            }\n        }\n\n        // --- HELPERS DE STATS ---\n        function atualizarStats(lista) {\n            document.getElementById('total-produtos').innerText = lista.length;\n            document.getElementById('total-ativos').innerText = lista.filter(i => i.ativo).length;\n            document.getElementById('estoque-baixo').innerText = lista.filter(i => i.estoque_atual > 0 && i.estoque_atual < 5).length;\n            document.getElementById('estoque-esgotado').innerText = lista.filter(i => i.estoque_atual === 0).length;\n        }\n\n        function mostrarToast(msg, tipo = 'sucesso') {\n            const t = document.getElementById('toast');\n            const cor = tipo === 'sucesso' ? 'bg-gray-900' : 'bg-red-600';\n            const icone = tipo === 'sucesso' ? '✓' : '🗑️';\n            t.className = `fixed bottom-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-full text-white font-bold shadow-2xl z-[100] flex items-center gap-2 transition-all duration-500 translate-y-20 opacity-0 ${cor}`;\n            t.innerHTML = `<span>${icone}</span> ${msg}`;\n            t.classList.remove('translate-y-20', 'opacity-0');\n            setTimeout(() => t.classList.add('translate-y-20', 'opacity-0'), 3000);\n        }\n    </script>\n</head>\n\n<body class=\"bg-gray-50 font-sans text-gray-800 h-screen flex flex-col overflow-hidden\">\n\n    <!-- HEADER FIXO (Topo) -->\n    <header class=\"glass-header h-16 flex items-center justify-between px-4 md:px-8 z-30 flex-shrink-0\">\n        <div class=\"flex items-center gap-3\">\n            <div class=\"bg-brand-600 text-white p-1.5 rounded-lg\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />\n                </svg>\n            </div>\n            <h1 class=\"font-bold text-gray-800 text-lg tracking-tight\">Admin <span class=\"text-gray-400 mx-1\">/</span>\n                Produtos</h1>\n        </div>\n\n        <nav class=\"flex gap-2 md:gap-4\">\n            <a href=\"https://imgur.com/upload\" target=\"_blank\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Upar Imagens</span>\n\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n            <a href=\"admin-clientes.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Clientes</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\" />\n                </svg>\n            </a>\n            <a href=\"admin-pedidos.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Pedidos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n            <a href=\"admin-custos.html\"\n                class=\"px-3 py-2 text-sm font-bold text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition flex items-center gap-2\">\n                <span class=\"hidden md:inline\">Custos</span>\n                <svg class=\"w-4 h-4 md:hidden\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                </svg>\n            </a>\n            <a href=\"index.html\" target=\"_blank\"\n                class=\"hidden md:flex px-3 py-2 text-sm font-bold text-brand-600 bg-brand-50 border border-brand-100 rounded-lg hover:bg-brand-100 transition items-center gap-2\">\n                <span>Ver Loja</span>\n                <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" />\n                </svg>\n            </a>\n            \n        </nav>\n    </header>\n\n    <!-- TOOLBAR, STATS E CONTROLES DE BUSCA -->\n    <div\n        class=\"bg-white border-b border-gray-200 px-4 md:px-8 pt-4 pb-2 flex flex-col md:flex-row gap-4 justify-between items-center flex-shrink-0\">\n\n        <!-- Stats Rápidos (Cards no Desktop, Compacto no Mobile) -->\n        <div\n            class=\"grid grid-cols-2 md:grid-cols-4 w-full md:w-auto gap-4 text-sm border-b md:border-0 border-gray-100 pb-4 md:pb-0\">\n            <div class=\"text-center md:text-left bg-gray-50 p-2 rounded-lg border border-gray-100\">\n                <p class=\"text-gray-400 text-xs font-bold uppercase\">Total</p>\n                <p id=\"total-produtos\" class=\"text-xl font-black text-gray-800\">0</p>\n            </div>\n            <div class=\"text-center md:text-left bg-green-50 p-2 rounded-lg border border-green-100\">\n                <p class=\"text-green-800 text-xs font-bold uppercase\">Ativos</p>\n                <p id=\"total-ativos\" class=\"text-xl font-black text-green-600\">0</p>\n            </div>\n            <div class=\"text-center md:text-left bg-orange-50 p-2 rounded-lg border border-orange-100\">\n                <p class=\"text-orange-800 text-xs font-bold uppercase\">Estoque Baixo</p>\n                <p id=\"estoque-baixo\" class=\"text-xl font-black text-orange-600\">0</p>\n            </div>\n            <div class=\"text-center md:text-left bg-red-50 p-2 rounded-lg border border-red-100\">\n                <p class=\"text-red-800 text-xs font-bold uppercase\">Esgotado</p>\n                <p id=\"estoque-esgotado\" class=\"text-xl font-black text-red-600\">0</p>\n            </div>\n        </div>\n\n        <!-- Controles de Ação -->\n        <div class=\"flex w-full md:w-auto gap-3 py-2\">\n            <div class=\"relative flex-grow md:w-64\">\n                <svg class=\"absolute left-3 top-3.5 w-5 h-5 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\"\n                    stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                        d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                </svg>\n                <input type=\"text\" id=\"search-input\" placeholder=\"Buscar produto ou categoria...\"\n                    class=\"w-full pl-10 pr-4 py-3 bg-gray-100 border-transparent focus:bg-white focus:border-brand-500 focus:ring-0 rounded-xl text-sm transition font-medium\">\n            </div>\n            <button onclick=\"abrirDrawer()\"\n                class=\"bg-gray-900 text-white px-5 py-3 rounded-xl font-bold text-sm hover:bg-gray-800 shadow-lg shadow-gray-300/50 transition active:scale-95 whitespace-nowrap flex items-center justify-center gap-2\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 4v16m8-8H4\" />\n                </svg>\n                <span class=\"hidden md:inline\">Novo Produto</span>\n            </button>\n        </div>\n    </div>\n\n    <!-- GRID DE PRODUTOS -->\n    <main class=\"flex-grow overflow-y-auto p-4 md:p-8 bg-gray-50\">\n        <div id=\"grid-produtos\" class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-20\">\n            <!-- Cards injetados via JS -->\n        </div>\n    </main>\n\n    <!-- DRAWER (Formulário Lateral/Inferior) -->\n    <div id=\"drawer-overlay\" onclick=\"fecharDrawer()\"\n        class=\"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300\"></div>\n\n    <!-- \n         Classe inicial: hidden (escondido), transform translate-y-full (escondido para mobile) e md:translate-x-full (escondido para desktop).\n         O JS remove 'hidden' e força style.transform = 'none' para exibir.\n    -->\n    <div id=\"drawer-form\" class=\"fixed z-50 bg-white shadow-2xl transition-transform duration-300 flex flex-col hidden\n        bottom-0 left-0 right-0 w-full h-[90vh] rounded-t-2xl md:h-full\n        md:inset-y-0 md:right-0 md:left-auto md:w-[480px] md:rounded-l-2xl md:rounded-tr-none\">\n\n        <!-- Header Drawer -->\n        <div class=\"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-white flex-shrink-0\">\n            <h2 id=\"drawer-title\" class=\"text-xl font-serif font-bold text-gray-900\">Novo Produto</h2>\n            <button onclick=\"fecharDrawer()\"\n                class=\"p-2 text-gray-400 hover:text-gray-600 bg-gray-50 rounded-full transition\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n            </button>\n        </div>\n\n        <!-- Form Content -->\n        <div class=\"flex-grow overflow-y-auto p-6 space-y-6\">\n            <form id=\"form-produto\" class=\"space-y-6\">\n\n                <!-- Preview Imagem -->\n                <div class=\"flex justify-center\">\n                    <div\n                        class=\"w-40 h-32 rounded-xl bg-gray-100 border border-gray-200 overflow-hidden relative shadow-inner\">\n                        <img id=\"preview-img\" src=\"https://placehold.co/400?text=Preview\"\n                            class=\"w-full h-full object-cover\">\n                        <div class=\"absolute bottom-0 w-full bg-black/50 text-white text-[10px] text-center py-1\">\n                            Preview</div>\n                    </div>\n                </div>\n\n                <!-- Toggle Ativo -->\n                <div class=\"flex justify-between items-center bg-gray-50 p-4 rounded-xl border border-gray-100\">\n                    <span class=\"font-bold text-gray-700 text-sm\">Produto Visível na Loja?</span>\n                    <div\n                        class=\"relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in\">\n                        <input type=\"checkbox\" name=\"ativo\" id=\"ativo\"\n                            class=\"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-300 ease-in-out left-0\" />\n                        <label for=\"ativo\"\n                            class=\"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer transition-colors duration-300\"></label>\n                    </div>\n                </div>\n\n                <!-- Campos Texto -->\n                <div class=\"grid grid-cols-1 gap-4\">\n                    <div>\n                        <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Nome do Produto</label>\n                        <input type=\"text\" id=\"nome\" required\n                            class=\"w-full p-3 border border-gray-200 rounded-xl focus:border-brand-500 focus:ring-0 outline-none font-bold text-gray-800\"\n                            placeholder=\"Ex: Brownie Tradicional\">\n                    </div>\n\n                    <div>\n                        <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Descrição</label>\n                        <textarea id=\"descricao\" rows=\"3\"\n                            class=\"w-full p-3 border border-gray-200 rounded-xl focus:border-brand-500 focus:ring-0 outline-none text-sm\"\n                            placeholder=\"Detalhes deliciosos...\"></textarea>\n                    </div>\n                </div>\n\n                <!-- Categoria -->\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Categoria</label>\n                    <select id=\"categoria-select\"\n                        class=\"w-full p-3 border border-gray-200 rounded-xl bg-white focus:border-brand-500 outline-none font-medium text-gray-700\">\n                        <option value=\"\" disabled selected>Carregando...</option>\n                    </select>\n\n                    <div id=\"categoria-nova-container\" class=\"hidden mt-2 animate-pulse\">\n                        <input type=\"text\" id=\"categoria-nova\"\n                            class=\"w-full p-3 border-2 border-brand-100 bg-brand-50 rounded-xl focus:border-brand-500 outline-none text-brand-800 placeholder-brand-300 font-bold\"\n                            placeholder=\"Nome da nova categoria (Ex: Vegano)\">\n                    </div>\n                </div>\n\n                <!-- Preços e Estoque -->\n                <div class=\"grid grid-cols-2 gap-4\">\n                    <div>\n                        <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Preço Base (R$)</label>\n                        <input type=\"number\" id=\"preco\" step=\"0.01\" required\n                            class=\"w-full p-3 border border-gray-200 rounded-xl focus:border-brand-500 outline-none font-bold text-gray-800\"\n                            placeholder=\"0.00\">\n                    </div>\n                    <div>\n                        <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Estoque Atual</label>\n                        <input type=\"number\" id=\"estoque-atual\" required\n                            class=\"w-full p-3 border border-gray-200 rounded-xl focus:border-brand-500 outline-none font-bold text-gray-800\"\n                            placeholder=\"0\">\n                    </div>\n                </div>\n\n                <!-- Opções Avançadas (Collapsible) -->\n                <details\n                    class=\"group bg-gray-50 rounded-xl border border-gray-100 open:bg-white open:shadow-sm transition-all\">\n                    <summary\n                        class=\"list-none flex justify-between items-center p-4 cursor-pointer font-bold text-sm text-gray-600 group-open:text-brand-600\">\n                        Opções Avançadas (Promoção, Imagem, Tags)\n                        <svg class=\"w-4 h-4 transition-transform group-open:rotate-180\" fill=\"none\" viewBox=\"0 0 24 24\"\n                            stroke=\"currentColor\">\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\" />\n                        </svg>\n                    </summary>\n                    <div class=\"p-4 pt-0 space-y-4 border-t border-gray-100 mt-2\">\n\n                        <div class=\"mt-4\">\n                            <label class=\"block text-xs font-bold text-red-500 uppercase mb-1 ml-1\">Preço Promocional\n                                (Opcional)</label>\n                            <input type=\"number\" id=\"preco-promo\" step=\"0.01\"\n                                class=\"w-full p-3 border border-red-100 bg-red-50 rounded-xl text-red-600 placeholder-red-200 font-bold\"\n                                placeholder=\"0.00\">\n                        </div>\n\n                        <div>\n                            <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">URL da\n                                Imagem</label>\n                            <input type=\"text\" id=\"imagem\"\n                                class=\"w-full p-3 border border-gray-200 rounded-xl text-xs text-gray-500 focus:border-brand-500 outline-none\"\n                                placeholder=\"https://...\">\n                        </div>\n\n                        <div>\n                            <label class=\"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1\">Tag\n                                Especial</label>\n                            <select id=\"tag-especial\" class=\"w-full p-3 border border-gray-200 rounded-xl text-sm\">\n                                <option value=\"normal\">Nenhuma (Padrão)</option>\n                                <option value=\"do_dia\">📅 Destaque do Dia</option>\n                                <option value=\"promo\">🏷️ Promoção</option>\n                            </select>\n                        </div>\n\n                        <div class=\"flex items-center gap-2\">\n                            <input type=\"checkbox\" id=\"destaque\"\n                                class=\"w-5 h-5 rounded border-gray-300 text-brand-600 focus:ring-brand-500\">\n                            <label for=\"destaque\" class=\"text-sm font-bold text-gray-600\">Exibir na vitrine de\n                                Destaques</label>\n                        </div>\n                    </div>\n                </details>\n\n            </form>\n        </div>\n\n        <!-- Footer Drawer (Botão Salvar Fixo) -->\n        <div class=\"p-6 border-t border-gray-100 bg-white pb-safe-area flex-shrink-0\">\n            <button form=\"form-produto\" type=\"submit\" id=\"btn-salvar\"\n                class=\"w-full bg-brand-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-brand-200 hover:bg-brand-700 active:scale-95 transition flex justify-center items-center\">\n                Salvar Produto\n            </button>\n        </div>\n    </div>\n\n    <!-- TOAST -->\n    <div id=\"toast\"></div>\n\n    <!-- PWA PROMPT (Mobile Only) -->\n    <div id=\"pwa-prompt\"\n        class=\"fixed bottom-0 left-0 right-0 p-4 bg-gray-900 text-white z-50 hidden shadow-[0_0_20px_rgba(0,0,0,0.5)]\">\n        <div class=\"flex items-center justify-between\">\n            <div class=\"flex items-center gap-3\">\n                <!-- Ícone simulando app -->\n                <div class=\"w-10 h-10 bg-pink-600 rounded-lg flex items-center justify-center shadow-md\">\n                    <svg class=\"w-6 h-6 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                            d=\"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />\n                    </svg>\n                </div>\n                <div>\n                    <p class=\"font-bold text-sm\">Instalar Gestão de Produtos</p>\n                    <p id=\"install-instructions\" class=\"text-xs text-gray-300 mt-0.5\">Toque no botão e instale na sua\n                        tela inicial.</p>\n                </div>\n            </div>\n            <button id=\"pwa-close\" class=\"text-gray-400 hover:text-white p-1 rounded-full\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n            </button>\n        </div>\n    </div>\n\n</body>\n\n</html>"
    },
    {
        "caminho": "Reh\\ads.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Divulgação Status</title>\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@700;900&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { \n                        sans: ['DM Sans', 'sans-serif'], \n                        serif: ['Playfair Display', 'serif'] \n                    },\n                    colors: { \n                        brand: { 500: '#ec4899', 600: '#db2777', 800: '#9d174d', 900: '#831843' } \n                    },\n                    backgroundImage: {\n                        'brownie-pattern': \"url('https://www.transparenttextures.com/patterns/cubes.png')\"\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        /* Reset e altura total fixada para print perfeito */\n        body, html { height: 100%; margin: 0; overflow: hidden; background-color: #db2777; }\n        \n        .glass-card {\n            background: rgba(255, 255, 255, 0.98);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(255, 255, 255, 0.8);\n            box-shadow: 0 20px 60px -15px rgba(0, 0, 0, 0.3);\n        }\n\n        .text-shadow {\n            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n        }\n    </style>\n</head>\n<body class=\"bg-gradient-to-b from-brand-600 to-brand-900 flex items-center justify-center relative\">\n\n    <!-- Fundo Decorativo Estático -->\n    <div class=\"absolute inset-0 bg-brownie-pattern opacity-10\"></div>\n    \n    <!-- Círculos Decorativos (Sem animação) -->\n    <div class=\"absolute top-0 left-0 w-full h-full overflow-hidden\">\n        <div class=\"absolute -top-10 -left-10 w-80 h-80 bg-brand-500 rounded-full mix-blend-overlay filter blur-3xl opacity-40\"></div>\n        <div class=\"absolute top-1/3 right-0 w-60 h-60 bg-purple-500 rounded-full mix-blend-overlay filter blur-3xl opacity-30\"></div>\n        <div class=\"absolute -bottom-20 left-20 w-96 h-96 bg-pink-400 rounded-full mix-blend-overlay filter blur-3xl opacity-30\"></div>\n    </div>\n\n    <!-- ARTE PRINCIPAL -->\n    <main class=\"relative z-10 w-full max-w-md h-full flex flex-col px-8 py-12 justify-between\">\n        \n        <!-- Topo -->\n        <div class=\"flex flex-col items-center space-y-6\">\n            <!-- Tag Superior -->\n            <div class=\"bg-white/20 backdrop-blur-md border border-white/40 px-6 py-1.5 rounded-full shadow-sm\">\n                <span class=\"text-white text-xs font-bold tracking-[0.25em] uppercase\">\n                    Cardápio Digital\n                </span>\n            </div>\n\n            <!-- Logo Central -->\n            <div class=\"relative mt-4\">\n                <div class=\"absolute inset-0 bg-brand-900 rounded-full blur-2xl opacity-40 transform translate-y-4\"></div>\n                <div class=\"w-40 h-40 bg-white rounded-full p-1.5 shadow-2xl relative z-10 border-4 border-white/50\">\n                    <img src=\"logo.png\" class=\"w-full h-full object-cover rounded-full border border-gray-100\" onerror=\"this.src='https://placehold.co/200?text=Logo'\">\n                </div>\n                <div class=\"absolute -bottom-3 -right-3 bg-green-500 text-white text-[10px] font-black px-3 py-1.5 rounded-lg shadow-lg border-2 border-white uppercase tracking-wide\">\n                    Peça & Retire\n                </div>\n            </div>\n        </div>\n\n        <!-- Mensagem Principal -->\n        <div class=\"text-center space-y-4 my-4\">\n            <h1 class=\"text-5xl font-serif font-black text-white leading-[0.9] text-shadow\">\n                Delicia<br>\n                <span class=\"text-brand-200\">D'Brownie</span>\n            </h1>\n            <div class=\"w-16 h-1.5 bg-white/30 rounded-full mx-auto my-4\"></div>\n            <p class=\"text-white/90 text-lg font-medium leading-relaxed\">\n                Faça seu pedido online e<br> retire na loja sem filas!\n            </p>\n        </div>\n\n        <!-- Card do Site -->\n        <div class=\"w-full\">\n            <div class=\"glass-card rounded-2xl p-6 text-center transform translate-y-2\">\n                <p class=\"text-gray-400 text-[10px] font-bold uppercase tracking-widest mb-3\">ACESSE NOSSO CARDÁPIO</p>\n                \n                <div class=\"bg-gray-50 rounded-xl py-4 px-2 border border-gray-200 mb-4\">\n                    <p class=\"text-brand-700 font-bold text-lg leading-tight break-words font-serif\">\n                        deliciadebrowniecuritiba.com.br\n                    </p>\n                </div>\n\n                <!-- Ícones de Benefícios -->\n                <div class=\"flex justify-center gap-6 border-t border-gray-100 pt-4\">\n                    <div class=\"flex flex-col items-center\">\n                        <div class=\"w-8 h-8 bg-brand-50 text-brand-600 rounded-full flex items-center justify-center mb-1\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg>\n                        </div>\n                        <span class=\"text-[10px] font-bold text-gray-600 uppercase\">Rápido</span>\n                    </div>\n                    <div class=\"flex flex-col items-center\">\n                        <div class=\"w-8 h-8 bg-brand-50 text-brand-600 rounded-full flex items-center justify-center mb-1\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"/></svg>\n                        </div>\n                        <span class=\"text-[10px] font-bold text-gray-600 uppercase\">Prático</span>\n                    </div>\n                    <div class=\"flex flex-col items-center\">\n                        <div class=\"w-8 h-8 bg-green-50 text-green-600 rounded-full flex items-center justify-center mb-1\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/></svg>\n                        </div>\n                        <span class=\"text-[10px] font-bold text-gray-600 uppercase\">Retire</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Footer Call to Action -->\n        <div class=\"text-center mt-4\">\n            <p class=\"text-white/70 text-sm font-medium uppercase tracking-wide\">\n                Link na Bio\n            </p>\n            <div class=\"text-white mt-2 opacity-80\">\n                <svg class=\"w-6 h-6 mx-auto\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 10l7-7m0 0l7 7m-7-7v18\"/></svg>\n            </div>\n        </div>\n\n    </main>\n\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\comprovante.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#34d399\">\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n    <title>Comprovante | Delicia D'Brownie</title>\n    \n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- FONTES -->\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { \n                        sans: ['DM Sans', 'sans-serif'], \n                        serif: ['Playfair Display', 'serif'] \n                    },\n                    colors: { \n                        brand: { \n                            50: '#fff1f2', 100: '#ffe4e6', 500: '#f43f5e', 600: '#db2777', 900: '#881337',\n                            success: '#10b981', // Verde esmeralda\n                        } \n                    },\n                    boxShadow: {\n                        'success': '0 10px 15px -3px rgba(16, 185, 129, 0.5), 0 4px 6px -2px rgba(16, 185, 129, 0.1)',\n                    },\n                    animation: {\n                        'slide-down': 'slideDown 0.5s ease-out forwards',\n                    },\n                    keyframes: {\n                        slideDown: { '0%': { opacity: '0', transform: 'translateY(-20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } }\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }\n        .receipt-container { \n            position: relative; \n            background: #fff; \n            border-radius: 1.5rem; \n            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n            max-width: 450px;\n        }\n        /* Efeito de picote de recibo */\n        .receipt-bottom:before {\n            content: '';\n            position: absolute;\n            top: -20px; /* Alinha na borda superior */\n            left: 0;\n            width: 100%;\n            height: 20px;\n            background: linear-gradient(-45deg, #f9fafb 10px, transparent 0) 0 100%, \n                        linear-gradient(45deg, #f9fafb 10px, transparent 0) 0 100%;\n            background-size: 20px 20px;\n            background-repeat: repeat-x;\n        }\n    </style>\n</head>\n\n<body class=\"bg-gray-50 font-sans text-gray-800 min-h-screen flex flex-col items-center pt-8 pb-12\">\n\n    <!-- Recibo Principal -->\n    <div class=\"receipt-container w-full mx-4 shadow-xl mb-6 animate-slide-down\">\n        \n        <!-- Header de Sucesso -->\n        <div class=\"bg-brand-success p-8 rounded-t-3xl text-white text-center\">\n            <svg class=\"w-12 h-12 mx-auto mb-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" /></svg>\n            <h1 class=\"text-3xl font-serif font-black mb-1\">Pedido Enviado!</h1>\n            <p class=\"text-sm opacity-90\">Sua reserva para retirada foi concluída.</p>\n        </div>\n\n        <!-- Corpo do Recibo -->\n        <div class=\"p-6\">\n            \n            <!-- Detalhes do Pedido -->\n            <div class=\"mb-6 border-b border-gray-100 pb-4\">\n                <div class=\"flex justify-between items-center mb-2\">\n                    <span class=\"text-xs font-bold text-gray-400 uppercase\">ID do Pedido</span>\n                    <span id=\"comp-id\" class=\"text-lg font-mono font-black text-gray-900\">#0000</span>\n                </div>\n                <div class=\"flex justify-between items-center mb-2\">\n                    <span class=\"text-xs font-bold text-gray-400 uppercase\">Data/Hora</span>\n                    <span id=\"comp-data\" class=\"text-sm font-medium text-gray-600\">--/--/--</span>\n                </div>\n                <div class=\"flex justify-between items-center\">\n                    <span class=\"text-xs font-bold text-gray-400 uppercase\">Retirada em</span>\n                    <span class=\"text-sm font-medium text-gray-600\">Nossa Loja (Centro)</span>\n                </div>\n            </div>\n\n            <!-- Itens do Pedido -->\n            <h2 class=\"text-sm font-bold text-gray-500 uppercase mb-3\">Sua Reserva</h2>\n            <div id=\"comp-itens\" class=\"space-y-3 mb-6\">\n                <!-- Itens serão injetados aqui -->\n            </div>\n\n            <!-- Total -->\n            <div class=\"relative receipt-bottom pt-6 mt-4\">\n                <div class=\"flex justify-between font-bold text-xl text-gray-900\">\n                    <span>Total</span>\n                    <span id=\"comp-total\">R$ 0,00</span>\n                </div>\n                <p class=\"text-xs text-gray-500 mt-2 text-center\">O pagamento será feito no momento da retirada.</p>\n            </div>\n        </div>\n\n        <!-- Footer com Pontos e Endereço -->\n        <div class=\"p-6 border-t border-gray-100 bg-gray-50 rounded-b-3xl\">\n            <div class=\"flex items-center justify-center gap-2 mb-4 text-brand-600\">\n                <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/></svg>\n                <span id=\"comp-pontos\" class=\"text-sm font-bold\">Você ganhou +1 Ponto Fidelidade!</span>\n            </div>\n            \n            <p class=\"text-xs text-gray-500 text-center\">\n                <span class=\"font-bold\">Endereço de Retirada:</span> Rua Exemplo, 123 - Centro.\n            </p>\n        </div>\n    </div>\n\n    <!-- Ações Finais -->\n    <div class=\"flex flex-col gap-3 w-full max-w-sm px-4\">\n        <a href=\"pedidos.html\" class=\"w-full bg-brand-success text-white text-center font-bold py-3 rounded-xl shadow-lg shadow-green-200 active:scale-95 transition-transform\">\n            Acompanhar Pedido\n        </a>\n        <a href=\"index.html\" class=\"w-full bg-white border border-gray-200 text-gray-600 text-center font-bold py-3 rounded-xl active:scale-95 transition-transform\">\n            Voltar ao Cardápio\n        </a>\n    </div>\n\n    <script>\n        document.addEventListener('DOMContentLoaded', () => {\n            const pedidoDataJson = sessionStorage.getItem('lastPedidoData');\n            \n            if (!pedidoDataJson) {\n                // Se não houver dados, redireciona para o histórico\n                window.location.href = 'pedidos.html';\n                return;\n            }\n\n            const pedido = JSON.parse(pedidoDataJson);\n            renderizarComprovante(pedido);\n\n            // Limpa após renderizar para que o cliente não veja o mesmo comprovante se recarregar\n            sessionStorage.removeItem('lastPedidoData'); \n        });\n\n        function renderizarComprovante(pedido) {\n            // Formatos utilitários\n            const formatarMoeda = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v);\n            const data = new Date(pedido.data);\n            const dataFormatada = data.toLocaleDateString('pt-BR') + ' ' + data.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n\n            // 1. Detalhes de Header\n            document.getElementById('comp-id').innerText = pedido.id_visual;\n            document.getElementById('comp-data').innerText = dataFormatada;\n\n            // 2. Itens\n            const listaItens = document.getElementById('comp-itens');\n            listaItens.innerHTML = pedido.itens.map(item => {\n                const obs = item.obs ? `<span class=\"text-[10px] text-red-500 block italic ml-4\">Obs: ${item.obs}</span>` : '';\n                return `\n                    <div class=\"flex justify-between items-start text-sm border-l-2 border-brand-50 pl-2\">\n                        <div>\n                            <span class=\"font-medium text-gray-800\">${item.qtd}x ${item.nome}</span>\n                            ${obs}\n                        </div>\n                        <span class=\"font-bold text-gray-900\">${formatarMoeda(item.precoFinal * item.qtd)}</span>\n                    </div>\n                `;\n            }).join('');\n\n            // 3. Total e Pontos\n            document.getElementById('comp-total').innerText = formatarMoeda(pedido.total);\n            const pontosTxt = pedido.pontos_ganhos > 0 ? `Você ganhou +${pedido.pontos_ganhos} Ponto Fidelidade!` : 'Obrigado por sua compra!';\n            document.getElementById('comp-pontos').innerText = pontosTxt;\n        }\n\n        // Função para simular a impressão ou captura de tela (apenas para fins de demonstração)\n        function capturarComprovante() {\n             alert('Em um aplicativo real, aqui você teria a opção de salvar como PDF ou imagem!');\n        }\n    </script>\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\encomendas.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#db2777\">\n    <title>Fazer Encomenda | Delicia D'Brownie</title>\n    \n    <!-- FAVICON -->\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n\n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- FIREBASE -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES -->\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { \n                        sans: ['DM Sans', 'sans-serif'], \n                        serif: ['Playfair Display', 'serif'] \n                    },\n                    colors: { \n                        brand: { 50: '#fff1f2', 100: '#ffe4e6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d' } \n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0,0,0,0.05); }\n        .pb-safe-area { padding-bottom: env(safe-area-inset-bottom); }\n        /* Checkbox personalizado */\n        .checkbox-custom:checked { background-color: #db2777; border-color: #db2777; }\n        .checkbox-custom:checked + div { color: #db2777; font-weight: bold; }\n    </style>\n\n    <script>\n        const firebaseConfig = {\n            apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n            authDomain: \"renata-26079.firebaseapp.com\",\n            projectId: \"renata-26079\",\n            storageBucket: \"renata-26079.firebasestorage.app\",\n            messagingSenderId: \"995787482442\",\n            appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n        };\n\n        firebase.initializeApp(firebaseConfig);\n        const db = firebase.firestore();\n        const auth = firebase.auth();\n\n        document.addEventListener('DOMContentLoaded', () => {\n            auth.onAuthStateChanged(user => { if (!user) auth.signInAnonymously(); });\n            verificarLogin();\n            \n            // Define data mínima como hoje\n            const hoje = new Date().toISOString().split('T')[0];\n            document.getElementById('data-evento').min = hoje;\n        });\n\n        function verificarLogin() {\n            const nome = localStorage.getItem('userName');\n            const fone = localStorage.getItem('userPhone');\n\n            if (!nome || !fone) {\n                document.getElementById('form-container').innerHTML = `\n                    <div class=\"text-center py-10\">\n                        <div class=\"w-20 h-20 bg-brand-50 rounded-full flex items-center justify-center mx-auto mb-4\">\n                            <svg class=\"w-10 h-10 text-brand-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"/></svg>\n                        </div>\n                        <h2 class=\"text-xl font-bold text-gray-900 mb-2\">Identifique-se</h2>\n                        <p class=\"text-gray-500 mb-6 px-6\">Para solicitar um orçamento, precisamos saber quem você é.</p>\n                        <a href=\"perfil.html\" class=\"bg-brand-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:bg-brand-700 transition\">Fazer Login</a>\n                    </div>\n                `;\n            } else {\n                document.getElementById('cliente-nome').value = nome;\n                document.getElementById('cliente-fone').value = fone;\n                document.getElementById('msg-ola').innerText = `Olá, ${nome.split(' ')[0]}! Vamos planejar seu evento?`;\n            }\n        }\n\n        async function enviarEncomenda(e) {\n            e.preventDefault();\n            const btn = document.getElementById('btn-enviar');\n            const originalText = btn.innerText;\n            \n            // Coleta dados\n            const dataEvento = document.getElementById('data-evento').value;\n            const qtdPessoas = document.getElementById('qtd-pessoas').value;\n            const descricao = document.getElementById('descricao').value;\n            \n            // Coleta checkbox\n            const tipos = [];\n            document.querySelectorAll('input[name=\"tipo\"]:checked').forEach(el => tipos.push(el.value));\n\n            if (!dataEvento || !descricao || tipos.length === 0) {\n                alert(\"Por favor, preencha a data, selecione pelo menos um tipo e descreva o que precisa.\");\n                return;\n            }\n\n            btn.disabled = true;\n            btn.innerText = \"Enviando...\";\n\n            const pedido = {\n                tipo_pedido: 'encomenda', // Flag importante para o admin separar\n                status: 'Pendente Aprovação',\n                cliente_nome: localStorage.getItem('userName'),\n                cliente_telefone: localStorage.getItem('userPhone'),\n                cliente_telefone_limpo: localStorage.getItem('userPhone').replace(/\\D/g, ''),\n                data_solicitacao: new Date().toISOString(),\n                detalhes: {\n                    data_evento: dataEvento,\n                    qtd_pessoas: qtdPessoas,\n                    tipos_itens: tipos,\n                    descricao: descricao\n                }\n            };\n\n            try {\n                await db.collection('encomendas').add(pedido);\n                \n                // Feedback visual\n                document.getElementById('form-container').innerHTML = `\n                    <div class=\"text-center py-10 animate-pulse\">\n                        <div class=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                            <svg class=\"w-10 h-10 text-green-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/></svg>\n                        </div>\n                        <h2 class=\"text-2xl font-serif font-bold text-gray-900 mb-2\">Solicitação Enviada!</h2>\n                        <p class=\"text-gray-500 mb-6 px-4\">Recebemos seu pedido de orçamento. A loja analisará e entrará em contato pelo WhatsApp em breve.</p>\n                        <a href=\"pedidos.html\" class=\"text-brand-600 font-bold underline\">Acompanhar meus pedidos</a>\n                    </div>\n                `;\n\n                // Notifica loja via Zap (Opcional)\n                /*\n                const msg = `*NOVA ENCOMENDA*\\nCliente: ${pedido.cliente_nome}\\nData Evento: ${dataEvento.split('-').reverse().join('/')}\\nItens: ${tipos.join(', ')}`;\n                window.open(`https://wa.me/5541992480604?text=${encodeURIComponent(msg)}`, '_blank');\n                */\n\n            } catch (error) {\n                console.error(error);\n                alert(\"Erro ao enviar. Tente novamente.\");\n                btn.disabled = false;\n                btn.innerText = originalText;\n            }\n        }\n    </script>\n</head>\n<body class=\"bg-gray-50 font-sans text-gray-800 pb-24 md:pb-0 min-h-screen flex flex-col\">\n\n    <!-- HEADER -->\n    <header class=\"fixed top-0 w-full z-40 glass-effect border-b border-gray-100 shadow-sm\">\n        <div class=\"container mx-auto px-4 h-16 flex justify-between items-center\">\n            <div class=\"flex items-center gap-2\">\n                <a href=\"index.html\" class=\"p-1 rounded-full hover:bg-gray-100 transition\">\n                    <svg class=\"w-6 h-6 text-gray-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/></svg>\n                </a>\n                <h1 class=\"text-xl font-serif font-black text-gray-900 tracking-tight\">Encomendas</h1>\n            </div>\n        </div>\n    </header>\n\n    <!-- CONTEÚDO -->\n    <main class=\"flex-grow pt-20 px-4 container mx-auto max-w-lg\">\n        \n        <div class=\"mb-6\">\n            <h2 class=\"text-2xl font-serif font-bold text-brand-600 mb-1\">Faça sua festa</h2>\n            <p class=\"text-sm text-gray-500\" id=\"msg-ola\">Solicite um orçamento para eventos.</p>\n        </div>\n\n        <div id=\"form-container\" class=\"bg-white p-6 rounded-2xl shadow-sm border border-gray-100\">\n            <form onsubmit=\"enviarEncomenda(event)\" class=\"space-y-5\">\n                \n                <input type=\"hidden\" id=\"cliente-nome\">\n                <input type=\"hidden\" id=\"cliente-fone\">\n\n                <!-- Data do Evento -->\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1 ml-1\">Data do Evento</label>\n                    <input type=\"date\" id=\"data-evento\" required class=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:border-brand-500 outline-none font-bold text-gray-700\">\n                </div>\n\n                <!-- Qtd Pessoas -->\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1 ml-1\">Número de Convidados (Aprox.)</label>\n                    <input type=\"number\" id=\"qtd-pessoas\" class=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:border-brand-500 outline-none font-bold text-gray-700\" placeholder=\"Ex: 50\">\n                </div>\n\n                <!-- Checkboxes -->\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-2 ml-1\">O que você precisa?</label>\n                    <div class=\"grid grid-cols-2 gap-3\">\n                        <label class=\"flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition\">\n                            <input type=\"checkbox\" name=\"tipo\" value=\"Doces\" class=\"checkbox-custom w-5 h-5 rounded border-gray-300 text-brand-600 focus:ring-brand-500 transition\">\n                            <div class=\"ml-3 text-sm text-gray-600\">Doces</div>\n                        </label>\n                        <label class=\"flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition\">\n                            <input type=\"checkbox\" name=\"tipo\" value=\"Salgados\" class=\"checkbox-custom w-5 h-5 rounded border-gray-300 text-brand-600 focus:ring-brand-500 transition\">\n                            <div class=\"ml-3 text-sm text-gray-600\">Salgados</div>\n                        </label>\n                        <label class=\"flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition\">\n                            <input type=\"checkbox\" name=\"tipo\" value=\"Bolos\" class=\"checkbox-custom w-5 h-5 rounded border-gray-300 text-brand-600 focus:ring-brand-500 transition\">\n                            <div class=\"ml-3 text-sm text-gray-600\">Bolos</div>\n                        </label>\n                        <label class=\"flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition\">\n                            <input type=\"checkbox\" name=\"tipo\" value=\"Kit Festa\" class=\"checkbox-custom w-5 h-5 rounded border-gray-300 text-brand-600 focus:ring-brand-500 transition\">\n                            <div class=\"ml-3 text-sm text-gray-600\">Kit Festa</div>\n                        </label>\n                    </div>\n                </div>\n\n                <!-- Descrição -->\n                <div>\n                    <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1 ml-1\">Detalhes do Pedido</label>\n                    <textarea id=\"descricao\" rows=\"4\" required class=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:border-brand-500 outline-none text-sm text-gray-700\" placeholder=\"Descreva os sabores, preferências ou dúvidas...\"></textarea>\n                </div>\n\n                <!-- Botão -->\n                <button type=\"submit\" id=\"btn-enviar\" class=\"w-full bg-brand-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-brand-200 hover:bg-brand-700 active:scale-95 transition\">\n                    Enviar Solicitação\n                </button>\n\n            </form>\n        </div>\n\n    </main>\n\n    <!-- FOOTER MOBILE (Igual ao Index, mas com Encomendas ativo se quiser, ou padrão) -->\n    <nav class=\"md:hidden fixed bottom-0 w-full bg-white border-t border-gray-100 z-30 pb-safe-area shadow-[0_-5px_20px_rgba(0,0,0,0.03)]\">\n        <div class=\"flex justify-around items-center h-16\">\n            <a href=\"index.html\" class=\"flex flex-col items-center text-gray-400 hover:text-brand-600 transition-colors active:scale-90\">\n                <svg class=\"w-6 h-6 mb-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"/></svg>\n                <span class=\"text-[10px] font-medium\">Início</span>\n            </a>\n            \n            <!-- Botão Encomendas (Destaque) -->\n            <a href=\"encomendas.html\" class=\"flex flex-col items-center text-brand-600 active:scale-90\">\n                <svg class=\"w-6 h-6 mb-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"/></svg>\n                <span class=\"text-[10px] font-bold\">Encomendas</span>\n            </a>\n\n            <a href=\"pedidos.html\" class=\"flex flex-col items-center text-gray-400 hover:text-brand-600 transition-colors active:scale-90\">\n                <svg class=\"w-6 h-6 mb-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"/></svg>\n                <span class=\"text-[10px] font-medium\">Pedidos</span>\n            </a>\n        </div>\n    </nav>\n\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\firebase_config.js",
        "conteudo": "// --- ARQUIVO DE BACKUP DAS CHAVES ---\n// Atualmente, o sistema \"App Like\" usa essas chaves diretamente\n// dentro dos arquivos .html para facilitar o uso sem servidor.\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n    authDomain: \"renata-26079.firebaseapp.com\",\n    projectId: \"renata-26079\",\n    storageBucket: \"renata-26079.firebasestorage.app\",\n    messagingSenderId: \"995787482442\",\n    appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n};\n\n// Se um dia quiser centralizar, você usaria assim:\n// export { firebaseConfig };"
    },
    {
        "caminho": "Reh\\guia-custos.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Manual de Precificação - Delicia D'Brownie</title>\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@700&display=swap\" rel=\"stylesheet\">\n    <link href=\"https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { sans: ['DM Sans', 'sans-serif'], serif: ['Playfair Display', 'serif'] },\n                    colors: { brand: { 500: '#ec4899', 600: '#db2777', 900: '#831843' } }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        /* Ajustes para Impressão (Ctrl+P) */\n        @media print {\n            body { background: white; color: black; }\n            .no-print { display: none !important; }\n            .page-break { page-break-before: always; }\n            .shadow-lg, .shadow-xl { box-shadow: none !important; border: 1px solid #ddd; }\n            .bg-gray-50 { background-color: #f9fafb !important; -webkit-print-color-adjust: exact; }\n            .bg-brand-600 { background-color: #db2777 !important; color: white !important; -webkit-print-color-adjust: exact; }\n        }\n    </style>\n</head>\n<body class=\"bg-gray-100 text-gray-700 font-sans min-h-screen\">\n\n    <!-- BARRA DE AÇÃO (Não sai na impressão) -->\n    <div class=\"no-print fixed bottom-6 right-6 z-50 flex gap-2\">\n        <a href=\"admin-custos.html\" class=\"bg-white text-gray-600 px-4 py-3 rounded-full shadow-lg font-bold flex items-center gap-2 hover:bg-gray-50 border border-gray-200\">\n            <i class=\"ri-arrow-left-line\"></i> Voltar\n        </a>\n        <button onclick=\"window.print()\" class=\"bg-brand-600 text-white px-6 py-3 rounded-full shadow-lg font-bold flex items-center gap-2 hover:bg-brand-500 animate-bounce\">\n            <i class=\"ri-printer-line\"></i> Imprimir Guia / Salvar PDF\n        </button>\n    </div>\n\n    <!-- CONTEÚDO DO DOCUMENTO -->\n    <div class=\"max-w-3xl mx-auto bg-white shadow-xl min-h-screen p-8 md:p-16 my-0 md:my-10 print:my-0 print:shadow-none\">\n        \n        <!-- CABEÇALHO -->\n        <header class=\"text-center border-b-2 border-brand-600 pb-8 mb-8\">\n            <div class=\"w-20 h-20 bg-gray-100 rounded-full mx-auto mb-4 flex items-center justify-center border-2 border-brand-600\">\n                <!-- Logo Placeholder -->\n                <i class=\"ri-calculator-fill text-3xl text-brand-600\"></i>\n            </div>\n            <h1 class=\"text-4xl font-serif font-bold text-gray-900 mb-2\">Entendendo seus Custos</h1>\n            <p class=\"text-lg text-gray-500\">Como o sistema calcula o lucro real de cada produto</p>\n        </header>\n\n        <!-- INTRODUÇÃO -->\n        <section class=\"mb-10\">\n            <div class=\"bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg\">\n                <p class=\"font-medium text-blue-800\">Por que isso é importante?</p>\n                <p class=\"text-sm text-blue-600 mt-1\">Muitas lojas perdem dinheiro sem saber porque calculam o custo errado. Nosso sistema automatiza a \"regra de três\" dos ingredientes e separa taxas invisíveis (como iFood) dos custos físicos.</p>\n            </div>\n        </section>\n\n        <!-- 1. A FÓRMULA -->\n        <section class=\"mb-12\">\n            <h2 class=\"text-2xl font-bold text-gray-900 mb-4 flex items-center gap-2\">\n                <span class=\"w-8 h-8 bg-brand-600 text-white rounded-full flex items-center justify-center text-sm\">1</span>\n                A Matemática do Lucro\n            </h2>\n            <p class=\"mb-4 text-gray-600\">O sistema segue uma lógica rigorosa para te dar a verdade:</p>\n            \n            <div class=\"flex flex-col md:flex-row items-center justify-center gap-4 text-center font-bold text-sm md:text-base bg-gray-50 p-6 rounded-xl border border-gray-200\">\n                <div class=\"bg-green-100 text-green-800 px-4 py-2 rounded-lg border border-green-200 w-full md:w-auto\">\n                    Preço de Venda\n                </div>\n                <div class=\"text-gray-400\"><i class=\"ri-subtract-line text-xl\"></i></div>\n                <div class=\"bg-red-50 text-red-800 px-4 py-2 rounded-lg border border-red-100 w-full md:w-auto\">\n                    Custo Ingredientes\n                    <br><span class=\"text-[10px] font-normal\">(Proporcional)</span>\n                </div>\n                <div class=\"text-gray-400\"><i class=\"ri-subtract-line text-xl\"></i></div>\n                <div class=\"bg-orange-50 text-orange-800 px-4 py-2 rounded-lg border border-orange-100 w-full md:w-auto\">\n                    Custos Fixos\n                    <br><span class=\"text-[10px] font-normal\">(Embalagem/Gás)</span>\n                </div>\n                <div class=\"text-gray-400\"><i class=\"ri-subtract-line text-xl\"></i></div>\n                <div class=\"bg-purple-50 text-purple-800 px-4 py-2 rounded-lg border border-purple-100 w-full md:w-auto\">\n                    Taxas Variáveis\n                    <br><span class=\"text-[10px] font-normal\">(% iFood/Cartão)</span>\n                </div>\n                <div class=\"text-gray-400\"><i class=\"ri-equal-line text-xl\"></i></div>\n                <div class=\"bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg w-full md:w-auto border border-gray-900\">\n                    LUCRO REAL\n                </div>\n            </div>\n        </section>\n\n        <div class=\"page-break\"></div>\n\n        <!-- 2. DETALHANDO OS CAMPOS -->\n        <section class=\"mb-12\">\n            <h2 class=\"text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n                <span class=\"w-8 h-8 bg-brand-600 text-white rounded-full flex items-center justify-center text-sm\">2</span>\n                Entendendo cada Campo\n            </h2>\n\n            <!-- INGREDIENTES -->\n            <div class=\"mb-8\">\n                <h3 class=\"font-bold text-lg text-gray-800 mb-2 border-b border-gray-100 pb-2\">🅰️ Ingredientes (Custo Proporcional)</h3>\n                <p class=\"text-sm text-gray-600 mb-4\">Aqui você cadastra a matéria-prima. O pulo do gato é que você informa <strong>como compra</strong> e <strong>quanto usa</strong>. O sistema calcula o resto.</p>\n                \n                <div class=\"bg-white border border-gray-200 rounded-xl overflow-hidden\">\n                    <table class=\"w-full text-sm text-left\">\n                        <thead class=\"bg-gray-50 text-gray-500 font-bold uppercase text-xs\">\n                            <tr>\n                                <th class=\"p-3\">Campo</th>\n                                <th class=\"p-3\">O que preencher?</th>\n                                <th class=\"p-3\">Exemplo Prático</th>\n                            </tr>\n                        </thead>\n                        <tbody class=\"divide-y divide-gray-100\">\n                            <tr>\n                                <td class=\"p-3 font-bold text-brand-600\">Preço de Compra</td>\n                                <td class=\"p-3\">Quanto você pagou no pacote fechado no mercado.</td>\n                                <td class=\"p-3\">Paguei <strong>R$ 15,00</strong> num saco de farinha.</td>\n                            </tr>\n                            <tr>\n                                <td class=\"p-3 font-bold text-brand-600\">Qtd. da Embalagem</td>\n                                <td class=\"p-3\">O peso ou volume total que vem na embalagem fechada.</td>\n                                <td class=\"p-3\">O saco tem <strong>5kg</strong> (ou 5000g).</td>\n                            </tr>\n                            <tr>\n                                <td class=\"p-3 font-bold text-brand-600\">Uso na Receita</td>\n                                <td class=\"p-3\">Quanto dessa matéria-prima vai em <strong>UMA</strong> unidade do seu produto.</td>\n                                <td class=\"p-3\">Para um brownie, uso <strong>50g</strong> de farinha.</td>\n                            </tr>\n                            <tr class=\"bg-green-50\">\n                                <td class=\"p-3 font-bold text-green-700\">Cálculo Automático</td>\n                                <td class=\"p-3 text-green-700\" colspan=\"2\">\n                                    O sistema faz: (15,00 ÷ 5000g) × 50g = <strong>R$ 0,15</strong> de custo.\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n\n            <!-- CUSTOS EXTRAS (FIXOS vs VARIÁVEIS) -->\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                \n                <!-- Fixos -->\n                <div class=\"border border-gray-200 rounded-xl p-5 bg-orange-50/30\">\n                    <h3 class=\"font-bold text-orange-700 mb-2 flex items-center gap-2\">\n                        <i class=\"ri-money-dollar-box-line\"></i> Custos Fixos (R$)\n                    </h3>\n                    <p class=\"text-xs text-gray-600 mb-3\">São custos que <strong>não dependem do preço de venda</strong>, mas você gasta para produzir cada unidade.</p>\n                    <ul class=\"text-sm space-y-2 list-disc list-inside text-gray-700\">\n                        <li><strong>Embalagem:</strong> Caixa, fita, adesivo (Ex: R$ 1,50).</li>\n                        <li><strong>Gás/Luz:</strong> Uma estimativa difícil de medir exato, mas essencial. Estime um valor fixo (Ex: R$ 0,50 por brownie assado).</li>\n                    </ul>\n                </div>\n\n                <!-- Variáveis -->\n                <div class=\"border border-gray-200 rounded-xl p-5 bg-purple-50/30\">\n                    <h3 class=\"font-bold text-purple-700 mb-2 flex items-center gap-2\">\n                        <i class=\"ri-percent-line\"></i> Taxas Variáveis (%)\n                    </h3>\n                    <p class=\"text-xs text-gray-600 mb-3\">São \"mordidas\" que parceiros dão no seu valor de venda. Se o preço do produto sobe, essa taxa sobe junto (em dinheiro).</p>\n                    <ul class=\"text-sm space-y-2 list-disc list-inside text-gray-700\">\n                        <li><strong>iFood:</strong> Geralmente 12% a 27%.</li>\n                        <li><strong>Cartão:</strong> Taxa da maquininha (Ex: 4%).</li>\n                        <li><strong>Imposto:</strong> Se emitir nota (Ex: DAS MEI).</li>\n                    </ul>\n                    <p class=\"text-[10px] mt-2 text-purple-600 font-bold bg-purple-100 p-1 rounded\">O sistema calcula essa % em cima do \"Preço Simulado\".</p>\n                </div>\n\n            </div>\n        </section>\n\n        <!-- 3. O SIMULADOR -->\n        <section class=\"mb-12\">\n            <h2 class=\"text-2xl font-bold text-gray-900 mb-4 flex items-center gap-2\">\n                <span class=\"w-8 h-8 bg-brand-600 text-white rounded-full flex items-center justify-center text-sm\">3</span>\n                O Simulador de Preço\n            </h2>\n            <div class=\"bg-gray-50 border border-gray-200 rounded-xl p-6 flex flex-col md:flex-row gap-6 items-center\">\n                <div class=\"flex-1\">\n                    <p class=\"text-gray-700 mb-3\">\n                        No topo da calculadora, existe um campo chamado <strong>\"Venda (R$)\"</strong>. Ele puxa o preço atual do produto, mas você pode digitar qualquer valor ali.\n                    </p>\n                    <p class=\"text-gray-700 text-sm\">\n                        <strong>Para que serve?</strong><br>\n                        Para você brincar de \"E se?\".<br>\n                        <em>\"E se eu vender a R$ 10,00? Tenho lucro?\"</em><br>\n                        <em>\"E se eu vender a R$ 12,00?\"</em>\n                    </p>\n                    <p class=\"text-xs text-gray-400 mt-2 italic\">* Alterar este valor na calculadora NÃO muda o preço na vitrine da loja, é apenas para simulação.</p>\n                </div>\n                <div class=\"w-full md:w-64 bg-white p-4 rounded-lg border border-gray-200 shadow-sm\">\n                    <div class=\"text-xs font-bold text-gray-400 uppercase mb-1\">Exemplo Visual</div>\n                    <div class=\"flex items-center gap-2 bg-gray-100 p-2 rounded mb-2\">\n                        <span class=\"text-xs font-bold\">Venda (R$)</span>\n                        <div class=\"bg-white border border-gray-300 px-2 rounded font-black text-brand-600\">15,00</div>\n                        <i class=\"ri-edit-line text-gray-400\"></i>\n                    </div>\n                    <div class=\"text-center\">\n                        <div class=\"text-xs text-gray-500\">Lucro Resultante</div>\n                        <div class=\"text-xl font-black text-green-500\">R$ 4,50</div>\n                    </div>\n                </div>\n            </div>\n        </section>\n\n        <!-- FOOTER -->\n        <footer class=\"text-center text-gray-400 text-sm border-t border-gray-200 pt-8 mt-10\">\n            <p class=\"font-bold text-gray-500 mb-1\">Delicia D'Brownie - Sistema de Gestão</p>\n            <p>Documento gerado em <script>document.write(new Date().toLocaleDateString())</script></p>\n        </footer>\n\n    </div>\n\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\index-logic.js",
        "conteudo": "// --- CONFIGURAÇÕES ---\nconst firebaseConfig = {\n    apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n    authDomain: \"renata-26079.firebaseapp.com\",\n    projectId: \"renata-26079\",\n    storageBucket: \"renata-26079.firebasestorage.app\",\n    messagingSenderId: \"995787482442\",\n    appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n};\n\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\nconst auth = firebase.auth();\n\n// Constantes\nconst REGIAO_ATENDIMENTO = \"Curitiba e Região\";\nlet configuracaoLoja = { status: 'Fechada', horario_abertura: '18:00', horario_fechamento: '23:00', dias: 'Todos os dias' }; \n\n// Estado Global\nlet carrinho = JSON.parse(localStorage.getItem('meuCarrinho')) || [];\nlet favoritos = JSON.parse(localStorage.getItem('meusFavoritos')) || [];\nlet userPoints = parseInt(localStorage.getItem('userPoints') || 0);\nlet todosProdutos = []; \nlet produtoSelecionado = null, qtdModal = 1;\nlet filtroFavoritosAtivo = false;\n\n// Utilitários\nconst sanitizarId = (str) => str.replace(/[^a-zA-Z0-9]/g, '-').toLowerCase();\nconst formatarMoeda = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v);\nconst vibrar = () => { if (navigator.vibrate) navigator.vibrate(50); };\n\n// --- INICIALIZAÇÃO ---\ndocument.addEventListener('DOMContentLoaded', () => {\n    // Configura autenticação anônima se não houver usuário logado\n    auth.onAuthStateChanged(user => { if (!user) auth.signInAnonymously(); });\n    initApp();\n    atualizarSaudacao();\n    atualizarPontosUI();\n    \n    // Efeito de sombra e glass no header ao rolar a página\n    let lastScroll = 0;\n    window.addEventListener('scroll', () => {\n        const header = document.getElementById('main-header');\n        const currentScroll = window.pageYOffset;\n        \n        if (currentScroll > 50) {\n            header.classList.add('shadow-lg', 'bg-white');\n            header.classList.remove('shadow-sm', 'glass-effect');\n        } else {\n            header.classList.remove('shadow-lg', 'bg-white');\n            header.classList.add('shadow-sm', 'glass-effect');\n        }\n        lastScroll = currentScroll;\n    });\n\n    // Filtra a vitrine conforme o usuário digita na busca\n    document.getElementById('search-input').addEventListener('input', (e) => filtrarVitrine(e.target.value.toLowerCase()));\n});\n\n// Atualiza a saudação no topo (Bom dia, Boa tarde, Boa noite)\nfunction atualizarSaudacao() {\n    const nome = localStorage.getItem('userName');\n    const el = document.getElementById('saudacao-usuario');\n    const hora = new Date().getHours();\n    let periodo = \"Olá\";\n\n    if (hora >= 5 && hora < 12) periodo = \"Bom dia\";\n    else if (hora >= 12 && hora < 18) periodo = \"Boa tarde\";\n    else periodo = \"Boa noite\";\n\n    if (nome) {\n        el.innerText = `${periodo}, ${nome.split(' ')[0]}!`;\n    } else {\n        el.innerText = `${periodo}, Visitante`;\n    }\n}\n\n// Atualiza a contagem de pontos no header e no banner\nfunction atualizarPontosUI() {\n    const p = document.getElementById('user-points-header');\n    const b = document.getElementById('banner-points');\n    if(p) p.innerText = userPoints;\n    if(b) b.innerText = userPoints;\n}\n\n// Inicializa a aplicação carregando configurações e produtos\nasync function initApp() {\n    renderizarSkeleton();\n    atualizarBadge();\n    \n    // Listener para o status da loja em tempo real\n    db.collection('config').doc('loja').onSnapshot(doc => {\n        if(doc.exists) configuracaoLoja = doc.data();\n        atualizarStatusLoja(); \n    });\n\n    try {\n        // Busca produtos ativos\n        const snap = await db.collection('produtos').where('ativo', '==', true).get();\n        todosProdutos = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n        \n        renderizarBanners(todosProdutos);\n        renderizarCategorias(todosProdutos);\n        renderizarVitrine(todosProdutos);\n        atualizarIconeFavoritosHeader();\n        \n    } catch (e) {\n        console.error(\"Erro ao carregar app:\", e);\n    }\n}\n\n// --- RENDERIZAÇÃO VISUAL ---\n\nfunction renderizarSkeleton() {}\n\n// Renderiza o carrossel de destaques e o banner de fidelidade\nfunction renderizarBanners(produtos) {\n    const container = document.getElementById('banners-container');\n    const carrossel = document.getElementById('carrossel-destaques');\n    // Filtra até 5 produtos marcados como destaque ou do dia\n    const destaques = produtos.filter(p => p.tag_especial === 'do_dia' || p.destaque).slice(0, 5);\n    \n    container.classList.remove('hidden');\n    \n    let html = ``;\n    destaques.forEach(p => {\n        html += `\n        <div onclick=\"abrirModalProduto('${encodeURIComponent(JSON.stringify(p))}', this)\" class=\"snap-center shrink-0 w-[80vw] md:w-[350px] h-36 rounded-2xl bg-gradient-to-br from-brand-500 to-brand-700 relative overflow-hidden cursor-pointer shadow-lg shadow-brand-200/50 transform transition hover:scale-[1.01]\">\n            <div class=\"absolute inset-0 bg-white/5\"></div>\n            <div class=\"relative z-10 p-5 flex flex-col justify-center h-full w-2/3\">\n                <span class=\"bg-white/20 backdrop-blur text-white text-[9px] font-bold px-2 py-0.5 rounded w-fit mb-1\">OFERTA</span>\n                <h3 class=\"text-white font-serif font-black text-xl leading-tight mb-1 text-shadow-sm line-clamp-2\">${p.nome}</h3>\n                <p class=\"text-white/80 text-xs font-bold flex items-center gap-1\">Ver detalhes <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M17 8l4 4m0 0l-4 4m4-4H3\"/></svg></p>\n            </div>\n            <img src=\"${p.imagem}\" class=\"absolute -right-2 top-1/2 -translate-y-1/2 w-32 h-32 object-cover rounded-full border-4 border-white/20 shadow-2xl rotate-[-12deg]\">\n        </div>`;\n    });\n    carrossel.innerHTML = html;\n}\n\n// Renderiza os botões de categorias\nfunction renderizarCategorias(produtos) {\n    const nav = document.getElementById('nav-categorias');\n    // Extrai categorias únicas e ordena\n    const cats = [...new Set(produtos.map(p => p.categoria))].sort();\n    \n    let html = `<button onclick=\"scrollToCat('topo')\" class=\"flex-shrink-0 px-4 py-2 rounded-xl bg-gray-900 text-white font-bold text-xs shadow-md active:scale-95 transition-all snap-center\">Início</button>`;\n\n    cats.forEach(c => {\n        html += `<button onclick=\"scrollToCat('cat-${sanitizarId(c)}')\" class=\"flex-shrink-0 px-4 py-2 rounded-xl bg-white text-gray-600 font-bold text-xs shadow-sm border border-gray-100 hover:bg-gray-50 active:scale-95 transition-all snap-center whitespace-nowrap\">${c}</button>`;\n    });\n    nav.innerHTML = html;\n}\n\n// Renderiza a lista principal de produtos\nfunction renderizarVitrine(lista) {\n    const container = document.getElementById('main-vitrine');\n    container.innerHTML = '';\n\n    if (lista.length === 0) {\n        container.innerHTML = `<div class=\"text-center py-10 opacity-50\"><p>Nenhum item encontrado.</p></div>`;\n        return;\n    }\n\n    // Se o filtro de favoritos estiver ativo, renderiza tudo junto\n    if (filtroFavoritosAtivo) {\n        document.getElementById('titulo-secao').innerText = \"Meus Favoritos\";\n        document.getElementById('btn-ver-todos').classList.remove('hidden');\n        let htmlItens = `<div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 px-4 md:px-0\">`;\n        lista.forEach(p => htmlItens += cardProdutoApp(p));\n        htmlItens += `</div>`;\n        container.innerHTML = htmlItens;\n        return;\n    }\n\n    // Caso contrário, renderiza por categoria\n    document.getElementById('titulo-secao').innerText = \"Cardápio\";\n    document.getElementById('btn-ver-todos').classList.add('hidden');\n\n    const cats = [...new Set(lista.map(p => p.categoria))].sort();\n\n    cats.forEach(cat => {\n        const itens = lista.filter(p => p.categoria === cat);\n        const section = document.createElement('div');\n        section.id = `cat-${sanitizarId(cat)}`;\n        section.className = \"scroll-mt-48\"; \n        let htmlItens = `<div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 px-4 md:px-0\">`;\n        itens.forEach(p => htmlItens += cardProdutoApp(p));\n        htmlItens += `</div>`;\n        section.innerHTML = `\n            <div class=\"flex items-center gap-3 mb-4 px-4 md:px-0 mt-6\">\n                <h2 class=\"text-lg font-black text-gray-900 tracking-tight\">${cat}</h2>\n                <div class=\"h-px bg-gray-200 flex-grow opacity-50\"></div>\n            </div>\n            ${htmlItens}\n        `;\n        container.appendChild(section);\n    });\n}\n\n// Cria o HTML de um único card de produto\nconst cardProdutoApp = (p) => {\n    const dados = encodeURIComponent(JSON.stringify(p));\n    const precoDisplay = p.preco_promo > 0 ? formatarMoeda(p.preco_promo) : formatarMoeda(p.preco);\n    const precoAntigo = p.preco_promo > 0 ? `<span class=\"text-xs text-gray-400 line-through mr-2\">${formatarMoeda(p.preco)}</span>` : '';\n    const isFav = favoritos.includes(p.id);\n    \n    // Rating simulado para prova social\n    const stars = Math.floor(Math.random() * (50 - 45) + 45) / 10;\n\n    return `\n    <div class=\"bg-white rounded-2xl p-3 md:p-4 shadow-soft border border-gray-50 hover:border-brand-100 hover:shadow-lg transition-all relative overflow-hidden group h-full\">\n        <div onclick=\"abrirModalProduto('${dados}', this)\" class=\"flex justify-between gap-3 cursor-pointer\">\n            <div class=\"flex flex-col justify-between flex-1 py-1 min-h-[100px]\">\n                <div>\n                    <h3 class=\"font-bold text-gray-800 text-[15px] leading-tight mb-1 group-hover:text-brand-600 transition-colors line-clamp-2\">${p.nome}</h3>\n                    <div class=\"flex items-center gap-1 mb-2\">\n                        <svg class=\"w-3 h-3 text-brand-gold\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\n                        <span class=\"text-[10px] font-bold text-gray-500\">${stars}</span>\n                    </div>\n                    <p class=\"text-xs text-gray-500 leading-relaxed line-clamp-2\">${p.descricao}</p>\n                </div>\n                <div class=\"flex items-baseline mt-2\">\n                    ${precoAntigo}\n                    <span class=\"font-bold text-green-600 text-base\">${precoDisplay}</span>\n                </div>\n            </div>\n            <div class=\"relative w-28 h-28 flex-shrink-0\">\n                <img src=\"${p.imagem}\" class=\"w-full h-full object-cover rounded-xl bg-gray-100 product-img-source transition-transform duration-500 group-hover:scale-105\" loading=\"lazy\" onerror=\"this.src='https://placehold.co/120?text=Delicia'\">\n                <div class=\"absolute -bottom-2 -right-2 bg-white rounded-tl-xl p-1.5 shadow-sm z-10\">\n                    <div class=\"bg-brand-600 text-white w-8 h-8 rounded-lg flex items-center justify-center text-lg font-bold shadow-brand-200 shadow-lg active:scale-90 transition-transform\">+</div>\n                </div>\n            </div>\n        </div>\n        <button onclick=\"event.stopPropagation(); toggleFavorito('${p.id}')\" class=\"absolute top-2 right-2 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-sm z-20 active:scale-90 transition-transform\">\n            ${isFav ? '<svg class=\"w-5 h-5 text-red-500 heart-pop\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"/></svg>' : '<svg class=\"w-5 h-5 text-gray-300 hover:text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"/></svg>'}\n        </button>\n    </div>`;\n};\n\n// --- FAVORITOS ---\nwindow.toggleFavorito = (id) => {\n    vibrar();\n    const idx = favoritos.indexOf(id);\n    if (idx === -1) {\n        favoritos.push(id);\n        mostrarToast(\"Salvo nos favoritos ❤️\", 'sucesso');\n    } else {\n        favoritos.splice(idx, 1);\n        if (filtroFavoritosAtivo) { filtrarFavoritos(true); return; }\n    }\n    localStorage.setItem('meusFavoritos', JSON.stringify(favoritos));\n    renderizarVitrine(todosProdutos);\n    atualizarIconeFavoritosHeader();\n    if (produtoSelecionado && produtoSelecionado.id === id) atualizarBotaoFavModal();\n}\n\nwindow.filtrarFavoritos = (forceRefresh = false) => {\n    if (!forceRefresh) { filtroFavoritosAtivo = !filtroFavoritosAtivo; vibrar(); }\n    const btn = document.getElementById('btn-header-fav');\n    if (filtroFavoritosAtivo) {\n        const prodsFavs = todosProdutos.filter(p => favoritos.includes(p.id));\n        renderizarVitrine(prodsFavs);\n        btn.classList.add('text-brand-600', 'bg-brand-50');\n        btn.classList.remove('text-gray-400');\n    } else {\n        resetarFiltros();\n    }\n}\n\nwindow.resetarFiltros = () => {\n    filtroFavoritosAtivo = false;\n    renderizarVitrine(todosProdutos);\n    const btn = document.getElementById('btn-header-fav');\n    btn.classList.remove('text-brand-600', 'bg-brand-50');\n    btn.classList.add('text-gray-400');\n}\n\nfunction atualizarIconeFavoritosHeader() {\n    const btn = document.getElementById('btn-header-fav');\n    if (favoritos.length > 0) {\n        btn.innerHTML = `<svg class=\"w-6 h-6\" fill=\"${filtroFavoritosAtivo ? 'currentColor' : 'none'}\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"/></svg>`;\n    }\n}\n\n// --- MODAL PRODUTO ---\nwindow.abrirModalProduto = (dados, elOrigem) => {\n    vibrar();\n    produtoSelecionado = JSON.parse(decodeURIComponent(dados));\n    qtdModal = 1;\n    const preco = produtoSelecionado.preco_promo > 0 ? produtoSelecionado.preco_promo : produtoSelecionado.preco;\n    produtoSelecionado.precoFinal = preco;\n\n    document.getElementById('modal-img').src = produtoSelecionado.imagem;\n    document.getElementById('modal-titulo').innerText = produtoSelecionado.nome;\n    document.getElementById('modal-desc').innerText = produtoSelecionado.descricao;\n    document.getElementById('modal-obs').value = ''; \n    atualizarBotaoFavModal();\n    atualizarBtnModal();\n    toggleModal('modal-produto', true);\n}\n\nfunction atualizarBotaoFavModal() {\n    const isFav = favoritos.includes(produtoSelecionado.id);\n    const btn = document.getElementById('modal-btn-fav');\n    btn.innerHTML = isFav \n        ? `<svg class=\"w-6 h-6 text-red-500 heart-pop\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"/></svg>`\n        : `<svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"/></svg>`;\n    btn.onclick = () => toggleFavorito(produtoSelecionado.id);\n}\n\nwindow.mudarQtd = (n) => { vibrar(); if(qtdModal + n >= 1) { qtdModal += n; atualizarBtnModal(); } }\nfunction atualizarBtnModal() {\n    document.getElementById('qtd-display').innerText = qtdModal;\n    const total = produtoSelecionado.precoFinal * qtdModal;\n    document.getElementById('modal-btn-preco').innerText = formatarMoeda(total);\n}\n\nwindow.addAoCarrinho = () => {\n    vibrar();\n    const obs = document.getElementById('modal-obs').value;\n    const item = { ...produtoSelecionado, qtd: qtdModal, obs: obs };\n    carrinho.push(item);\n    salvarCarrinho();\n    toggleModal('modal-produto', false);\n    mostrarToast(`Adicionado! 🛒`, 'sucesso');\n    animarCarrinho();\n}\n\nfunction animarCarrinho() {\n    const iconD = document.getElementById('cart-icon-svg');\n    const iconM = document.getElementById('cart-icon-mobile');\n    const bgM = document.getElementById('cart-icon-mobile-bg');\n    if(iconD) iconD.parentElement.classList.add('animate-bounce-short');\n    if(iconM) { iconM.classList.add('scale-125'); bgM.classList.remove('scale-0'); }\n    setTimeout(() => {\n        if(iconD) iconD.parentElement.classList.remove('animate-bounce-short');\n        if(iconM) { iconM.classList.remove('scale-125'); bgM.classList.add('scale-0'); }\n    }, 500);\n}\n\n// --- CARRINHO E PEDIDO ---\nwindow.abrirCarrinho = () => { vibrar(); renderizarCarrinho(); toggleModal('modal-carrinho', true); }\nfunction renderizarCarrinho() {\n    const lista = document.getElementById('lista-carrinho');\n    lista.innerHTML = '';\n    let total = 0;\n    if (carrinho.length === 0) {\n        lista.innerHTML = `<div class=\"flex flex-col items-center justify-center h-64 text-center opacity-50\"><svg class=\"w-16 h-16 text-gray-300 mb-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"/></svg><p class=\"font-bold\">Sua sacola está vazia</p></div>`;\n        document.getElementById('btn-finalizar').disabled = true;\n        document.getElementById('btn-finalizar').classList.add('opacity-50');\n    } else {\n        document.getElementById('btn-finalizar').disabled = false;\n        document.getElementById('btn-finalizar').classList.remove('opacity-50');\n        carrinho.forEach((item, idx) => {\n            total += item.precoFinal * item.qtd;\n            lista.innerHTML += `<div class=\"flex gap-3 py-3 border-b border-gray-50 last:border-0\"><img src=\"${item.imagem}\" class=\"w-14 h-14 rounded-xl bg-gray-100 object-cover\"><div class=\"flex-1\"><div class=\"flex justify-between\"><h4 class=\"font-bold text-sm text-gray-800 line-clamp-1\">${item.nome}</h4><span class=\"font-bold text-sm text-gray-900\">${formatarMoeda(item.precoFinal * item.qtd)}</span></div><p class=\"text-xs text-gray-400 mb-1\">${item.qtd}x ${formatarMoeda(item.precoFinal)}</p><button onclick=\"removerItem(${idx})\" class=\"text-[10px] font-bold text-red-500 mt-1\">Remover</button></div></div>`;\n        });\n    }\n    document.getElementById('subtotal-carrinho').innerText = formatarMoeda(total);\n}\nwindow.removerItem = (idx) => { vibrar(); carrinho.splice(idx, 1); salvarCarrinho(); renderizarCarrinho(); }\n\nwindow.prepararPedido = () => {\n    if (configuracaoLoja.status === 'Fechada') {\n        vibrar(); alert('A loja está fechada. Voltamos às ' + configuracaoLoja.horario_abertura); return;\n    }\n    const nome = localStorage.getItem('userName');\n    const fone = localStorage.getItem('userPhone');\n    if (!nome || !fone) {\n        toggleModal('modal-carrinho', false);\n        mostrarToast('Faça login para finalizar', 'erro');\n        setTimeout(() => window.location.href = \"perfil.html\", 1500);\n        return;\n    }\n\n    // CELEBRAÇÃO DE CONFETES\n    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#db2777', '#f43f5e', '#fbbf24'] });\n    vibrar();\n\n    const total = carrinho.reduce((acc, i) => acc + (i.precoFinal * i.qtd), 0);\n    const btn = document.getElementById('btn-finalizar');\n    const txtOriginal = btn.innerText; // Guarda o texto original\n    btn.innerText = 'Enviando...'; btn.disabled = true;\n\n    // ATUALIZA PONTOS (antes de limpar o carrinho)\n    const pontosGanhos = 1;\n    userPoints += pontosGanhos;\n    localStorage.setItem('userPoints', userPoints);\n    atualizarPontosUI();\n    \n    // Salva pontos no Firebase se tiver ID (Telefone)\n    const uid = fone.replace(/\\D/g, '');\n    db.collection('users').doc(uid).set({ pontos: userPoints }, { merge: true });\n\n    const pedido = {\n        id_visual: `#${Math.floor(Math.random()*10000)}`,\n        cliente_nome: nome,\n        cliente_telefone: fone,\n        cliente_telefone_limpo: uid,\n        itens: carrinho,\n        total: total,\n        status: 'Enviado',\n        tipo_entrega: 'Retirada',\n        pontos_ganhos: pontosGanhos,\n        data: new Date().toISOString()\n    };\n\n    db.collection('pedidos').add(pedido).then(() => {\n        // --- NOVO PASSO: SALVA DADOS DO PEDIDO PARA A PÁGINA DE COMPROVANTE ---\n        // Usamos sessionStorage pois a informação só é necessária para o próximo carregamento.\n        sessionStorage.setItem('lastPedidoData', JSON.stringify(pedido));\n        \n        // Monta mensagem do WhatsApp\n        let msg = `*NOVO PEDIDO (RETIRADA) ${pedido.id_visual}*\\n👤 ${nome}\\n\\n`;\n        pedido.itens.forEach(i => { msg += `${i.qtd}x ${i.nome}\\n`; if(i.obs) msg += `   _Obs: ${i.obs}_\\n`; });\n        msg += `\\n💰 *Total: ${formatarMoeda(total)}*`;\n        msg += `\\n🎁 *Ganhei +${pontosGanhos} Ponto Fidelidade!*`;\n        msg += `\\n\\nVou passar buscar!`;\n        \n        // Limpa o carrinho local e a UI\n        carrinho = []; salvarCarrinho();\n        \n        // Redireciona para o comprovante E abre o WhatsApp\n        setTimeout(() => {\n            window.open(`https://wa.me/5541992480604?text=${encodeURIComponent(msg)}`, '_blank');\n            window.location.href = 'comprovante.html'; // REDIRECIONA PARA O COMPROVANTE\n        }, 1500); // Delay para ver os confetes\n    }).catch(e => {\n        console.error(e); \n        btn.innerText = txtOriginal; // Volta o texto\n        btn.disabled = false;\n        alert('Erro ao enviar pedido. Tente novamente.');\n    });\n}\n\nfunction salvarCarrinho() { localStorage.setItem('meuCarrinho', JSON.stringify(carrinho)); atualizarBadge(); }\nfunction atualizarBadge() {\n    const qtd = carrinho.reduce((a, b) => a + b.qtd, 0);\n    const badgeD = document.getElementById('badge-cart-desktop');\n    if(badgeD) { badgeD.innerText = qtd; badgeD.classList.toggle('scale-0', qtd === 0); }\n    const badgeM = document.getElementById('badge-cart-mobile');\n    if(badgeM) { badgeM.innerText = qtd; badgeM.classList.toggle('scale-0', qtd === 0); }\n}\nfunction atualizarStatusLoja() {\n    const bar = document.getElementById('status-loja-bar');\n    if (configuracaoLoja.status === 'Fechada') { bar.classList.remove('hidden'); bar.innerText = `LOJA FECHADA • Abre às ${configuracaoLoja.horario_abertura}`; } else { bar.classList.add('hidden'); }\n}\nwindow.scrollToCat = (id) => {\n    vibrar();\n    if(id === 'topo') window.scrollTo({ top: 0, behavior: 'smooth' });\n    else { const el = document.getElementById(id); if(el) { const top = el.getBoundingClientRect().top + window.pageYOffset - 220; window.scrollTo({ top: top, behavior: 'smooth' }); } }\n}\nfunction filtrarVitrine(termo) {\n    if (!termo) { renderizarVitrine(todosProdutos); document.getElementById('banners-container').classList.remove('hidden'); }\n    else { const filtrados = todosProdutos.filter(p => p.nome.toLowerCase().includes(termo) || p.categoria.toLowerCase().includes(termo)); document.getElementById('banners-container').classList.add('hidden'); renderizarVitrine(filtrados); }\n}\nfunction toggleModal(id, show) {\n    const el = document.getElementById(id);\n    const content = el.querySelector('.modal-content');\n    const overlay = el.querySelector('.modal-overlay');\n    if(show) { el.classList.remove('hidden'); setTimeout(() => { overlay.classList.remove('opacity-0'); content.classList.remove('translate-y-full', 'translate-x-full'); }, 10); }\n    else { overlay.classList.add('opacity-0'); if (window.innerWidth < 768) content.classList.add('translate-y-full'); else content.classList.add(id === 'modal-carrinho' ? 'translate-x-full' : 'translate-y-full'); setTimeout(() => el.classList.add('hidden'), 300); }\n}\nfunction mostrarToast(msg, tipo) {\n    const t = document.getElementById('toast');\n    t.className = `fixed top-4 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full shadow-xl z-[100] text-sm font-bold text-white transition-all duration-300 ${tipo === 'sucesso' ? 'bg-gray-900' : 'bg-red-600'}`;\n    t.innerText = msg; t.classList.remove('hidden', '-translate-y-20', 'opacity-0');\n    setTimeout(() => t.classList.add('-translate-y-20', 'opacity-0'), 3000);\n}"
    },
    {
        "caminho": "Reh\\index.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\" class=\"scroll-smooth\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#ffffff\">\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"description\" content=\"O melhor brownie da cidade. Peça e retire na loja.\">\n    <title>Delicia D'Brownie | App</title>\n    \n    <!-- FAVICON -->\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n\n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    \n    <!-- CONFETTI JS (Efeito de Celebração) -->\n    <script src=\"https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js\"></script>\n\n    <!-- FIREBASE SDKs -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES -->\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800;900&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { \n                        sans: ['DM Sans', 'sans-serif'], \n                        serif: ['Playfair Display', 'serif'] \n                    },\n                    colors: { \n                        brand: { \n                            50: '#fff1f2', 100: '#ffe4e6', 200: '#fecdd3', 300: '#fda4af', \n                            400: '#fb7185', 500: '#f43f5e', 600: '#db2777', 700: '#be123c', 800: '#9f1239',\n                            gold: '#fbbf24'\n                        } \n                    },\n                    boxShadow: {\n                        'up': '0 -4px 20px -2px rgba(0, 0, 0, 0.05)',\n                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',\n                        'glow': '0 0 15px rgba(219, 39, 119, 0.3)'\n                    },\n                    animation: {\n                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',\n                        'bounce-short': 'bounce 0.5s 1',\n                        'float': 'float 3s ease-in-out infinite'\n                    },\n                    keyframes: {\n                        float: {\n                            '0%, 100%': { transform: 'translateY(0)' },\n                            '50%': { transform: 'translateY(-5px)' },\n                        }\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        .hide-scroll::-webkit-scrollbar { display: none; }\n        .hide-scroll { -ms-overflow-style: none; scrollbar-width: none; }\n        .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.03); }\n        .img-cover { width: 100%; height: 100%; object-fit: cover; }\n        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }\n        .pt-safe { padding-top: env(safe-area-inset-top); }\n        .heart-pop { animation: heartPop 0.3s ease-in-out; }\n        @keyframes heartPop { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }\n    </style>\n</head>\n<body class=\"bg-gray-50 text-gray-800 pb-24 md:pb-0 min-h-screen antialiased selection:bg-brand-100 selection:text-brand-900\">\n\n    <!-- HEADER -->\n    <header class=\"fixed top-0 w-full z-40 glass-effect transition-all duration-300 pt-safe shadow-sm\" id=\"main-header\">\n        <!-- Status Loja -->\n        <div id=\"status-loja-bar\" class=\"bg-red-600 text-white text-[10px] font-bold text-center py-1 hidden\">\n            <span id=\"status-text\">LOJA FECHADA</span>\n        </div>\n\n        <div class=\"container mx-auto px-4 py-2\">\n            <!-- Topo -->\n            <div class=\"flex justify-between items-center mb-3 mt-1\">\n                <div class=\"flex flex-col cursor-pointer\" onclick=\"window.location.href='perfil.html'\">\n                    <span id=\"saudacao-usuario\" class=\"text-xs font-bold text-brand-600 uppercase tracking-wide mb-0.5\">Olá, Visitante</span>\n                    \n                    <!-- Mini Status Fidelidade -->\n                    <div class=\"flex items-center gap-1 text-gray-900 group\">\n                        <span class=\"font-serif font-black text-lg leading-none\">Meus Pontos</span>\n                        <div class=\"flex items-center bg-brand-50 px-2 py-0.5 rounded-full border border-brand-100 group-hover:bg-brand-100 transition-colors\">\n                            <svg class=\"w-3 h-3 text-brand-600 mr-1\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/></svg>\n                            <span id=\"user-points-header\" class=\"text-xs font-bold text-brand-700\">0</span>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"flex items-center gap-3\">\n                    <button onclick=\"filtrarFavoritos()\" id=\"btn-header-fav\" class=\"p-2 rounded-full text-gray-400 hover:text-brand-500 hover:bg-brand-50 transition-all\">\n                        <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"/></svg>\n                    </button>\n\n                    <button onclick=\"abrirCarrinho()\" class=\"relative p-2 bg-gray-100 rounded-full hover:bg-brand-50 transition-colors group\">\n                        <svg id=\"cart-icon-svg\" class=\"w-5 h-5 text-gray-800 group-hover:text-brand-600 transition-colors\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"/></svg>\n                        <span id=\"badge-cart-desktop\" class=\"absolute -top-1 -right-1 w-4 h-4 bg-brand-600 text-white text-[9px] font-bold flex items-center justify-center rounded-full scale-0 transition-transform border border-white\">0</span>\n                    </button>\n                    \n                     <a href=\"encomendas.html\" class=\"hidden md:flex p-2 text-gray-400 hover:text-brand-600 transition\" title=\"Encomendas\">\n                        <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"/></svg>\n                    </a>\n                </div>\n            </div>\n\n            <!-- Busca -->\n            <div class=\"relative group mb-1\">\n                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                    <svg class=\"h-4 w-4 text-gray-400 group-focus-within:text-brand-500 transition-colors\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/></svg>\n                </div>\n                <input type=\"text\" id=\"search-input\" class=\"block w-full pl-10 pr-4 py-3 border-none rounded-xl bg-gray-100 text-gray-900 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-brand-500/20 focus:shadow-soft transition-all text-sm font-medium\" placeholder=\"O que você deseja hoje?\">\n            </div>\n        </div>\n\n        <!-- Menu Categorias -->\n        <div class=\"border-t border-gray-50 bg-white/95 backdrop-blur-sm\">\n            <div id=\"nav-categorias\" class=\"container mx-auto flex gap-3 overflow-x-auto hide-scroll py-3 px-4 scroll-smooth snap-x\">\n                <!-- Via JS -->\n            </div>\n        </div>\n    </header>\n\n    <!-- MAIN -->\n    <main class=\"container mx-auto pt-[185px] md:pt-[195px] px-0 md:px-4 min-h-screen transition-all\">\n        \n        <!-- BANNERS (Promo e Fidelidade) -->\n        <section id=\"banners-container\" class=\"mb-8 px-4 md:px-0 hidden animate-fade-in space-y-4\">\n            <!-- Banner Fidelidade -->\n            <div onclick=\"window.location.href='perfil.html'\" class=\"bg-gradient-to-r from-gray-900 to-gray-800 rounded-2xl p-4 text-white flex justify-between items-center shadow-lg cursor-pointer relative overflow-hidden group\">\n                <div class=\"absolute -right-6 -top-6 w-24 h-24 bg-white/10 rounded-full blur-xl group-hover:scale-150 transition-transform\"></div>\n                <div class=\"z-10\">\n                    <p class=\"text-[10px] font-bold text-brand-300 uppercase mb-1\">CLUBE FIDELIDADE</p>\n                    <h3 class=\"font-serif font-bold text-lg\">Ganhe Brownies Grátis</h3>\n                    <p class=\"text-xs text-gray-400\">Acumule selos a cada compra!</p>\n                </div>\n                <div class=\"z-10 bg-white/20 backdrop-blur px-3 py-1.5 rounded-lg border border-white/10 flex flex-col items-center\">\n                    <span id=\"banner-points\" class=\"text-xl font-black text-yellow-400\">0</span>\n                    <span class=\"text-[9px] font-bold uppercase\">Pontos</span>\n                </div>\n            </div>\n            \n            <!-- Carrossel Destaques (Via JS) -->\n            <div id=\"carrossel-destaques\" class=\"flex gap-4 overflow-x-auto hide-scroll snap-x py-2\"></div>\n        </section>\n\n        <!-- VITRINE -->\n        <div class=\"px-4 md:px-0 mb-4 flex justify-between items-end\">\n            <h2 id=\"titulo-secao\" class=\"text-xl font-serif font-black text-gray-900\">Cardápio</h2>\n            <button onclick=\"resetarFiltros()\" id=\"btn-ver-todos\" class=\"hidden text-xs font-bold text-brand-600 bg-brand-50 px-3 py-1 rounded-full\">Ver todos</button>\n        </div>\n\n        <div id=\"main-vitrine\" class=\"space-y-8 pb-10 min-h-[50vh]\">\n            <!-- Skeleton -->\n            <div class=\"px-4 md:px-0 grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div class=\"h-32 w-full bg-white rounded-2xl shadow-sm border border-gray-100 animate-pulse\"></div>\n                <div class=\"h-32 w-full bg-white rounded-2xl shadow-sm border border-gray-100 animate-pulse\"></div>\n            </div>\n        </div>\n    </main>\n\n    <!-- BOTTOM NAV -->\n    <nav class=\"md:hidden fixed bottom-0 w-full bg-white/95 backdrop-blur-lg border-t border-gray-100 z-40 pb-safe shadow-up\">\n        <div class=\"flex justify-around items-center h-16 px-2\">\n            <button onclick=\"window.scrollTo({top:0, behavior:'smooth'})\" class=\"flex flex-col items-center w-full text-brand-600 active:scale-90 transition-transform\">\n                <div class=\"relative\">\n                    <svg class=\"w-6 h-6 mb-0.5\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M3 13h1v7c0 1.103.897 2 2 2h12c1.103 0 2-.897 2-2v-7h1a1 1 0 0 0 .707-1.707l-9-9a.999.999 0 0 0-1.414 0l-9 9A1 1 0 0 0 3 13zm9-8.586 6 6V15l.001 5H6v-9.586l6-6z\"/><path d=\"M12 18c3.703 0 4.901-3.539 4.901-3.539C15.768 15.812 14.363 16 12 16c-2.408 0-3.808-.197-4.901-1.539C7.099 14.461 8.297 18 12 18z\"/></svg>\n                </div>\n                <span class=\"text-[10px] font-bold\">Início</span>\n            </button>\n            \n            <button onclick=\"window.location.href='perfil.html'\" class=\"flex flex-col items-center w-full text-gray-400 hover:text-brand-600 active:scale-90 transition-all\">\n                <svg class=\"w-6 h-6 mb-0.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"/></svg>\n                <span class=\"text-[10px] font-medium\">Perfil</span>\n            </button>\n\n            <button onclick=\"abrirCarrinho()\" class=\"relative flex flex-col items-center w-full text-gray-400 hover:text-brand-600 active:scale-90 transition-all\">\n                <div class=\"relative\">\n                    <div id=\"cart-icon-mobile-bg\" class=\"absolute inset-0 bg-brand-100 rounded-full scale-0 transition-transform\"></div>\n                    <svg id=\"cart-icon-mobile\" class=\"w-6 h-6 mb-0.5 relative z-10\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"/></svg>\n                    <span id=\"badge-cart-mobile\" class=\"absolute -top-1 -right-2 min-w-[18px] h-[18px] bg-brand-600 text-white text-[10px] font-bold flex items-center justify-center rounded-full px-1 scale-0 transition-transform border-2 border-white z-20 shadow-sm\">0</span>\n                </div>\n                <span class=\"text-[10px] font-medium\">Sacola</span>\n            </button>\n            \n            <button onclick=\"window.location.href='pedidos.html'\" class=\"flex flex-col items-center w-full text-gray-400 hover:text-brand-600 active:scale-90 transition-all\">\n                <svg class=\"w-6 h-6 mb-0.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"/></svg>\n                <span class=\"text-[10px] font-medium\">Pedidos</span>\n            </button>\n        </div>\n    </nav>\n\n    <!-- MODAL PRODUTO -->\n    <div id=\"modal-produto\" class=\"fixed inset-0 z-[60] hidden flex items-end md:items-center justify-center\">\n        <div onclick=\"toggleModal('modal-produto', false)\" class=\"modal-overlay absolute inset-0 bg-black/60 backdrop-blur-sm opacity-0 transition-opacity duration-300\"></div>\n        <div class=\"modal-content bg-white w-full md:max-w-lg rounded-t-3xl md:rounded-2xl overflow-hidden shadow-2xl transform translate-y-full md:translate-y-0 transition-transform duration-300 flex flex-col max-h-[90vh]\">\n            \n            <div class=\"relative h-72 bg-gray-100 flex-shrink-0\">\n                <img id=\"modal-img\" src=\"\" class=\"img-cover\">\n                <div class=\"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-black/60 to-transparent\"></div>\n                \n                <button onclick=\"toggleModal('modal-produto', false)\" class=\"absolute top-4 left-4 bg-black/20 text-white p-2 rounded-full backdrop-blur-md hover:bg-black/40 transition-colors active:scale-90\">\n                    <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/></svg>\n                </button>\n\n                <button id=\"modal-btn-fav\" class=\"absolute top-4 right-4 bg-white/20 text-white p-2 rounded-full backdrop-blur-md hover:bg-white/40 transition-all active:scale-75\">\n                    <!-- Icone Fav -->\n                </button>\n            </div>\n            \n            <div class=\"p-6 overflow-y-auto\">\n                <div class=\"flex justify-between items-start mb-1\">\n                    <h2 id=\"modal-titulo\" class=\"text-2xl font-serif font-black text-gray-900 leading-tight\"></h2>\n                </div>\n                \n                <!-- Avaliação (Fake Dinâmica) -->\n                <div class=\"flex items-center gap-1 mb-4\">\n                    <div class=\"flex text-yellow-400\">\n                        <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\n                        <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\n                        <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\n                        <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\n                        <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\n                    </div>\n                    <span class=\"text-xs text-gray-500\">(4.9/5.0)</span>\n                </div>\n\n                <p id=\"modal-desc\" class=\"text-gray-500 leading-relaxed text-sm mb-6\"></p>\n                \n                <div class=\"mb-6\">\n                    <label class=\"flex items-center gap-2 text-xs font-bold text-gray-400 uppercase mb-2\">\n                        <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"/></svg>\n                        Observações\n                    </label>\n                    <textarea id=\"modal-obs\" rows=\"2\" class=\"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:border-brand-500 focus:bg-white transition-colors\" placeholder=\"Ex: Sem cebola, caprichar na calda...\"></textarea>\n                </div>\n            </div>\n\n            <div class=\"p-4 border-t border-gray-100 bg-white pb-safe md:pb-4 shadow-up\">\n                <div class=\"flex items-center gap-4\">\n                    <div class=\"flex items-center bg-gray-100 rounded-xl h-12 px-1 border border-gray-200\">\n                        <button onclick=\"mudarQtd(-1)\" class=\"w-12 h-full font-bold text-xl text-gray-500 hover:text-brand-600 active:scale-90 transition\">-</button>\n                        <span id=\"qtd-display\" class=\"w-8 text-center font-bold text-gray-800 text-lg\">1</span>\n                        <button onclick=\"mudarQtd(1)\" class=\"w-12 h-full font-bold text-xl text-brand-600 active:scale-90 transition\">+</button>\n                    </div>\n                    <button onclick=\"addAoCarrinho()\" id=\"btn-add-modal\" class=\"flex-1 bg-brand-600 text-white h-12 rounded-xl font-bold shadow-lg shadow-brand-200 active:scale-95 transition-all flex justify-between items-center px-6\">\n                        <span>Adicionar</span>\n                        <span id=\"modal-btn-preco\">R$ 0,00</span>\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- MODAL CARRINHO -->\n    <div id=\"modal-carrinho\" class=\"fixed inset-0 z-[70] hidden flex items-end justify-end\">\n        <div onclick=\"toggleModal('modal-carrinho', false)\" class=\"modal-overlay absolute inset-0 bg-black/50 backdrop-blur-sm opacity-0 transition-opacity duration-300\"></div>\n        <div class=\"modal-content bg-white w-full md:w-[450px] h-[90vh] md:h-full flex flex-col transform translate-y-full md:translate-y-0 md:translate-x-full transition-transform duration-300 shadow-2xl md:rounded-l-2xl rounded-t-2xl\">\n            \n            <div class=\"p-5 border-b border-gray-100 flex justify-between items-center bg-white z-10\">\n                <h2 class=\"text-xl font-serif font-black text-gray-900\">Sua Sacola (Retirada)</h2>\n                <button onclick=\"toggleModal('modal-carrinho', false)\" class=\"text-gray-400 hover:text-gray-600 bg-gray-50 p-2 rounded-full\">\n                    <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/></svg>\n                </button>\n            </div>\n            \n            <div id=\"lista-carrinho\" class=\"flex-grow overflow-y-auto p-5 space-y-4 bg-white\">\n                <!-- Itens -->\n            </div>\n            \n            <!-- Área de Cupom e Fidelidade no Carrinho -->\n            <div class=\"px-6 pt-2 bg-gray-50\">\n                <div class=\"flex items-center gap-2 text-xs text-brand-600 bg-brand-50 p-2 rounded border border-brand-100\">\n                    <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/></svg>\n                    <span class=\"font-bold\">+1 Ponto Fidelidade será adicionado</span>\n                </div>\n            </div>\n\n            <div class=\"p-6 bg-gray-50 border-t border-gray-100 pb-safe shadow-up z-20\">\n                <div class=\"flex justify-between items-center mb-4\">\n                    <span class=\"text-gray-500 font-medium text-sm\">Total do Pedido</span>\n                    <span id=\"subtotal-carrinho\" class=\"text-2xl font-black text-gray-900\">R$ 0,00</span>\n                </div>\n                <button id=\"btn-finalizar\" onclick=\"prepararPedido()\" class=\"w-full bg-green-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-green-200 active:scale-95 transition-all flex justify-center items-center gap-2 relative overflow-hidden\">\n                    <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z\"/></svg>\n                    Enviar Pedido\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <!-- TOAST -->\n    <div id=\"toast\" class=\"hidden\"></div>\n\n    <!-- SCRIPTS LÓGICA -->\n    <script src=\"index-logic.js\"></script>\n\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\pedidos.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#db2777\">\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n    <title>Rastreio | Delicia D'Brownie</title>\n    \n    <!-- TAILWIND CSS -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n\n    <!-- CONFETTI JS -->\n    <script src=\"https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js\"></script>\n\n    <!-- FIREBASE -->\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <!-- FONTES -->\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    fontFamily: { \n                        sans: ['DM Sans', 'sans-serif'], \n                        serif: ['Playfair Display', 'serif'] \n                    },\n                    colors: { \n                        brand: { \n                            50: '#fff1f2', 100: '#ffe4e6', 500: '#f43f5e', 600: '#db2777', 900: '#881337'\n                        } \n                    },\n                    animation: {\n                        'pulse-ring': 'pulse-ring 2s cubic-bezier(0.24, 0, 0.38, 1) infinite',\n                        'slide-up': 'slideUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',\n                    },\n                    keyframes: {\n                        'pulse-ring': {\n                            '0%': { transform: 'scale(0.8)', opacity: '0.5' },\n                            '100%': { transform: 'scale(2.5)', opacity: '0' },\n                        },\n                        slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } }\n                    }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }\n        .timeline-line { position: absolute; left: 15px; top: 30px; bottom: -10px; width: 2px; background-color: #e5e7eb; z-index: 0; }\n        .timeline-item.active .timeline-line { background-color: #db2777; }\n        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }\n    </style>\n</head>\n\n<body class=\"bg-gray-50 font-sans text-gray-800 pb-24 min-h-screen flex flex-col\">\n\n    <!-- HEADER -->\n    <header class=\"fixed top-0 w-full z-40 glass-effect border-b border-gray-100 shadow-sm transition-all duration-300\">\n        <div class=\"container mx-auto px-4 h-16 flex justify-between items-center\">\n            <h1 class=\"text-xl font-serif font-black text-gray-900 tracking-tight\">Meus Pedidos</h1>\n            <button onclick=\"carregarHistorico()\" class=\"p-2 text-brand-600 bg-brand-50 rounded-full hover:bg-brand-100 transition-colors\">\n                <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/></svg>\n            </button>\n        </div>\n    </header>\n\n    <!-- CONTEÚDO -->\n    <main class=\"flex-grow pt-20 px-4 container mx-auto max-w-lg\" id=\"main-container\">\n        <!-- Skeleton Loading -->\n        <div id=\"skeleton\" class=\"space-y-4 animate-pulse\">\n            <div class=\"h-40 bg-white rounded-2xl shadow-sm\"></div>\n            <div class=\"h-24 bg-white rounded-2xl shadow-sm\"></div>\n        </div>\n        \n        <!-- Lista Injetada via JS -->\n        <div id=\"lista-pedidos\" class=\"hidden space-y-6\"></div>\n    </main>\n\n    <!-- MODAL RASTREAMENTO (Timeline) -->\n    <div id=\"modal-timeline\" class=\"fixed inset-0 z-50 hidden\">\n        <!-- Overlay -->\n        <div onclick=\"fecharTimeline()\" class=\"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity opacity-0 modal-overlay\"></div>\n        \n        <!-- Card Deslizante -->\n        <div class=\"absolute bottom-0 w-full bg-gray-50 rounded-t-3xl shadow-2xl transform translate-y-full transition-transform duration-300 modal-content h-[85vh] flex flex-col\">\n            \n            <!-- Header Modal -->\n            <div class=\"bg-white px-6 py-4 rounded-t-3xl border-b border-gray-100 flex justify-between items-center flex-shrink-0\">\n                <div>\n                    <p class=\"text-xs font-bold text-gray-400 uppercase tracking-wider\">Pedido</p>\n                    <h2 id=\"tl-id\" class=\"text-2xl font-serif font-black text-gray-900\">#0000</h2>\n                </div>\n                <button onclick=\"fecharTimeline()\" class=\"bg-gray-100 p-2 rounded-full text-gray-500 hover:bg-gray-200\">\n                    <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/></svg>\n                </button>\n            </div>\n\n            <!-- Corpo Rolável -->\n            <div class=\"flex-grow overflow-y-auto p-6\">\n                \n                <!-- Status Atual -->\n                <div class=\"text-center mb-8\">\n                    <div class=\"inline-block p-4 bg-white rounded-full shadow-lg shadow-brand-100 mb-3 relative\">\n                        <span id=\"tl-icon\" class=\"text-4xl\">🍳</span>\n                        <div id=\"tl-pulse\" class=\"absolute inset-0 border-4 border-brand-500 rounded-full animate-pulse-ring opacity-0\"></div>\n                    </div>\n                    <h3 id=\"tl-status-titulo\" class=\"text-xl font-bold text-gray-900 mb-1\">Preparando com amor</h3>\n                    <p id=\"tl-status-desc\" class=\"text-sm text-gray-500\">Estamos cuidando dos detalhes do seu pedido.</p>\n                </div>\n\n                <!-- Timeline Vertical -->\n                <div class=\"relative pl-4 space-y-0 mb-8\">\n                    \n                    <!-- Passo 1 -->\n                    <div class=\"timeline-item relative flex gap-4 pb-8 group\" id=\"step-enviado\">\n                        <div class=\"timeline-line h-full\"></div>\n                        <div class=\"z-10 w-8 h-8 rounded-full border-2 flex items-center justify-center bg-white transition-colors duration-500 border-gray-200 text-gray-300\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg>\n                        </div>\n                        <div>\n                            <h4 class=\"font-bold text-sm text-gray-900\">Pedido Recebido</h4>\n                            <p class=\"text-xs text-gray-500 mt-0.5\">Recebemos seu pedido com sucesso.</p>\n                        </div>\n                    </div>\n\n                    <!-- Passo 2 -->\n                    <div class=\"timeline-item relative flex gap-4 pb-8 group\" id=\"step-produzindo\">\n                        <div class=\"timeline-line h-full\"></div>\n                        <div class=\"z-10 w-8 h-8 rounded-full border-2 flex items-center justify-center bg-white transition-colors duration-500 border-gray-200 text-gray-300\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\"/></svg>\n                        </div>\n                        <div>\n                            <h4 class=\"font-bold text-sm text-gray-900\">Em Preparação</h4>\n                            <p class=\"text-xs text-gray-500 mt-0.5\">Estamos montando seus brownies.</p>\n                        </div>\n                    </div>\n\n                    <!-- Passo 3 -->\n                    <div class=\"timeline-item relative flex gap-4 group\" id=\"step-finalizado\">\n                        <div class=\"z-10 w-8 h-8 rounded-full border-2 flex items-center justify-center bg-white transition-colors duration-500 border-gray-200 text-gray-300\">\n                            <svg class=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"/></svg>\n                        </div>\n                        <div>\n                            <h4 class=\"font-bold text-sm text-gray-900\">Pronto para Retirada</h4>\n                            <p class=\"text-xs text-gray-500 mt-0.5\">Pode vir buscar na loja!</p>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Resumo Itens -->\n                <div class=\"bg-white rounded-xl p-4 border border-gray-100 shadow-sm\">\n                    <h4 class=\"text-xs font-bold text-gray-400 uppercase mb-3 border-b border-gray-50 pb-2\">Itens do Pedido</h4>\n                    <div id=\"tl-itens\" class=\"space-y-2 text-sm text-gray-600\"></div>\n                    <div class=\"mt-3 pt-3 border-t border-gray-50 flex justify-between font-bold text-gray-900\">\n                        <span>Total</span>\n                        <span id=\"tl-total\">R$ 0,00</span>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Footer Ações -->\n            <div class=\"p-4 bg-white border-t border-gray-100 pb-safe\">\n                <a href=\"https://wa.me/5541992480604\" target=\"_blank\" class=\"block w-full bg-green-500 text-white text-center font-bold py-3 rounded-xl shadow-lg shadow-green-200 active:scale-95 transition-transform flex items-center justify-center gap-2\">\n                    <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z\"/></svg>\n                    Falar com a Loja\n                </a>\n            </div>\n        </div>\n    </div>\n\n    <!-- FOOTER MOBILE -->\n    <nav class=\"md:hidden fixed bottom-0 w-full bg-white border-t border-gray-100 z-30 pb-safe shadow-[0_-5px_20px_rgba(0,0,0,0.03)]\">\n        <div class=\"flex justify-around items-center h-16\">\n            <a href=\"index.html\" class=\"flex flex-col items-center text-gray-400 hover:text-brand-600 transition-colors active:scale-90\">\n                <svg class=\"w-6 h-6 mb-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"/></svg>\n                <span class=\"text-[10px] font-medium\">Início</span>\n            </a>\n            \n            <a href=\"perfil.html\" class=\"flex flex-col items-center text-gray-400 hover:text-brand-600 transition-colors active:scale-90\">\n                <svg class=\"w-6 h-6 mb-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"/></svg>\n                <span class=\"text-[10px] font-medium\">Perfil</span>\n            </a>\n\n            <a href=\"pedidos.html\" class=\"flex flex-col items-center text-brand-600 active:scale-90\">\n                <svg class=\"w-6 h-6 mb-1\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M5 22h14c1.103 0 2-.897 2-2V9a1 1 0 0 0-1-1h-3V5c0-2.757-2.243-5-5-5S7 2.243 7 5v3H4a1 1 0 0 0-1 1v11c0 1.103.897 2 2 2zM9 5c0-1.654 1.346-3 3-3s3 1.346 3 3v3H9V5zm-4 5h14v10H5V10z\"/></svg>\n                <span class=\"text-[10px] font-bold\">Pedidos</span>\n            </a>\n        </div>\n    </nav>\n\n    <!-- SCRIPTS -->\n    <script>\n        const firebaseConfig = {\n            apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n            authDomain: \"renata-26079.firebaseapp.com\",\n            projectId: \"renata-26079\",\n            storageBucket: \"renata-26079.firebasestorage.app\",\n            messagingSenderId: \"995787482442\",\n            appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n        };\n\n        firebase.initializeApp(firebaseConfig);\n        const db = firebase.firestore();\n        const auth = firebase.auth();\n        \n        let pedidosCache = [];\n\n        document.addEventListener('DOMContentLoaded', () => {\n            carregarHistorico();\n        });\n\n        async function carregarHistorico() {\n            const fone = localStorage.getItem('userPhone');\n            const container = document.getElementById('lista-pedidos');\n            const skeleton = document.getElementById('skeleton');\n\n            if (!fone) {\n                renderizarVazio(container, \"Faça login no seu perfil para ver seus pedidos.\");\n                skeleton.classList.add('hidden');\n                container.classList.remove('hidden');\n                return;\n            }\n\n            try {\n                // CORREÇÃO: Removi o .orderBy() do Firestore.\n                // O Firestore exige um índice composto se usarmos .where() e .orderBy() juntos.\n                // Para evitar erros, buscamos os dados e ordenamos via JavaScript.\n                const snap = await db.collection('pedidos')\n                    .where('cliente_telefone_limpo', '==', fone.replace(/\\D/g, ''))\n                    .limit(20) // Buscamos um pouco mais para garantir\n                    .get();\n\n                pedidosCache = snap.docs.map(d => ({ id_doc: d.id, ...d.data() }));\n                \n                // Ordenação via Código (JavaScript) - Data mais recente primeiro\n                pedidosCache.sort((a, b) => new Date(b.data) - new Date(a.data));\n                \n                renderizarLista(pedidosCache, container);\n                skeleton.classList.add('hidden');\n                container.classList.remove('hidden');\n\n            } catch (e) {\n                console.error(\"Erro ao buscar pedidos:\", e);\n                renderizarVazio(container, \"Erro ao buscar pedidos. Tente recarregar.\");\n                skeleton.classList.add('hidden');\n                container.classList.remove('hidden');\n            }\n        }\n\n        function renderizarLista(pedidos, container) {\n            container.innerHTML = '';\n            \n            if (pedidos.length === 0) {\n                renderizarVazio(container, \"Você ainda não fez nenhum pedido.\");\n                return;\n            }\n\n            // Separa o pedido mais recente (Ativo)\n            const ativo = pedidos[0]; \n            \n            // Card Grande do Pedido Ativo\n            if (ativo && ['Enviado', 'Produzindo', 'Finalizado'].includes(ativo.status)) {\n                container.innerHTML += `\n                <div onclick=\"abrirTimeline('${ativo.id_doc}')\" class=\"bg-white rounded-3xl p-6 shadow-lg shadow-brand-100 border border-brand-50 cursor-pointer transform transition hover:scale-[1.02] group relative overflow-hidden\">\n                    <div class=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-brand-400 to-brand-600\"></div>\n                    <div class=\"flex justify-between items-start mb-4\">\n                        <div>\n                            <span class=\"text-xs font-bold text-brand-600 uppercase tracking-wide bg-brand-50 px-2 py-1 rounded-md mb-2 inline-block\">Pedido Recente</span>\n                            <h2 class=\"text-2xl font-serif font-black text-gray-900\">${ativo.id_visual}</h2>\n                        </div>\n                        <div class=\"w-10 h-10 rounded-full bg-brand-50 flex items-center justify-center text-brand-600 group-hover:bg-brand-600 group-hover:text-white transition-colors\">\n                            <svg class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\"/></svg>\n                        </div>\n                    </div>\n                    <div class=\"flex items-center gap-3 text-sm text-gray-600\">\n                        <div class=\"relative flex h-3 w-3\">\n                          <span class=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75\"></span>\n                          <span class=\"relative inline-flex rounded-full h-3 w-3 bg-green-500\"></span>\n                        </div>\n                        <span class=\"font-bold\">${ativo.status}</span>\n                        <span class=\"text-gray-300\">|</span>\n                        <span>${new Date(ativo.data).toLocaleDateString('pt-BR')}</span>\n                    </div>\n                </div>\n                \n                <h3 class=\"font-bold text-gray-400 text-xs uppercase tracking-wider mt-8 mb-2 ml-2\">Histórico Anterior</h3>\n                `;\n            }\n\n            // Lista dos demais\n            const historico = ['Enviado', 'Produzindo', 'Finalizado'].includes(ativo.status) ? pedidos.slice(1) : pedidos;\n\n            if(historico.length > 0) {\n                historico.forEach(p => {\n                    container.innerHTML += `\n                    <div onclick=\"abrirTimeline('${p.id_doc}')\" class=\"bg-white rounded-2xl p-4 border border-gray-100 flex justify-between items-center active:bg-gray-50 transition mt-2\">\n                        <div>\n                            <p class=\"font-bold text-gray-900\">${p.id_visual}</p>\n                            <p class=\"text-xs text-gray-400\">${new Date(p.data).toLocaleDateString('pt-BR')}</p>\n                        </div>\n                        <div class=\"text-right\">\n                            <p class=\"text-sm font-medium text-gray-600\">${p.status}</p>\n                            <p class=\"text-xs font-bold text-gray-900\">${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(p.total)}</p>\n                        </div>\n                    </div>`;\n                });\n            } else if (!['Enviado', 'Produzindo', 'Finalizado'].includes(ativo.status)) {\n                 container.innerHTML = \"\"; // Limpa se não tiver o card de destaque nem histórico\n                 // Mas se tiver 1 pedido e não for ativo (ex: cancelado), precisa mostrar na lista normal\n                 pedidos.forEach(p => {\n                    container.innerHTML += `\n                    <div onclick=\"abrirTimeline('${p.id_doc}')\" class=\"bg-white rounded-2xl p-4 border border-gray-100 flex justify-between items-center active:bg-gray-50 transition mt-2\">\n                        <div>\n                            <p class=\"font-bold text-gray-900\">${p.id_visual}</p>\n                            <p class=\"text-xs text-gray-400\">${new Date(p.data).toLocaleDateString('pt-BR')}</p>\n                        </div>\n                        <div class=\"text-right\">\n                            <p class=\"text-sm font-medium text-gray-600\">${p.status}</p>\n                            <p class=\"text-xs font-bold text-gray-900\">${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(p.total)}</p>\n                        </div>\n                    </div>`;\n                });\n            }\n        }\n\n        // --- LÓGICA DA TIMELINE ---\n\n        function abrirTimeline(id) {\n            const pedido = pedidosCache.find(p => p.id_doc === id);\n            if (!pedido) return;\n\n            // Preenche Dados\n            document.getElementById('tl-id').innerText = pedido.id_visual;\n            document.getElementById('tl-total').innerText = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(pedido.total);\n            \n            const listaItens = document.getElementById('tl-itens');\n            listaItens.innerHTML = pedido.itens.map(i => `\n                <div class=\"flex justify-between\">\n                    <span>${i.qtd}x ${i.nome}</span>\n                    <span>${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(i.precoFinal * i.qtd)}</span>\n                </div>\n            `).join('');\n\n            // Atualiza Estado Visual\n            atualizarVisualTimeline(pedido.status);\n\n            // Abre Modal\n            const modal = document.getElementById('modal-timeline');\n            const content = modal.querySelector('.modal-content');\n            const overlay = modal.querySelector('.modal-overlay');\n\n            modal.classList.remove('hidden');\n            setTimeout(() => {\n                overlay.classList.remove('opacity-0');\n                content.classList.remove('translate-y-full');\n            }, 10);\n\n            // Confetti se estiver finalizado\n            if (pedido.status === 'Finalizado') {\n                setTimeout(() => confetti({ particleCount: 100, spread: 70, origin: { y: 0.8 }, colors: ['#db2777', '#f43f5e'] }), 300);\n            }\n        }\n\n        function fecharTimeline() {\n            const modal = document.getElementById('modal-timeline');\n            const content = modal.querySelector('.modal-content');\n            const overlay = modal.querySelector('.modal-overlay');\n\n            overlay.classList.add('opacity-0');\n            content.classList.add('translate-y-full');\n            \n            setTimeout(() => modal.classList.add('hidden'), 300);\n        }\n\n        function atualizarVisualTimeline(status) {\n            // Reset\n            document.querySelectorAll('.timeline-item').forEach(el => {\n                el.classList.remove('active');\n                const dot = el.querySelector('.z-10');\n                const line = el.querySelector('.timeline-line');\n                \n                dot.classList.remove('bg-brand-600', 'text-white', 'border-brand-600');\n                dot.classList.add('bg-white', 'text-gray-300', 'border-gray-200');\n                if(line) line.classList.remove('bg-brand-600');\n            });\n\n            const titulo = document.getElementById('tl-status-titulo');\n            const desc = document.getElementById('tl-status-desc');\n            const icon = document.getElementById('tl-icon');\n            const pulse = document.getElementById('tl-pulse');\n\n            pulse.classList.remove('opacity-0'); // Ativa pulse por padrão\n\n            // Mapeamento de Passos\n            let steps = ['step-enviado'];\n            if (status === 'Produzindo') steps = ['step-enviado', 'step-produzindo'];\n            if (status === 'Finalizado') steps = ['step-enviado', 'step-produzindo', 'step-finalizado'];\n            if (status === 'Cancelado') steps = [];\n\n            // Ativa os passos\n            steps.forEach(id => {\n                const el = document.getElementById(id);\n                const dot = el.querySelector('.z-10');\n                const line = el.querySelector('.timeline-line');\n\n                dot.classList.remove('bg-white', 'text-gray-300', 'border-gray-200');\n                dot.classList.add('bg-brand-600', 'text-white', 'border-brand-600');\n                if(line) line.classList.add('bg-brand-600'); // Pinta a linha anterior\n            });\n\n            // Textos e Ícones\n            if (status === 'Enviado') {\n                titulo.innerText = \"Pedido Recebido\";\n                desc.innerText = \"Aguarde, logo começaremos o preparo.\";\n                icon.innerText = \"📝\";\n            } else if (status === 'Produzindo') {\n                titulo.innerText = \"Preparando com Amor\";\n                desc.innerText = \"Seus brownies estão sendo montados agora.\";\n                icon.innerText = \"👩‍🍳\";\n            } else if (status === 'Finalizado') {\n                titulo.innerText = \"Pronto para Retirada!\";\n                desc.innerText = \"Corre pra cá, está fresquinho!\";\n                icon.innerText = \"🎁\";\n            } else {\n                titulo.innerText = status;\n                desc.innerText = \"Verifique o status do seu pedido.\";\n                icon.innerText = \"🔎\";\n                pulse.classList.add('opacity-0');\n            }\n        }\n\n        function renderizarVazio(container, msg = \"Nenhum pedido encontrado.\") {\n            container.innerHTML = `\n                <div class=\"flex flex-col items-center justify-center py-20 text-center opacity-60\">\n                    <svg class=\"w-20 h-20 text-gray-300 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1\" d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"/></svg>\n                    <p class=\"text-gray-500\">${msg}</p>\n                </div>`;\n        }\n    </script>\n</body>\n</html>"
    },
    {
        "caminho": "Reh\\perfil.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <meta name=\"theme-color\" content=\"#db2777\">\n    <link rel=\"icon\" type=\"image/png\" href=\"logo.png\">\n    <title>Meu Clube | Delicia D'Brownie</title>\n    \n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js\"></script>\n\n    <link href=\"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;800&display=swap\" rel=\"stylesheet\">\n\n    <script>\n        tailwind.config = {\n            theme: {\n                extend: {\n                    colors: { brand: { 500: '#f43f5e', 600: '#db2777', 800: '#9f1239' } },\n                    fontFamily: { sans: ['DM Sans'], serif: ['Playfair Display'] }\n                }\n            }\n        }\n    </script>\n\n    <style>\n        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.5); }\n        .stamp-animation { animation: stampIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; opacity: 0; transform: scale(0) rotate(-45deg); }\n        @keyframes stampIn { 100% { opacity: 1; transform: scale(1) rotate(0deg); } }\n    </style>\n</head>\n<body class=\"bg-gray-50 pb-24 min-h-screen\">\n\n    <!-- HEADER -->\n    <div class=\"bg-brand-600 pb-16 pt-8 px-6 rounded-b-[3rem] shadow-lg relative overflow-hidden\">\n        <div class=\"absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none\">\n            <div class=\"absolute top-[-20px] right-[-20px] w-40 h-40 rounded-full bg-white blur-3xl\"></div>\n            <div class=\"absolute bottom-[-20px] left-[-20px] w-40 h-40 rounded-full bg-white blur-3xl\"></div>\n        </div>\n\n        <div class=\"relative z-10 flex justify-between items-center mb-6\">\n            <a href=\"index.html\" class=\"text-white/80 hover:text-white transition\">\n                <svg class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/></svg>\n            </a>\n            <h1 class=\"text-white font-serif font-bold text-xl\">Minha Conta</h1>\n            <div class=\"w-6\"></div>\n        </div>\n\n        <div class=\"relative z-10 text-center mb-4\">\n            <div class=\"w-24 h-24 bg-white p-1 rounded-full mx-auto shadow-xl mb-3 relative group cursor-pointer\">\n                <img id=\"user-photo\" src=\"https://ui-avatars.com/api/?name=User&background=random\" class=\"w-full h-full rounded-full object-cover\">\n                <div class=\"absolute bottom-0 right-0 bg-green-500 w-6 h-6 rounded-full border-4 border-white\"></div>\n            </div>\n            <h2 id=\"user-name-display\" class=\"text-white font-bold text-2xl tracking-tight\">Visitante</h2>\n            <p id=\"user-phone-display\" class=\"text-brand-200 text-sm font-medium\">--</p>\n        </div>\n    </div>\n\n    <!-- CARTÃO FIDELIDADE -->\n    <div class=\"px-4 -mt-12 relative z-20\">\n        <div class=\"bg-white rounded-3xl shadow-xl p-6 border border-gray-100\">\n            <div class=\"flex justify-between items-center mb-4\">\n                <div>\n                    <h3 class=\"font-black text-gray-800 text-lg uppercase tracking-wide\">Cartão Fidelidade</h3>\n                    <p class=\"text-xs text-gray-400\">Complete 10 pedidos e ganhe um prêmio!</p>\n                </div>\n                <div class=\"bg-brand-50 text-brand-600 px-3 py-1 rounded-full text-xs font-bold border border-brand-100\">\n                    <span id=\"pontos-txt\">0</span>/10\n                </div>\n            </div>\n\n            <!-- GRID DE SELOS -->\n            <div class=\"grid grid-cols-5 gap-3 mb-6\" id=\"stamps-grid\">\n                <!-- Injetado via JS -->\n            </div>\n\n            <div id=\"premio-box\" class=\"hidden bg-gradient-to-r from-yellow-400 to-orange-500 text-white p-4 rounded-xl shadow-lg text-center animate-pulse\">\n                <p class=\"font-bold text-sm mb-1\">🎉 PARABÉNS! VOCÊ GANHOU!</p>\n                <p class=\"text-xs opacity-90\">Mostre essa tela na loja para retirar seu prêmio.</p>\n            </div>\n        </div>\n    </div>\n\n    <!-- FORMULÁRIO LOGIN/DADOS -->\n    <div class=\"px-6 mt-8 max-w-md mx-auto\">\n        <form id=\"profile-form\" class=\"space-y-5\">\n            <div>\n                <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1 ml-1\">Seu Nome</label>\n                <input type=\"text\" id=\"nome\" class=\"w-full bg-white border border-gray-200 rounded-xl px-4 py-3 font-medium text-gray-800 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 outline-none transition-all\" placeholder=\"Como quer ser chamado?\">\n            </div>\n            \n            <div>\n                <label class=\"block text-xs font-bold text-gray-400 uppercase mb-1 ml-1\">WhatsApp (Celular)</label>\n                <input type=\"tel\" id=\"telefone\" class=\"w-full bg-white border border-gray-200 rounded-xl px-4 py-3 font-medium text-gray-800 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 outline-none transition-all\" placeholder=\"(41) 99999-9999\">\n            </div>\n\n            <button type=\"submit\" class=\"w-full bg-gray-900 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition-transform\">\n                Salvar Dados\n            </button>\n        </form>\n\n        <button onclick=\"logout()\" class=\"w-full mt-4 text-red-500 text-sm font-bold py-3 hover:bg-red-50 rounded-xl transition\">\n            Sair da Conta\n        </button>\n    </div>\n\n    <script>\n        const firebaseConfig = {\n            apiKey: \"AIzaSyCM9tMvnRV-o7X66euCBKuLmuz-kIrClWY\",\n            authDomain: \"renata-26079.firebaseapp.com\",\n            projectId: \"renata-26079\",\n            storageBucket: \"renata-26079.firebasestorage.app\",\n            messagingSenderId: \"995787482442\",\n            appId: \"1:995787482442:web:fdbca404a0e251cc278db3\"\n        };\n        firebase.initializeApp(firebaseConfig);\n        const db = firebase.firestore();\n\n        document.addEventListener('DOMContentLoaded', () => {\n            loadUserData();\n        });\n\n        function loadUserData() {\n            const nome = localStorage.getItem('userName');\n            const fone = localStorage.getItem('userPhone');\n            const pontos = parseInt(localStorage.getItem('userPoints') || 0);\n\n            if(nome) {\n                document.getElementById('nome').value = nome;\n                document.getElementById('user-name-display').innerText = nome;\n                document.getElementById('user-photo').src = `https://ui-avatars.com/api/?name=${encodeURIComponent(nome)}&background=db2777&color=fff`;\n            }\n            if(fone) {\n                document.getElementById('telefone').value = fone;\n                document.getElementById('user-phone-display').innerText = fone;\n            }\n\n            renderStamps(pontos);\n        }\n\n        function renderStamps(pontos) {\n            const grid = document.getElementById('stamps-grid');\n            grid.innerHTML = '';\n            document.getElementById('pontos-txt').innerText = pontos;\n\n            if(pontos >= 10) document.getElementById('premio-box').classList.remove('hidden');\n\n            for(let i=1; i<=10; i++) {\n                const filled = i <= pontos;\n                const delay = i * 100;\n                \n                const stamp = document.createElement('div');\n                stamp.className = `aspect-square rounded-full flex items-center justify-center border-2 ${filled ? 'border-brand-600 bg-brand-50' : 'border-gray-200 bg-gray-50'}`;\n                \n                if(filled) {\n                    stamp.innerHTML = `<svg class=\"w-6 h-6 text-brand-600 stamp-animation\" style=\"animation-delay: ${delay}ms\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/></svg>`;\n                } else {\n                    stamp.innerHTML = `<span class=\"text-gray-300 text-xs font-bold\">${i}</span>`;\n                }\n                grid.appendChild(stamp);\n            }\n        }\n\n        document.getElementById('profile-form').addEventListener('submit', (e) => {\n            e.preventDefault();\n            const nome = document.getElementById('nome').value;\n            const fone = document.getElementById('telefone').value;\n\n            if(nome && fone) {\n                localStorage.setItem('userName', nome);\n                localStorage.setItem('userPhone', fone);\n                \n                // Salva no Firebase para ter histórico real\n                const uid = fone.replace(/\\D/g, ''); // Usa telefone como ID simples\n                db.collection('users').doc(uid).set({\n                    nome: nome,\n                    telefone: fone,\n                    lastUpdate: new Date()\n                }, { merge: true });\n\n                alert('Perfil atualizado com sucesso!');\n                loadUserData();\n            } else {\n                alert('Preencha todos os campos!');\n            }\n        });\n\n        function logout() {\n            if(confirm('Deseja sair?')) {\n                localStorage.clear();\n                window.location.href = 'index.html';\n            }\n        }\n    </script>\n</body>\n</html>"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\ACOMPANHAMENTO CRM\\Acompanhamento CRM.chd",
        "conteudo": "[Consulta]\nCaption=CRM\nTabela=mov_Pessoa_Acompanhamento\nCampos=10\nCommandText=Select,\"  Tbl2.IdAcompanhamento,\",\"  Tbl2.Data as Data,\",\"  DatePart(year, Tbl2.Data) as Ano,\",\"  DatePart(month, Tbl2.Data) as Mes,\",\"  DatePart(day, Tbl2.Data) as Dia,\",\"  Tbl2.Descricao as Descricao,\",\"  Tbl2.IdGrupo_Tarefa as Tbl2_IdGrupo_Tarefa,\",\"  Tbl4.Nome as Grupo_Tarefa,\",\"  Tbl2.IdResponsavel as Tbl2_IdResponsavel,\",\"  Tbl6.IdPessoa as Tbl6_IdPessoa,\",\"  Tbl9.Nome as Responsavel,\",\"  Tbl1.IdPessoa,\",\"  Tbl21.Nome as Cliente\",From,\"  cad_Pessoa_Contrato_Logistica Tbl1\",\"Left Outer Join\",\"  mov_Acompanhamento Tbl2 on Tbl2.IdProjeto_Atividade = Tbl1.IdProjeto_Atividade\",\"Left Outer Join\",\"  cad_Grupo_Tarefa Tbl4 on Tbl4.IdGrupo_Tarefa = Tbl2.IdGrupo_Tarefa\",\"Left Outer Join\",\"  cad_Funcionario Tbl6 on Tbl6.IdPessoa = Tbl2.IdResponsavel\",\"Left Outer Join\",\"  cad_Pessoa Tbl9 on Tbl9.IdPessoa = Tbl6.IdPessoa\",\"Left Outer Join\",\"  cad_Pessoa Tbl21 on Tbl21.IdPessoa = Tbl1.IdPessoa\",Where,\"  Tbl2.Descricao is not null \",\"order by\",\"  Tbl4.Nome,Tbl2.IdResponsavel,Tbl2.Data\"\n\n[Campos]\nCampo[0].FieldName=IdAcompanhamento\nCampo[0].Origin=Tbl1.IdAcompanhamento\nCampo[0].PrimaryKey=1\nCampo[0].Foreign.Enabled=1\nCampo[0].Foreign.Divisao=Acompanhamento\nCampo[0].Foreign.Campo=IdAcompanhamento\nCampo[0].Foreign.Tabela=mov_Acompanhamento\nCampo[1].FieldName=Data\nCampo[1].Origin=Tbl2.Data\nCampo[1].DisplayLabel=Data Inserção\nCampo[1].Join.Enabled=1\nCampo[1].Join.Result=Data\nCampo[1].Join.Search=IdAcompanhamento\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=80\nCampo[2].FieldName=Cliente\nCampo[2].Origin=Tbl21.Nome\nCampo[2].DisplayLabel=Cliente\nCampo[2].Join.Enabled=1\nCampo[2].Join.Result=Nome\nCampo[2].Join.Search=IdPessoa\nCampo[2].Width=200\nCampo[3].FieldName=Descricao\nCampo[3].Origin=Tbl2.Descricao\nCampo[3].DisplayLabel=Descrição\nCampo[3].Join.Enabled=1\nCampo[3].Join.Result=Descricao\nCampo[3].Join.Search=IdAcompanhamento\nCampo[3].Width=300\nCampo[4].FieldName=Tbl2_IdGrupo_Tarefa\nCampo[4].Origin=Tbl2.IdGrupo_Tarefa\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Grupo_Tarefa\nCampo[4].Foreign.Campo=IdGrupo_Tarefa\nCampo[4].Foreign.Tabela=cad_Grupo_Tarefa\nCampo[4].Join.Enabled=1\nCampo[4].Join.Result=IdGrupo_Tarefa\nCampo[4].Join.Search=IdAcompanhamento\nCampo[5].FieldName=Grupo_Tarefa\nCampo[5].Origin=Tbl4.Nome\nCampo[5].DisplayLabel=Grupo Tarefa\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=Nome\nCampo[5].Join.Search=Tbl2_IdGrupo_Tarefa\nCampo[5].Width=160\nCampo[6].FieldName=Tbl2_IdResponsavel\nCampo[6].Origin=Tbl2.IdResponsavel\nCampo[6].Foreign.Enabled=1\nCampo[6].Foreign.Divisao=Funcionario\nCampo[6].Foreign.Campo=IdPessoa\nCampo[6].Foreign.Tabela=vis_Funcionario\nCampo[6].Join.Enabled=1\nCampo[6].Join.Result=IdResponsavel\nCampo[6].Join.Search=IdAcompanhamento\nCampo[7].FieldName=Tbl6_IdPessoa\nCampo[7].Origin=Tbl6.IdPessoa\nCampo[7].PrimaryKey=1\nCampo[7].Foreign.Enabled=1\nCampo[7].Foreign.Divisao=Pessoa\nCampo[7].Foreign.Campo=IdPessoa\nCampo[7].Foreign.Tabela=cad_Pessoa\nCampo[7].Join.Enabled=1\nCampo[7].Join.Result=IdPessoa\nCampo[7].Join.Search=Tbl2_IdResponsavel\nCampo[8].FieldName=Responsavel\nCampo[8].Origin=Tbl9.Nome\nCampo[8].DisplayLabel=Responsável\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Nome\nCampo[8].Join.Search=Tbl6_IdPessoa\nCampo[8].Width=200\nCampo[9].FieldName=IdPessoa\nCampo[9].Origin=Tbl1.IdPessoa\nCampo[9].Foreign.Enabled=1\nCampo[9].Foreign.Divisao=Pessoa\nCampo[9].Foreign.Campo=IdPessoa\nCampo[9].Foreign.Tabela=cad_Pessoa\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\ACOMPANHAMENTO DE COTAÇÕES\\RELATORIO ACOMPANHAMENTO DE COTACOES.chd",
        "conteudo": "[Consulta]\nCaption=ACOMPANHAMENTO DE COTAÇÕES\nTabela=mov_Oferta_Frete_Fechamento\nCampos=54\nCommandText=Select,\"  Tbl1.IdOferta_Frete_Fechamento,\",\"  Tbl1.Lucro_Estimado,\",\"  Tbl1.IdMoeda,\",\"  Tbl2.Sigla as Tbl2_Sigla,\",\"  Tbl1.IdOferta_Frete,\",\"  Tbl5.Modalidade_Processo as Tbl5_Modalidade_Processo,\",\"  Tbl5.Numero_Oferta as Tbl5_Numero_Oferta,\",\"  CASE WHEN Tbl5.Situacao = 1 THEN 'Aguardando aprovação' WHEN Tbl5.Situacao = 2 THEN 'Aprovada' WHEN Tbl5.Situacao = 3 THEN 'Não Aprovada' WHEN Tbl5.Situacao = 4 THEN 'Não Enviada' WHEN Tbl5.Situacao = 6 THEN 'Enviada' End as Tbl5_Situacao,\",\"  Tbl5.Tipo_Operacao as Tbl5_Tipo_Operacao,\",\"  Tbl5.Tipo_Servico as Tbl5_Tipo_Servico,\",\"  Tbl5.IdAgente_Destino as Tbl5_IdAgente_Destino,\",\"  Tbl7.IdPessoa as Tbl7_IdPessoa,\",\"  Tbl9.Nome as Tbl9_Nome,\",\"  Tbl5.IdAgente_Origem as Tbl5_IdAgente_Origem,\",\"  Tbl21.IdPessoa as Tbl21_IdPessoa,\",\"  Tbl23.Nome as Tbl23_Nome,\",\"  Tbl5.IdCompanhia_Transporte as Tbl5_IdCompanhia_Transporte,\",\"  Tbl35.IdPessoa as Tbl35_IdPessoa,\",\"  Tbl36.Nome as Tbl36_Nome,\",\"  Tbl5.IdDestino as Tbl5_IdDestino,\",\"  Tbl50.Nome as Tbl50_Nome,\",\"  Tbl50.IdPais as Tbl50_IdPais,\",\"  Tbl53.Nome as Tbl53_Nome,\",\"  Tbl5.IdOrigem as Tbl5_IdOrigem,\",\"  Tbl68.Nome as Tbl68_Nome,\",\"  Tbl68.IdPais as Tbl68_IdPais,\",\"  Tbl71.Nome as Tbl71_Nome,\",\"  Tbl5.IdProposta_Frete as Tbl5_IdProposta_Frete,\",\"  Tbl75.Data_Aprovacao as Tbl75_Data_Aprovacao,\",\"  Tbl75.Data_Proposta as Tbl75_Data_Proposta,\",\"  Tbl75.Tipo_Proposta as Tbl75_Tipo_Proposta,\",\"  Tbl75.IdCliente as Tbl75_IdCliente,\",\"  Tbl76.IdPessoa as Tbl76_IdPessoa,\",\"  Tbl80.Nome as Tbl80_Nome,\",\"  Tbl80.Cpf_Cnpj,\",\"  Tbl75.IdResponsavel as Tbl75_IdResponsavel,\",\"  Tbl98.IdPessoa as Tbl98_IdPessoa,\",\"  Tbl102.Nome as Tbl102_Nome,\",\"  Tbl75.IdVendedor as Tbl75_IdVendedor,\",\"  Tbl115.IdPessoa as Tbl115_IdPessoa,\",\"  Tbl119.Nome as Tbl119_Nome,\",\"  Tbl5.IdProposta_Frete_Carga as Tbl5_IdProposta_Frete_Carga,\",\"  Tbl132.Metros_Cubicos as Tbl132_Metros_Cubicos,\",\"  Tbl132.Peso_Bruto as Tbl132_Peso_Bruto,\",\"  Tbl132.Peso_Considerado as Tbl132_Peso_Considerado,\",\"  Tbl132.Peso_Cubado as Tbl132_Peso_Cubado,\",\"  Tbl132.Peso_Liquido as Tbl132_Peso_Liquido,\",\"  Tbl132.Peso_Taxado as Tbl132_Peso_Taxado,\",\"  Tbl132.Seguro as Tbl132_Seguro,\",\"  Tbl132.Tipo_Carga as Tbl132_Tipo_Carga,\",\"  Tbl132.Total_Carretas as Tbl132_Total_Carretas,\",\"  Tbl132.Total_Container_20 as Tbl132_Total_Container_20,\",\"  Tbl132.Total_Container_40 as Tbl132_Total_Container_40,\",\"  Tbl132.IdProposta_Frete as Tbl132_IdProposta_Frete\",From,\"  mov_Oferta_Frete_Fechamento Tbl1\",\"Left Outer Join\",\"  cad_Moeda Tbl2 on Tbl2.IdMoeda = Tbl1.IdMoeda\",\"Left Outer Join\",\"  mov_Oferta_Frete Tbl5 on Tbl5.IdOferta_Frete = Tbl1.IdOferta_Frete\",\"Left Outer Join\",\"  cad_Agente_Carga Tbl7 on Tbl7.IdPessoa = Tbl5.IdAgente_Destino\",\"Left Outer Join\",\"  cad_Pessoa Tbl9 on Tbl9.IdPessoa = Tbl7.IdPessoa\",\"Left Outer Join\",\"  cad_Agente_Carga Tbl21 on Tbl21.IdPessoa = Tbl5.IdAgente_Origem\",\"Left Outer Join\",\"  cad_Pessoa Tbl23 on Tbl23.IdPessoa = Tbl21.IdPessoa\",\"Left Outer Join\",\"  cad_Companhia_Transporte Tbl35 on Tbl35.IdPessoa = Tbl5.IdCompanhia_Transporte\",\"Left Outer Join\",\"  cad_Pessoa Tbl36 on Tbl36.IdPessoa = Tbl35.IdPessoa\",\"Left Outer Join\",\"  cad_Origem_Destino Tbl50 on Tbl50.IdOrigem_Destino = Tbl5.IdDestino\",\"Left Outer Join\",\"  cad_Pais Tbl53 on Tbl53.IdPais = Tbl50.IdPais\",\"Left Outer Join\",\"  cad_Origem_Destino Tbl68 on Tbl68.IdOrigem_Destino = Tbl5.IdOrigem\",\"Left Outer Join\",\"  cad_Pais Tbl71 on Tbl71.IdPais = Tbl68.IdPais\",\"Left Outer Join\",\"  mov_Proposta_Frete Tbl75 on Tbl75.IdProposta_Frete = Tbl5.IdProposta_Frete\",\"Left Outer Join\",\"  cad_Cliente Tbl76 on Tbl76.IdPessoa = Tbl75.IdCliente\",\"Left Outer Join\",\"  cad_Pessoa Tbl80 on Tbl80.IdPessoa = Tbl76.IdPessoa\",\"Left Outer Join\",\"  cad_Funcionario Tbl98 on Tbl98.IdPessoa = Tbl75.IdResponsavel\",\"Left Outer Join\",\"  cad_Pessoa Tbl102 on Tbl102.IdPessoa = Tbl98.IdPessoa\",\"Left Outer Join\",\"  cad_Funcionario Tbl115 on Tbl115.IdPessoa = Tbl75.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Tbl119 on Tbl119.IdPessoa = Tbl115.IdPessoa\",\"Left Outer Join\",\"  mov_Proposta_Frete_Carga Tbl132 on Tbl132.IdProposta_Frete_Carga = Tbl5.IdProposta_Frete_Carga\"\n\n[Campos]\nCampo[0].FieldName=IdOferta_Frete_Fechamento\nCampo[0].Origin=Tbl1.IdOferta_Frete_Fechamento\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Lucro_Estimado\nCampo[1].Origin=Tbl1.Lucro_Estimado\nCampo[1].DisplayLabel=Lucro estimado\nCampo[1].DisplayFormat=#,0.00;-#,0.00\nCampo[1].Alignment=1\nCampo[1].Width=-1\nCampo[2].FieldName=IdMoeda\nCampo[2].Origin=Tbl1.IdMoeda\nCampo[2].Foreign.Enabled=1\nCampo[2].Foreign.Divisao=Moeda\nCampo[2].Foreign.Campo=IdMoeda\nCampo[2].Foreign.Tabela=cad_Moeda\nCampo[3].FieldName=Tbl2_Sigla\nCampo[3].Origin=Tbl2.Sigla\nCampo[3].DisplayLabel=Moeda\nCampo[3].Join.Enabled=1\nCampo[3].Join.Result=Sigla\nCampo[3].Join.Search=IdMoeda\nCampo[3].Width=40\nCampo[4].FieldName=IdOferta_Frete\nCampo[4].Origin=Tbl1.IdOferta_Frete\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Oferta_Frete\nCampo[4].Foreign.Campo=IdOferta_Frete\nCampo[4].Foreign.Tabela=mov_Oferta_Frete\nCampo[5].FieldName=Tbl5_Modalidade_Processo\nCampo[5].Origin=Tbl5.Modalidade_Processo\nCampo[5].DisplayLabel=Modalidade processo\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=Modalidade_Processo\nCampo[5].Join.Search=IdOferta_Frete\nCampo[5].Width=160\nCampo[5].Items=1,2,3,4,5\nCampo[5].ItemsEx=Aéreo,Marítimo,Terrestre,Air-Air,Sea-Air\nCampo[6].FieldName=Tbl5_Numero_Oferta\nCampo[6].Origin=Tbl5.Numero_Oferta\nCampo[6].DisplayLabel=Número oferta\nCampo[6].Join.Enabled=1\nCampo[6].Join.Result=Numero_Oferta\nCampo[6].Join.Search=IdOferta_Frete\nCampo[6].Width=-1\nCampo[7].FieldName=Tbl5_Situacao\nCampo[7].DisplayLabel=Situacao\nCampo[7].Origin=CASE WHEN Tbl5.Situacao = 1 THEN 'Aguardando aprovação' WHEN Tbl5.Situacao = 2 THEN 'Aprovada' WHEN Tbl5.Situacao = 3 THEN 'Não Aprovada' WHEN Tbl5.Situacao = 4 THEN 'Não Enviada' WHEN Tbl5.Situacao = 6 THEN 'Enviada' End as Tbl5_Situacao\nCampo[7].Width=100\nCampo[8].FieldName=Tbl5_Tipo_Operacao\nCampo[8].Origin=Tbl5.Tipo_Operacao\nCampo[8].DisplayLabel=Tipo operação\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Tipo_Operacao\nCampo[8].Join.Search=IdOferta_Frete\nCampo[8].Width=160\nCampo[8].Items=1,2,3\nCampo[8].ItemsEx=Exportação,Importação,Nacional\nCampo[9].FieldName=Tbl5_Tipo_Servico\nCampo[9].Origin=Tbl5.Tipo_Servico\nCampo[9].DisplayLabel=Tipo serviço\nCampo[9].Join.Enabled=1\nCampo[9].Join.Result=Tipo_Servico\nCampo[9].Join.Search=IdOferta_Frete\nCampo[9].Width=160\nCampo[9].Items=0,1,2,3,4\nCampo[9].ItemsEx=\"(Não informado)\",\"Door to door\",\"Door to port\",\"Port to door\",\"Port to port\"\nCampo[10].FieldName=Tbl5_IdAgente_Destino\nCampo[10].Origin=Tbl5.IdAgente_Destino\nCampo[10].Foreign.Enabled=1\nCampo[10].Foreign.Divisao=Agente_Carga\nCampo[10].Foreign.Campo=IdPessoa\nCampo[10].Foreign.Tabela=vis_Agente_Carga\nCampo[10].Join.Enabled=1\nCampo[10].Join.Result=IdAgente_Destino\nCampo[10].Join.Search=IdOferta_Frete\nCampo[11].FieldName=Tbl7_IdPessoa\nCampo[11].Origin=Tbl7.IdPessoa\nCampo[11].PrimaryKey=1\nCampo[11].Foreign.Enabled=1\nCampo[11].Foreign.Divisao=Pessoa\nCampo[11].Foreign.Campo=IdPessoa\nCampo[11].Foreign.Tabela=cad_Pessoa\nCampo[11].Join.Enabled=1\nCampo[11].Join.Result=IdPessoa\nCampo[11].Join.Search=Tbl5_IdAgente_Destino\nCampo[12].FieldName=Tbl9_Nome\nCampo[12].Origin=Tbl9.Nome\nCampo[12].DisplayLabel=Agente Destino\nCampo[12].Join.Enabled=1\nCampo[12].Join.Result=Nome\nCampo[12].Join.Search=Tbl7_IdPessoa\nCampo[12].Width=200\nCampo[13].FieldName=Tbl5_IdAgente_Origem\nCampo[13].Origin=Tbl5.IdAgente_Origem\nCampo[13].Foreign.Enabled=1\nCampo[13].Foreign.Divisao=Agente_Carga\nCampo[13].Foreign.Campo=IdPessoa\nCampo[13].Foreign.Tabela=vis_Agente_Carga\nCampo[13].Join.Enabled=1\nCampo[13].Join.Result=IdAgente_Origem\nCampo[13].Join.Search=IdOferta_Frete\nCampo[14].FieldName=Tbl21_IdPessoa\nCampo[14].Origin=Tbl21.IdPessoa\nCampo[14].PrimaryKey=1\nCampo[14].Foreign.Enabled=1\nCampo[14].Foreign.Divisao=Pessoa\nCampo[14].Foreign.Campo=IdPessoa\nCampo[14].Foreign.Tabela=cad_Pessoa\nCampo[14].Join.Enabled=1\nCampo[14].Join.Result=IdPessoa\nCampo[14].Join.Search=Tbl5_IdAgente_Origem\nCampo[15].FieldName=Tbl23_Nome\nCampo[15].Origin=Tbl23.Nome\nCampo[15].DisplayLabel=Agente Origem\nCampo[15].Join.Enabled=1\nCampo[15].Join.Result=Nome\nCampo[15].Join.Search=Tbl21_IdPessoa\nCampo[15].Width=200\nCampo[16].FieldName=Tbl5_IdCompanhia_Transporte\nCampo[16].Origin=Tbl5.IdCompanhia_Transporte\nCampo[16].Foreign.Enabled=1\nCampo[16].Foreign.Divisao=Companhia_Transporte\nCampo[16].Foreign.Campo=IdPessoa\nCampo[16].Foreign.Tabela=vis_Companhia_Transporte\nCampo[16].Join.Enabled=1\nCampo[16].Join.Result=IdCompanhia_Transporte\nCampo[16].Join.Search=IdOferta_Frete\nCampo[17].FieldName=Tbl35_IdPessoa\nCampo[17].Origin=Tbl35.IdPessoa\nCampo[17].PrimaryKey=1\nCampo[17].Foreign.Enabled=1\nCampo[17].Foreign.Divisao=Pessoa\nCampo[17].Foreign.Campo=IdPessoa\nCampo[17].Foreign.Tabela=cad_Pessoa\nCampo[17].Join.Enabled=1\nCampo[17].Join.Result=IdPessoa\nCampo[17].Join.Search=Tbl5_IdCompanhia_Transporte\nCampo[18].FieldName=Tbl36_Nome\nCampo[18].Origin=Tbl36.Nome\nCampo[18].DisplayLabel=Cia de Transporte\nCampo[18].Join.Enabled=1\nCampo[18].Join.Result=Nome\nCampo[18].Join.Search=Tbl35_IdPessoa\nCampo[18].Width=200\nCampo[19].FieldName=Tbl5_IdDestino\nCampo[19].Origin=Tbl5.IdDestino\nCampo[19].Foreign.Enabled=1\nCampo[19].Foreign.Divisao=Origem_Destino\nCampo[19].Foreign.Campo=IdOrigem_Destino\nCampo[19].Foreign.Tabela=cad_Origem_Destino\nCampo[19].Join.Enabled=1\nCampo[19].Join.Result=IdDestino\nCampo[19].Join.Search=IdOferta_Frete\nCampo[20].FieldName=Tbl50_Nome\nCampo[20].Origin=Tbl50.Nome\nCampo[20].DisplayLabel=Destino\nCampo[20].Join.Enabled=1\nCampo[20].Join.Result=Nome\nCampo[20].Join.Search=Tbl5_IdDestino\nCampo[20].Width=160\nCampo[21].FieldName=Tbl50_IdPais\nCampo[21].Origin=Tbl50.IdPais\nCampo[21].Foreign.Enabled=1\nCampo[21].Foreign.Divisao=Pais\nCampo[21].Foreign.Campo=IdPais\nCampo[21].Foreign.Tabela=cad_Pais\nCampo[21].Join.Enabled=1\nCampo[21].Join.Result=IdPais\nCampo[21].Join.Search=Tbl5_IdDestino\nCampo[22].FieldName=Tbl53_Nome\nCampo[22].Origin=Tbl53.Nome\nCampo[22].DisplayLabel=País Destino\nCampo[22].Join.Enabled=1\nCampo[22].Join.Result=Nome\nCampo[22].Join.Search=Tbl50_IdPais\nCampo[22].Width=160\nCampo[23].FieldName=Tbl5_IdOrigem\nCampo[23].Origin=Tbl5.IdOrigem\nCampo[23].Foreign.Enabled=1\nCampo[23].Foreign.Divisao=Origem_Destino\nCampo[23].Foreign.Campo=IdOrigem_Destino\nCampo[23].Foreign.Tabela=cad_Origem_Destino\nCampo[23].Join.Enabled=1\nCampo[23].Join.Result=IdOrigem\nCampo[23].Join.Search=IdOferta_Frete\nCampo[24].FieldName=Tbl68_Nome\nCampo[24].Origin=Tbl68.Nome\nCampo[24].DisplayLabel=Origem\nCampo[24].Join.Enabled=1\nCampo[24].Join.Result=Nome\nCampo[24].Join.Search=Tbl5_IdOrigem\nCampo[24].Width=160\nCampo[25].FieldName=Tbl68_IdPais\nCampo[25].Origin=Tbl68.IdPais\nCampo[25].Foreign.Enabled=1\nCampo[25].Foreign.Divisao=Pais\nCampo[25].Foreign.Campo=IdPais\nCampo[25].Foreign.Tabela=cad_Pais\nCampo[25].Join.Enabled=1\nCampo[25].Join.Result=IdPais\nCampo[25].Join.Search=Tbl5_IdOrigem\nCampo[26].FieldName=Tbl71_Nome\nCampo[26].Origin=Tbl71.Nome\nCampo[26].DisplayLabel=País Origem\nCampo[26].Join.Enabled=1\nCampo[26].Join.Result=Nome\nCampo[26].Join.Search=Tbl68_IdPais\nCampo[26].Width=160\nCampo[27].FieldName=Tbl5_IdProposta_Frete\nCampo[27].Origin=Tbl5.IdProposta_Frete\nCampo[27].Foreign.Enabled=1\nCampo[27].Foreign.Divisao=Proposta_Frete\nCampo[27].Foreign.Campo=IdProposta_Frete\nCampo[27].Foreign.Tabela=mov_Proposta_Frete\nCampo[27].Join.Enabled=1\nCampo[27].Join.Result=IdProposta_Frete\nCampo[27].Join.Search=IdOferta_Frete\nCampo[28].FieldName=Tbl75_Data_Aprovacao\nCampo[28].Origin=Tbl75.Data_Aprovacao\nCampo[28].DisplayLabel=Data aprovação\nCampo[28].Join.Enabled=1\nCampo[28].Join.Result=Data_Aprovacao\nCampo[28].Join.Search=Tbl5_IdProposta_Frete\nCampo[28].DisplayFormat=dd/mm/yyyy\nCampo[28].Width=80\nCampo[29].FieldName=Tbl75_Data_Proposta\nCampo[29].Origin=Tbl75.Data_Proposta\nCampo[29].DisplayLabel=Data proposta\nCampo[29].Join.Enabled=1\nCampo[29].Join.Result=Data_Proposta\nCampo[29].Join.Search=Tbl5_IdProposta_Frete\nCampo[29].DisplayFormat=dd/mm/yyyy\nCampo[29].Width=80\nCampo[30].FieldName=Tbl75_Tipo_Proposta\nCampo[30].Origin=Tbl75.Tipo_Proposta\nCampo[30].DisplayLabel=Tipo proposta\nCampo[30].Join.Enabled=1\nCampo[30].Join.Result=Tipo_Proposta\nCampo[30].Join.Search=Tbl5_IdProposta_Frete\nCampo[30].Width=-1\nCampo[30].Items=1,2,3,4,5\nCampo[30].ItemsEx=Prospecção,\"Cliente ativo\",\"Contrato ativo\",\"Contrato inativo\",\"Acordo ativo\"\nCampo[31].FieldName=Tbl75_IdCliente\nCampo[31].Origin=Tbl75.IdCliente\nCampo[31].Foreign.Enabled=1\nCampo[31].Foreign.Divisao=Cliente\nCampo[31].Foreign.Campo=IdPessoa\nCampo[31].Foreign.Tabela=vis_Cliente\nCampo[31].Join.Enabled=1\nCampo[31].Join.Result=IdCliente\nCampo[31].Join.Search=Tbl5_IdProposta_Frete\nCampo[32].FieldName=Tbl76_IdPessoa\nCampo[32].Origin=Tbl76.IdPessoa\nCampo[32].PrimaryKey=1\nCampo[32].Foreign.Enabled=1\nCampo[32].Foreign.Divisao=Pessoa\nCampo[32].Foreign.Campo=IdPessoa\nCampo[32].Foreign.Tabela=cad_Pessoa\nCampo[32].Join.Enabled=1\nCampo[32].Join.Result=IdPessoa\nCampo[32].Join.Search=Tbl75_IdCliente\nCampo[33].FieldName=Tbl80_Nome\nCampo[33].Origin=Tbl80.Nome\nCampo[33].DisplayLabel=Cliente\nCampo[33].Join.Enabled=1\nCampo[33].Join.Result=Nome\nCampo[33].Join.Search=Tbl76_IdPessoa\nCampo[33].Width=200\nCampo[34].FieldName=Cpf_Cnpj\nCampo[34].DisplayLabel=CNPJ\nCampo[34].Origin=Tbl80.Cpf_Cnpj\nCampo[34].Width=120\nCampo[35].FieldName=Tbl75_IdResponsavel\nCampo[35].Origin=Tbl75.IdResponsavel\nCampo[35].Foreign.Enabled=1\nCampo[35].Foreign.Divisao=Funcionario\nCampo[35].Foreign.Campo=IdPessoa\nCampo[35].Foreign.Tabela=vis_Funcionario\nCampo[35].Join.Enabled=1\nCampo[35].Join.Result=IdResponsavel\nCampo[35].Join.Search=Tbl5_IdProposta_Frete\nCampo[36].FieldName=Tbl98_IdPessoa\nCampo[36].Origin=Tbl98.IdPessoa\nCampo[36].PrimaryKey=1\nCampo[36].Foreign.Enabled=1\nCampo[36].Foreign.Divisao=Pessoa\nCampo[36].Foreign.Campo=IdPessoa\nCampo[36].Foreign.Tabela=cad_Pessoa\nCampo[36].Join.Enabled=1\nCampo[36].Join.Result=IdPessoa\nCampo[36].Join.Search=Tbl75_IdResponsavel\nCampo[37].FieldName=Tbl102_Nome\nCampo[37].Origin=Tbl102.Nome\nCampo[37].DisplayLabel=Inside/Responsável\nCampo[37].Join.Enabled=1\nCampo[37].Join.Result=Nome\nCampo[37].Join.Search=Tbl98_IdPessoa\nCampo[37].Width=200\nCampo[38].FieldName=Tbl75_IdVendedor\nCampo[38].Origin=Tbl75.IdVendedor\nCampo[38].Foreign.Enabled=1\nCampo[38].Foreign.Divisao=Funcionario\nCampo[38].Foreign.Campo=IdPessoa\nCampo[38].Foreign.Tabela=vis_Funcionario\nCampo[38].Join.Enabled=1\nCampo[38].Join.Result=IdVendedor\nCampo[38].Join.Search=Tbl5_IdProposta_Frete\nCampo[39].FieldName=Tbl115_IdPessoa\nCampo[39].Origin=Tbl115.IdPessoa\nCampo[39].PrimaryKey=1\nCampo[39].Foreign.Enabled=1\nCampo[39].Foreign.Divisao=Pessoa\nCampo[39].Foreign.Campo=IdPessoa\nCampo[39].Foreign.Tabela=cad_Pessoa\nCampo[39].Join.Enabled=1\nCampo[39].Join.Result=IdPessoa\nCampo[39].Join.Search=Tbl75_IdVendedor\nCampo[40].FieldName=Tbl119_Nome\nCampo[40].Origin=Tbl119.Nome\nCampo[40].DisplayLabel=Vendedor\nCampo[40].Join.Enabled=1\nCampo[40].Join.Result=Nome\nCampo[40].Join.Search=Tbl115_IdPessoa\nCampo[40].Width=200\nCampo[41].FieldName=Tbl5_IdProposta_Frete_Carga\nCampo[41].Origin=Tbl5.IdProposta_Frete_Carga\nCampo[41].Foreign.Enabled=1\nCampo[41].Foreign.Divisao=Proposta_Frete_Carga\nCampo[41].Foreign.Campo=IdProposta_Frete_Carga\nCampo[41].Foreign.Tabela=mov_Proposta_Frete_Carga\nCampo[41].Join.Enabled=1\nCampo[41].Join.Result=IdProposta_Frete_Carga\nCampo[41].Join.Search=IdOferta_Frete\nCampo[42].FieldName=Tbl132_Metros_Cubicos\nCampo[42].Origin=Tbl132.Metros_Cubicos\nCampo[42].DisplayLabel=Metros cúbicos\nCampo[42].Join.Enabled=1\nCampo[42].Join.Result=Metros_Cubicos\nCampo[42].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[42].DisplayFormat=#,0.000 m³\nCampo[42].Alignment=1\nCampo[42].Width=-1\nCampo[43].FieldName=Tbl132_Peso_Bruto\nCampo[43].Origin=Tbl132.Peso_Bruto\nCampo[43].DisplayLabel=Peso bruto\nCampo[43].Join.Enabled=1\nCampo[43].Join.Result=Peso_Bruto\nCampo[43].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[43].DisplayFormat=#,0.000 kg\nCampo[43].Alignment=1\nCampo[43].Width=-1\nCampo[44].FieldName=Tbl132_Peso_Considerado\nCampo[44].Origin=Tbl132.Peso_Considerado\nCampo[44].DisplayLabel=Peso considerado\nCampo[44].Join.Enabled=1\nCampo[44].Join.Result=Peso_Considerado\nCampo[44].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[44].DisplayFormat=#,0.000\nCampo[44].Alignment=1\nCampo[44].Width=-1\nCampo[45].FieldName=Tbl132_Peso_Cubado\nCampo[45].Origin=Tbl132.Peso_Cubado\nCampo[45].DisplayLabel=Peso cubado\nCampo[45].Join.Enabled=1\nCampo[45].Join.Result=Peso_Cubado\nCampo[45].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[45].DisplayFormat=#,0.000 kg\nCampo[45].Alignment=1\nCampo[45].Width=-1\nCampo[46].FieldName=Tbl132_Peso_Liquido\nCampo[46].Origin=Tbl132.Peso_Liquido\nCampo[46].DisplayLabel=Peso líquido\nCampo[46].Join.Enabled=1\nCampo[46].Join.Result=Peso_Liquido\nCampo[46].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[46].DisplayFormat=#,0.000 kg\nCampo[46].Alignment=1\nCampo[46].Width=-1\nCampo[47].FieldName=Tbl132_Peso_Taxado\nCampo[47].Origin=Tbl132.Peso_Taxado\nCampo[47].DisplayLabel=Peso taxado\nCampo[47].Join.Enabled=1\nCampo[47].Join.Result=Peso_Taxado\nCampo[47].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[47].DisplayFormat=#,0.000 kg\nCampo[47].Alignment=1\nCampo[47].Width=-1\nCampo[48].FieldName=Tbl132_Seguro\nCampo[48].Origin=Tbl132.Seguro\nCampo[48].DisplayLabel=Seguro\nCampo[48].Join.Enabled=1\nCampo[48].Join.Result=Seguro\nCampo[48].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[48].DisplayFormat=Sim;Não\nCampo[48].Width=-1\nCampo[49].FieldName=Tbl132_Tipo_Carga\nCampo[49].Origin=Tbl132.Tipo_Carga\nCampo[49].DisplayLabel=Tipo carga\nCampo[49].Join.Enabled=1\nCampo[49].Join.Result=Tipo_Carga\nCampo[49].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[49].Width=160\nCampo[49].Items=1,2,3,4,5,6\nCampo[49].ItemsEx=Aéreo,Break-Bulk,FCL,LCL,RO-RO,Rodoviário\nCampo[50].FieldName=Tbl132_Total_Carretas\nCampo[50].Origin=Tbl132.Total_Carretas\nCampo[50].DisplayLabel=Total carretas\nCampo[50].Join.Enabled=1\nCampo[50].Join.Result=Total_Carretas\nCampo[50].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[50].Alignment=1\nCampo[50].Width=-1\nCampo[51].FieldName=Tbl132_Total_Container_20\nCampo[51].Origin=Tbl132.Total_Container_20\nCampo[51].DisplayLabel=Total container 20\nCampo[51].Join.Enabled=1\nCampo[51].Join.Result=Total_Container_20\nCampo[51].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[51].DisplayFormat=0\nCampo[51].Alignment=1\nCampo[51].Width=-1\nCampo[52].FieldName=Tbl132_Total_Container_40\nCampo[52].Origin=Tbl132.Total_Container_40\nCampo[52].DisplayLabel=Total container 40\nCampo[52].Join.Enabled=1\nCampo[52].Join.Result=Total_Container_40\nCampo[52].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[52].DisplayFormat=0\nCampo[52].Alignment=1\nCampo[52].Width=-1\nCampo[53].FieldName=Tbl132_IdProposta_Frete\nCampo[53].Origin=Tbl132.IdProposta_Frete\nCampo[53].Foreign.Enabled=1\nCampo[53].Foreign.Divisao=Proposta_Frete\nCampo[53].Foreign.Campo=IdProposta_Frete\nCampo[53].Foreign.Tabela=mov_Proposta_Frete\nCampo[53].Join.Enabled=1\nCampo[53].Join.Result=IdProposta_Frete\nCampo[53].Join.Search=Tbl5_IdProposta_Frete_Carga\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\ANALITICO TAXAS\\RELATORIO ANALITICO TAXAS OK.chd",
        "conteudo": "[Consulta]\nCaption=Logística - House\nTabela=mov_Logistica_House\nCampos=47\nCommandText=Select,\"    Lcm.IdLogistica_House,\",\"    Lcm.IdLogistica_Taxa,\",\"    Lcm.IdTaxa_Logistica_Exibicao,\",\"    Lcm.Origem_Taxa,\",\"    case When (Tlc.IdTaxa_Logistica_Classificacao = 1) And (Lcm.Data_Recebimento Is Null) Then 'Adiantado' Else Null End As Taxas_Adiantadas,\",\"    Lhs.Numero_Processo,\",\"    Lcm.Taxa_Logistica_Exibicao,\",\"    Lcm.Moeda_Corrente,\",\"    Vnd.Nome_Fantasia As Vendedor,\",\"    Ept.Nome_Fantasia As Shipper,\",\"    Imp.Nome_Fantasia As Consignee,\",\"    case When Lms.Tipo_Operacao = 1 Then Ept.Nome_Fantasia Else Imp.Nome_Fantasia End As Importador_Exportador,\",\"    Lhs.Agenciamento_Carga,\",\"    Lhs.Desembaraco_Aduaneiro,\",\"    Lhs.Demurrage_Detention,\",\"    Lhs.Situacao_Agenciamento,\",\"    Lhs.Data_Acerto_Agente,\",\"    Lhs.Data_Fechamento_Cambio,\",\"    Lhs.Data_Liberado_Faturamento,\",\"    Lhs.Data_Faturado,\",\"    Lhs.Data_Auditado,\",\"    \",\"    /*Variacao Cambial*/\",\"    Case When ((Lcm.Moeda_Pagamento = Lcm.Moeda_Corrente) And (Lcm.Moeda_Recebimento = Lcm.Moeda_Corrente)) Then 0 /*Tudo em BRL*/ When (Lcm.Moeda_Pagamento <> Lcm.Moeda_Recebimento) Then 0 /*Moedas Diferentes, ignora a variacao*/ Else (coalesce(Lcm.Valor_Pagamento_Total,0) * (Lcm.Fator_Recebimento_Dinamico-(Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End))) End As Variacao_Cambial,\",,\"    /*Valores de Pagamento*/\",\"    coalesce(Ppg.Nome_Fantasia,Ppg.Nome) As Pessoa_Pagamento,\",\"    Lcm.Pagar_Para,\",\"    Lcm.Moeda_Pagamento,\",\"    Lcm.Valor_Pagamento_Total,\",\"    Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End As Fator_Pagamento_Dinamico,\",\"    Lcm.Valor_Pagamento_Dinamico,\",\"    Lcm.Data_Pagamento,\",\"    case When (Lcm.Valor_Pagamento_Total Is Null) Then 0 When (Lcm.Data_Pagamento Is Null) Then 1 Else 2 End As Pago,\",\"    Mfp.Sigla As Moeda_Fat_Pgto,\",\"    Ffp.Data_Referencia As Data_Vcto_Pgto,\",\"    Ffp.Valor_Original As Valor_Fat_Pgto,\",\"\tLcm.Numero_Fat_Pag,\",\" \",\"    /*Valores de Recebimento*/\",\"    coalesce(Prc.Nome_Fantasia,Prc.Nome) As Pessoa_Recebimento,\",\"    Lcm.Receber_De,\",\"    Lcm.Moeda_Recebimento,\",\"    Lcm.Valor_Recebimento_Total,\",\"    Lcm.Fator_Recebimento_Dinamico,\",\"    Lcm.Valor_Recebimento_Dinamico,\",\"    Lcm.Data_Recebimento,\",\"    case When (Lcm.Valor_Recebimento_Total Is Null) Then 0 When (Lcm.Data_Recebimento Is Null) Then 1 Else 2 End As Recebido,\",\"    Ffr.Valor_Original As Valor_Fat_Rcbto,\",\"    Ffr.Data_Referencia As Data_Vcto_Rcbto,\",\"    Mfr.Sigla AS Moeda_Fat_Rcbto,\",\"\tLcm.Numero_Fat_Rec,\",\"  \",\"    /*Saldos*/\",\"    Coalesce(Lcm.Valor_Recebimento_Dinamico, 0) - Coalesce(Lcm.Valor_Pagamento_Dinamico, 0) As Saldo_Dinamico,\",\"    Lcm.Saldo_Efetivo,\",\"    Lmd.Lucro_Momento As Lucro_Processo,\",\"    case When Lms.Tipo_Operacao = 1 /*Expo*/ Then Lms.Data_Embarque Else Lms.Data_Desembarque End As Data_Competencia,\",\"    Lhs.Data_Recebimento_Local As Data_Recebimento_Processo\",From,\"  (Select\",\"    Txs.IdLogistica_House,\",\"    Txs.IdLogistica_Taxa,\",\"    Txs.Origem_Taxa,\",\"    Txs.IdRegistro_Pagamento,\",\"    Txs.IdRegistro_Recebimento,\",\"    Txs.IdTaxa_Logistica_Exibicao,\",\"    Txs.Taxa_Logistica_Exibicao,\",\"    Txs.IdTaxa_Logistica_Classificacao,\",\"    Txs.Moeda_Corrente,\",,\"    /*Valores de Pagamento*/\",\"    Txs.IdPessoa_Pagamento,\",\"    Txs.Moeda_Pagamento,\",\"    Txs.Valor_Pagamento_Total,\",\"    Case\",\"      When Txs.Moeda_Pagamento = Txs.Moeda_Corrente Then 1\",\"      When (Tfp.Data_Pagamento is NUll) Then Txs.Fator_Pgto_Corrente\",\"      Else Txs.Fator_Pgto_Fatura \",\"    End As Fator_Pagamento_Dinamico,\",\"    Case\",\"      When (Tfp.Data_Pagamento is NUll) Then Txs.Pagamento_Corrente_Estimado\",\"      Else (ROUND(Case\",\"                    When Txs.Subtotal_Fatura_Pagamento = 0 Then 0\",\"                    Else Txs.Pagamento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Pagamento\",\"                    End * Tfp.Total_Pago_Corrente / 100, 2))\",\"    End As Valor_Pagamento_Dinamico,\",\"    Tfp.Data_Pagamento,\",\"    Txs.Pagar_Para,\",\"\tTxs.Numero_Fat_Pag,\",,\"    /*Valores de Recebimento*/\",\"    Txs.IdPessoa_Recebimento,\",\"    Txs.Moeda_Recebimento,\",\"    Txs.Valor_Recebimento_Total,\",\"    Case\",\"      When Txs.Moeda_Recebimento = Txs.Moeda_Corrente Then 1\",\"      When (Tfr.Data_Pagamento is NUll) Then Txs.Fator_Rcbto_Corrente\",\"      Else Txs.Fator_Rcbto_Fatura \",\"    End As Fator_Recebimento_Dinamico,\",\"    Case\",\"      When (Tfr.Data_Pagamento is NUll) Then Txs.Recebimento_Corrente_Estimado\",\"      Else (ROUND(Case\",\"                    When Txs.Subtotal_Fatura_Recebimento = 0 Then 0\",\"                    Else Txs.Recebimento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Recebimento\",\"                    End * Tfr.Total_Pago_Corrente / 100, 2))\",\"    End As Valor_Recebimento_Dinamico,\",\"    Tfr.Data_Pagamento As Data_Recebimento,\",\"    Txs.Receber_De,\",\"\tTxs.Numero_Fat_Rec,\",\"  \",\"    /*Saldos*/\",\"    Coalesce(Txs.Recebimento_Corrente_Estimado, 0) \",\"    - Coalesce(Txs.Pagamento_Corrente_Estimado, 0) As Saldo_Estimado,\",,\"    Coalesce(ROUND(Case\",\"      When Txs.Subtotal_Fatura_Recebimento = 0 Then 0\",\"      Else Txs.Recebimento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Recebimento\",\"    End * Tfr.Total_Pago_Corrente / 100, 2), 0)\",\"    - Coalesce(ROUND(Case\",\"      When Txs.Subtotal_Fatura_Pagamento = 0 Then 0\",\"      Else Txs.Pagamento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Pagamento\",\"    End * Tfp.Total_Pago_Corrente / 100, 2), 0) As Saldo_Efetivo\",\"  From\",\"   (Select\",\"      Ltx.IdLogistica_House,\",\"      Ltx.IdTaxa_Logistica_Classificacao,\",\"      Ltx.IdLogistica_Taxa,\",\"      Ltx.IdPessoa_Pagamento,\",\"      Ltx.IdPessoa_Recebimento,\",\"      Ltx.IdRegistro_Pagamento,\",\"      Ltx.Origem_Taxa,\",\"      Ltx.IdRegistro_Recebimento,\",\"      Ltx.IdTaxa_Logistica_Exibicao,\",\"      Tle.Nome As Taxa_Logistica_Exibicao,\",\"      Mcr.Sigla As Moeda_Corrente,\",\"      Mrc.Sigla As Moeda_Recebimento,\",\"      Ltx.Valor_Recebimento_Total,\",\"      Mpg.Sigla As Moeda_Pagamento,\",\"      Ltx.Valor_Pagamento_Total,\",\"      Ltx.Pagar_Para,\",\"      Ltx.Receber_De,\",\"      Ffr.Fator_Conversao As Fator_Rcbto_Fatura,\",\"      Ffp.Fator_Conversao As Fator_Pgto_Fatura,\",\"      Fcr.Fator_Conversao As Fator_Rcbto_Corrente,\",\"      Fcp.Fator_Conversao As Fator_Pgto_Corrente,      \",\"      Case\",\"        When (Ltx.IdMoeda_Pagamento = Mcr.IdMoeda) Or (Ltx.Valor_Pagamento_Total Is NULL) Then Ltx.Valor_Pagamento_Total\",\"        When (Fcp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento And Fcp.IdMoeda_Destino = Mcr.IdMoeda) Then ROUND(Ltx.Valor_Pagamento_Total * Fcp.Fator_Conversao, 2)\",\"        When (Fcp.IdMoeda_Origem = Mcr.IdMoeda And Fcp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento) And (Coalesce(Fcp.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Pagamento_Total / Fcp.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Pagamento_Corrente_Estimado,\",\"      Case\",\"        When (Ltx.IdMoeda_Recebimento = Mcr.IdMoeda) Or (Ltx.Valor_Recebimento_Total Is NULL) Then Ltx.Valor_Recebimento_Total\",\"        When (Fcr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento And Fcr.IdMoeda_Destino = Mcr.IdMoeda) Then ROUND(Ltx.Valor_Recebimento_Total * Fcr.Fator_Conversao, 2)\",\"        When (Fcr.IdMoeda_Origem = Mcr.IdMoeda And Fcr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento) And (Coalesce(Fcr.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Recebimento_Total / Fcr.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Recebimento_Corrente_Estimado,\",\"      Case\",\"        When (Ltx.IdMoeda_Pagamento = Lfp.IdMoeda) Or (Ltx.Valor_Pagamento_Total Is NULL) Then Ltx.Valor_Pagamento_Total\",\"        When (Ffp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento) And (Ffp.IdMoeda_Destino = Lfp.IdMoeda) Then ROUND(Ltx.Valor_Pagamento_Total * Ffp.Fator_Conversao, 2)\",\"        When (Ffp.IdMoeda_Origem = Lfp.IdMoeda) And (Ffp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento) And (Coalesce(Ffp.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Pagamento_Total / Ffp.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Pagamento_Convertido_Fatura,\",\"      Case\",\"        When (Ltx.IdMoeda_Recebimento = Lfr.IdMoeda) Or (Ltx.Valor_Recebimento_Total Is NULL) Then Ltx.Valor_Recebimento_Total\",\"        When (Ffr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento) And (Ffr.IdMoeda_Destino = Lfr.IdMoeda) Then ROUND(Ltx.Valor_Recebimento_Total * Ffr.Fator_Conversao, 2)\",\"        When (Ffr.IdMoeda_Origem = Lfr.IdMoeda) And (Ffr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento) And (Coalesce(Ffr.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Recebimento_Total / Ffr.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Recebimento_Convertido_Fatura,\",\"      Lfp.Subtotal As Subtotal_Fatura_Pagamento,\",\"      Lfr.Subtotal As Subtotal_Fatura_Recebimento,\",\"      Lfp.Situacao as Pagamento_Situacao,\",\"      Lfp.Natureza as Pagamento_Natureza,\",\"      Lfr.Situacao as Recebimento_Situacao,\",\"      Lfr.Natureza as Recebimento_Natureza,\",\"\t  Lfp.Numero as Numero_Fat_Pag,\",\"\t  Lfr.Numero as Numero_Fat_Rec\",\"    From\",\"      mov_Logistica_Taxa Ltx\",\"    Left Outer Join\",\"      cad_Moeda Mcr On Mcr.Moeda_Corrente = 1\",\"    Left Outer Join\",\"      cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\",\"    Left Outer Join\",\"      cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\",\"    Left Outer Join\",\"      cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao  \",\"    Left Outer Join\",\"      vis_Logistica_Fatura Lfp On Lfp.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\",\"    Left Outer Join\",\"      vis_Logistica_Fatura Lfr On Lfr.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\",\"    Left Outer Join /* Fator Corrente Pagamento */\",\"      mov_Logistica_Fatura_Conversao Fcp On Fcp.IdLogistica_Fatura = Lfp.IdRegistro_Financeiro\",\"        And ((Fcp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento And Fcp.IdMoeda_Destino = Mcr.IdMoeda)\",\"        Or (Fcp.IdMoeda_Origem = Mcr.IdMoeda And Fcp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento))\",\"    Left Outer Join /* Fator Corrente Recebimento */\",\"      mov_Logistica_Fatura_Conversao Fcr On Fcr.IdLogistica_Fatura = Lfr.IdRegistro_Financeiro\",\"        And ((Fcr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento And Fcr.IdMoeda_Destino = Mcr.IdMoeda)\",\"        Or (Fcr.IdMoeda_Origem = Mcr.IdMoeda And Fcr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento))\",\"    Left Outer Join /* Fator Fatura Pagamento */\",\"      mov_Logistica_Fatura_Conversao Ffp On Ffp.IdLogistica_Fatura = Lfp.IdRegistro_Financeiro\",\"        And ((Ffp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento And Ffp.IdMoeda_Destino = Lfp.IdMoeda)\",\"        Or (Ffp.IdMoeda_Origem = Lfp.IdMoeda And Ffp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento))\",\"    Left Outer Join /* Fator Fatura Recebimento */\",\"      mov_Logistica_Fatura_Conversao Ffr On Ffr.IdLogistica_Fatura = Lfr.IdRegistro_Financeiro\",\"        And ((Ffr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento And Ffr.IdMoeda_Destino = Lfr.IdMoeda)\",\"        Or (Ffr.IdMoeda_Origem = Lfr.IdMoeda And Ffr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento))\",\"  ) Txs\",\"  Left Outer Join\",\"    Mov_Logistica_House Lhs on Lhs.IdLogistica_House = Txs.IdLogistica_House\",\"  Left Outer Join /* Totaliza as faturas de Pagamento */\",\"    (Select\",\"      Ffn.IdRegistro_Financeiro,\",\"      Ffn.Natureza,\",\"      Ffn.Situacao,\",\"      Max(Ffn.Data_Pagamento) As Data_Pagamento,\",\"      Sum(Coalesce(Ffn.Total_Pago_Corrente, 0) + Coalesce(Ffn.Total_Pago_Corrente_Unificado, 0)) As Total_Pago_Corrente\",\"    From\",\"      (Select\",\"        Lft.IdRegistro_Financeiro,\",\"        Lft.Natureza,\",\"        Lft.Situacao,\",\"        Ffn.Total_Pago_Corrente,\",\"        Run.IdMoeda,\",\"        Case\",\"          When Ffn.Data_Pagamento Is NULL Then Fun.Data_Pagamento\",\"          When Fun.Data_Pagamento Is NULL Then Ffn.Data_Pagamento\",\"          When Ffn.Data_Pagamento >= Fun.Data_Pagamento Then Ffn.Data_Pagamento\",\"          Else Fun.Data_Pagamento\",\"        End As Data_Pagamento,\",\"        CAST(ROUND(Case /* Obtêm o Percentual da Fatura Unificada no Registro Unificador */\",\"          When (Run.IdRegistro_Financeiro is NULL) or (Run.Subtotal = 0) Then 0\",\"          When (Lft.IdMoeda <> Run.IdMoeda) Then ROUND(Ffn.Valor_Residual * Ffn.Fator_Unificacao * 100, 2) / Run.Subtotal\",\"          Else Ffn.Valor_Residual * 100 / Run.Subtotal\",\"        End * Fun.Total_Pago_Corrente_Unificado / 100, 2) As Numeric(19, 2)) As Total_Pago_Corrente_Unificado\",\"      From\",\"        vis_Logistica_Fatura Lft\",\"      Join\",\"        mov_Fatura_Financeira Ffn On Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro  \",\"      Left Outer Join\",\"        mov_Registro_Financeiro Run On Run.IdRegistro_Financeiro = Ffn.IdRegistro_Unificador\",\"      Left Outer Join\",\"        (Select\",\"          Fun.IdRegistro_Financeiro,\",\"          Fun.Natureza,\",\"          Fun.Situacao,\",\"          MAX(Fun.Data_Pagamento) As Data_Pagamento,\",\"          SUM(Fun.Total_Pago_Corrente) As Total_Pago_Corrente_Unificado\",\"        From\",\"          mov_Fatura_Financeira Fun\",\"        Group BY\",\"          Fun.IdRegistro_Financeiro,\",\"          fun.Situacao,\",\"          fun.Natureza  \",\"        ) As Fun On Fun.IdRegistro_Financeiro = Run.IdRegistro_Financeiro\",\"      ) Ffn\",\"    Group By\",\"      Ffn.IdRegistro_Financeiro,\",\"      Ffn.Situacao,\",\"      Ffn.Natureza\",\"    ) Tfp On Tfp.IdRegistro_Financeiro = Txs.IdRegistro_Pagamento\",\"  Left Outer Join /* Totaliza as faturas de recebimento */\",\"    (Select\",\"      Ffn.IdRegistro_Financeiro,\",\"      MAX(Ffn.Data_Pagamento) As Data_Pagamento,\",\"      SUM(Coalesce(Ffn.Total_Pago_Corrente, 0) + Coalesce(Ffn.Total_Pago_Corrente_Unificado, 0)) As Total_Pago_Corrente\",\"    From\",\"      (Select\",\"        Lft.IdRegistro_Financeiro,\",\"        Ffn.Total_Pago_Corrente,\",\"        Ffn.Situacao,\",\"        Ffn.Natureza,\",\"        Run.IdMoeda,        \",\"        Case\",\"          When Ffn.Data_Pagamento Is NULL Then Fun.Data_Pagamento\",\"          When Fun.Data_Pagamento Is NULL Then Ffn.Data_Pagamento\",\"          When Ffn.Data_Pagamento >= Fun.Data_Pagamento Then Ffn.Data_Pagamento\",\"          Else Fun.Data_Pagamento\",\"        End As Data_Pagamento,\",\"        CAST(ROUND(Case /* Obtêm o Percentual da Fatura Unificada no Registro Unificador */\",\"          When (Run.IdRegistro_Financeiro is NULL) or (Run.Subtotal = 0) Then 0\",\"          When (Lft.IdMoeda <> Run.IdMoeda) Then ROUND(Ffn.Valor_Residual * Ffn.Fator_Unificacao * 100, 2) / Run.Subtotal\",\"          Else Ffn.Valor_Residual * 100 / Run.Subtotal\",\"        End * Fun.Total_Pago_Corrente_Unificado / 100, 2) As Numeric(19, 2)) As Total_Pago_Corrente_Unificado\",\"      From\",\"        vis_Logistica_Fatura Lft\",\"      Join\",\"        mov_Fatura_Financeira Ffn On Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro  \",\"      Left Outer Join\",\"        mov_Registro_Financeiro Run On Run.IdRegistro_Financeiro = Ffn.IdRegistro_Unificador\",\"      Left Outer Join\",\"        (Select\",\"          Fun.IdRegistro_Financeiro,\",\"          Fun.Situacao,\",\"          Fun.Natureza,\",\"          MAX(Fun.Data_Pagamento) As Data_Pagamento,\",\"          SUM(Fun.Total_Pago_Corrente) As Total_Pago_Corrente_Unificado\",\"        From\",\"          mov_Fatura_Financeira Fun\",\"        Group BY\",\"          Fun.IdRegistro_Financeiro,\",\"          Fun.Situacao,\",\"          Fun.Natureza  \",\"        ) As Fun On Fun.IdRegistro_Financeiro = Run.IdRegistro_Financeiro\",\"      ) Ffn\",\"    Group By\",\"      Ffn.IdRegistro_Financeiro,\",\"      Ffn.Situacao,\",\"      Ffn.Natureza\",\"    ) Tfr On Tfr.IdRegistro_Financeiro = Txs.IdRegistro_Recebimento\",\"  ) Lcm\",\"Left Outer Join\",\"  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Lcm.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",\"Left Outer Join\",\"  cad_Pessoa Ppg On Ppg.IdPessoa = Lcm.IdPessoa_Pagamento  \",\"Left Outer Join\",\"  cad_Pessoa Prc On Prc.IdPessoa = Lcm.IdPessoa_Recebimento\",\"Left Outer Join\",\"  vis_Logistica_Fatura Ffp on Ffp.IdRegistro_Financeiro = Lcm.IdRegistro_Pagamento\",\"Left Outer Join\",\"  vis_Logistica_Fatura Ffr on Ffr.IdRegistro_Financeiro = Lcm.IdRegistro_Recebimento   \",\"Left Outer Join\",\"  cad_Moeda Mfp on Mfp.IdMoeda = Ffp.IdMoeda\",\"Left Outer Join\",\"  cad_Moeda Mfr on Mfr.IdMoeda = Ffr.IdMoeda\",\"Left Outer Join\",\"  cad_Moeda Mcr On Mcr.Moeda_Corrente = 1\",\"Left Outer Join\",\"  mov_Logistica_Moeda Lmd On Lmd.IdLogistica_House = Lhs.IdLogistica_House And Lmd.IdMoeda = Mcr.IdMoeda\",\"Left Outer Join\",\"  cad_Taxa_Logistica_Classificacao Tlc on Tlc.IdTaxa_Logistica_Classificacao = Lcm.IdTaxa_Logistica_Classificacao\",\"Left Outer Join\",\"  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\",\"Left Outer Join\",\"  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\",/*WHERE*/,\"Order by\",\"  Lcm.IdLogistica_House\"\n\n[Campos]\nCampo[0].FieldName=IdLogistica_Taxa\nCampo[0].Origin=Lcm.IdLogistica_Taxa\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Taxa_Logistica_Exibicao\nCampo[1].Origin=Lcm.Taxa_Logistica_Exibicao\nCampo[1].DisplayLabel=Taxa\nCampo[1].Width=100\nCampo[2].FieldName=Numero_Processo\nCampo[2].Origin=Lhs.Numero_Processo\nCampo[2].DisplayLabel=Processo\nCampo[2].Width=80\nCampo[3].FieldName=Pessoa_Pagamento\nCampo[3].Origin=coalesce(Ppg.Nome_Fantasia,Ppg.Nome)\nCampo[3].DisplayLabel=Pessoa Pgto\nCampo[3].Width=120\nCampo[4].FieldName=Moeda_Pagamento\nCampo[4].Origin=Lcm.Moeda_Pagamento\nCampo[4].DisplayLabel=Moeda Pgto\nCampo[4].Width=40\nCampo[5].FieldName=Valor_Pagamento_Total\nCampo[5].Origin=Lcm.Valor_Pagamento_Total\nCampo[5].DisplayLabel=Valor Pgto\nCampo[5].DisplayFormat=#,0.00\nCampo[5].Width=70\nCampo[6].FieldName=Fator_Pagamento_Dinamico\nCampo[6].Origin=Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End\nCampo[6].DisplayLabel=Fator Pgto\nCampo[6].DisplayFormat=#,0.0000\nCampo[6].Width=70\nCampo[7].FieldName=Valor_Pagamento_Dinamico\nCampo[7].Origin=Lcm.Valor_Pagamento_Dinamico\nCampo[7].DisplayLabel=Valor Pgto BRL\nCampo[7].DisplayFormat=#,0.00\nCampo[7].Width=70\nCampo[8].FieldName=Data_Pagamento\nCampo[8].Origin=Lcm.Data_Pagamento\nCampo[8].DisplayLabel=Data Pgto\nCampo[8].DisplayFormat=dd/mm/yyyy\nCampo[8].Width=70\nCampo[9].FieldName=Pagar_Para\nCampo[9].Origin=Lcm.Pagar_Para\nCampo[9].DisplayLabel=Tipo Pessoa Pagto\nCampo[9].Width=50\nCampo[9].Items=0,1,2,3,13,9,4,5,6,10,11,12,15,14,7,8\nCampo[9].ItemsEx=\"Sem pagamento)\",Agencia,\"Agente Origem\", \"Agente Destino\",\"Associação Internacional\",Cliente, Comissionado, \"Cia Transporte\", Despachante, Exportador, Importador, Representante, \"Representante DF\", Seguradora, Vendedor, Outro\nCampo[9].Alignment=0\nCampo[10].FieldName=Pago\nCampo[10].Origin=case When (Lcm.Valor_Pagamento_Total Is Null) Then 0 When (Lcm.Data_Pagamento Is Null) Then 1 Else 2 End\nCampo[10].DisplayLabel=Pago\nCampo[10].Width=50\nCampo[10].Items=0,1,2\nCampo[10].ItemsEx=\"Sem cobrança\",\"Em aberto\",\"Pago\"\nCampo[10].Alignment=0\nCampo[11].FieldName=Data_Vcto_Pgto\nCampo[11].Origin=Ffp.Data_Referencia\nCampo[11].DisplayLabel=Data Vcto Pgto\nCampo[11].DisplayFormat=dd/mm/yyyy\nCampo[11].Width=70\nCampo[12].FieldName=Moeda_Fat_Pgto\nCampo[12].Origin=Mfp.Sigla\nCampo[12].DisplayLabel=Moeda Fat Pgto\nCampo[12].Width=40\nCampo[13].FieldName=Valor_Fat_Pgto\nCampo[13].Origin=Ffp.Valor_Original\nCampo[13].DisplayLabel=Valor Fat Pgto\nCampo[13].DisplayFormat=#,0.00\nCampo[13].Width=70\nCampo[14].FieldName=Numero_Fat_Pag\nCampo[14].DisplayLabel=Numero_Fat_Pag\nCampo[14].Origin=Lcm.Numero_Fat_Pag\nCampo[14].Width=70\nCampo[15].FieldName=Pessoa_Recebimento\nCampo[15].Origin=coalesce(Prc.Nome_Fantasia,Prc.Nome)\nCampo[15].DisplayLabel=Pessoa Rcbto\nCampo[15].Width=120\nCampo[16].FieldName=Receber_De\nCampo[16].Origin=Lcm.Receber_De\nCampo[16].DisplayLabel=Tipo Pessoa Rcbto\nCampo[16].Width=50\nCampo[16].Items=0,1,2,10,3,4,8,5,6,9,7\nCampo[16].ItemsEx=\"(Sem recebimento)\",\"Agente  Origem\", \"Agente Destino\", Associação, Cliente, Comissionado, \"Cia Transporte\", Exportador, Importador, Notify, Outro\nCampo[16].Alignment=0\nCampo[17].FieldName=Moeda_Recebimento\nCampo[17].Origin=Lcm.Moeda_Recebimento\nCampo[17].DisplayLabel=Moeda Rcbto\nCampo[17].Width=40\nCampo[18].FieldName=Valor_Recebimento_Total\nCampo[18].Origin=Lcm.Valor_Recebimento_Total\nCampo[18].DisplayLabel=Valor Rcbto\nCampo[18].DisplayFormat=#,0.00\nCampo[18].Width=70\nCampo[19].FieldName=Fator_Recebimento_Dinamico\nCampo[19].Origin=Lcm.Fator_Recebimento_Dinamico\nCampo[19].DisplayLabel=Fator Rcbto\nCampo[19].DisplayFormat=#,0.0000\nCampo[19].Width=70\nCampo[20].FieldName=Valor_Recebimento_Dinamico\nCampo[20].Origin=Lcm.Valor_Recebimento_Dinamico\nCampo[20].DisplayLabel=Valor Rcbto BRL\nCampo[20].DisplayFormat=#,0.00\nCampo[20].Width=70\nCampo[21].FieldName=Data_Recebimento\nCampo[21].Origin=Lcm.Data_Recebimento\nCampo[21].DisplayLabel=Data Rcbto\nCampo[21].DisplayFormat=dd/mm/yyyy\nCampo[21].Width=70\nCampo[22].FieldName=Recebido\nCampo[22].Origin=case When (Lcm.Valor_Recebimento_Total Is Null) Then 0 When (Lcm.Data_Recebimento Is Null) Then 1 Else 2 End\nCampo[22].DisplayLabel=Recebido\nCampo[22].Width=50\nCampo[22].Items=0,1,2\nCampo[22].ItemsEx=\"Sem cobrança\",\"Em aberto\",\"Recebido\"\nCampo[22].Alignment=0\nCampo[23].FieldName=Data_Vcto_Rcbto\nCampo[23].Origin=Ffr.Data_Referencia\nCampo[23].DisplayLabel=Data Vcto Rcbto\nCampo[23].DisplayFormat=dd/mm/yyyy\nCampo[23].Width=70\nCampo[24].FieldName=Moeda_Fat_Rcbto\nCampo[24].Origin=Mfr.Sigla\nCampo[24].DisplayLabel=Moeda Fat Rcbto\nCampo[24].Width=40\nCampo[25].FieldName=Valor_Fat_Rcbto\nCampo[25].Origin=Ffr.Valor_Original\nCampo[25].DisplayLabel=Valor Fat Rcbto\nCampo[25].DisplayFormat=#,0.00\nCampo[25].Width=70\nCampo[26].FieldName=Numero_Fat_Rec\nCampo[26].DisplayLabel=Numero_Fat_Rec\nCampo[26].Origin=Lcm.Numero_Fat_Rec\nCampo[26].Width=70\nCampo[27].FieldName=Saldo_Dinamico\nCampo[27].Origin=Coalesce(Lcm.Valor_Recebimento_Dinamico, 0) - Coalesce(Lcm.Valor_Pagamento_Dinamico, 0)\nCampo[27].DisplayLabel=Saldo Estimado Taxa\nCampo[27].DisplayFormat=#,0.00\nCampo[27].Width=70\nCampo[28].FieldName=Saldo_Efetivo\nCampo[28].Origin=Lcm.Saldo_Efetivo\nCampo[28].DisplayLabel=Saldo Efetivo Taxa\nCampo[28].DisplayFormat=#,0.00\nCampo[28].Width=70\nCampo[29].FieldName=Lucro_Processo\nCampo[29].Origin=Lmd.Lucro_Momento\nCampo[29].DisplayLabel=Profit Estimado Processo\nCampo[29].DisplayFormat=#,0.00\nCampo[29].Width=70\nCampo[30].FieldName=Data_Recebimento_Processo\nCampo[30].Origin=Lhs.Data_Recebimento_Local\nCampo[30].DisplayLabel=Data Recebimento Processo\nCampo[30].DisplayFormat=dd/mm/yyyy\nCampo[30].Width=70\nCampo[31].FieldName=Data_Competencia\nCampo[31].Origin=case When Lms.Tipo_Operacao = 1 /*Expo*/ Then Lms.Data_Embarque Else Lms.Data_Desembarque End\nCampo[31].DisplayLabel=Data Competência\nCampo[31].DisplayFormat=dd/mm/yyyy\nCampo[32].FieldName=Taxas_Adiantadas\nCampo[32].Origin=case When (Tlc.IdTaxa_Logistica_Classificacao = 1) And (Lcm.Data_Recebimento Is Null) Then 'Adiantado' Else Null End\nCampo[32].DisplayLabel=Adiantado\nCampo[32].Width=70\nCampo[33].FieldName=Variacao_Cambial\nCampo[33].Origin=Case When ((Lcm.Moeda_Pagamento = Lcm.Moeda_Corrente) And (Lcm.Moeda_Recebimento = Lcm.Moeda_Corrente)) Then 0 /*Tudo em BRL*/ When (Lcm.Moeda_Pagamento <> Lcm.Moeda_Recebimento) Then 0 /*Moedas Diferentes, ignora a variacao*/ Else (coalesce(Lcm.Valor_Pagamento_Total,0) * (Lcm.Fator_Recebimento_Dinamico-(Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End))) End\nCampo[33].DisplayLabel=Variacao Cambial\nCampo[33].DisplayFormat=#,0.00\nCampo[33].Width=70\nCampo[34].FieldName=Vendedor\nCampo[34].Origin=Vnd.Nome_Fantasia\nCampo[34].DisplayLabel=Vendedor\nCampo[34].Width=120\nCampo[35].FieldName=Shipper\nCampo[35].Origin=Ept.Nome_Fantasia\nCampo[35].DisplayLabel=Shipper\nCampo[35].Width=120\nCampo[36].FieldName=Consignee\nCampo[36].Origin=Imp.Nome_Fantasia\nCampo[36].DisplayLabel=Consignee\nCampo[36].Width=120\nCampo[37].FieldName=Importador_Exportador\nCampo[37].Origin=case When Lms.Tipo_Operacao = 1 Then Ept.Nome_Fantasia Else Imp.Nome_Fantasia End\nCampo[37].DisplayLabel=Shipper_Consignee\nCampo[37].Width=120\nCampo[38].FieldName=Agenciamento_Carga\nCampo[38].Origin=Lhs.Agenciamento_Carga\nCampo[38].DisplayLabel=Agenciamento\nCampo[38].Width=70\nCampo[39].FieldName=Desembaraco_Aduaneiro\nCampo[39].Origin=Lhs.Desembaraco_Aduaneiro\nCampo[39].DisplayLabel=Desembaraço\nCampo[39].Width=70\nCampo[40].FieldName=Demurrage_Detention\nCampo[40].Origin=Lhs.Demurrage_Detention\nCampo[40].DisplayLabel=Demurrage/Detention\nCampo[40].Width=70\nCampo[41].FieldName=Data_Fechamento_Processo\nCampo[41].Origin=Lhs.Data_Fechamento_Processo\nCampo[41].DisplayLabel=Data Finalizado\nCampo[41].DisplayFormat=dd/mm/yyyy\nCampo[41].Width=70\nCampo[42].FieldName=Data_Acerto_Agente\nCampo[42].Origin=Lhs.Data_Acerto_Agente\nCampo[42].DisplayLabel=Data Acerto Agente\nCampo[42].DisplayFormat=dd/mm/yyyy\nCampo[42].Width=70\nCampo[43].FieldName=Data_Liberado_Faturamento\nCampo[43].Origin=Lhs.Data_Liberado_Faturamento\nCampo[43].DisplayLabel=Data Liberado Faturamento\nCampo[43].DisplayFormat=dd/mm/yyyy\nCampo[43].Width=70\nCampo[44].FieldName=Situacao_Agenciamento\nCampo[44].Origin=Lhs.Situacao_Agenciamento\nCampo[44].DisplayLabel=Situação Agenciamento\nCampo[44].Width=80\nCampo[44].Items=1,2,3,4,5,6,7\nCampo[44].ItemsEx=\"Processo Aberto\",\"Em andamento\",\"Liberado Faturamento \",\"Faturado\",\"Finalizado\",\"Auditado\",Cancelado\nCampo[44].Alignment=0\nCampo[45].FieldName=Data_Faturado\nCampo[45].Origin=Lhs.Data_Faturado\nCampo[45].DisplayLabel=Data Faturado\nCampo[45].DisplayFormat=dd/mm/yyyy\nCampo[45].Width=70\nCampo[46].FieldName=Data_Auditado\nCampo[46].Origin=Lhs.Data_Auditado\nCampo[46].DisplayLabel=Data Auditado\nCampo[46].DisplayFormat=dd/mm/yyyy\nCampo[46].Width=70\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\COMISSÃO VENDEDOR\\Sql consulta comissão vendedor.chd",
        "conteudo": "[Consulta]\nCampos=12\nCommandText=Select,\"ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"Lhs.Numero_Processo,\",\"Lhs.Data_Abertura_Processo,\",\"Case When Lhs.Situacao_Agenciamento = 1 Then 'Processo Aberto' When Lhs.Situacao_Agenciamento = 2 Then 'Em Andamento' When Lhs.Situacao_Agenciamento = 3 Then 'Liberado Faturamento' When Lhs.Situacao_Agenciamento = 4 Then 'Faturado' When Lhs.Situacao_Agenciamento = 5 Then 'Finalizado' When Lhs.Situacao_Agenciamento = 6 Then 'Auditado' When Lhs.Situacao_Agenciamento = 7 Then 'Cancelado' End as Situacao_Agenciamento,\",\"Lft.Numero as Numero_Fatura,\",\"Lft.Data as Data_Insercao_Fatura,\",\"Ffn.Data_Vencimento,\",\"Psa.Nome as Vendedor,\",\"Moe.Sigla as Moeda,\",\"Lft.Valor_Original,\",\"Lft.Fator_Corrente,\",Lft.Valor_Corrente,From,\"  Vis_Logistica_Fatura Lft\",\"Left outer join\",\"  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Lft.IdLogistica_House\",\"Left outer Join\",\"  mov_Fatura_Financeira Ffn on Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\",\"Left outer join\",\"  cad_Pessoa Psa on Psa.IdPessoa = Lft.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Moe on Moe.IdMoeda = Lft.IdMoeda\",/*WHERE*/,Where,\"  Lft.Tipo_Fatura = 8 /*Vendedor*/ and Lft.Valor_Corrente <> 0\"\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].DisplayLabel=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].Width=50\nCampo[1].FieldName=Numero_Processo\nCampo[1].DisplayLabel=Numero_Processo\nCampo[1].Origin=Lhs.Numero_Processo\nCampo[1].Width=100\nCampo[2].FieldName=Data_Abertura_Processo\nCampo[2].DisplayLabel=Data_Abertura_Processo\nCampo[2].Origin=Lhs.Data_Abertura_Processo\nCampo[2].Width=100\nCampo[3].FieldName=Situacao_Agenciamento\nCampo[3].DisplayLabel=Situacao_Agenciamento\nCampo[3].Origin=Case When Lhs.Situacao_Agenciamento = 1 Then 'Processo Aberto' When Lhs.Situacao_Agenciamento = 2 Then 'Em Andamento' When Lhs.Situacao_Agenciamento = 3 Then 'Liberado Faturamento' When Lhs.Situacao_Agenciamento = 4 Then 'Faturado' When Lhs.Situacao_Agenciamento = 5 Then 'Finalizado' When Lhs.Situacao_Agenciamento = 6 Then 'Auditado' When Lhs.Situacao_Agenciamento = 7 Then 'Cancelado' End\nCampo[3].Width=150\nCampo[4].FieldName=Numero_Fatura\nCampo[4].DisplayLabel=Numero_Fatura\nCampo[4].Origin=Lft.Numero\nCampo[4].Width=100\nCampo[5].FieldName=Data_Insercao_Fatura\nCampo[5].DisplayLabel=Data_Insercao_Fatura\nCampo[5].Origin=Lft.Data\nCampo[5].Width=100\nCampo[6].FieldName=Data_Vencimento\nCampo[6].DisplayLabel=Data_Vencimento\nCampo[6].Origin=Ffn.Data_Vencimento\nCampo[6].Width=100\nCampo[7].FieldName=Vendedor\nCampo[7].DisplayLabel=Vendedor\nCampo[7].Origin=Psa.Nome\nCampo[7].Width=200\nCampo[8].FieldName=Moeda\nCampo[8].DisplayLabel=Moeda\nCampo[8].Origin=Moe.Sigla\nCampo[8].Width=80\nCampo[9].FieldName=Valor_Original\nCampo[9].DisplayLabel=Valor_Original\nCampo[9].Origin=Lft.Valor_Original\nCampo[9].Width=100\nCampo[10].FieldName=Fator_Corrente\nCampo[10].DisplayLabel=Fator_Corrente\nCampo[10].Origin=Lft.Fator_Corrente\nCampo[10].Width=100\nCampo[11].FieldName=Valor_Corrente\nCampo[11].DisplayLabel=Valor_Corrente\nCampo[11].Origin=Lft.Valor_Corrente\nCampo[11].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\CONTAS A PAGAR\\RELATORIO CONTAS A PAGAR OK.chd",
        "conteudo": "[Consulta]\nCampos=15\nCommandText=Select,\"  ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"  Lft.Referencia,\",\"  Lft.Referencia_Externa,\",\"  Lft.Numero AS Numero_Fatura,\",\"  Lft.Data,\",\"  DATEDIFF(day, Getdate(), Lft.Data_Referencia) AS Dias_Vencimento_Vencido,\",\"  Case\",\"    When Lft.Natureza = 0 Then 'DÉBITO'\",\"\tWhen Lft.Natureza = 1 Then 'CRÉDITO'\",\"  End As Natureza,\",\"  Lft.Data_Referencia,\",\"  Ttc.Nome AS Tipo_Transacao,\",\"  Psa.Nome AS Pessoa,\",\"  Case\",\"    When Lft.Situacao = 1 Then 'EM ABERTO'\",\"\tWhen Lft.Situacao = 2 Then 'QUITADA'\",\"\tWhen Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA'\",\"\tWhen Lft.Situacao = 4 Then 'UNIFICADA'\",\"\tWhen Lft.Situacao = 5 Then 'EM COBRANÇA'\",\"\tWhen Lft.Situacao = 6 Then 'CANCELADA'\",\"\tWhen Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL'\",\"\tWhen Lft.Situacao = 8 Then 'NEGATIVADO'\",\"\tWhen Lft.Situacao = 9 Then 'PROTESTADO'\",\"\tWhen Lft.Situacao = 10 Then 'JUNK'\",\"  End As Situacao,\",\"  Case\",\"    When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO'\",\"\tWhen Lft.Tipo_Fatura = 3 Then 'AGENTE'\",\"\tWhen Lft.Tipo_Fatura = 4 Then 'COMISSÃO'\",\"\tWhen Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS'\",\"\tWhen Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO'\",\"\tWhen Lft.Tipo_Fatura = 8 Then 'VENDEDOR'\",\"\tWhen Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE'\",\"\tWhen Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL'\",\"\tWhen Lft.Tipo_Fatura = 13 Then 'SEGURADORA'\",\"\tWhen Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE'\",\"\tWhen Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT'\",\"\tWhen Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE'\",\"\tWhen Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE'\",\"  End As Tipo_Fatura,\",\"  Lft.Data_Pagamento,\",\"  Mda.Sigla AS Moeda,\",\"  FORMAT(Lft.Valor_Total, 'N', 'pt-BR') AS Valor_Total,\",\"  FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR') AS Valor_Residual\",,From,\"  vis_Logistica_Fatura_Totais Lft\",,/*OPERACIONAL*/,\"   \",,/*CADASTRO*/,\"Left Outer Join\",\"  cad_Tipo_Transacao Ttc ON Ttc.IdTipo_Transacao = Lft.IdTipo_Transacao\",\"Left Outer Join\",\"  cad_Pessoa Psa ON Psa.IdPessoa = Lft.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda ON Mda.IdMoeda = Lft.IdMoeda\",Where,\"  Lft.Natureza = 0 /*Débito*/\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Referencia\nCampo[1].DisplayLabel=Referência\nCampo[1].Origin=Lft.Referencia\nCampo[1].Width=100\nCampo[2].FieldName=Numero_Fatura\nCampo[2].DisplayLabel=Número Fatura\nCampo[2].Origin=Lft.Numero_Fatura\nCampo[2].Width=100\nCampo[3].FieldName=Data\nCampo[3].DisplayLabel=Data\nCampo[3].Origin=Lft.Data\nCampo[3].Width=100\nCampo[3].DisplayFormat=dd/mm/yyyy\nCampo[4].FieldName=Dias_Vencimento_Vencido\nCampo[4].DisplayLabel=Dias a Vencer/Vencido\nCampo[4].Origin=DATEDIFF(day, Getdate(), Lft.Data_Referencia)\nCampo[4].Width=50\nCampo[5].FieldName=Natureza\nCampo[5].DisplayLabel=Natureza\nCampo[5].Origin=Case When Lft.Natureza = 0 Then 'DÉBITO' When Lft.Natureza = 1 Then 'CRÉDITO' End\nCampo[5].Width=100\nCampo[6].FieldName=Data_Referencia\nCampo[6].DisplayLabel=Data Referência\nCampo[6].Origin=LFt.Data_Referencia\nCampo[6].Width=100\nCampo[6].DisplayFormat=dd/mm/yyyy\nCampo[7].FieldName=Tipo_Transacao\nCampo[7].DisplayLabel=Tipo de Transação\nCampo[7].Origin=Ttc.Nome\nCampo[7].Width=100\nCampo[8].FieldName=Pessoa\nCampo[8].DisplayLabel=Pessoa\nCampo[8].Origin=Psa.Nome\nCampo[8].Width=150\nCampo[9].FieldName=Situacao\nCampo[9].DisplayLabel=Situação\nCampo[9].Origin=Case When Lft.Situacao = 1 Then 'EM ABERTO' When Lft.Situacao = 2 Then 'QUITADA' When Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA' When Lft.Situacao = 4 Then 'UNIFICADA' When Lft.Situacao = 5 Then 'EM COBRANÇA' When Lft.Situacao = 6 Then 'CANCELADA' When Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL' When Lft.Situacao = 8 Then 'NEGATIVADO' When Lft.Situacao = 9 Then 'PROTESTADO' When Lft.Situacao = 10 Then 'JUNK' End\nCampo[9].Width=100\nCampo[10].FieldName=Tipo_Fatura\nCampo[10].DisplayLabel=Tipo de Fatura\nCampo[10].Origin=Case When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO' When Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO' When Lft.Tipo_Fatura = 3 Then 'AGENTE' When Lft.Tipo_Fatura = 4 Then 'COMISSÃO' When Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS' When Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO' When Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO' When Lft.Tipo_Fatura = 8 Then 'VENDEDOR' When Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE' When Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE' When Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE' When Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL' When Lft.Tipo_Fatura = 13 Then 'SEGURADORA' When Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE' When Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT' When Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE' When Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE' End\nCampo[10].Width=100\nCampo[11].FieldName=Data_Pagamento\nCampo[11].DisplayLabel=Data Pagamento\nCampo[11].Origin=Lft.Data_Pagamento\nCampo[11].Width=100\nCampo[11].DisplayFormat=dd/mm/yyyy\nCampo[12].FieldName=Moeda\nCampo[12].DisplayLabel=Moeda\nCampo[12].Origin=Mda.Sigla\nCampo[12].Width=50\nCampo[13].FieldName=Valor_Total\nCampo[13].DisplayLabel=Valor Total\nCampo[13].Origin=FORMAT(Lft.Valor_Total, 'N', 'pt-BR')\nCampo[13].Width=100\nCampo[14].FieldName=Valor_Residual\nCampo[14].DisplayLabel=Valor Residual\nCampo[14].Origin=FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR')\nCampo[14].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\CONTAS A RECEBER\\RELATORIO CONTAS A RECEBER OK.chd",
        "conteudo": "[Consulta]\nCampos=15\nCommandText=Select,\"  ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"  Lft.Referencia,\",\"  Lft.Referencia_Externa,\",\"  Lft.Numero AS Numero_Fatura,\",\"  Lft.Data,\",\"  DATEDIFF(day, Getdate(), Lft.Data_Referencia) AS Dias_Vencimento_Vencido,\",\"  Case\",\"    When Lft.Natureza = 0 Then 'DÉBITO'\",\"\tWhen Lft.Natureza = 1 Then 'CRÉDITO'\",\"  End As Natureza,\",\"  Lft.Data_Referencia,\",\"  Ttc.Nome AS Tipo_Transacao,\",\"  Psa.Nome AS Pessoa,\",\"  Case\",\"    When Lft.Situacao = 1 Then 'EM ABERTO'\",\"\tWhen Lft.Situacao = 2 Then 'QUITADA'\",\"\tWhen Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA'\",\"\tWhen Lft.Situacao = 4 Then 'UNIFICADA'\",\"\tWhen Lft.Situacao = 5 Then 'EM COBRANÇA'\",\"\tWhen Lft.Situacao = 6 Then 'CANCELADA'\",\"\tWhen Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL'\",\"\tWhen Lft.Situacao = 8 Then 'NEGATIVADO'\",\"\tWhen Lft.Situacao = 9 Then 'PROTESTADO'\",\"\tWhen Lft.Situacao = 10 Then 'JUNK'\",\"  End As Situacao,\",\"  Case\",\"    When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO'\",\"\tWhen Lft.Tipo_Fatura = 3 Then 'AGENTE'\",\"\tWhen Lft.Tipo_Fatura = 4 Then 'COMISSÃO'\",\"\tWhen Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS'\",\"\tWhen Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO'\",\"\tWhen Lft.Tipo_Fatura = 8 Then 'VENDEDOR'\",\"\tWhen Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE'\",\"\tWhen Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL'\",\"\tWhen Lft.Tipo_Fatura = 13 Then 'SEGURADORA'\",\"\tWhen Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE'\",\"\tWhen Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT'\",\"\tWhen Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE'\",\"\tWhen Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE'\",\"  End As Tipo_Fatura,\",\"  Lft.Data_Pagamento,\",\"  Mda.Sigla AS Moeda,\",\"  FORMAT(Lft.Valor_Total, 'N', 'pt-BR') AS Valor_Total,\",\"  FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR') AS Valor_Residual\",,From,\"  vis_Logistica_Fatura_Totais Lft\",,/*OPERACIONAL*/,\"   \",,/*CADASTRO*/,\"Left Outer Join\",\"  cad_Tipo_Transacao Ttc ON Ttc.IdTipo_Transacao = Lft.IdTipo_Transacao\",\"Left Outer Join\",\"  cad_Pessoa Psa ON Psa.IdPessoa = Lft.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda ON Mda.IdMoeda = Lft.IdMoeda\",Where,\"  Lft.Natureza = 1 /*Crédito*/\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Referencia\nCampo[1].DisplayLabel=Referência\nCampo[1].Origin=Lft.Referencia\nCampo[1].Width=100\nCampo[2].FieldName=Numero_Fatura\nCampo[2].DisplayLabel=Número Fatura\nCampo[2].Origin=Lft.Numero_Fatura\nCampo[2].Width=100\nCampo[3].FieldName=Data\nCampo[3].DisplayLabel=Data\nCampo[3].Origin=Lft.Data\nCampo[3].Width=100\nCampo[3].DisplayFormat=dd/mm/yyyy\nCampo[4].FieldName=Dias_Vencimento_Vencido\nCampo[4].DisplayLabel=Dias a Vencer/Vencido\nCampo[4].Origin= DATEDIFF(day, Getdate(), Lft.Data_Referencia)\nCampo[4].Width=50\nCampo[5].FieldName=Natureza\nCampo[5].DisplayLabel=Natureza\nCampo[5].Origin=Case When Lft.Natureza = 0 Then 'DÉBITO' When Lft.Natureza = 1 Then 'CRÉDITO' End\nCampo[5].Width=100\nCampo[6].FieldName=Data_Referencia\nCampo[6].DisplayLabel=Data Referência\nCampo[6].Origin=LFt.Data_Referencia\nCampo[6].Width=100\nCampo[6].DisplayFormat=dd/mm/yyyy\nCampo[7].FieldName=Tipo_Transacao\nCampo[7].DisplayLabel=Tipo de Transação\nCampo[7].Origin=Ttc.Nome\nCampo[7].Width=100\nCampo[8].FieldName=Pessoa\nCampo[8].DisplayLabel=Pessoa\nCampo[8].Origin=Psa.Nome\nCampo[8].Width=150\nCampo[9].FieldName=Situacao\nCampo[9].DisplayLabel=Situação\nCampo[9].Origin=Case When Lft.Situacao = 1 Then 'EM ABERTO' When Lft.Situacao = 2 Then 'QUITADA' When Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA' When Lft.Situacao = 4 Then 'UNIFICADA' When Lft.Situacao = 5 Then 'EM COBRANÇA' When Lft.Situacao = 6 Then 'CANCELADA' When Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL' When Lft.Situacao = 8 Then 'NEGATIVADO' When Lft.Situacao = 9 Then 'PROTESTADO' When Lft.Situacao = 10 Then 'JUNK' End\nCampo[9].Width=100\nCampo[10].FieldName=Tipo_Fatura\nCampo[10].DisplayLabel=Tipo de Fatura\nCampo[10].Origin=Case When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO' When Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO' When Lft.Tipo_Fatura = 3 Then 'AGENTE' When Lft.Tipo_Fatura = 4 Then 'COMISSÃO' When Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS' When Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO' When Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO' When Lft.Tipo_Fatura = 8 Then 'VENDEDOR' When Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE' When Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE' When Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE' When Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL' When Lft.Tipo_Fatura = 13 Then 'SEGURADORA' When Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE' When Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT' When Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE' When Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE' End\nCampo[10].Width=100\nCampo[11].FieldName=Data_Pagamento\nCampo[11].DisplayLabel=Data Pagamento\nCampo[11].Origin=Lft.Data_Pagamento\nCampo[11].Width=100\nCampo[11].DisplayFormat=dd/mm/yyyy\nCampo[12].FieldName=Moeda\nCampo[12].DisplayLabel=Moeda\nCampo[12].Origin=Mda.Sigla\nCampo[12].Width=50\nCampo[13].FieldName=Valor_Total\nCampo[13].DisplayLabel=Valor Total\nCampo[13].Origin=FORMAT(Lft.Valor_Total, 'N', 'pt-BR')\nCampo[13].Width=100\nCampo[14].FieldName=Valor_Residual\nCampo[14].DisplayLabel=Valor Residual\nCampo[14].Origin=FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR')\nCampo[14].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\CONTAS ADMINISTRATIVAS\\CONTAS ADMINISTRATIVAS CONSULTA.chd",
        "conteudo": "[Consulta]\nCampos=10\nCommandText=SELECT,\"Ffn.Numero as Numero_Fatura,\",\"Ffn.Data as Data_Insercao_Fatura,\",\"Ffn.Data_Vencimento,\",\"CASE WHEN Ffn.Situacao = 1 THEN 'Em Aberto' WHEN Ffn.Situacao = 2 THEN 'Quitada' WHEN Ffn.Situacao = 3 THEN 'Parcialmente Quitada' WHEN Ffn.Situacao = 4 THEN 'Unificada' End as Situacao,\",\"CASE WHEN Ffn.Natureza = 0 THEN 'Débito'  WHEN Ffn.Natureza = 1 THEN 'Crédito' End as Natureza,\",\"Moe.Sigla as Moeda,\",\"Ffn.Valor as Valor_Fatura,\",\"Ffn.Valor_Residual,\",\"Psa.Nome as Pessoa_Fatura,\",\"Cpg.Nome as Condicao_Pagamento\",From,\"  mov_Fatura_Financeira Ffn\",\"Left Outer Join\",\"  mov_Logistica_Fatura Lft on Lft.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"Left Outer Join\",\"  mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"Left Outer Join\",\"  cad_Pessoa Psa on Psa.IdPessoa = Rfn.IdPessoa\",\"Left Outer Join\",\"  cad_Condicao_Pagamento Cpg on Cpg.IdCondicao_Pagamento = Rfn.IdCondicao_Pagamento\",\"Left Outer Join\",\"  cad_Moeda Moe on Moe.IdMoeda = Rfn.IdMoeda\",/*WHERE*/,Where,\"\tLft.IdRegistro_Financeiro is null\"\n\n[Campos]\nCampo[0].FieldName=Numero_Fatura\nCampo[0].DisplayLabel=Numero_Fatura\nCampo[0].Origin=Ffn.Numero\nCampo[0].Width=80\nCampo[1].FieldName=Data_Insercao_Fatura\nCampo[1].DisplayLabel=Data_Insercao_Fatura\nCampo[1].Origin=Ffn.Data\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=80\nCampo[2].FieldName=Data_Vencimento\nCampo[2].DisplayLabel=Data_Vencimento\nCampo[2].Origin=Ffn.Data_Vencimento\nCampo[2].Width=80\nCampo[3].FieldName=Situacao\nCampo[3].DisplayLabel=Situacao\nCampo[3].Origin=CASE WHEN Ffn.Situacao = 1 THEN 'Em Aberto' WHEN Ffn.Situacao = 2 THEN 'Quitada' WHEN Ffn.Situacao = 3 THEN 'Parcialmente Quitada' WHEN Ffn.Situacao = 4 THEN 'Unificada' End\nCampo[3].Width=100\nCampo[4].FieldName=Natureza\nCampo[4].DisplayLabel=Natureza\nCampo[4].Origin=CASE WHEN Ffn.Natureza = 0 THEN 'Débito'  WHEN Ffn.Natureza = 1 THEN 'Crédito' End\nCampo[4].Width=100\nCampo[5].FieldName=Moeda\nCampo[5].DisplayLabel=Moeda\nCampo[5].Origin=Moe.Sigla\nCampo[5].Width=80\nCampo[6].FieldName=Valor_Fatura\nCampo[6].DisplayLabel=Valor_Fatura\nCampo[6].Origin=Ffn.Valor\nCampo[6].Width=80\nCampo[7].FieldName=Valor_Residual\nCampo[7].DisplayLabel=Valor_Residual\nCampo[7].Origin=Ffn.Valor_Residual\nCampo[7].Width=80\nCampo[8].FieldName=Pessoa_Fatura\nCampo[8].DisplayLabel=Pessoa_Fatura\nCampo[8].Origin=Psa.Nome\nCampo[8].Width=200\nCampo[9].FieldName=Condicao_Pagamento\nCampo[9].DisplayLabel=Condicao_Pagamento\nCampo[9].Origin=Cpg.Nome\nCampo[9].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\CONTATOS CRM\\RELATORIO CONTATOS CRM OK.chd",
        "conteudo": "[Consulta]\nCommandText=Select,\"        ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"\tCli.Codigo,\",\"\tCli.Nome,\",\"\tCli.Cpf_Cnpj,\",\"\tVnd.Nome as Vendedor,\",\"\tPct.Nome as Contato,\",\"\tPct.Fone as Fone_Contato,\",\"\tPct.Email as Email_Contato,\",\"\tCrg.Nome as Cargo_Contato,\",\"\tStr.Nome As Setor_Contato\",\"From \",\"\tvis_Cliente Cli\",\"Left Outer Join\",\"\tcad_Pessoa_Contato Pct on Pct.IdPessoa = Cli.IdPessoa\",\"Left Outer Join\",\"\tcad_Pessoa Vnd on Vnd.IdPessoa = Cli.IdVendedor_Responsavel\",\"Left Outer Join\",\"\tcad_Setor Str on Str.IdSetor = Pct.IdSetor\",\"Left Outer Join\",\"\tcad_Cargo Crg on Crg.IdCargo = Pct.IdCargo\",/*Where*/\nCampos=10\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].PrimaryKey=1\nCampo[1].FieldName=Codigo\nCampo[1].DisplayLabel=Codigo\nCampo[1].Origin=Cli.Codigo\nCampo[1].Width=100\nCampo[2].FieldName=Nome\nCampo[2].DisplayLabel=Cliente\nCampo[2].Origin=Cli.Nome\nCampo[2].Width=150\nCampo[3].FieldName=Cpf_Cnpj\nCampo[3].DisplayLabel=CNPJ\nCampo[3].Origin=Cli.Cpf_Cnpj\nCampo[3].Width=150\nCampo[4].FieldName=Vendedor\nCampo[4].DisplayLabel=Vendedor\nCampo[4].Origin=Vnd.Nome\nCampo[4].Width=150\nCampo[5].FieldName=Contato\nCampo[5].DisplayLabel=Contato\nCampo[5].Origin=Pct.Nome\nCampo[5].Width=150\nCampo[6].FieldName=Fone_Contato\nCampo[6].DisplayLabel=Fone Contato\nCampo[6].Origin=Pct.Fone\nCampo[6].Width=150\nCampo[7].FieldName=Email_Contato\nCampo[7].DisplayLabel=Email Contato\nCampo[7].Origin=Pct.Email\nCampo[7].Width=200\nCampo[8].FieldName=Cargo_Contato\nCampo[8].DisplayLabel=Cargo Contato\nCampo[8].Origin=Crg.Nome\nCampo[8].Width=150\nCampo[9].FieldName=Setor_Contato\nCampo[9].DisplayLabel=Setor Contato\nCampo[9].Origin=Str.Nome\nCampo[9].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\CONTROLE DE ENVIO DE PROPOSTA\\RELATORIO CONTROLE DE ENVIO DE PROPOSTA OK.chd",
        "conteudo": "[Consulta]\nCampos=13\nCommandText=\"SELECT \",\"  Pfr.Numero_Proposta,\",\"  Pfr.Data_Solicitacao_Cliente,\",\"  CASE WHEN Pfr.Situacao = 1 THEN 'Aguardando Aprovação' WHEN Pfr.Situacao = 2 THEN 'Aprovada' WHEN Pfr.Situacao = 3 THEN 'Não Aprovada' WHEN Pfr.Situacao = 4 THEN 'Não Enviada' WHEN Pfr.Situacao = 5 THEN 'Pré-proposta' WHEN Pfr.Situacao = 6 THEN 'Enviada' END Situacao_Proposta,\",\"  Inc.Nome AS Incoterm,\",\"  Pfc.Tipo_Carga,\",\"  Taf.Descricao AS Atividade,\",\"  Atv.Previsao_Termino,\",\"  Atv.Data_Termino,\",\"  Pes.Nome AS Responsavel,\",\"  CASE WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino < Atv.Data_termino THEN 0 WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino > Atv.Data_termino THEN 1 WHEN Atv.Data_Termino IS NULL THEN 2 END AS Prazo,\",\"  DATEDIFF(day, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) AS Dias,\",\"  DATEDIFF(hour, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 24 AS Horas,\",\"  DATEDIFF(minute, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 60 AS Minutos\",\"FROM \",\"  mov_Proposta_Frete Pfr \",\"left outer join \",\"  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\",\"left outer join \",\"  cad_Incoterm Inc on Inc.IdIncoterm = Ofr.IdIncoterm\",\"left outer join \",\"  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete = Pfr.IdProposta_Frete\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade and Atv.IdTarefa = 162\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa\",\"left outer join \",\"  cad_Pessoa Pes on Pes.IdPessoa = Atv.IdResponsavel\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Numero_Proposta\nCampo[0].DisplayLabel=Número Proposta\nCampo[0].Origin=Pfr.Numero_Proposta\nCampo[0].Width=100\nCampo[1].FieldName=Data_Solicitacao_Cliente\nCampo[1].DisplayLabel=Data Solicitação Cotação\nCampo[1].Origin=Pfr.Data_Solicitacao_Cliente\nCampo[1].Width=100\nCampo[2].FieldName=Incoterm\nCampo[2].DisplayLabel=Incoterm\nCampo[2].Origin=Inc.Nome\nCampo[2].Width=50\nCampo[3].FieldName=Tipo_Carga\nCampo[3].DisplayLabel=Tipo Carga\nCampo[3].Origin=Pfc.Tipo_Carga\nCampo[3].Width=50\nCampo[4].FieldName=Atividade\nCampo[4].DisplayLabel=Atividade\nCampo[4].Origin=Taf.Descricao\nCampo[4].Width=200\nCampo[5].FieldName=Previsao_Termino\nCampo[5].DisplayLabel=Previsão Término\nCampo[5].Origin=Atv.Previsao_Termino\nCampo[5].Width=100\nCampo[6].FieldName=Data_Termino\nCampo[6].DisplayLabel=Data Término\nCampo[6].Origin=Atv.Data_Termino\nCampo[6].Width=100\nCampo[7].FieldName=Prazo\nCampo[7].DisplayLabel=Prazo\nCampo[7].Origin=CASE WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino < Atv.Data_termino THEN 0 WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino > Atv.Data_termino THEN 1 WHEN Atv.Data_Termino IS NULL THEN 2 END\nCampo[7].Width=50\nCampo[8].FieldName=Responsavel\nCampo[8].DisplayLabel=Responsável\nCampo[8].Origin=Pes.Nome\nCampo[8].Width=200\nCampo[9].FieldName=Situacao_Proposta\nCampo[9].DisplayLabel=Situação Proposta\nCampo[9].Origin=CASE WHEN Pfr.Situacao = 1 THEN 'Aguardando Aprovação' WHEN Pfr.Situacao = 2 THEN 'Aprovada' WHEN Pfr.Situacao = 3 THEN 'Não Aprovada' WHEN Pfr.Situacao = 4 THEN 'Não Enviada' WHEN Pfr.Situacao = 5 THEN 'Pré-proposta' WHEN Pfr.Situacao = 6 THEN 'Enviada' END\nCampo[9].Width=100\nCampo[10].FieldName=Dias\nCampo[10].DisplayLabel=Dias\nCampo[10].Origin=DATEDIFF(day, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino)\nCampo[10].Width=50\nCampo[11].FieldName=Horas\nCampo[11].DisplayLabel=Horas\nCampo[11].Origin=DATEDIFF(hour, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 24\nCampo[11].Width=50\nCampo[12].FieldName=Minutos\nCampo[12].DisplayLabel=Minutos\nCampo[12].Origin=DATEDIFF(minute, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 60\nCampo[12].Width=50\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\FECHAMENTO VENDEDOR CRM\\RELATORIO FECHAMENTO VENDEDOR OK.chd",
        "conteudo": "[Consulta]\nCaption=Fechamentos\nTabela=mov_Logistica_Moeda\nCampos=35\nCommandText=Select,\"  CASE\",\"    WHEN Tbl30.Situacao_Embarque = 0 THEN 'Pré-processo'\",\"\tWHEN Tbl30.Situacao_Embarque = 1 THEN 'Aguardando embarque'\",\"\tWHEN Tbl30.Situacao_Embarque = 2 THEN 'Embarcado'\",\"\tWHEN Tbl30.Situacao_Embarque = 3 THEN 'Desembarcado'\",\"\tWHEN Tbl30.Situacao_Embarque = 4 THEN 'Cancelado'\",\"\tWHEN Tbl30.Situacao_Embarque = 5 THEN 'Pendente'\",\"\tWHEN Tbl30.Situacao_Embarque = 6 THEN 'Autorizado'\",\"\tWHEN Tbl30.Situacao_Embarque = 7 THEN 'Coletado'\",\"\tWHEN Tbl30.Situacao_Embarque = 8 THEN 'Entregue'\",\"\tWHEN Tbl30.Situacao_Embarque = 9 THEN 'Aguardando prontidão da mercadoria'\",\"\tWHEN Tbl30.Situacao_Embarque = 10 THEN 'Aguardando Booking'\",\"\tWHEN Tbl30.Situacao_Embarque = 11 THEN 'Finalizado'\",\"\tWHEN Tbl30.Situacao_Embarque = 12 THEN 'Aguardando coleta'\",\"\tWHEN Tbl30.Situacao_Embarque = 13 THEN 'Aguardando Entrega'\",\"\tEND AS Tbl30_Situacao_Embarque,\",\"  Tbl1.IdLogistica_Moeda,\",\"  Tbl1.Lucro_Efetivo,\",\"  Tbl1.Lucro_Estimado,\",\"  Tbl1.Comissao_Vendedor_Efetiva,\",\"  Tbl1.Comissao_Vendedor_Estimada,\",\"  Tbl1.Lucro_Efetivo + Coalesce(Tbl1.Comissao_Vendedor_Efetiva, 0) As Profit_Total_Efetivo,\",\"  Tbl1.Lucro_Estimado + Coalesce(Tbl1.Comissao_Vendedor_Estimada, 0) As Profit_Total_Estimado,\",\"  Tbl1.IdLogistica_House,\",\"  Tbl2.Numero_Processo as Tbl2_Numero_Processo,\",\"  Tbl2.Situacao_Agenciamento as Tbl2_Situacao_Agenciamento,\",\"  Tbl2.IdCliente as Tbl2_IdCliente,\",\"  Tbl3.IdPessoa as Tbl3_IdPessoa,\",\"  Tbl7.Nome as Tbl7_Nome,\",\"  Tbl2.IdEmpresa_Sistema as Tbl2_IdEmpresa_Sistema,\",\"  Tbl22.Nome as Tbl22_Nome,\",\"  Tbl22.IdEmpresa_Sistema as Tbl22_IdEmpresa_Sistema,\",\"  Tbl2.IdLogistica_Master as Tbl2_IdLogistica_Master,\",\"  Tbl30.Modalidade_Processo as Tbl30_Modalidade_Processo,\",\"  Tbl30.Tipo_Operacao as Tbl30_Tipo_Operacao,\",\"  Tbl2.IdVendedor as Tbl2_IdVendedor,\",\"  Tbl52.IdPessoa as Tbl52_IdPessoa,\",\"  Tbl56.Nome as Tbl56_Nome,\",\"  Tbl1.IdMoeda,\",\"  Tbl69.Sigla as Tbl69_Sigla,\",\"  Tbl2.Peso_Cubado,\",\"  Lah.Peso_Taxado,\",\"  Tbl2.Peso_Bruto,\",\"  Tbl2.Metros_Cubicos,\",\"  Tbl2.Total_Conhecimentos,\",\"  Tbl2.Quantidade_Volumes,\",\"  Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40, 0) As Total_Equipamentos,\",\"  Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40 * 2, 0) As TEUS,\",\"  Tbl2.Peso_Considerado,\",\"  Case\",\"    When Tbl30.Tipo_Operacao = 2 /* Importação */ Then Coalesce(Tbl30.Data_Desembarque, Tbl30.Data_Previsao_Desembarque)\",\"    Else Coalesce(Tbl30.Data_Embarque, Tbl30.Data_Previsao_Embarque)\",\"  End As Data_Competencia\",From,\"  mov_Logistica_Moeda Tbl1\",Join,\"  cad_Moeda Tbl69 on Tbl69.IdMoeda = Tbl1.IdMoeda And Tbl69.Moeda_Corrente = 1\",Join,\"  mov_Logistica_House Tbl2 on Tbl2.IdLogistica_House = Tbl1.IdLogistica_House\",\"Left Outer Join\",\"  cad_Cliente Tbl3 on Tbl3.IdPessoa = Tbl2.IdCliente\",\"Left Outer Join\",\"  cad_Pessoa Tbl7 on Tbl7.IdPessoa = Tbl3.IdPessoa\",\"Left Outer Join\",\"  sys_Empresa_Sistema Tbl22 on Tbl22.IdEmpresa_Sistema = Tbl2.IdEmpresa_Sistema\",\"Left Outer Join\",\"  mov_Logistica_Master Tbl30 on Tbl30.IdLogistica_Master = Tbl2.IdLogistica_Master\",\"Left Outer Join\",\"  cad_Funcionario Tbl52 on Tbl52.IdPessoa = Tbl2.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Tbl56 on Tbl56.IdPessoa = Tbl52.IdPessoa\",\"Left Outer Join\",\"  mov_Logistica_Maritima_House Lmh On Lmh.IdLogistica_House = Tbl2.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Aerea_House Lah On Lah.IdLogistica_House = Tbl2.IdLogistica_House\",/*Where*/,Where,\"  Tbl2.Situacao_Agenciamento <> 7\",\n\n[Campos]\nCampo[0].FieldName=IdLogistica_Moeda\nCampo[0].Origin=Tbl1.IdLogistica_Moeda\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Lucro_Efetivo\nCampo[1].Origin=Tbl1.Lucro_Efetivo\nCampo[1].DisplayLabel=Lucro efetivo\nCampo[1].DisplayFormat=#,0.00;-#,0.00\nCampo[1].Alignment=1\nCampo[1].Width=100\nCampo[2].FieldName=Lucro_Estimado\nCampo[2].Origin=Tbl1.Lucro_Estimado\nCampo[2].DisplayLabel=Lucro estimado\nCampo[2].DisplayFormat=#,0.00;-#,0.00\nCampo[2].Alignment=1\nCampo[2].Width=100\nCampo[3].FieldName=Comissao_Vendedor_Efetiva\nCampo[3].Origin=Comissao_Vendedor_Efetiva\nCampo[3].DisplayLabel=Comissão vendedor efetiva\nCampo[3].DisplayFormat=#,0.00\nCampo[3].Width=100\nCampo[4].FieldName=Comissao_Vendedor_Estimada\nCampo[4].Origin=Comissao_Vendedor_Estimada\nCampo[4].DisplayLabel=Comissão vendedor estimada\nCampo[4].DisplayFormat=#,0.00\nCampo[4].Width=100\nCampo[5].FieldName=Profit_Total_Efetivo\nCampo[5].Origin=Tbl1.Lucro_Efetivo + Coalesce(Tbl1.Comissao_Vendedor_Efetiva, 0)\nCampo[5].DisplayLabel=Profit total efetivo\nCampo[5].DisplayFormat=#,0.00\nCampo[5].Width=100\nCampo[6].FieldName=Profit_Total_Estimado\nCampo[6].Origin=Tbl1.Lucro_Estimado + Coalesce(Tbl1.Comissao_Vendedor_Estimada, 0)\nCampo[6].DisplayLabel=Profit total estimado\nCampo[6].DisplayFormat=#,0.00\nCampo[6].Width=100\nCampo[7].FieldName=IdLogistica_House\nCampo[7].Origin=Tbl1.IdLogistica_House\nCampo[7].Foreign.Enabled=1\nCampo[7].Foreign.Divisao=Logistica_House\nCampo[7].Foreign.Campo=IdLogistica_House\nCampo[7].Foreign.Tabela=mov_Logistica_House\nCampo[8].FieldName=Tbl2_Numero_Processo\nCampo[8].Origin=Tbl2.Numero_Processo\nCampo[8].DisplayLabel=Número processo\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Numero_Processo\nCampo[8].Join.Search=IdLogistica_House\nCampo[8].Width=120\nCampo[9].FieldName=Tbl2_Situacao_Agenciamento\nCampo[9].Origin=Tbl2.Situacao_Agenciamento\nCampo[9].DisplayLabel=Situação agenciamento\nCampo[9].Join.Enabled=1\nCampo[9].Join.Result=Situacao_Agenciamento\nCampo[9].Join.Search=IdLogistica_House\nCampo[9].Width=160\nCampo[9].Items=1,2,3,4,6,5,7\nCampo[9].ItemsEx=\"Processo aberto\",\"Em andamento\",\"Liberado faturamento\",Faturado,Auditado,Finalizado,Cancelado\nCampo[9].Alignment=0\nCampo[10].FieldName=Tbl2_IdCliente\nCampo[10].Origin=Tbl2.IdCliente\nCampo[10].Foreign.Enabled=1\nCampo[10].Foreign.Divisao=Cliente\nCampo[10].Foreign.Campo=IdPessoa\nCampo[10].Foreign.Tabela=vis_Cliente\nCampo[10].Join.Enabled=1\nCampo[10].Join.Result=IdCliente\nCampo[10].Join.Search=IdLogistica_House\nCampo[11].FieldName=Tbl3_IdPessoa\nCampo[11].Origin=Tbl3.IdPessoa\nCampo[11].PrimaryKey=1\nCampo[11].Foreign.Enabled=1\nCampo[11].Foreign.Divisao=Pessoa\nCampo[11].Foreign.Campo=IdPessoa\nCampo[11].Foreign.Tabela=cad_Pessoa\nCampo[11].Join.Enabled=1\nCampo[11].Join.Result=IdPessoa\nCampo[11].Join.Search=Tbl2_IdCliente\nCampo[12].FieldName=Tbl7_Nome\nCampo[12].Origin=Tbl7.Nome\nCampo[12].DisplayLabel=Cliente\nCampo[12].Join.Enabled=1\nCampo[12].Join.Result=Nome\nCampo[12].Join.Search=Tbl3_IdPessoa\nCampo[12].Width=200\nCampo[13].FieldName=Tbl2_IdEmpresa_Sistema\nCampo[13].Origin=Tbl2.IdEmpresa_Sistema\nCampo[13].Foreign.Enabled=1\nCampo[13].Foreign.Divisao=Empresa_Sistema\nCampo[13].Foreign.Campo=IdEmpresa_Sistema\nCampo[13].Foreign.Tabela=sys_Empresa_Sistema\nCampo[13].Join.Enabled=1\nCampo[13].Join.Result=IdEmpresa_Sistema\nCampo[13].Join.Search=IdLogistica_House\nCampo[14].FieldName=Tbl22_Nome\nCampo[14].Origin=Tbl22.Nome\nCampo[14].DisplayLabel=Empresa\nCampo[14].Join.Enabled=1\nCampo[14].Join.Result=Nome\nCampo[14].Join.Search=Tbl2_IdEmpresa_Sistema\nCampo[14].Width=304\nCampo[15].FieldName=Tbl22_IdEmpresa_Sistema\nCampo[15].Origin=Tbl22.IdEmpresa_Sistema\nCampo[15].PrimaryKey=1\nCampo[15].Foreign.Enabled=1\nCampo[15].Foreign.Divisao=Empresa\nCampo[15].Foreign.Campo=IdEmpresa_Sistema\nCampo[15].Foreign.Tabela=Empresa\nCampo[15].Join.Enabled=1\nCampo[15].Join.Result=IdEmpresa_Sistema\nCampo[15].Join.Search=Tbl2_IdEmpresa_Sistema\nCampo[16].FieldName=Tbl2_IdLogistica_Master\nCampo[16].Origin=Tbl2.IdLogistica_Master\nCampo[16].Foreign.Enabled=1\nCampo[16].Foreign.Divisao=Logistica_Master\nCampo[16].Foreign.Campo=IdLogistica_Master\nCampo[16].Foreign.Tabela=mov_Logistica_Master\nCampo[16].Join.Enabled=1\nCampo[16].Join.Result=IdLogistica_Master\nCampo[16].Join.Search=IdLogistica_House\nCampo[17].FieldName=Tbl30_Modalidade_Processo\nCampo[17].Origin=Tbl30.Modalidade_Processo\nCampo[17].DisplayLabel=Modalidade processo\nCampo[17].Join.Enabled=1\nCampo[17].Join.Result=Modalidade_Processo\nCampo[17].Join.Search=Tbl2_IdLogistica_Master\nCampo[17].Width=160\nCampo[17].Items=1,2,3\nCampo[17].ItemsEx=Aéreo,Marítimo,Terrestre\nCampo[17].Alignment=0\nCampo[18].FieldName=Tbl30_Situacao_Embarque\nCampo[18].Origin=Tbl30.Situacao_Embarque\nCampo[18].DisplayLabel=Situação embarque\nCampo[18].Join.Enabled=1\nCampo[18].Join.Result=Situacao_Embarque\nCampo[18].Join.Search=Tbl2_IdLogistica_Master\nCampo[18].Width=160\nCampo[18].Items=0,1,2,3,4\nCampo[18].ItemsEx=Pré-processo,\"Aguardando embarque\",Embarcado,Desembarcado,Cancelado\nCampo[18].Alignment=0\nCampo[19].FieldName=Tbl30_Tipo_Operacao\nCampo[19].Origin=Tbl30.Tipo_Operacao\nCampo[19].DisplayLabel=Tipo operação\nCampo[19].Join.Enabled=1\nCampo[19].Join.Result=Tipo_Operacao\nCampo[19].Join.Search=Tbl2_IdLogistica_Master\nCampo[19].Width=160\nCampo[19].Items=1,2,3\nCampo[19].ItemsEx=Exportação,Importação,Nacional\nCampo[19].Alignment=0\nCampo[20].FieldName=Tbl2_IdVendedor\nCampo[20].Origin=Tbl2.IdVendedor\nCampo[20].Foreign.Enabled=1\nCampo[20].Foreign.Divisao=Funcionario\nCampo[20].Foreign.Campo=IdPessoa\nCampo[20].Foreign.Tabela=vis_Funcionario\nCampo[20].Join.Enabled=1\nCampo[20].Join.Result=IdVendedor\nCampo[20].Join.Search=IdLogistica_House\nCampo[21].FieldName=Tbl52_IdPessoa\nCampo[21].Origin=Tbl52.IdPessoa\nCampo[21].PrimaryKey=1\nCampo[21].Foreign.Enabled=1\nCampo[21].Foreign.Divisao=Pessoa\nCampo[21].Foreign.Campo=IdPessoa\nCampo[21].Foreign.Tabela=cad_Pessoa\nCampo[21].Join.Enabled=1\nCampo[21].Join.Result=IdPessoa\nCampo[21].Join.Search=Tbl2_IdVendedor\nCampo[22].FieldName=Tbl56_Nome\nCampo[22].Origin=Tbl56.Nome\nCampo[22].DisplayLabel=Vendedor\nCampo[22].Join.Enabled=1\nCampo[22].Join.Result=Nome\nCampo[22].Join.Search=Tbl52_IdPessoa\nCampo[22].Width=200\nCampo[23].FieldName=IdMoeda\nCampo[23].Origin=Tbl1.IdMoeda\nCampo[23].Foreign.Enabled=1\nCampo[23].Foreign.Divisao=Moeda\nCampo[23].Foreign.Campo=IdMoeda\nCampo[23].Foreign.Tabela=cad_Moeda\nCampo[24].FieldName=Tbl69_Sigla\nCampo[24].Origin=Tbl69.Sigla\nCampo[24].DisplayLabel=Moeda\nCampo[24].Join.Enabled=1\nCampo[24].Join.Result=Sigla\nCampo[24].Join.Search=IdMoeda\nCampo[24].Width=40\nCampo[25].FieldName=Peso_Cubado\nCampo[25].Origin=Tbl2.Peso_Cubado\nCampo[25].DisplayFormat=#,0.00\nCampo[25].Width=80\nCampo[25].DisplayLabel=Peso cubado\nCampo[26].FieldName=Peso_Bruto\nCampo[26].Origin=Tbl2.Peso_Bruto\nCampo[26].DisplayFormat=#,0.00\nCampo[26].Width=80\nCampo[26].DisplayLabel=Peso bruto\nCampo[27].FieldName=Metros_Cubicos\nCampo[27].Origin=Tbl2.Metros_Cubicos\nCampo[27].DisplayFormat=#,0.00\nCampo[27].Width=80\nCampo[27].DisplayLabel=Metros cúbicos\nCampo[28].FieldName=Total_Conhecimentos\nCampo[28].Origin=Tbl2.Total_Conhecimentos\nCampo[28].DisplayFormat=#,0.00\nCampo[28].Width=80\nCampo[28].DisplayLabel=Total conhecimentos\nCampo[29].FieldName=Quantidade_Volumes\nCampo[29].Origin=Tbl2.Quantidade_Volumes\nCampo[29].DisplayFormat=#,0.00\nCampo[29].Width=80\nCampo[29].DisplayLabel=Quantidade volumes\nCampo[30].FieldName=Total_Equipamentos\nCampo[30].Origin=Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40, 0)\nCampo[30].DisplayFormat=#,0.00\nCampo[30].Width=80\nCampo[30].DisplayLabel=Total equipamentos\nCampo[31].FieldName=TEUS\nCampo[31].Origin=Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40 * 2, 0)\nCampo[31].DisplayFormat=0\nCampo[31].Width=80\nCampo[31].DisplayLabel=TEUS\nCampo[32].FieldName=Peso_Considerado\nCampo[32].Origin=Tbl2.Peso_Considerado\nCampo[32].DisplayFormat=#,0.00\nCampo[32].Width=80\nCampo[32].DisplayLabel=Peso considerado\nCampo[33].FieldName=Peso_Taxado\nCampo[33].Origin=Lah.Peso_Taxado\nCampo[33].DisplayFormat=#,0.00\nCampo[33].Width=80\nCampo[33].DisplayLabel=Peso taxado\nCampo[34].FieldName=Data_Competencia\nCampo[34].Origin=Case When Tbl30.Tipo_Operacao = 2 /* Importação */ Then Coalesce(Tbl30.Data_Desembarque, Tbl30.Data_Previsao_Desembarque) Else Coalesce(Tbl30.Data_Embarque, Tbl30.Data_Previsao_Embarque) End\nCampo[34].DisplayLabel=Data competência\nCampo[34].DisplayFormat=dd/mm/yyyy\nCampo[34].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\LUCRO MENSAL EMPRESA\\LUCRO MENSAL EMPRESA - FATURAS - CONSULTA.chd",
        "conteudo": "[Consulta]\nCommandText=Select,\"ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"Ltl.Ano,\",\"Ltl.Mes,\",\"SUM(Ltl.Total_Pago) AS Total_Pago,\",\"SUM(Ltl.Total_Recebido) AS Total_Recebido,\",\"SUM(Ltl.Total_Estimado) as Lucro_Estimado,\",\"SUM(Ltl.Total_Efetivo) as Lucro_Efetivo\",\"From \",\"\tvis_Logistica_Fatura_Totais Lft\",\"Left Outer Join (\",\"    Select\",\"        IdRegistro_Financeiro,\",\"        SUM(Valor_Estimado_Fatura) as Total_Estimado,\",\"        SUM(Valor_Efetivo_Fatura) as Total_Efetivo,\",\"        YEAR(COALESCE(Data_Pagamento, Data_Referencia)) as Ano,\",\"        MONTH(COALESCE(Data_Pagamento, Data_Referencia)) as Mes,\",\"        Case When Natureza = 0 /*Debito*/ and Situacao = 2 /*Finalizada*/ Then SUM(Valor_Efetivo_Fatura) end as Total_Pago,\",\"        Case When Natureza = 1 /*Credito*/ and Situacao = 2 /*Finalizada*/ Then SUM(Valor_Efetivo_Fatura) end as Total_Recebido      \",\"    From vis_Logistica_Fatura_Totais\",\"    Group By IdRegistro_Financeiro, Data_Pagamento, Data_Referencia, Natureza, Situacao\",\") Ltl on Ltl.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\",\"Group by\",\"    Ltl.Ano,\",\"    Ltl.Mes\"\nCampos=6\n\n[Campos]\nCampo[0].FieldName=Ano\nCampo[0].DisplayLabel=Ano\nCampo[0].Origin=Ltl.Ano\nCampo[0].Width=80\nCampo[1].FieldName=Mes\nCampo[1].DisplayLabel=Mes\nCampo[1].Origin=Ltl.Mes\nCampo[1].Width=70\nCampo[2].FieldName=Total_Pago\nCampo[2].DisplayLabel=Total_Pago\nCampo[2].Origin=SUM(Ltl.Total_Pago)\nCampo[2].Width=80\nCampo[3].FieldName=Total_Recebido\nCampo[3].DisplayLabel=Total_Recebido\nCampo[3].Origin=SUM(Ltl.Total_Recebido)\nCampo[3].Width=80\nCampo[4].FieldName=Lucro_Estimado\nCampo[4].DisplayLabel=Lucro_Estimado\nCampo[4].Origin=SUM(Ltl.Total_Estimado)\nCampo[4].Width=80\nCampo[5].FieldName=Lucro_Efetivo\nCampo[5].DisplayLabel=Lucro_Efetivo\nCampo[5].Origin=SUM(Ltl.Total_Efetivo)\nCampo[5].Width=80\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\LUCRO MENSAL EMPRESA\\RELATORIO LUCRO MENSAL EMPRESA OK.chd",
        "conteudo": "[Consulta]\nCampos=6\nCommandText=\"select \",\"  /*Lhs.Numero_Processo,\",\"  Lhs.Data_Abertura_Processo,\",\"  Lhs.Referencia_Cliente,*/\",\"  SUM(Lgm.Total_Pago) AS TOTAL_PAGO, \",\"  SUM(Lgm.Total_Recebido) AS TOTAL_RECEBIDO,\",\"  SUM(Lgm.Lucro_Estimado) AS LUCRO_ESTIMADO,\",\"  SUM(Lgm.Lucro_Efetivo) AS LUCRO_EFETIVO,\",\"  MONTH(Lhs.Data_Abertura_Processo) AS MES,\",\"  YEAR (Lhs.Data_Abertura_Processo) AS ANO\",\"from \",\"mov_Logistica_House Lhs \",\"  LEFT OUTER JOIN \",\"mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Lhs.IdLogistica_House and Lgm.IdMoeda = 20 /* REAL */\",\"WHERE \",\"  Lhs.Data_Abertura_Processo between '2023-01-01' and '2024-12-31'\",\"GROUP BY \",\"   MONTH(Lhs.Data_Abertura_Processo),\",\"   YEAR (Lhs.Data_Abertura_Processo)\",\"ORDER BY \",\"  ANO, MES\"\n\n[Campos]\nCampo[0].FieldName=TOTAL_PAGO\nCampo[0].DisplayLabel=TOTAL_PAGO\nCampo[0].Origin=SUM(Lgm.Total_Pago)\nCampo[0].Width=100\nCampo[1].FieldName=TOTAL_RECEBIDO\nCampo[1].DisplayLabel=TOTAL_RECEBIDO\nCampo[1].Origin=SUM(Lgm.Total_Recebido)\nCampo[1].Width=120\nCampo[2].FieldName=LUCRO_ESTIMADO\nCampo[2].DisplayLabel=LUCRO_ESTIMADO\nCampo[2].Origin=SUM(Lgm.Lucro_Estimado)\nCampo[2].Width=120\nCampo[3].FieldName=LUCRO_EFETIVO\nCampo[3].DisplayLabel=LUCRO_EFETIVO\nCampo[3].Origin=SUM(Lgm.Lucro_Efetivo)\nCampo[3].Width=100\nCampo[4].FieldName=MES\nCampo[4].DisplayLabel=MES\nCampo[4].Origin=MONTH(Lhs.Data_Abertura_Processo)\nCampo[4].Width=50\nCampo[5].FieldName=ANO\nCampo[5].DisplayLabel=ANO\nCampo[5].Origin=YEAR (Lhs.Data_Abertura_Processo)\nCampo[5].Width=70\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\LUCRO POR PROCESSO\\RELATORIO LUCRO POR PROCESSO OK.chd",
        "conteudo": "[Consulta]\nCommandText=\"select \",\"  Lhs.Numero_Processo,\",\"  SUM(Lgm.Total_Pago) AS TOTAL_PAGO, \",\"  SUM(Lgm.Total_Recebido) AS TOTAL_RECEBIDO,\",\"  SUM(Lgm.Lucro_Estimado) AS LUCRO_ESTIMADO,\",\"  SUM(Lgm.Lucro_Efetivo) AS LUCRO_EFETIVO\",from,\"mov_Logistica_House Lhs \",\"  LEFT OUTER JOIN \",\"mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Lhs.IdLogistica_House\",\"group by\",Numero_Processo\nCampos=5\n\n[Campos]\nCampo[0].FieldName=Numero_Processo\nCampo[0].DisplayLabel=Numero_Processo\nCampo[0].Origin=Lhs.Numero_Processo\nCampo[0].Width=70\nCampo[1].FieldName=TOTAL_PAGO\nCampo[1].DisplayLabel=TOTAL_PAGO\nCampo[1].Origin=SUM(Lgm.Total_Pago)\nCampo[1].Width=80\nCampo[2].FieldName=TOTAL_RECEBIDO\nCampo[2].DisplayLabel=TOTAL_RECEBIDO\nCampo[2].Origin=SUM(Lgm.Total_Recebido)\nCampo[2].Width=80\nCampo[3].FieldName=LUCRO_ESTIMADO\nCampo[3].DisplayLabel=LUCRO_ESTIMADO\nCampo[3].Origin=SUM(Lgm.Lucro_Estimado)\nCampo[3].Width=80\nCampo[4].FieldName=LUCRO_EFETIVO\nCampo[4].DisplayLabel=LUCRO_EFETIVO\nCampo[4].Origin=SUM(Lgm.Lucro_Efetivo)\nCampo[4].Width=80\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\LUCRO POR PROCESSO MENSAL\\RELATORIO LUCRO POR PROCESSO MENSAL OK.chd",
        "conteudo": "[Consulta]\nCampos=16\nCommandText=\"SELECT \",\"  COUNT(Lhs.IdLogistica_House) AS Qta_Processos,\",\"  CASE WHEN SUM(Lgm.Lucro_Efetivo) > 0 THEN 1 WHEN SUM(Lgm.Lucro_Efetivo) < 0 THEN 2 WHEN SUM(Lgm.Lucro_Efetivo) = 0 THEN 3 END AS Situacao_Lucro,\",\"  CASE WHEN SUM(Lgm.Lucro_Momento) > 0 THEN 1 WHEN SUM(Lgm.Lucro_Momento) < 0 THEN 2 WHEN SUM(Lgm.Lucro_Momento) = 0 THEN 3 END AS Situacao_Momento,\",\"  CASE WHEN SUM(Lgm.Lucro_Estimado) > 0 THEN 1 WHEN SUM(Lgm.Lucro_Estimado) < 0 THEN 2 WHEN SUM(Lgm.Lucro_Estimado) = 0 THEN 3 END AS Situacao_Lucro_Est,\",\"  CASE WHEN (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) > 0 THEN 1 WHEN (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) < 0 THEN 2 WHEN (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) = 0 THEN 3 END AS Situacao_Profit,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 1 THEN 1 END) AS Processo_Aberto,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 2 THEN 1 END) AS Em_Andamento,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 3 THEN 1 END) AS Lib_Faturamento,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 4 THEN 1 END) AS Faturado,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 5 THEN 1 END) AS Auditado,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 6 THEN 1 END) AS Finalizado,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 7 THEN 1 END) AS Cancelado,\",\"  SUM(Lgm.Lucro_Estimado) AS Lucro_Estimado,\",\"  SUM(Lgm.Lucro_Efetivo) AS Lucro_Efetivo,\",\"  SUM(Lgm.Lucro_Momento) AS Lucro_Momento,\",\"  SUM(Lgm.Total_Pagamento) AS Pagamento,  \",\"  SUM(Lgm.Total_Recebimento) AS Recebimento,\",\"  (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) AS Total_Profit,\",\"  DATEPART(MONTH,Lhs.Data_Abertura_Processo) AS Mes,\",\"  DATEPART(YEAR,Lhs.Data_Abertura_Processo) AS Ano\",\"FROM \",\"  mov_Logistica_House Lhs \",\"left outer join \",\"  mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Lhs.IdLogistica_House and Lgm.IdMoeda = 20 /* REAL */\",\"GROUP BY \",\"  DATEPART(MONTH,Lhs.Data_Abertura_Processo),\",\"  DATEPART(YEAR,Lhs.Data_Abertura_Processo)\"\n\n[Campos]\nCampo[0].FieldName=Qta_Processos\nCampo[0].DisplayLabel=Quantidade Processos\nCampo[0].Origin=COUNT(Lhs.IdLogistica_House)\nCampo[0].Width=100\nCampo[1].FieldName=Processo_Aberto\nCampo[1].DisplayLabel=Processo Aberto\nCampo[1].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 1 THEN 1 END)\nCampo[1].Width=100\nCampo[2].FieldName=Em_Andamento\nCampo[2].DisplayLabel=Em Andamento\nCampo[2].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 2 THEN 1 END)\nCampo[2].Width=100\nCampo[3].FieldName=Lib_Faturamento\nCampo[3].DisplayLabel=Liberado Faturamento\nCampo[3].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 3 THEN 1 END)\nCampo[3].Width=100\nCampo[4].FieldName=Faturado\nCampo[4].DisplayLabel=Faturado\nCampo[4].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 4 THEN 1 END)\nCampo[4].Width=100\nCampo[5].FieldName=Auditado\nCampo[5].DisplayLabel=Auditado\nCampo[5].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 5 THEN 1 END)\nCampo[5].Width=100\nCampo[6].FieldName=Finalizado\nCampo[6].DisplayLabel=Finalizado\nCampo[6].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 6 THEN 1 END)\nCampo[6].Width=100\nCampo[7].FieldName=Cancelado\nCampo[7].DisplayLabel=Cancelado\nCampo[7].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 7 THEN 1 END)\nCampo[7].Width=100\nCampo[8].FieldName=Lucro_Estimado\nCampo[8].DisplayLabel=Lucro Estimado\nCampo[8].Origin=SUM(Lgm.Lucro_Estimado)\nCampo[8].Width=100\nCampo[8].DisplayFormat=#,0.00\nCampo[9].FieldName=Lucro_Momento\nCampo[9].DisplayLabel=Lucro Momento\nCampo[9].Origin=SUM(Lgm.Lucro_Momento)\nCampo[9].Width=100\nCampo[9].DisplayFormat=#,0.00\nCampo[10].FieldName=Lucro_Efetivo\nCampo[10].DisplayLabel=Lucro Efetivo\nCampo[10].Origin=SUM(Lgm.Lucro_Efetivo)\nCampo[10].Width=100\nCampo[10].DisplayFormat=#,0.00\nCampo[11].FieldName=Pagamento\nCampo[11].DisplayLabel=Pagamento\nCampo[11].Origin=SUM(Lgm.Total_Pagamento)\nCampo[11].Width=100\nCampo[11].DisplayFormat=#,0.00\nCampo[12].FieldName=Recebimento\nCampo[12].DisplayLabel=Recebimento\nCampo[12].Origin=SUM(Lgm.Total_Recebimento)\nCampo[12].Width=100\nCampo[12].DisplayFormat=#,0.00\nCampo[13].FieldName=Total_Profit\nCampo[13].DisplayLabel=Profit\nCampo[13].Origin=(SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento))\nCampo[13].Width=100\nCampo[13].DisplayFormat=#,0.00\nCampo[14].FieldName=Mes\nCampo[14].DisplayLabel=Mês\nCampo[14].Origin=DATEPART(MONTH,Lhs.Data_Abertura_Processo)\nCampo[14].Width=100\nCampo[15].FieldName=Ano\nCampo[15].DisplayLabel=Ano\nCampo[15].Origin=DATEPART(YEAR,Lhs.Data_Abertura_Processo)\nCampo[15].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\MAPA DE EMBARQUE\\RELATORIO MAPA DE EMBARQUE OK.chd",
        "conteudo": "[Consulta]\nCaption=Mapa de embarque\nTabela=mov_Frete_Transbordo\nCampos=35\nCommandText=Select,\"  Lhs.IdLogistica_House,\",\"  CASE \",\"    WHEN Lms.Data_Embarque IS NOT NULL THEN 1 \",\"    WHEN (Lms.Data_Previsao_Embarque >= getdate() AND Lms.Data_Embarque IS NULL) THEN 2 \",\"    WHEN (Lms.Data_Previsao_Embarque < getdate() AND Lms.Data_Embarque IS NULL) THEN 3\",\"  ELSE 4 END BIT_1,\",,\"  Lms.Data_Previsao_Embarque as Data_Previsao_Embarque,\",\"  Lms.Data_Embarque as Data_Embarque,\",\"  coalesce (Lms.Data_Embarque,Lms.Data_Previsao_Embarque) as Embarque, \",,\"  CASE \",\"    WHEN Lms.Data_Desembarque IS NOT NULL THEN 1 \",\"    WHEN (Lms.Data_Previsao_Desembarque >= getdate() AND Lms.Data_Desembarque IS NULL) THEN 2 \",\"    WHEN (Lms.Data_Previsao_Desembarque < getdate() AND Lms.Data_Desembarque IS NULL) THEN 3\",\"  ELSE 4 END BIT_2,\",,\"  Lms.Data_Previsao_Desembarque as Data_Previsao_Desembarque,\",\"  Lms.Data_Desembarque as Data_Desembarque,\",\"  coalesce (Lms.Data_Desembarque,Lms.Data_Previsao_Desembarque) as Desembarque,\",,\"  Lms.Modalidade_Processo,\",\"  Lms.Tipo_Operacao,\",\"  Lhs.Numero_Processo,\",\"  Lhs.Conhecimentos,\",\"  Lmh.Containers,\",\"  Lmh.Equipamentos,\",\"  Lms.Numero_Reserva as Numero_Booking,\",\"  Lhs.Referencia_Cliente as Referencia_Cliente,\",\"  coalesce(Lmm.Viagem_Navio,Vnv.Numero) as Viagem_Navio,\",\"  Cln.Nome as Cliente,\",\"  Cln.Cpf_Cnpj As CNPJ_Cliente,\",\"  Exp.Nome as Exportador,\",\"  Imp.Nome as Importador,\",\"  Nvi.Nome as Navio,\",\"  Org.Nome as Origem,\",\"  Dst.Nome as Destino,\",\"  Nty.Nome as Notify,\",\"  Ctr.Nome as Cia_Trasporte,\",\"  Trb.Viagem,\",,\"  CASE \",\"    WHEN Trb.Data_Chegada IS NOT NULL THEN 1 \",\"    WHEN (Trb.Data_Previsao_Chegada >= getdate() AND Trb.Data_Chegada IS NULL) THEN 2 \",\"    WHEN (Trb.Data_Previsao_Chegada < getdate() AND Trb.Data_Chegada IS NULL) THEN 3\",\"  ELSE 4 END BIT_3,\",,\"  Trb.Data_Previsao_Chegada AS Prev_Chegada_Transbordo,\",\"  Trb.Data_Chegada AS Data_Chegada_Transbordo,\",\"  COALESCE (Trb.Data_Chegada, Trb.Data_Previsao_Chegada) AS Prev_Confir_Chegada_Transbordo,\",,\"  CASE \",\"    WHEN Trb.Data_Embarque IS NOT NULL THEN 1 \",\"    WHEN (Trb.Data_Previsao_Embarque >= getdate() AND Trb.Data_Embarque IS NULL) THEN 2 \",\"    WHEN (Trb.Data_Previsao_Embarque < getdate() AND Trb.Data_Embarque IS NULL) THEN 3\",\"  ELSE 4 END BIT_4,\",,\"  Trb.Data_Previsao_Embarque AS Prev_Saida_Transbordo,\",\"  Trb.Data_Embarque AS Data_Saida_Transbordo,\",\"  COALESCE (Trb.Data_Embarque, Trb.Data_Previsao_Embarque) AS Prev_Confir_Saida_Transbordo,\",,\"  Trb.Porto_Transbordo,\",\"  Trb.Porto_Desembarque,\",\"  Trb.Navio_Transbordo\",From,\"  mov_Logistica_House Lhs\",\"Left Outer Join\",\"  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.Idlogistica_Master\",\"Left Outer Join\",\"  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\",\"Left Outer Join\",\"  mov_Logistica_Maritima_House Lmh on Lmh.IdLogistica_House= Lhs.IdLogistica_House\",\"Left Outer Join\",\"  vis_Cliente Cln on Cln.IdPessoa = Lhs.IdCliente\",\"Left Outer Join\",\"  vis_Cliente Exp on Exp.IdPessoa = Lhs.IdExportador\",\"Left Outer Join\",\"  vis_Cliente Imp on Imp.IdPessoa = Lhs.IdImportador\",\"Left Outer Join\",\"  vis_Cliente Nty on Nty.IdPessoa = Lhs.IdNotify\",\"Left Outer Join\",\"  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\",\"Left Outer Join\",\"  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\",\"Left Outer Join\",\"  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\",\"Left Outer Join\",\"  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\",\"Left Outer Join\",\"  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\",\"Left Outer Join\",\"  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Lms.IdDestino_Final\",\"Left Outer Join\",\"  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\",\"Left Outer Join\",\"  (Select\",\"    Lmt.IdLogistica_Master,\",\"    Lmt.Viagem,\",\"    Lmt.Data_Desembarque,\",\"\tLmt.Data_Previsao_Chegada,\",\"\tLmt.Data_Previsao_Embarque,\",\"    Lmt.Data_Embarque,\",\"    Lmt.Data_Chegada,\",\"    Ptr.Nome As Porto_Transbordo,\",\"    Pds.Nome As Porto_Desembarque,\",\"    Nvi.Nome As Navio_Transbordo,\",\"    Rank() Over (Partition By Lmt.IdLogistica_Master Order By Lmt.IdLogistica_Master, Lmt.Data_Previsao_Chegada, Lmt.IdLogistica_Maritima_Transbordo)As Ranking\",\"  From\",\"    mov_Logistica_Maritima_Transbordo Lmt\",\"  Left Outer Join\",\"    cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\",\"  Left Outer Join\",\"    cad_Origem_Destino Pds on Pds.IdOrigem_Destino = Lmt.IdPorto_Desembarque\",\"  Left Outer Join\",\"    cad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\",\"  ) As Trb On (Trb.IdLogistica_Master = Lhs.IdLogistica_Master) And (Trb.Ranking = 1)\",/*where*/\n\n[Campos]\nCampo[0].FieldName=IdLogistica_House\nCampo[0].Origin=Lhs.IdLogistica_House\nCampo[0].PrimaryKey=1\nCampo[1].FieldName=Data_Previsao_Embarque\nCampo[1].Origin=Lms.Data_Previsao_Embarque\nCampo[1].DisplayLabel=Data Previsão Embarque\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=-1\nCampo[2].FieldName=Data_Embarque\nCampo[2].Origin=Lms.Data_Embarque\nCampo[2].DisplayLabel=Data Embarque\nCampo[2].DisplayFormat=dd/mm/yyyy\nCampo[2].Width=-1\nCampo[3].FieldName=Embarque\nCampo[3].Origin=coalesce (Lms.Data_Embarque,Lms.Data_Previsao_Embarque)\nCampo[3].DisplayLabel=Embarque\nCampo[3].DisplayFormat=dd/mm/yyyy\nCampo[3].Width=-1\nCampo[4].FieldName=Data_Previsao_Desembarque\nCampo[4].Origin=Lms.Data_Previsao_Desembarque\nCampo[4].DisplayLabel=Data Previsão Desembarque\nCampo[4].DisplayFormat=dd/mm/yyyy\nCampo[4].Width=-1\nCampo[5].FieldName=Data_Desembarque\nCampo[5].Origin=Lms.Data_Desembarque\nCampo[5].DisplayLabel=Data Desembarque\nCampo[5].DisplayFormat=dd/mm/yyyy\nCampo[5].Width=-1\nCampo[6].FieldName=Desembarque\nCampo[6].Origin=coalesce (Lms.Data_Desembarque,Lms.Data_Previsao_Desembarque)\nCampo[6].DisplayLabel=Desembarque\nCampo[6].DisplayFormat=dd/mm/yyyy\nCampo[6].Width=-1\nCampo[7].FieldName=Modalidade_Processo\nCampo[7].Origin=Lms.Modalidade_Processo\nCampo[7].DisplayLabel=Modalidade Processo\nCampo[7].Width=50\nCampo[8].FieldName=Tipo_Operacao\nCampo[8].Origin=Lms.Tipo_Operacao\nCampo[8].DisplayLabel=Tipo Operação\nCampo[8].Width=50\nCampo[9].FieldName=Numero_Processo\nCampo[9].DisplayLabel=Número Processo\nCampo[9].Origin=Lhs.Numero_Processo\nCampo[9].Width=100\nCampo[10].FieldName=Conhecimentos\nCampo[10].DisplayLabel=Conhecimentos\nCampo[10].Origin=Lhs.Conhecimentos\nCampo[10].Width=100\nCampo[11].FieldName=Containers\nCampo[11].DisplayLabel=Containers\nCampo[11].Origin=Lmh.Containers\nCampo[11].Width=100\nCampo[12].FieldName=Equipamentos\nCampo[12].DisplayLabel=Equipamentos\nCampo[12].Origin=Lmh.Equipamentos\nCampo[12].Width=100\nCampo[13].FieldName=Numero_Booking\nCampo[13].DisplayLabel=Número Booking\nCampo[13].Origin=Lms.Numero_Reserva\nCampo[13].Width=100\nCampo[14].FieldName=Referencia_Cliente\nCampo[14].DisplayLabel=Referência Cliente\nCampo[14].Origin=Lhs.Referencia_Cliente\nCampo[14].Width=100\nCampo[15].FieldName=Viagem_Navio\nCampo[15].DisplayLabel=Viagem Navio\nCampo[15].Origin=coalesce(Lmm.Viagem_Navio,Vnv.Numero)\nCampo[15].Width=100\nCampo[16].FieldName=Cliente\nCampo[16].DisplayLabel=Cliente\nCampo[16].Origin=Cln.Nome\nCampo[16].Width=300\nCampo[17].FieldName=CNPJ_Cliente\nCampo[17].DisplayLabel=CNPJ Cliente\nCampo[17].Origin=Cln.Cpf_Cnpj\nCampo[17].Width=100\nCampo[18].FieldName=Exportador\nCampo[18].DisplayLabel=Exportador\nCampo[18].Origin=Exp.Nome\nCampo[18].Width=300\nCampo[19].FieldName=Importador\nCampo[19].DisplayLabel=Importador\nCampo[19].Origin=Imp.Nome\nCampo[19].Width=300\nCampo[20].FieldName=Navio\nCampo[20].DisplayLabel=Navio\nCampo[20].Origin=Nvi.Nome\nCampo[20].Width=100\nCampo[21].FieldName=Origem\nCampo[21].DisplayLabel=Origem\nCampo[21].Origin=Org.Nome\nCampo[21].Width=100\nCampo[22].FieldName=Destino\nCampo[22].DisplayLabel=Destino\nCampo[22].Origin=Dst.Nome\nCampo[22].Width=100\nCampo[23].FieldName=Notify\nCampo[23].DisplayLabel=Notify\nCampo[23].Origin=Nty.Nome\nCampo[23].Width=300\nCampo[24].FieldName=Cia_Trasporte\nCampo[24].DisplayLabel=Cia_Trasporte\nCampo[24].Origin=Ctr.Nome\nCampo[24].Width=200\nCampo[25].FieldName=Viagem\nCampo[25].DisplayLabel=Viagem\nCampo[25].Origin=Trb.Viagem\nCampo[25].Width=100\nCampo[26].FieldName=Prev_Chegada_Transbordo\nCampo[26].DisplayLabel=Previsão Chegada Transbordo\nCampo[26].Origin=Trb.Data_Previsao_Chegada\nCampo[26].Width=-1\nCampo[26].DisplayFormat=dd/mm/yyyy\nCampo[27].FieldName=Data_Chegada_Transbordo\nCampo[27].DisplayLabel=Data Chegada Transbordo\nCampo[27].Origin=Trb.Data_Chegada\nCampo[27].Width=-1\nCampo[27].DisplayFormat=dd/mm/yyyy\nCampo[28].FieldName=Prev_Confir_Chegada_Transbordo\nCampo[28].DisplayLabel=Previsão Confirmação Chegada Transbordo\nCampo[28].Origin=COALESCE (Trb.Data_Chegada, Trb.Data_Previsao_Chegada)\nCampo[28].Width=-1\nCampo[28].DisplayFormat=dd/mm/yyyy\nCampo[29].FieldName=Prev_Saida_Transbordo\nCampo[29].DisplayLabel=Previsão Saída Transbordo\nCampo[29].Origin=Trb.Data_Previsao_Embarque\nCampo[29].Width=-1\nCampo[29].DisplayFormat=dd/mm/yyyy\nCampo[30].FieldName=Data_Saida_Transbordo\nCampo[30].DisplayLabel=Data Saída Transbordo\nCampo[30].Origin=Trb.Data_Embarque\nCampo[30].Width=-1\nCampo[30].DisplayFormat=dd/mm/yyyy\nCampo[31].FieldName=Prev_Confir_Saida_Transbordo\nCampo[31].DisplayLabel=Previsão Confirmção Saída Transbordo\nCampo[31].Origin=COALESCE (Trb.Data_Embarque, Trb.Data_Previsao_Embarque)\nCampo[31].Width=-1\nCampo[31].DisplayFormat=dd/mm/yyyy\nCampo[32].FieldName=Porto_Transbordo\nCampo[32].DisplayLabel=Porto Transbordo\nCampo[32].Origin=Trb.Porto_Transbordo\nCampo[32].Width=100\nCampo[33].FieldName=Porto_Desembarque\nCampo[33].DisplayLabel=Porto Desembarque\nCampo[33].Origin=Trb.Porto_Desembarque\nCampo[33].Width=100\nCampo[34].FieldName=Navio_Transbordo\nCampo[34].DisplayLabel=Navio Transbordo\nCampo[34].Origin=Trb.Navio_Transbordo\nCampo[34].Width=100\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\PROPOSTA NAO ENVIADA - NAO APROVADA\\RELATORIO PROPOSTAS NAO APROVADAS OK.chd",
        "conteudo": "[Consulta]\nCaption=NAO APROVADAS - MOTIVO\nTabela=mov_Proposta_Frete\nCampos=12\nCommandText=Select,\"  Tbl1.IdProposta_Frete,\",\"  Tbl1.Data_Proposta,\",\"  Tbl1.Numero_Proposta,\",\"case \",\"\tWhen Tbl1.Situacao = 3 Then 'Não Aprovada' \",\"\tWhen Tbl1.Situacao = 4 Then 'Não Enviada' \",\"End as Situacao,\",\"  Tbl1.IdCliente,\",\"  Tbl2.IdPessoa as Tbl2_IdPessoa,\",\"  Tbl6.Nome as Tbl6_Nome,\",\"  Tbl1.IdMotivo_Nao_Aprovacao_Proposta,\",\"  Tbl21.Descricao as Tbl21_Descricao,\",\"  Tbl1.IdVendedor,\",\"  Tbl25.IdPessoa as Tbl25_IdPessoa,\",\"  Tbl29.Nome as Tbl29_Nome\",From,\"  mov_Proposta_Frete Tbl1\",\"Left Outer Join\",\"  cad_Cliente Tbl2 on Tbl2.IdPessoa = Tbl1.IdCliente\",\"Left Outer Join\",\"  cad_Pessoa Tbl6 on Tbl6.IdPessoa = Tbl2.IdPessoa\",\"Left Outer Join\",\"  cad_Motivo_Nao_Aprovacao_Proposta Tbl21 on Tbl21.IdMotivo_Nao_Aprovacao_Proposta = Tbl1.IdMotivo_Nao_Aprovacao_Proposta\",\"Left Outer Join\",\"  cad_Funcionario Tbl25 on Tbl25.IdPessoa = Tbl1.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Tbl29 on Tbl29.IdPessoa = Tbl25.IdPessoa\",,Where,\"Tbl1.Situacao in (3 /*Não Aprovada*/, 4 /* Não Enviada*/)\"\n\n[Campos]\nCampo[0].FieldName=IdProposta_Frete\nCampo[0].Origin=Tbl1.IdProposta_Frete\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Data_Proposta\nCampo[1].Origin=Tbl1.Data_Proposta\nCampo[1].DisplayLabel=Data proposta\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=80\nCampo[2].FieldName=Numero_Proposta\nCampo[2].Origin=Tbl1.Numero_Proposta\nCampo[2].DisplayLabel=Número proposta\nCampo[2].Width=120\nCampo[3].FieldName=Situacao\nCampo[3].Origin=case When Tbl1.Situacao = 3 Then 'Não Aprovada' When Tbl1.Situacao = 4 Then 'Não Enviada' End as Situacao,\nCampo[3].DisplayLabel=Situação\nCampo[3].Width=160\nCampo[4].FieldName=IdCliente\nCampo[4].Origin=Tbl1.IdCliente\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Cliente\nCampo[4].Foreign.Campo=IdPessoa\nCampo[4].Foreign.Tabela=vis_Cliente\nCampo[5].FieldName=Tbl2_IdPessoa\nCampo[5].Origin=Tbl2.IdPessoa\nCampo[5].PrimaryKey=1\nCampo[5].Foreign.Enabled=1\nCampo[5].Foreign.Divisao=Pessoa\nCampo[5].Foreign.Campo=IdPessoa\nCampo[5].Foreign.Tabela=cad_Pessoa\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=IdPessoa\nCampo[5].Join.Search=IdCliente\nCampo[6].FieldName=Tbl6_Nome\nCampo[6].Origin=Tbl6.Nome\nCampo[6].DisplayLabel=Cliente\nCampo[6].Join.Enabled=1\nCampo[6].Join.Result=Nome\nCampo[6].Join.Search=Tbl2_IdPessoa\nCampo[6].Width=200\nCampo[7].FieldName=IdMotivo_Nao_Aprovacao_Proposta\nCampo[7].Origin=Tbl1.IdMotivo_Nao_Aprovacao_Proposta\nCampo[7].Foreign.Enabled=1\nCampo[7].Foreign.Divisao=Motivo_Nao_Aprovacao_Proposta\nCampo[7].Foreign.Campo=IdMotivo_Nao_Aprovacao_Proposta\nCampo[7].Foreign.Tabela=cad_Motivo_Nao_Aprovacao_Proposta\nCampo[8].FieldName=Tbl21_Descricao\nCampo[8].Origin=Tbl21.Descricao\nCampo[8].DisplayLabel=Descrição / Motivo da não aprovação\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Descricao\nCampo[8].Join.Search=IdMotivo_Nao_Aprovacao_Proposta\nCampo[8].Width=220\nCampo[9].FieldName=IdVendedor\nCampo[9].Origin=Tbl1.IdVendedor\nCampo[9].Foreign.Enabled=1\nCampo[9].Foreign.Divisao=Funcionario\nCampo[9].Foreign.Campo=IdPessoa\nCampo[9].Foreign.Tabela=vis_Funcionario\nCampo[10].FieldName=Tbl25_IdPessoa\nCampo[10].Origin=Tbl25.IdPessoa\nCampo[10].PrimaryKey=1\nCampo[10].Foreign.Enabled=1\nCampo[10].Foreign.Divisao=Pessoa\nCampo[10].Foreign.Campo=IdPessoa\nCampo[10].Foreign.Tabela=cad_Pessoa\nCampo[10].Join.Enabled=1\nCampo[10].Join.Result=IdPessoa\nCampo[10].Join.Search=IdVendedor\nCampo[11].FieldName=Tbl29_Nome\nCampo[11].Origin=Tbl29.Nome\nCampo[11].DisplayLabel=Comercial\nCampo[11].Join.Enabled=1\nCampo[11].Join.Result=Nome\nCampo[11].Join.Search=Tbl25_IdPessoa\nCampo[11].Width=200\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\SALDO DEVEDOR CLIENTE\\RELATORIO SALDO DEVEDOR CLIENTE OK.chd",
        "conteudo": "[Consulta]\nCampos=9\nCommandText=Declare,\"  @IdMoeda IdCurto,\",\"  @IdConversao_Moeda IdCurto\",,\"Set @IdMoeda = 20 /* REAL */\",\"Set @IdConversao_Moeda = 1\",,Select,\"  Fts.IdPessoa,\",\"  Psa.Nome As Pessoa,\",\"  Mda.Sigla As Moeda,\",\"  SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Atual,\",\"  SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_1_30,\",\"  SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_31_60,\",\"  SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_61_90,\",\"  SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_91,\",\"  SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Total\",From,\"  (Select\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda,\",\"    SUM(Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End) As Total,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) <= 0 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Atual,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 1 And 30 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_1_30,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 31 And 60 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_31_60,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 61 And 90 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_61_90,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) >= 91 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_91\",\"  From\",\"    mov_Fatura_Financeira Ffn\",\"  Join\",\"    mov_Registro_Financeiro Rfn On Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"  Join\",\"    vis_cliente Cln on Cln.IdPessoa = Rfn.IdPessoa\",\"  Where\",\"    Not Ffn.Situacao In (2, 4, 6)\",\"  Group By\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda\",\"  ) Fts\",\"Left Outer Join\",\"  cad_Pessoa Psa On Psa.IdPessoa = Fts.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda On Mda.IdMoeda = @IdMoeda\",\"Left Outer Join\",\"  (Select\",\"    Cmf.IdMoeda_Origem,\",\"    Cmf.IdMoeda_Destino,\",\"    Cmf.Fator,\",\"    Rank() Over(Partition By Cmf.IdMoeda_Origem, Cmf.IdMoeda_Destino Order By Cmf.Data Desc) As Ranking\",\"  From\",\"    cad_Conversao_Moeda_Fator Cmf\",\"  Where\",\"    Cmf.IdConversao_Moeda = @IdConversao_Moeda\",\"  ) Ftr On Ftr.Ranking = 1\",\"    And ((Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda)\",\"      Or (Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda))\",\"Group By\",\"  Fts.IdPessoa,\",\"  Psa.Nome,\",\"  Mda.Sigla\",\"Order By\",\"  Psa.Nome\"\n\n[Campos]\nCampo[0].FieldName=IdPessoa\nCampo[0].Origin=Fts.IdPessoa\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Pessoa\nCampo[1].Origin=Psa.Nome\nCampo[1].DisplayLabel=Pessoa\nCampo[1].Width=80\nCampo[2].FieldName=Moeda\nCampo[2].Origin=Mda.Sigla\nCampo[2].DisplayLabel=Moeda\nCampo[2].Width=80\nCampo[3].FieldName=Atual\nCampo[3].Origin=SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[3].DisplayLabel=Atual\nCampo[3].Width=80\nCampo[3].DisplayFormat=#,0.00\nCampo[4].FieldName=Periodo_1_30\nCampo[4].Origin=SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[4].DisplayLabel=Até 30 dias\nCampo[4].Width=80\nCampo[4].DisplayFormat=#,0.00\nCampo[5].FieldName=Periodo_31_60\nCampo[5].Origin=SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[5].DisplayLabel=31 a 60 dias\nCampo[5].Width=80\nCampo[5].DisplayFormat=#,0.00\nCampo[6].FieldName=Periodo_61_90\nCampo[6].Origin=SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[6].DisplayLabel=De 61 a 90 dias\nCampo[6].Width=80\nCampo[6].DisplayFormat=#,0.00\nCampo[7].FieldName=Periodo_91\nCampo[7].Origin=SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[7].DisplayLabel=+ 90 dias\nCampo[7].Width=80\nCampo[7].displayFormat=#,0.00\nCampo[8].FieldName=Total\nCampo[8].Origin=SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[8].DisplayLabel=Total\nCampo[8].Width=80\nCampo[8].DisplayFormat=#,0.00\n\n"
    },
    {
        "caminho": "RELATORIOS - CONSULTAS + PDF\\SALDO DEVEDOR FORNECEDOR\\RELATORIO SALDO DEVEDOR FORNECEDOR OK.chd",
        "conteudo": "[Consulta]\nCampos=9\nCommandText=Declare,\"  @IdMoeda IdCurto,\",\"  @IdConversao_Moeda IdCurto\",,\"Set @IdMoeda = 20 /* REAL */\",\"Set @IdConversao_Moeda = 1\",,Select,\"  Fts.IdPessoa,\",\"  Psa.Nome As Pessoa,\",\"  Mda.Sigla As Moeda,\",\"  SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Atual,\",\"  SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_1_30,\",\"  SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_31_60,\",\"  SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_61_90,\",\"  SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_91,\",\"  SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Total\",From,\"  (Select\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda,\",\"    SUM(Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End) As Total,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) <= 0 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Atual,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 1 And 30 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_1_30,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 31 And 60 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_31_60,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 61 And 90 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_61_90,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) >= 91 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_91\",\"  From\",\"    mov_Fatura_Financeira Ffn\",\"  Join\",\"    mov_Registro_Financeiro Rfn On Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"  Left Outer Join\",\"    vis_cliente Cln on Cln.IdPessoa = Rfn.IdPessoa\",\"  Where\",\"    Not Ffn.Situacao In (2, 4, 6)\",\"  And\",\"    (Cln.IdPessoa Is Null)\",\"  Group By\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda\",\"  ) Fts\",\"Left Outer Join\",\"  cad_Pessoa Psa On Psa.IdPessoa = Fts.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda On Mda.IdMoeda = @IdMoeda\",\"Left Outer Join\",\"  (Select\",\"    Cmf.IdMoeda_Origem,\",\"    Cmf.IdMoeda_Destino,\",\"    Cmf.Fator,\",\"    Rank() Over(Partition By Cmf.IdMoeda_Origem, Cmf.IdMoeda_Destino Order By Cmf.Data Desc) As Ranking\",\"  From\",\"    cad_Conversao_Moeda_Fator Cmf\",\"  Where\",\"    Cmf.IdConversao_Moeda = @IdConversao_Moeda\",\"  ) Ftr On Ftr.Ranking = 1\",\"    And ((Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda)\",\"      Or (Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda))\",\"Group By\",\"  Fts.IdPessoa,\",\"  Psa.Nome,\",\"  Mda.Sigla\",\"Order By\",\"  Psa.Nome\"\n\n[Campos]\nCampo[0].FieldName=IdPessoa\nCampo[0].Origin=Fts.IdPessoa\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Pessoa\nCampo[1].Origin=Psa.Nome\nCampo[1].DisplayLabel=Pessoa\nCampo[1].Width=80\nCampo[2].FieldName=Moeda\nCampo[2].Origin=Mda.Sigla\nCampo[2].DisplayLabel=Moeda\nCampo[2].Width=80\nCampo[3].FieldName=Atual\nCampo[3].Origin=SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[3].DisplayLabel=Atual\nCampo[3].Width=80\nCampo[3].DisplayFormat=#,0.00\nCampo[4].FieldName=Periodo_1_30\nCampo[4].Origin=SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[4].DisplayLabel=Até 30 dias\nCampo[4].Width=80\nCampo[4].DisplayFormat=#,0.00\nCampo[5].FieldName=Periodo_31_60\nCampo[5].Origin=SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[5].DisplayLabel=31 a 60 dias\nCampo[5].Width=80\nCampo[5].DisplayFormat=#,0.00\nCampo[6].FieldName=Periodo_61_90\nCampo[6].Origin=SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[6].DisplayLabel=De 61 a 90 dias\nCampo[6].Width=80\nCampo[6].DisplayFormat=#,0.00\nCampo[7].FieldName=Periodo_91\nCampo[7].Origin=SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[7].DisplayLabel=+ 90 dias\nCampo[7].Width=80\nCampo[7].displayFormat=#,0.00\nCampo[8].FieldName=Total\nCampo[8].Origin=SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[8].DisplayLabel=Total\nCampo[8].Width=80\nCampo[8].DisplayFormat=#,0.00\n\n"
    },
    {
        "caminho": "Scripts\\Atualização NSL.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdLogistica_House\" Type=\"ftInteger\" Size=\"0\" Test=\"3052\"/></Parameters><CommandText>DECLARE\n  @IdLogistica_House Integer = :IdLogistica_House\n\nSELECT\n  Lhs.IdLogistica_House,\n  ISNULL(Lmc.Lucro_Efetivo, 0) - ISNULL(Txs.Total_Taxas_Tributaveis, 0) AS Lucro_Contabil_Total,\n  CAST(CASE \n    WHEN Lhs.Situacao_Agenciamento = 5 /* Finalizado */ THEN 1\n    ELSE 0\n  END AS BIT) AS Disponivel_Apuracao\nFROM\n  mov_Logistica_House Lhs\nJOIN\n  cad_Moeda Mcr ON Mcr.Moeda_Corrente = 1\nLEFT OUTER JOIN\n  mov_Logistica_Moeda Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\n    AND Lmc.IdMoeda = Mcr.IdMoeda\nLEFT OUTER JOIN\n  (SELECT\n    Ltx.IdLogistica_House,\n    SUM(CASE\n      WHEN Ltx.IdMoeda_Recebimento = Mcr.IdMoeda THEN Ltx.Valor_Recebimento_Total\n      WHEN Lfc.IdMoeda_Origem = Ltx.IdMoeda_Recebimento AND Lfc.IdMoeda_Destino = Mcr.IdMoeda THEN ROUND(Ltx.Valor_Recebimento_Total * Lfc.Fator_Conversao, 2)\n      WHEN Lfc.IdMoeda_Origem = Mcr.IdMoeda AND Lfc.IdMoeda_Destino = Ltx.IdMoeda_Recebimento AND ISNULL(Lfc.Fator_Conversao, 0) &lt;&gt; 0 THEN ROUND(Ltx.Valor_Recebimento_Total * ROUND(1 / Lfc.Fator_Conversao, 6), 2)\n      ELSE 0\n    END) AS Total_Taxas_Tributaveis\n  FROM\n    mov_Logistica_Taxa Ltx\n  LEFT OUTER JOIN\n    cad_Moeda Mcr ON Mcr.Moeda_Corrente = 1\n  LEFT OUTER JOIN\n    mov_Logistica_Fatura_Conversao Lfc ON Lfc.IdLogistica_Fatura = Ltx.IdRegistro_Recebimento\n      AND ((Lfc.IdMoeda_Origem = Ltx.IdMoeda_Recebimento AND Lfc.IdMoeda_Destino = Mcr.IdMoeda)\n        OR (Lfc.IdMoeda_Origem = Mcr.IdMoeda AND Lfc.IdMoeda_Destino = Ltx.IdMoeda_Recebimento))\n  WHERE\n    Ltx.IdLogistica_House = @IdLogistica_House\n  AND\n    Ltx.Tributavel = 1\n  GROUP BY\n    Ltx.IdLogistica_House\n  ) Txs ON Txs.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\n  Lhs.IdLogistica_House = @IdLogistica_House</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Buscador.py",
        "conteudo": "import os\nimport threading\nimport subprocess\nimport time\nimport customtkinter as ctk\nfrom tkinter import filedialog, messagebox\n\n# --- Configurações Iniciais ---\nctk.set_appearance_mode(\"Dark\")\nctk.set_default_color_theme(\"dark-blue\")\n\nclass ScriptHunter(ctk.CTk):\n    def __init__(self):\n        super().__init__()\n\n        # --- Configuração da Janela ---\n        self.title(\"Script Hunter | Busca Otimizada\")\n        self.geometry(\"1100x800\")\n        self.minsize(900, 600)\n        \n        # Variáveis de Estado\n        self.pasta_alvo = os.getcwd()\n        self.resultados_pendentes = [] # Lista para renderização gradual\n        self.cancelar_renderizacao = False\n        \n        # Mapeamento de extensões para os Checkboxes\n        self.extensoes_map = {\n            \"SQL (.sql)\": \".sql\",\n            \"Python (.py)\": \".py\",\n            \"HTML (.html)\": \".html\",\n            \"Texto (.txt)\": \".txt\",\n            \"JavaScript (.js)\": \".js\", \n            \"CSS (.css)\": \".css\",\n            \"JSON (.json)\": \".json\"\n        }\n        self.check_vars = {} \n\n        # --- Construção do Layout ---\n        self.grid_columnconfigure(0, weight=0) # Menu fixo\n        self.grid_columnconfigure(1, weight=1) # Conteúdo expansível\n        self.grid_rowconfigure(0, weight=1)\n\n        self.construir_sidebar()\n        self.construir_area_conteudo()\n\n    def construir_sidebar(self):\n        \"\"\"Cria o menu lateral com suporte a busca dupla e filtros múltiplos.\"\"\"\n        self.sidebar = ctk.CTkFrame(self, width=280, corner_radius=0, fg_color=\"#212121\")\n        self.sidebar.grid(row=0, column=0, sticky=\"nsew\")\n        self.sidebar.grid_rowconfigure(10, weight=1) \n\n        # 1. Botão de Seleção de Pasta\n        self.btn_pasta = ctk.CTkButton(self.sidebar, text=\"📂 Selecionar Pasta\", \n                                       fg_color=\"#333333\", hover_color=\"#404040\", \n                                       height=40, anchor=\"w\", command=self.selecionar_pasta)\n        self.btn_pasta.grid(row=0, column=0, padx=20, pady=(30, 10), sticky=\"ew\")\n\n        # Label da Pasta Atual\n        self.lbl_pasta = ctk.CTkLabel(self.sidebar, text=os.path.basename(self.pasta_alvo), \n                                      font=(\"Arial\", 11), text_color=\"gray\", anchor=\"w\")\n        self.lbl_pasta.grid(row=1, column=0, padx=20, pady=(0, 20), sticky=\"ew\")\n\n        # 2. Filtro de Extensões\n        self.lbl_filtro = ctk.CTkLabel(self.sidebar, text=\"Tipos de Arquivo:\", text_color=\"#aaaaaa\", anchor=\"w\")\n        self.lbl_filtro.grid(row=2, column=0, padx=20, pady=(10, 5), sticky=\"w\")\n        \n        self.frame_checks = ctk.CTkScrollableFrame(self.sidebar, height=150, fg_color=\"transparent\")\n        self.frame_checks.grid(row=3, column=0, padx=10, pady=(0, 20), sticky=\"ew\")\n\n        for nome, ext in self.extensoes_map.items():\n            var = ctk.BooleanVar(value=True) \n            self.check_vars[ext] = var\n            chk = ctk.CTkCheckBox(self.frame_checks, text=nome, variable=var, \n                                  font=(\"Arial\", 12), hover_color=\"#106EBE\", fg_color=\"#106EBE\")\n            chk.pack(anchor=\"w\", pady=2)\n\n        # 3. Switch de Modo Ligação\n        self.var_modo_join = ctk.BooleanVar(value=False)\n        self.switch_join = ctk.CTkSwitch(self.sidebar, text=\"Modo Ligação (Join)\", \n                                         variable=self.var_modo_join, command=self.toggle_modo_join,\n                                         font=(\"Arial\", 12, \"bold\"), fg_color=\"#106EBE\", progress_color=\"#2CC985\")\n        self.switch_join.grid(row=4, column=0, padx=20, pady=(10, 15), sticky=\"w\")\n\n        # 4. Entradas de Busca\n        self.lbl_busca_1 = ctk.CTkLabel(self.sidebar, text=\"Palavra-chave A:\", text_color=\"#aaaaaa\", anchor=\"w\")\n        self.lbl_busca_1.grid(row=5, column=0, padx=20, pady=(5, 5), sticky=\"w\")\n\n        self.entry_busca = ctk.CTkEntry(self.sidebar, placeholder_text=\"Ex: cad_Pessoa\", height=40)\n        self.entry_busca.grid(row=6, column=0, padx=20, pady=(0, 10), sticky=\"ew\")\n        self.entry_busca.bind(\"<Return>\", lambda e: self.iniciar_busca())\n\n        self.lbl_busca_2 = ctk.CTkLabel(self.sidebar, text=\"Palavra-chave B (Obrigatória):\", text_color=\"#aaaaaa\", anchor=\"w\")\n        self.entry_busca_2 = ctk.CTkEntry(self.sidebar, placeholder_text=\"Ex: mov_Logistica\", height=40)\n        \n        # 5. Botão de Ação\n        self.btn_buscar = ctk.CTkButton(self.sidebar, text=\"🔍 BUSCAR\", height=50,\n                                        fg_color=\"#106EBE\", hover_color=\"#005a9e\", \n                                        font=(\"Arial\", 14, \"bold\"), command=self.iniciar_busca)\n        self.btn_buscar.grid(row=9, column=0, padx=20, pady=30, sticky=\"ew\")\n\n    def toggle_modo_join(self):\n        \"\"\"Alterna a visibilidade dos campos de busca.\"\"\"\n        if self.var_modo_join.get():\n            self.lbl_busca_2.grid(row=7, column=0, padx=20, pady=(5, 5), sticky=\"w\")\n            self.entry_busca_2.grid(row=8, column=0, padx=20, pady=(0, 10), sticky=\"ew\")\n            self.btn_buscar.configure(text=\"🔍 BUSCAR LIGAÇÃO\", fg_color=\"#2e7d32\", hover_color=\"#1b5e20\")\n        else:\n            self.lbl_busca_2.grid_forget()\n            self.entry_busca_2.grid_forget()\n            self.btn_buscar.configure(text=\"🔍 BUSCAR\", fg_color=\"#106EBE\", hover_color=\"#005a9e\")\n\n    def construir_area_conteudo(self):\n        \"\"\"Cria a área de resultados à direita.\"\"\"\n        self.area_conteudo = ctk.CTkFrame(self, corner_radius=0, fg_color=\"transparent\")\n        self.area_conteudo.grid(row=0, column=1, sticky=\"nsew\", padx=20, pady=20)\n\n        # Cabeçalho de Resultados\n        self.lbl_status_resultado = ctk.CTkLabel(self.area_conteudo, text=\"Resultados\", font=(\"Arial\", 20, \"bold\"), anchor=\"w\")\n        self.lbl_status_resultado.pack(fill=\"x\", pady=(0, 10))\n\n        # Container com Scroll\n        self.scroll_frame = ctk.CTkScrollableFrame(self.area_conteudo, label_text=\"Arquivos Encontrados\")\n        self.scroll_frame.pack(fill=\"both\", expand=True)\n\n        self.msg_inicial = ctk.CTkLabel(self.scroll_frame, text=\"Aguardando comando...\", text_color=\"gray\")\n        self.msg_inicial.pack(pady=50)\n\n    # --- Lógica do Sistema ---\n\n    def selecionar_pasta(self):\n        caminho = filedialog.askdirectory()\n        if caminho:\n            self.pasta_alvo = caminho\n            nome_exibicao = os.path.basename(caminho) or caminho\n            self.lbl_pasta.configure(text=f\"📂 {nome_exibicao}\")\n\n    def iniciar_busca(self):\n        termo1 = self.entry_busca.get().strip()\n        termo2 = self.entry_busca_2.get().strip() if self.var_modo_join.get() else None\n\n        if not termo1: return\n        if self.var_modo_join.get() and not termo2:\n            messagebox.showwarning(\"Atenção\", \"Para buscar uma ligação, você PRECISA digitar as duas palavras.\")\n            return\n\n        # Para qualquer renderização anterior pendente\n        self.cancelar_renderizacao = True\n        \n        # Limpa UI imediatamente\n        for widget in self.scroll_frame.winfo_children():\n            widget.destroy()\n\n        self.btn_buscar.configure(state=\"disabled\", text=\"Buscando...\")\n        self.msg_inicial = ctk.CTkLabel(self.scroll_frame, text=\"Pesquisando...\", font=(\"Arial\", 16))\n        self.msg_inicial.pack(pady=20)\n\n        # Inicia nova thread\n        self.cancelar_renderizacao = False\n        threading.Thread(target=self.processar_busca, args=(termo1, termo2)).start()\n\n    def processar_busca(self, termo1, termo2=None):\n        resultados = []\n        lidos = 0\n        termo1_lower = termo1.lower()\n        termo2_lower = termo2.lower() if termo2 else None\n        \n        extensoes_ativas = [ext for ext, var in self.check_vars.items() if var.get()]\n        if not extensoes_ativas:\n            extensoes_ativas = list(self.check_vars.keys())\n        \n        # Converte para tupla para o endswith aceitar\n        tupla_extensoes = tuple(extensoes_ativas)\n\n        for root, _, files in os.walk(self.pasta_alvo):\n            for file in files:\n                if not file.lower().endswith(tupla_extensoes):\n                    continue\n\n                caminho_full = os.path.join(root, file)\n                \n                # OTIMIZAÇÃO: Pula arquivos maiores que 5MB para não travar\n                try:\n                    if os.path.getsize(caminho_full) > 5 * 1024 * 1024: \n                        continue\n                except: pass\n\n                lidos += 1\n\n                try:\n                    try:\n                        with open(caminho_full, 'r', encoding='utf-8') as f: \n                            conteudo_total = f.read()\n                    except UnicodeDecodeError:\n                        with open(caminho_full, 'r', encoding='latin-1') as f: \n                            conteudo_total = f.read()\n                except:\n                    continue \n                \n                conteudo_lower = conteudo_total.lower()\n                \n                # Verifica Ligação (Join) antes de processar linhas\n                if termo2_lower:\n                    if (termo1_lower not in conteudo_lower) or (termo2_lower not in conteudo_lower):\n                        continue\n\n                # Processa linhas\n                linhas = conteudo_total.splitlines()\n                for i, linha in enumerate(linhas):\n                    linha_lower = linha.lower()\n                    match_encontrado = False\n                    \n                    if termo2_lower:\n                        if (termo1_lower in linha_lower) or (termo2_lower in linha_lower):\n                            match_encontrado = True\n                    else:\n                        if termo1_lower in linha_lower:\n                            match_encontrado = True\n                            \n                    if match_encontrado:\n                        resultados.append({\n                            'arquivo': file,\n                            'caminho': caminho_full,\n                            'linha': i + 1,\n                            'conteudo': linha.strip(),\n                            'modo_join': bool(termo2_lower)\n                        })\n\n        self.after(0, lambda: self.preparar_exibicao(resultados, lidos))\n\n    def preparar_exibicao(self, resultados, lidos):\n        \"\"\"Prepara os dados para renderização em lotes.\"\"\"\n        texto_btn = \"🔍 BUSCAR LIGAÇÃO\" if self.var_modo_join.get() else \"🔍 BUSCAR\"\n        self.btn_buscar.configure(state=\"normal\", text=texto_btn)\n        \n        # Limpa mensagem de \"carregando\"\n        for widget in self.scroll_frame.winfo_children():\n            widget.destroy()\n\n        if not resultados:\n            lbl = ctk.CTkLabel(self.scroll_frame, text=\"❌ Nenhum arquivo encontrado.\", font=(\"Arial\", 16))\n            lbl.pack(pady=40)\n            return\n\n        self.lbl_status_resultado.configure(text=f\"Encontrados: {len(resultados)} (em {lidos} arquivos)\")\n        \n        # Inicia o processo de renderização em lotes\n        self.resultados_pendentes = resultados\n        self.renderizar_lote()\n\n    def renderizar_lote(self):\n        \"\"\"Desenha os cards aos poucos para não travar a UI.\"\"\"\n        if self.cancelar_renderizacao:\n            return\n\n        # Pega os próximos 20 itens\n        lote = self.resultados_pendentes[:20]\n        self.resultados_pendentes = self.resultados_pendentes[20:]\n\n        for item in lote:\n            self.criar_card(item)\n\n        # Se ainda tem itens, agenda a próxima renderização para daqui 10ms\n        if self.resultados_pendentes:\n            self.after(10, self.renderizar_lote)\n\n    def criar_card(self, item):\n        card = ctk.CTkFrame(self.scroll_frame, fg_color=\"#2b2b2b\", corner_radius=8)\n        card.pack(fill=\"x\", pady=6, padx=5)\n\n        # Header\n        header = ctk.CTkFrame(card, fg_color=\"transparent\")\n        header.pack(fill=\"x\", padx=10, pady=(10, 5))\n        \n        icone = \"🔗\" if item.get('modo_join') else \"📄\"\n        \n        ctk.CTkLabel(header, text=f\"{icone} {item['arquivo']}\", font=(\"Arial\", 14, \"bold\"), text_color=\"white\").pack(side=\"left\")\n        ctk.CTkLabel(card, text=item['caminho'], font=(\"Arial\", 10), text_color=\"gray\", anchor=\"w\").pack(fill=\"x\", padx=10)\n\n        # Código\n        code_bg = ctk.CTkFrame(card, fg_color=\"#1e1e1e\", corner_radius=4)\n        code_bg.pack(fill=\"x\", padx=10, pady=8)\n        \n        ctk.CTkLabel(code_bg, text=f\"{item['linha']}:  {item['conteudo']}\", \n                     font=(\"Consolas\", 12), text_color=\"#9CDCFE\", anchor=\"w\").pack(fill=\"x\", padx=5, pady=5)\n\n        # Botão\n        btn = ctk.CTkButton(card, text=\"Abrir no VS Code 🚀\", height=32,\n                            fg_color=\"#238636\", hover_color=\"#2ea043\",\n                            command=lambda: self.abrir_vscode(item['caminho'], item['linha']))\n        btn.pack(side=\"right\", padx=10, pady=(0, 10))\n\n    def abrir_vscode(self, caminho, linha):\n        \"\"\"Abre VS Code e copia termo.\"\"\"\n        def automacao():\n            termo = self.entry_busca.get()\n            self.clipboard_clear()\n            self.clipboard_append(termo)\n            self.update()\n\n            try:\n                subprocess.Popen(f'code -g \"{caminho}\":{linha}', shell=True)\n            except Exception as e:\n                messagebox.showerror(\"Erro\", f\"Falha ao abrir VS Code.\\n{e}\")\n                return\n\n            try:\n                import pyautogui\n                time.sleep(1.0)\n                pyautogui.hotkey('ctrl', 'f')\n                time.sleep(0.1)\n                pyautogui.hotkey('ctrl', 'v')\n            except ImportError:\n                print(\"PyAutoGUI não instalado.\")\n\n        threading.Thread(target=automacao).start()\n\nif __name__ == \"__main__\":\n    app = ScriptHunter()\n    app.mainloop()"
    },
    {
        "caminho": "Scripts\\Fazendo_agora.html",
        "conteudo": "\nPrimeira previsão de embarque\n\nPrimeira_Data_Previsao_Embarque\n\n\n\nIdOrigem_Desino = 535     CSS SPO\nIdTarefa = 295            CSS SPO\n\n\nIdTarefa = 2059           Headsoft\nIdOrigem_Desino = 39      Headsoft\n\nmov_Logistica_Viagem\nIdLogistica_Viagem = 39\n\nLvm.Tipo_Viagem = 4\nAVS_VALIDADE_AGENTE_CE_MERCANTE\nAviso de validade do agente no CE MERCANTE\n\n\nIA0009-26\nEnviar Shipping Instructions ao agente na origem\nEnviar e-mail de agradecimento ao cliente\nEnviar instruções OEA\n867\n\nSHIPPING INSTRUCIONS\n\n01 - IA - Shipping Instrution\n\n564584\n\nLINHA BASE EXTRAIDA DO SISTEMA PARA FATURAMENTO\nAlterar o campo para puxar HOUSE e nao MASTER - liberacao, coluna - Liberação de BL\nPuxar informacao da Previsao da Data de Desembarque - coluna Data de chegada\nExcluir coluna Outras Taxas Recebimento e deixar apenas coluna Outras Taxas BRL\n\nOutras Taxas Pagamento  /*excluir*/\nOutras Taxas Recebimento  /*excluir*/\n\nLms.Data_Previsao_Desembarque as Data_Previsao_Chegada, /*campo adicionado*/\n\n\nmov_Logistica_Embalagem\nIdLogistica_Embalagem\nIdLOgistica_House\nQuantidade\nAltura\nLargura\nComprimento\n\nOFERTA_FRETE_TOTAL\nTOTAL_MOEDA\n\ncad_Pessoa_Contato\nIdCargo = 18\nEMail\n\n\nOFERTA_FRETE_TAXA_TOTAL_MOEDA_SEGURO['Total_Moeda'];\n\n\nmov_Logistica_Taxa\nValor_Pagamento_Minimo\nValor_Recebimento_Minimo\n\nmov_Oferta_Frete_Taxa Oft\n\n\nmov_Logistica_Viagem\n\nIdOrigem\nTipo_Viagem = 4\n\nPF000434/26\n\nFATURA DE RECEBIMENTO\n\nChave PIX CNPJ: 28750033000178\n\nTEX021153-25\n\n\n\nVOX Atualização sistema. \natual: 3.0.296.1\nnova: 3.0.305.1  atualizar 27-01-26 as 12:10h\n\n\n\nSELECT\n*\nFROM\nmov_Atividade atv \nLeft Outer Join\n  cad_Pessoa Pes ON Pes.IdPessoa = Atv.IdResponsavel \nwhere \nPes.IdPessoa in (117117, 102466, 116185)\n\n\nAnalista: Andressa Burger - Assistente: Fernanda Scheistl\nAnalista Operacional: Heloisa Souza - Assistente: Fernanda Scheistl\nAnalista Operacional: Leonardo Bonsignori - Assistente: Luisa Stallbaum - CS IM\n\n\nKalil Farran\n\n\nVENDEDOR:  JOSE ANTONIO MEIRINHO = 86404\n\n\n\n[CONFIGURACAO]PRAZO MANUTENÇÃO DE FOLLOW UP - OK\nMonitoramento: TLogisticaMaster: Não realizar ao preencher 'Data Embarque'\nGatilho:  Manutenção de Follow up - concluida - nao iniciada\nEtapa: DATA ATUAL\n\nQuando concluida '[CONFIGURACAO]PRAZO MANUTENÇÃO DE FOLLOW UP - OK' -> gera a atividade 'Manutenção de Follow up'\n\nManutenção de Follow up\nProjeto:\nTarefa vinculo data: [CONFIGURACAO]PRAZO MANUTENÇÃO DE FOLLOW UP - OK\nBase cal. prev. inicio: termino tarefa vinculo: 7 dias 7h\nBase cal. prev. termino: termino tarefa vinculo: 7 dias 7h\nGatilho: '[CONFIGURACAO]PRAZO MANUTENÇÃO DE FOLLOW UP - OK' - '[MENSAGEM] Manutenção de Follow-up'\nMonitoramento: TLogistica_Master: Nao iniciada ao preencher a data de embarque\n\n\n\n[CONFIGURACAO] ATUALIZACAO STATUS PROCESSO\n\nATUALIZACAO DO STATUS PROCESSO\n\n\n\nOFERTA_FRETE_TAXA_EXIBIR_CLIENTE\n\nOFERTA_FRETE_TAXA\n\n\nemilly.jesus\n\n\nramil.acosta\n\n\n\nNEWEST/BRURAN - SAFRA/BANRISUL/OCEAN/HERITAGE - INGLES/PORTUGUES\n\n11984745209\n\n\n\n\n\n---------------------------\nErro\n---------------------------\nOcorreu um erro ao tentar excluir o(a) conhecimento embarque.\n---------------------------\nDetalhes:\n\nTempo limite de consulta excedido\n---------------------------\nOK\n---------------------------\n\n\n\nIA0012-26\n\n\nEM - PROPOSTA COMERCIAL FCL\nEM - PROPOSTA COMERCIAL LCL\nIM - PROPOSTA COMERCIAL LCL\nIM - PROPOSTA COMERCIAL FCL\n\nOFERTA_TRANSBORDO\nTransbordo_Escala\n\n\n\n<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\"/></Parameters><CommandText>\nSelect\nOfv.IdOferta_Frete,\nstring_agg(cast(Dst.Nome as varchar(max)), ' / ') as Destinos,\nstring_agg(cast(Dst.Sigla AS VARCHAR(MAX)), ' / ') AS Siglas,\nstring_agg(cast(case Ofv.Tipo_Viagem when 1 then 'Coleta' when 2 then 'Pré-embarque' when 3 then 'Local Recebimento' when 4 then 'Embarque inicial' when 5 then 'Transbordo / Escala' when 6 then 'Destino final' when 7 then 'Pós-embarque' when 8 then 'Entrega' end as varchar(max)), ' / ') AS Tipos_Viagem\nFROM\nmov_Oferta_Frete_Viagem Ofv\nLeft Outer Join\ncad_Origem_Destino Orm on Orm.IdOrigem_Destino = Ofv.IdOrigem\nLeft Outer Join\ncad_Origem_Destino Dst on Dst.IdOrigem_Destino = Ofv.IdDestino\nLeft Outer Join\ncad_Pessoa Cia ON Cia.IdPessoa = Ofv.IdCompanhia_Transporte\nwhere\nOfv.IdOferta_Frete = :IdOferta_Frete\ngroup by\nOfv.IdOferta_Frete\n</CommandText></DataSet>\n\n\n\n\npolyfills.4a5d1a8a5e271cf5.js:1 \n \n POST https://api.headsoft.com.br/web2/import-protocols/e6cef1ae-5663-435b-aacc-9d27ee7aa849/import 500 (Internal Server Error)\n\n\n\n\npolyfills.2abbaffcdada36ab.js:1   POST https://api.headsoft.com.br/web/import-protocols/upload-xl 400 (Bad Request)\n\n\n\n\n\n\npolyfills.4a5d1a8a5e271cf5.js:1   POST https://api.headsoft.com.br/web2/import-protocols/e6cef1ae-5663-435b-aacc-9d27ee7aa849/import 500 (Internal Server Error)\n\n\n\n\n\n\n\n\n---------------------------\nErro\n---------------------------\nOcorreu algum erro na geração do documento.\n---------------------------\nDetalhes:\n\nErro abrindo o dataset (Formatacao). [Invalid object name '#Global_Var']\n---------------------------\nOK\n---------------------------\n\n\n\n---------------------------\nErro\n---------------------------\nOcorreu algum erro na geração do documento.\n---------------------------\nDetalhes:\n\nSQL para fonte de dados não especificado. [DataSet Name=\"Contatos\" Sql=\"Select\n  Mmn.IdGrupo_Envio_Mensagem,\n  Pcn.Nome,\n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\n    and\n   Pge.IdGrupo_Envio_Mensagem = 13 /*grupo de mensagem representantes*/\"]\n---------------------------\nOK\n---------------------------\n\n\n\n---------------------------\nErro\n---------------------------\nOcorreu algum erro na geração do documento.\n---------------------------\nDetalhes:\n\nErro abrindo o dataset (Processo). [Invalid object name 'cad_Viagem_Navio']\n---------------------------\nOK\n---------------------------\n---------------------------\nErro\n---------------------------\nOcorreu algum erro na geração do documento.\n---------------------------\nDetalhes:\n\nErro abrindo o dataset (Operacional). [Invalid column name 'IdOrigem']\n---------------------------\nOK\n---------------------------\n\n\n--------------------------\n\ngiovanna.monteiro <- origem\nariane.domingues <- destino\n\n\nEM0259-26 - exalog\n\n\nmov_Logistica_Viagem\n\nTipo_Viagem\n1 Coleta - Origem   - IdOrigem  - Valor_Fixo_Cog    - Coleta Origem\n\n8 Entrega - Destino   - IdDestino - Valor_Fixo_Cds  - Entrega Destino\n\nOrg =Origem\nDst =Destino\n\n\n\n240x120\n\n\n\nrelatorio de  shupper\nviviane amaral\n\n\n\nNão insere processo sem contato externo com Grupo de envio OPERACIONAL AGENTE\n\n\n\n[001] Não aprova proposta sem contato externo com Grupo de envio OPERACIONAL AGENTE\n\n\n---------------------------\nErro\n---------------------------\nErro abrindo o dataset (cdsConsulta) da janela.\n---------------------------\nDetalhes:\n\nIncorrect syntax near '='\n---------------------------\nOK\n---------------------------\n"
    },
    {
        "caminho": "Scripts\\Fluxos.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>FluxoDesign Pro - Editor Profissional</title>\n    <!-- Bootstrap 5 -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <!-- FontAwesome Icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <!-- Google Fonts (Inter) -->\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap\" rel=\"stylesheet\">\n\n    <style>\n        :root {\n            --sidebar-width: 80px;\n            --primary-color: #4f46e5;\n            --bg-color: #f8fafc;\n            --canvas-bg: #ffffff;\n            --border-color: #e2e8f0;\n            --selection-blue: rgba(79, 70, 229, 0.1);\n            --selection-border: rgba(79, 70, 229, 0.6);\n        }\n\n        body {\n            font-family: 'Inter', sans-serif;\n            background-color: var(--bg-color);\n            overflow: hidden;\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            user-select: none;\n        }\n\n        /* --- UI: Barra Lateral --- */\n        #toolbar {\n            width: var(--sidebar-width);\n            background: white;\n            height: 100%;\n            position: fixed;\n            left: 0;\n            top: 0;\n            border-right: 1px solid var(--border-color);\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            padding-top: 20px;\n            z-index: 20;\n            overflow-y: auto;\n        }\n\n        .brand {\n            font-size: 0.7rem;\n            font-weight: 800;\n            color: var(--primary-color);\n            margin-bottom: 20px;\n            text-transform: uppercase;\n            letter-spacing: 1px;\n            text-align: center;\n        }\n\n        .tool-section {\n            width: 100%;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            margin-bottom: 15px;\n            padding-bottom: 15px;\n            border-bottom: 1px solid var(--border-color);\n        }\n        .tool-section:last-child { border-bottom: none; }\n        \n        .section-label {\n            font-size: 0.6rem;\n            color: #94a3b8;\n            margin-bottom: 8px;\n            font-weight: 600;\n        }\n\n        .tool-btn {\n            width: 44px;\n            height: 44px;\n            border-radius: 8px;\n            border: 1px solid transparent;\n            background: transparent;\n            color: #64748b;\n            font-size: 1.1rem;\n            margin-bottom: 6px;\n            transition: all 0.2s;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            cursor: pointer;\n            position: relative;\n        }\n\n        .tool-btn:hover {\n            background-color: #f1f5f9;\n            color: var(--primary-color);\n        }\n\n        .tool-btn.active {\n            background-color: #e0e7ff;\n            color: var(--primary-color);\n            border-color: #c7d2fe;\n        }\n\n        /* Tooltips */\n        .tool-btn::after {\n            content: attr(title);\n            position: absolute;\n            left: 55px;\n            background: #1e293b;\n            color: white;\n            padding: 5px 10px;\n            border-radius: 6px;\n            font-size: 0.75rem;\n            opacity: 0;\n            visibility: hidden;\n            transition: opacity 0.2s;\n            white-space: nowrap;\n            z-index: 100;\n            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);\n        }\n        .tool-btn:hover::after { opacity: 1; visibility: visible; }\n\n        /* --- UI: Área Principal --- */\n        #main-area {\n            margin-left: var(--sidebar-width);\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n        }\n\n        /* Barra Superior */\n        #top-bar {\n            height: 60px;\n            background: white;\n            border-bottom: 1px solid var(--border-color);\n            display: flex;\n            align-items: center;\n            padding: 0 24px;\n            justify-content: space-between;\n            z-index: 10;\n        }\n\n        .prop-group {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            padding-right: 20px;\n            border-right: 1px solid var(--border-color);\n            margin-right: 20px;\n        }\n        .prop-group:last-child { border: none; }\n\n        .color-input-wrap {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            background: #f8fafc;\n            padding: 4px 8px;\n            border-radius: 6px;\n            border: 1px solid var(--border-color);\n            cursor: pointer;\n        }\n        \n        input[type=\"color\"] {\n            border: none;\n            width: 24px;\n            height: 24px;\n            cursor: pointer;\n            background: none;\n            padding: 0;\n        }\n\n        .btn-toggle-group {\n            display: flex;\n            background: #f1f5f9;\n            padding: 3px;\n            border-radius: 8px;\n        }\n\n        .btn-toggle {\n            border: none;\n            background: transparent;\n            padding: 4px 10px;\n            border-radius: 6px;\n            color: #64748b;\n            font-size: 0.9rem;\n            cursor: pointer;\n        }\n        .btn-toggle:hover { color: #334155; }\n        .btn-toggle.active { background: white; color: var(--primary-color); box-shadow: 0 1px 2px rgba(0,0,0,0.1); }\n\n        /* Canvas */\n        #canvas-container {\n            flex-grow: 1;\n            position: relative;\n            background-color: #f8fafc;\n            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);\n            background-size: 20px 20px;\n            overflow: hidden;\n        }\n\n        .floating-textarea {\n            position: absolute;\n            background: rgba(255, 255, 255, 0.95);\n            border: 2px solid var(--primary-color);\n            outline: none;\n            resize: none;\n            overflow: hidden;\n            font-family: 'Inter', sans-serif;\n            padding: 4px;\n            z-index: 1000;\n            color: #333;\n            min-width: 50px;\n            min-height: 1.2em;\n            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);\n            border-radius: 4px;\n            line-height: 1.2;\n        }\n\n        /* Notificação de Salvamento */\n        #save-status {\n            font-size: 0.8rem;\n            color: #10b981;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            opacity: 0;\n            transition: opacity 0.5s;\n        }\n        #save-status.show { opacity: 1; }\n        \n        /* Dica de atalho */\n        .shortcut-hint {\n            position: absolute;\n            bottom: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(30, 41, 59, 0.8);\n            color: white;\n            padding: 6px 12px;\n            border-radius: 20px;\n            font-size: 0.75rem;\n            pointer-events: none;\n            opacity: 0.6;\n        }\n\n    </style>\n</head>\n<body>\n\n    <!-- Barra de Ferramentas -->\n    <div id=\"toolbar\">\n        <div class=\"brand\">PRO<br>FLUXO</div>\n        \n        <div class=\"tool-section\">\n            <div class=\"section-label\">GERAL</div>\n            <button class=\"tool-btn active\" onclick=\"setTool('select')\" title=\"Selecionar (V)\">\n                <i class=\"fa-solid fa-arrow-pointer\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"setTool('text')\" title=\"Texto Livre (T)\">\n                <i class=\"fa-solid fa-font\"></i>\n            </button>\n             <button class=\"tool-btn\" onclick=\"setTool('line')\" title=\"Conector (L)\">\n                <i class=\"fa-solid fa-arrow-right-long\"></i>\n            </button>\n        </div>\n\n        <div class=\"tool-section\">\n            <div class=\"section-label\">FORMAS</div>\n            <button class=\"tool-btn\" onclick=\"setTool('circle')\" title=\"Início/Fim\">\n                <i class=\"fa-regular fa-circle\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"setTool('rect')\" title=\"Processo\">\n                <i class=\"fa-regular fa-square\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"setTool('diamond')\" title=\"Decisão\">\n                <i class=\"fa-solid fa-diamond\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"setTool('parallelogram')\" title=\"Dados E/S\">\n                <i class=\"fa-solid fa-vector-square\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"setTool('database')\" title=\"Banco de Dados\">\n                <i class=\"fa-solid fa-database\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"setTool('document')\" title=\"Documento\">\n                <i class=\"fa-regular fa-file\"></i>\n            </button>\n        </div>\n\n        <div class=\"mt-auto mb-4 w-100 d-flex flex-column align-items-center\">\n            <button class=\"tool-btn text-danger\" onclick=\"deleteSelected()\" title=\"Excluir (Delete)\">\n                <i class=\"fa-regular fa-trash-can\"></i>\n            </button>\n            <button class=\"tool-btn\" onclick=\"resetCanvas()\" title=\"Novo Arquivo\">\n                <i class=\"fa-solid fa-file-circle-plus\"></i>\n            </button>\n        </div>\n    </div>\n\n    <!-- Área Principal -->\n    <div id=\"main-area\">\n        <!-- Barra Superior -->\n        <div id=\"top-bar\">\n            \n            <div class=\"d-flex align-items-center\">\n                <!-- Estilo -->\n                <div class=\"prop-group\">\n                    <div class=\"color-input-wrap\" title=\"Cor da Linha/Texto\">\n                        <i class=\"fa-solid fa-pen\" style=\"font-size:0.8rem; color:#64748b;\"></i>\n                        <input type=\"color\" id=\"strokeColor\" value=\"#1e293b\" onchange=\"updateProp('stroke', this.value)\">\n                    </div>\n                    <div class=\"color-input-wrap\" title=\"Cor de Preenchimento\">\n                        <i class=\"fa-solid fa-fill\" style=\"font-size:0.8rem; color:#64748b;\"></i>\n                        <input type=\"color\" id=\"fillColor\" value=\"#ffffff\" onchange=\"updateProp('fill', this.value)\">\n                    </div>\n                </div>\n\n                <!-- Texto -->\n                <div class=\"prop-group\">\n                    <div class=\"d-flex align-items-center gap-2 me-3\">\n                        <i class=\"fa-solid fa-text-height text-secondary\" style=\"font-size: 0.8rem;\"></i>\n                        <input type=\"number\" id=\"fontSize\" value=\"14\" min=\"8\" max=\"72\" \n                               style=\"width:50px; border:1px solid #e2e8f0; border-radius:6px; padding:4px;\"\n                               onchange=\"updateProp('fontSize', this.value)\">\n                    </div>\n\n                    <div class=\"btn-toggle-group\">\n                        <button class=\"btn-toggle\" id=\"align-left\" onclick=\"updateProp('textAlign', 'left')\"><i class=\"fa-solid fa-align-left\"></i></button>\n                        <button class=\"btn-toggle active\" id=\"align-center\" onclick=\"updateProp('textAlign', 'center')\"><i class=\"fa-solid fa-align-center\"></i></button>\n                        <button class=\"btn-toggle\" id=\"align-right\" onclick=\"updateProp('textAlign', 'right')\"><i class=\"fa-solid fa-align-right\"></i></button>\n                    </div>\n                </div>\n                \n                <!-- Status de Salvamento -->\n                <div id=\"save-status\">\n                    <i class=\"fa-solid fa-cloud-arrow-up\"></i> Salvo\n                </div>\n            </div>\n\n            <!-- Exportar -->\n            <button class=\"btn btn-dark btn-sm rounded-pill px-4 fw-medium\" onclick=\"exportImage()\">\n                <i class=\"fa-solid fa-download me-2\"></i>Baixar PNG\n            </button>\n        </div>\n\n        <!-- Canvas -->\n        <div id=\"canvas-container\">\n            <canvas id=\"flowCanvas\"></canvas>\n            <div class=\"shortcut-hint\">\n                Shift+Click: Multisseleção | Arrastar Fundo: Caixa de Seleção | Ctrl+A: Tudo\n            </div>\n        </div>\n    </div>\n\n    <script>\n        /**\n         * FLUXODESIGN PRO - CORE ENGINE 4.0\n         * Suporte a Multisseleção e Grupos.\n         */\n        \n        const canvas = document.getElementById('flowCanvas');\n        const ctx = canvas.getContext('2d');\n        const container = document.getElementById('canvas-container');\n        const saveStatus = document.getElementById('save-status');\n\n        // --- Estado da Aplicação ---\n        let shapes = [];\n        let currentTool = 'select';\n        \n        // --- Multisseleção ---\n        let selectedShapes = []; // Array de referências aos objetos selecionados\n        let selectionBox = null; // {x, y, w, h}\n        \n        // Controle de Mouse\n        let isDragging = false;\n        let isResizing = false;\n        let isDrawing = false;\n        let isSelectingBox = false;\n        let resizeHandle = null; \n        \n        let startX, startY;\n        let activeShape = null; // Usado para redimensionamento individual\n        \n        // Configurações Padrão\n        let style = {\n            stroke: '#1e293b',\n            fill: '#ffffff',\n            fontSize: 14,\n            textAlign: 'center'\n        };\n\n        // --- Inicialização ---\n        function init() {\n            resizeCanvas();\n            window.addEventListener('resize', resizeCanvas);\n            loadFromStorage();\n            draw();\n        }\n\n        function resizeCanvas() {\n            canvas.width = container.clientWidth;\n            canvas.height = container.clientHeight;\n            draw();\n        }\n\n        // --- SISTEMA DE PERSISTÊNCIA ---\n        \n        function saveToStorage() {\n            const data = JSON.stringify(shapes);\n            localStorage.setItem('fluxoProData', data);\n            saveStatus.classList.add('show');\n            setTimeout(() => saveStatus.classList.remove('show'), 2000);\n        }\n\n        function loadFromStorage() {\n            const data = localStorage.getItem('fluxoProData');\n            if (data) {\n                try {\n                    const parsed = JSON.parse(data);\n                    shapes = parsed.map(obj => {\n                        const s = new Shape(obj.x, obj.y, obj.w, obj.h, obj.type);\n                        Object.assign(s, obj);\n                        return s;\n                    });\n                } catch (e) {\n                    console.error(\"Erro ao carregar:\", e);\n                }\n            }\n        }\n\n        function resetCanvas() {\n            if(confirm(\"Deseja criar um novo arquivo? O atual será apagado.\")) {\n                shapes = [];\n                selectedShapes = [];\n                saveToStorage();\n                draw();\n            }\n        }\n\n        // --- CLASSE SHAPE ---\n        class Shape {\n            constructor(x, y, w, h, type) {\n                this.x = x; this.y = y;\n                this.w = w; this.h = h;\n                this.type = type;\n                this.text = type === 'line' ? '' : (type === 'text' ? 'Novo Texto' : '');\n                \n                this.strokeColor = style.stroke;\n                this.fillColor = type === 'text' ? 'transparent' : style.fill;\n                this.fontSize = style.fontSize;\n                this.textAlign = style.textAlign;\n                this.lineWidth = 2;\n            }\n\n            draw(ctx, isSelected) {\n                ctx.beginPath();\n                ctx.strokeStyle = this.strokeColor;\n                ctx.fillStyle = this.fillColor;\n                ctx.lineWidth = this.lineWidth;\n                ctx.lineJoin = 'round';\n                ctx.lineCap = 'round';\n\n                if (this.type !== 'line' && this.type !== 'text') {\n                    ctx.shadowColor = \"rgba(0,0,0,0.1)\";\n                    ctx.shadowBlur = 10;\n                    ctx.shadowOffsetY = 4;\n                } else {\n                    ctx.shadowColor = \"transparent\";\n                }\n\n                // Desenho das formas (Mantido igual)\n                switch(this.type) {\n                    case 'rect': ctx.rect(this.x, this.y, this.w, this.h); break;\n                    case 'circle': \n                        ctx.ellipse(this.x + this.w/2, this.y + this.h/2, Math.abs(this.w/2), Math.abs(this.h/2), 0, 0, 2 * Math.PI); \n                        break;\n                    case 'diamond':\n                        ctx.moveTo(this.x + this.w/2, this.y);\n                        ctx.lineTo(this.x + this.w, this.y + this.h/2);\n                        ctx.lineTo(this.x + this.w/2, this.y + this.h);\n                        ctx.lineTo(this.x, this.y + this.h/2);\n                        ctx.closePath();\n                        break;\n                    case 'parallelogram':\n                        const skew = this.w * 0.2;\n                        ctx.moveTo(this.x + skew, this.y);\n                        ctx.lineTo(this.x + this.w, this.y);\n                        ctx.lineTo(this.x + this.w - skew, this.y + this.h);\n                        ctx.lineTo(this.x, this.y + this.h);\n                        ctx.closePath();\n                        break;\n                    case 'database':\n                        const eh = this.h * 0.2;\n                        ctx.moveTo(this.x, this.y + eh);\n                        ctx.lineTo(this.x, this.y + this.h - eh);\n                        ctx.ellipse(this.x + this.w/2, this.y + this.h - eh, this.w/2, eh, 0, 0, Math.PI);\n                        ctx.lineTo(this.x + this.w, this.y + eh);\n                        ctx.ellipse(this.x + this.w/2, this.y + eh, this.w/2, eh, 0, 0, -Math.PI);\n                        break;\n                    case 'document':\n                        const wave = this.h * 0.15;\n                        ctx.moveTo(this.x, this.y);\n                        ctx.lineTo(this.x + this.w, this.y);\n                        ctx.lineTo(this.x + this.w, this.y + this.h - wave);\n                        ctx.quadraticCurveTo(this.x + this.w*0.75, this.y + this.h + wave, this.x + this.w*0.5, this.y + this.h - wave/2);\n                        ctx.quadraticCurveTo(this.x + this.w*0.25, this.y + this.h - wave*2, this.x, this.y + this.h - wave);\n                        ctx.closePath();\n                        break;\n                    case 'line':\n                        const angle = Math.atan2(this.h - this.y, this.w - this.x);\n                        ctx.moveTo(this.x, this.y);\n                        ctx.lineTo(this.w, this.h);\n                        ctx.stroke();\n                        const head = 10 + (this.fontSize / 4);\n                        ctx.beginPath();\n                        ctx.moveTo(this.w, this.h);\n                        ctx.lineTo(this.w - head * Math.cos(angle - Math.PI/6), this.h - head * Math.sin(angle - Math.PI/6));\n                        ctx.lineTo(this.w - head * Math.cos(angle + Math.PI/6), this.h - head * Math.sin(angle + Math.PI/6));\n                        ctx.fillStyle = this.strokeColor;\n                        ctx.fill();\n                        break;\n                }\n\n                if (this.type !== 'line' && this.type !== 'text') {\n                    ctx.fill();\n                    ctx.stroke();\n                    if (this.type === 'database') {\n                        ctx.beginPath();\n                        ctx.ellipse(this.x + this.w/2, this.y + this.h*0.2, this.w/2, this.h*0.2, 0, 0, 2*Math.PI);\n                        ctx.stroke();\n                    }\n                }\n\n                if (this.text) {\n                    ctx.shadowColor = \"transparent\";\n                    ctx.fillStyle = this.type === 'text' ? this.strokeColor : \"#1e293b\";\n                    ctx.font = `${this.fontSize}px Inter`;\n                    ctx.textAlign = this.type === 'line' ? 'center' : this.textAlign;\n                    ctx.textBaseline = \"middle\";\n\n                    let tx = this.x + this.w/2;\n                    let ty = this.y + this.h/2;\n                    \n                    if (this.type === 'line') {\n                        tx = (this.x + this.w)/2;\n                        ty = (this.y + this.h)/2 - this.fontSize;\n                    } else if (this.type !== 'text') {\n                        if(this.textAlign === 'left') tx = this.x + 10;\n                        if(this.textAlign === 'right') tx = this.x + this.w - 10;\n                    } else {\n                        tx = this.x + this.w/2; \n                        if (this.textAlign === 'left') tx = this.x;\n                        if (this.textAlign === 'right') tx = this.x + this.w;\n                    }\n\n                    const lines = this.text.split('\\n');\n                    const lh = this.fontSize * 1.2;\n                    const totalH = lines.length * lh;\n                    \n                    lines.forEach((line, i) => {\n                        const ly = ty - (totalH/2) + (i*lh) + (lh/2);\n                        ctx.fillText(line, tx, ly);\n                    });\n                }\n\n                if (isSelected) {\n                    ctx.shadowColor = \"transparent\";\n                    ctx.strokeStyle = \"#4f46e5\";\n                    ctx.lineWidth = 1;\n                    ctx.setLineDash([4, 4]);\n                    \n                    // Bounding Box\n                    if (this.type === 'line') {\n                        this.drawHandle(ctx, this.x, this.y);\n                        this.drawHandle(ctx, this.w, this.h);\n                    } else {\n                        ctx.strokeRect(this.x - 4, this.y - 4, this.w + 8, this.h + 8);\n                        // Apenas desenha handles se for o único selecionado (para evitar poluição visual em grupo)\n                        if (selectedShapes.length === 1) {\n                            this.drawHandle(ctx, this.x - 4, this.y - 4); \n                            this.drawHandle(ctx, this.x + this.w + 4, this.y - 4); \n                            this.drawHandle(ctx, this.x - 4, this.y + this.h + 4); \n                            this.drawHandle(ctx, this.x + this.w + 4, this.y + this.h + 4); \n                        }\n                    }\n                    ctx.setLineDash([]);\n                }\n            }\n\n            drawHandle(ctx, x, y) {\n                ctx.fillStyle = \"#fff\";\n                ctx.strokeStyle = \"#4f46e5\";\n                ctx.setLineDash([]);\n                ctx.fillRect(x - 4, y - 4, 8, 8);\n                ctx.strokeRect(x - 4, y - 4, 8, 8);\n            }\n\n            contains(mx, my) {\n                const p = 10; \n                if (this.type === 'line') {\n                    const A = mx - this.x; const B = my - this.y;\n                    const C = this.w - this.x; const D = this.h - this.y;\n                    const dot = A*C + B*D; const len_sq = C*C + D*D;\n                    let param = -1;\n                    if (len_sq !== 0) param = dot / len_sq;\n                    let xx, yy;\n                    if (param < 0) { xx = this.x; yy = this.y; }\n                    else if (param > 1) { xx = this.w; yy = this.h; }\n                    else { xx = this.x + param*C; yy = this.y + param*D; }\n                    const dist = Math.sqrt((mx-xx)**2 + (my-yy)**2);\n                    return dist < p;\n                }\n                \n                let rx = this.x, ry = this.y, rw = this.w, rh = this.h;\n                if (rw < 0) { rx += rw; rw = -rw; }\n                if (rh < 0) { ry += rh; rh = -rh; }\n                \n                return (mx >= rx - p && mx <= rx + rw + p && my >= ry - p && my <= ry + rh + p);\n            }\n\n            getHandle(mx, my) {\n                // Redimensionamento só funciona se apenas 1 objeto estiver selecionado\n                if (selectedShapes.length > 1) return null;\n\n                const s = 8;\n                if (this.type === 'line') {\n                    if (Math.abs(mx - this.x) < s && Math.abs(my - this.y) < s) return 'start';\n                    if (Math.abs(mx - this.w) < s && Math.abs(my - this.h) < s) return 'end';\n                } else {\n                    let x1 = this.x, y1 = this.y, x2 = this.x + this.w, y2 = this.y + this.h;\n                    if (Math.abs(mx - x1) < s && Math.abs(my - y1) < s) return 'nw';\n                    if (Math.abs(mx - x2) < s && Math.abs(my - y1) < s) return 'ne';\n                    if (Math.abs(mx - x1) < s && Math.abs(my - y2) < s) return 'sw';\n                    if (Math.abs(mx - x2) < s && Math.abs(my - y2) < s) return 'se';\n                }\n                return null;\n            }\n        }\n\n        // --- INTERAÇÃO (Eventos) ---\n\n        function getPos(e) {\n            const r = canvas.getBoundingClientRect();\n            return { x: e.clientX - r.left, y: e.clientY - r.top };\n        }\n\n        canvas.addEventListener('mousedown', e => {\n            const pos = getPos(e);\n            \n            // 1. Tentar pegar Handle de Resize (apenas se 1 item selecionado)\n            if (selectedShapes.length === 1) {\n                const s = selectedShapes[0];\n                const handle = s.getHandle(pos.x, pos.y);\n                if (handle) {\n                    isResizing = true;\n                    resizeHandle = handle;\n                    activeShape = s;\n                    return;\n                }\n            }\n\n            // 2. Lógica de Seleção\n            if (currentTool === 'select') {\n                // Checa se clicou em algum objeto\n                let hitShape = null;\n                for (let i = shapes.length - 1; i >= 0; i--) {\n                    if (shapes[i].contains(pos.x, pos.y)) {\n                        hitShape = shapes[i];\n                        break;\n                    }\n                }\n\n                if (hitShape) {\n                    // Clicou em um objeto\n                    const isAlreadySelected = selectedShapes.includes(hitShape);\n                    \n                    if (e.ctrlKey || e.shiftKey) {\n                        // Modo Adição/Remoção (Ctrl/Shift)\n                        if (isAlreadySelected) {\n                            // Remove da seleção\n                            selectedShapes = selectedShapes.filter(s => s !== hitShape);\n                        } else {\n                            // Adiciona à seleção\n                            selectedShapes.push(hitShape);\n                        }\n                    } else {\n                        // Clique normal\n                        if (!isAlreadySelected) {\n                            // Se clicou num não selecionado, limpa e seleciona só ele\n                            selectedShapes = [hitShape];\n                        }\n                        // Se já estava selecionado, mantém a seleção (para permitir arrastar grupo)\n                    }\n\n                    // Prepara para arrastar o grupo\n                    isDragging = true;\n                    startX = pos.x;\n                    startY = pos.y;\n                    \n                    // Salva posição original de TODOS os selecionados para mover em delta\n                    selectedShapes.forEach(s => {\n                        s.origX = s.x; s.origY = s.y;\n                        s.origW = s.w; s.origH = s.h;\n                    });\n                    \n                    if (selectedShapes.length === 1) updateUIFromShape(selectedShapes[0]);\n\n                } else {\n                    // Clicou no vazio\n                    if (!e.ctrlKey && !e.shiftKey) {\n                        selectedShapes = []; // Limpa seleção\n                    }\n                    // Inicia Caixa de Seleção\n                    isSelectingBox = true;\n                    startX = pos.x;\n                    startY = pos.y;\n                    selectionBox = { x: startX, y: startY, w: 0, h: 0 };\n                }\n                \n                draw();\n            }\n            // 3. Criar Novo Objeto\n            else {\n                isDrawing = true;\n                startX = pos.x;\n                startY = pos.y;\n                const newShape = new Shape(startX, startY, 0, 0, currentTool);\n                \n                if (currentTool === 'line') {\n                    newShape.w = startX;\n                    newShape.h = startY;\n                }\n                \n                shapes.push(newShape);\n                selectedShapes = [newShape]; // Já seleciona o novo\n                activeShape = newShape;\n            }\n        });\n\n        canvas.addEventListener('mousemove', e => {\n            const pos = getPos(e);\n\n            // Cursor Style\n            if (!isDrawing && !isDragging && !isResizing && !isSelectingBox) {\n                const hit = shapes.some(s => s.contains(pos.x, pos.y));\n                canvas.style.cursor = hit ? 'move' : (currentTool === 'select' ? 'default' : 'crosshair');\n            }\n\n            // Ações\n            if (isSelectingBox) {\n                selectionBox.w = pos.x - startX;\n                selectionBox.h = pos.y - startY;\n                draw();\n            }\n            else if (isResizing && activeShape) {\n                const s = activeShape;\n                if (s.type === 'line') {\n                    if (resizeHandle === 'start') { s.x = pos.x; s.y = pos.y; }\n                    else { s.w = pos.x; s.h = pos.y; }\n                } else {\n                    if (resizeHandle.includes('e')) s.w = pos.x - s.x;\n                    if (resizeHandle.includes('s')) s.h = pos.y - s.y;\n                    if (resizeHandle.includes('w')) {\n                        const right = s.x + s.w; s.x = pos.x; s.w = right - pos.x;\n                    }\n                    if (resizeHandle.includes('n')) {\n                        const bot = s.y + s.h; s.y = pos.y; s.h = bot - pos.y;\n                    }\n                }\n                draw();\n            }\n            else if (isDragging && selectedShapes.length > 0) {\n                // Move todos os selecionados pelo mesmo Delta\n                const dx = pos.x - startX;\n                const dy = pos.y - startY;\n                \n                selectedShapes.forEach(s => {\n                    if (s.type === 'line') {\n                        s.x = s.origX + dx; s.y = s.origY + dy;\n                        s.w = s.origW + dx; s.h = s.origH + dy;\n                    } else {\n                        s.x = s.origX + dx; s.y = s.origY + dy;\n                    }\n                });\n                draw();\n            }\n            else if (isDrawing && activeShape) {\n                if (currentTool === 'line') {\n                    activeShape.w = pos.x;\n                    activeShape.h = pos.y;\n                } else if (currentTool !== 'text') {\n                    activeShape.w = pos.x - startX;\n                    activeShape.h = pos.y - startY;\n                }\n                draw();\n            }\n        });\n\n        canvas.addEventListener('mouseup', () => {\n            \n            if (isSelectingBox) {\n                // Finaliza caixa de seleção: encontra objetos dentro\n                // Normaliza caixa (para funcionar se arrastou pra trás)\n                let bx = selectionBox.x, by = selectionBox.y, bw = selectionBox.w, bh = selectionBox.h;\n                if (bw < 0) { bx += bw; bw = -bw; }\n                if (bh < 0) { by += bh; bh = -bh; }\n\n                // Adiciona à seleção objetos que colidem com a caixa\n                shapes.forEach(s => {\n                    // Checagem simples de caixa dentro de caixa\n                    // Normaliza shape\n                    let sx = s.x, sy = s.y, sw = s.w, sh = s.h;\n                    if(s.type === 'line') { \n                        sx = Math.min(s.x, s.w); sy = Math.min(s.y, s.h);\n                        sw = Math.abs(s.w - s.x); sh = Math.abs(s.h - s.y);\n                    } else {\n                         if (sw < 0) { sx += sw; sw = -sw; }\n                         if (sh < 0) { sy += sh; sh = -sh; }\n                    }\n\n                    // AABB Collision (Caixa de Seleção vs Objeto)\n                    if (bx < sx + sw && bx + bw > sx && by < sy + sh && by + bh > sy) {\n                        if (!selectedShapes.includes(s)) {\n                            selectedShapes.push(s);\n                        }\n                    }\n                });\n            }\n\n            if (isDrawing) {\n                const s = activeShape;\n                if (currentTool !== 'text' && Math.abs(s.w) < 5 && Math.abs(s.h) < 5 && s.type !== 'line') {\n                    s.w = 120; s.h = 60; \n                    s.x -= 60; s.y -= 30;\n                }\n                if (s.type !== 'line') {\n                    if (s.w < 0) { s.x += s.w; s.w *= -1; }\n                    if (s.h < 0) { s.y += s.h; s.h *= -1; }\n                }\n                if (currentTool === 'text') {\n                    openTextEditor(s);\n                    setTool('select');\n                } else if (currentTool !== 'select') {\n                    setTool('select');\n                }\n            }\n\n            if (isDragging || isResizing || isDrawing) saveToStorage();\n\n            isDragging = false;\n            isResizing = false;\n            isDrawing = false;\n            isSelectingBox = false;\n            selectionBox = null;\n            activeShape = null;\n            resizeHandle = null;\n            draw();\n        });\n\n        // --- EDIÇÃO DE TEXTO ---\n\n        canvas.addEventListener('dblclick', e => {\n            const pos = getPos(e);\n            for (let i = shapes.length - 1; i >= 0; i--) {\n                if (shapes[i].contains(pos.x, pos.y)) {\n                    openTextEditor(shapes[i]);\n                    break;\n                }\n            }\n        });\n\n        function openTextEditor(shape) {\n            const input = document.createElement('textarea');\n            input.className = 'floating-textarea';\n            input.value = shape.text;\n            \n            input.style.color = shape.type === 'text' ? shape.strokeColor : '#1e293b';\n            input.style.fontSize = shape.fontSize + 'px';\n            input.style.textAlign = shape.textAlign;\n            \n            const rect = canvas.getBoundingClientRect();\n            let ix = shape.x, iy = shape.y, iw = shape.w, ih = shape.h;\n\n            if (shape.type === 'line') {\n                ix = (shape.x + shape.w)/2 - 60; iy = (shape.y + shape.h)/2 - 20;\n                iw = 120; ih = 40;\n            } else if (shape.type === 'text') {\n                ix = shape.x - 5; iy = shape.y - 5;\n                iw = Math.max(shape.w + 10, 100); ih = Math.max(shape.h + 10, 30);\n            }\n\n            input.style.left = (rect.left + ix) + 'px';\n            input.style.top = (rect.top + iy) + 'px';\n            input.style.width = Math.max(Math.abs(iw), 50) + 'px';\n            input.style.height = Math.max(Math.abs(ih), 30) + 'px';\n\n            document.body.appendChild(input);\n            input.focus();\n\n            const close = () => {\n                shape.text = input.value;\n                if (shape.type === 'text') {\n                    const lines = input.value.split('\\n');\n                    const maxLine = Math.max(...lines.map(l => l.length));\n                    shape.w = Math.max(40, maxLine * (shape.fontSize * 0.6));\n                    shape.h = Math.max(20, lines.length * (shape.fontSize * 1.2));\n                }\n                input.remove();\n                saveToStorage();\n                draw();\n            };\n\n            input.addEventListener('blur', close);\n            input.addEventListener('keydown', e => {\n                if (e.key === 'Enter' && e.ctrlKey) input.blur();\n            });\n        }\n\n        // --- CONTROLES DE UI ---\n\n        function setTool(name) {\n            currentTool = name;\n            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));\n            const btn = document.querySelector(`.tool-btn[onclick*=\"${name}\"]`);\n            if(btn) btn.classList.add('active');\n            selectedShapes = [];\n            draw();\n        }\n\n        function updateProp(key, val) {\n            style[key] = val;\n            if (selectedShapes.length > 0) {\n                selectedShapes.forEach(s => {\n                    s[key] = val;\n                    if(key === 'fontSize') s.fontSize = parseInt(val);\n                });\n                saveToStorage();\n                draw();\n            }\n            if (key === 'textAlign') {\n                document.querySelectorAll('.btn-toggle').forEach(b => b.classList.remove('active'));\n                document.getElementById(`align-${val}`).classList.add('active');\n            }\n        }\n\n        function updateUIFromShape(s) {\n            document.getElementById('strokeColor').value = s.strokeColor;\n            document.getElementById('fillColor').value = s.fillColor;\n            document.getElementById('fontSize').value = s.fontSize;\n            document.querySelectorAll('.btn-toggle').forEach(b => b.classList.remove('active'));\n            const alignBtn = document.getElementById(`align-${s.textAlign}`);\n            if(alignBtn) alignBtn.classList.add('active');\n        }\n\n        function deleteSelected() {\n            if (selectedShapes.length > 0) {\n                // Filtra shapes mantendo apenas os que NÃO estão na lista de selecionados\n                shapes = shapes.filter(s => !selectedShapes.includes(s));\n                selectedShapes = [];\n                saveToStorage();\n                draw();\n            }\n        }\n\n        function draw() {\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\n            \n            // Desenha Formas\n            shapes.forEach(s => {\n                const isSelected = selectedShapes.includes(s);\n                s.draw(ctx, isSelected);\n            });\n\n            // Desenha Caixa de Seleção (Se estiver ativa)\n            if (isSelectingBox && selectionBox) {\n                ctx.strokeStyle = \"rgba(79, 70, 229, 0.8)\";\n                ctx.fillStyle = \"rgba(79, 70, 229, 0.1)\";\n                ctx.lineWidth = 1;\n                ctx.setLineDash([]); // Borda sólida\n                ctx.fillRect(selectionBox.x, selectionBox.y, selectionBox.w, selectionBox.h);\n                ctx.strokeRect(selectionBox.x, selectionBox.y, selectionBox.w, selectionBox.h);\n            }\n        }\n\n        function exportImage() {\n            const temp = document.createElement('canvas');\n            temp.width = canvas.width;\n            temp.height = canvas.height;\n            const tCtx = temp.getContext('2d');\n            tCtx.fillStyle = \"#ffffff\";\n            tCtx.fillRect(0,0, temp.width, temp.height);\n            shapes.forEach(s => s.draw(tCtx, false));\n            const link = document.createElement('a');\n            link.download = 'fluxograma-pro.png';\n            link.href = temp.toDataURL();\n            link.click();\n        }\n\n        // Teclado (Atalhos)\n        window.addEventListener('keydown', e => {\n            if (e.key === 'Delete') deleteSelected();\n            \n            // Ctrl + A (Selecionar Tudo)\n            if ((e.ctrlKey || e.metaKey) && e.key === 'a') {\n                e.preventDefault(); // Impede selecionar texto da página\n                selectedShapes = [...shapes]; // Seleciona todos\n                draw();\n            }\n        });\n\n        init();\n\n    </script>\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\import psutil.py",
        "conteudo": "import os\nimport sys\nimport ctypes\nimport psutil\nimport subprocess\nimport time\nimport threading\nimport ttkbootstrap as ttk\nfrom ttkbootstrap.constants import *\nfrom ttkbootstrap.scrolled import ScrolledFrame\nfrom tkinter import messagebox\n\n# --- CONFIGURAÇÕES ---\nPASTA_LOGINS = r\"C:\\Users\\Kauan Lauer\\Desktop\\Logins\"\nPORTA_CONFLITO = 53232\n\ndef is_admin():\n    try:\n        return ctypes.windll.shell32.IsUserAnAdmin()\n    except:\n        return False\n\n# Força execução como Admin para o comando netsh funcionar\nif not is_admin():\n    ctypes.windll.shell32.ShellExecuteW(None, \"runas\", sys.executable, f'\"{__file__}\"', None, 1)\n    sys.exit()\n\nclass SmartLauncher(ttk.Window):\n    def __init__(self):\n        super().__init__(themename=\"darkly\")\n        self.title(\"HeadCargo Multi-Client Dashboard\")\n        self.geometry(\"900x650\")\n        self.protocol(\"WM_DELETE_WINDOW\", self.quit)\n        \n        self.busca_var = ttk.StringVar()\n        self.busca_var.trace(\"w\", self.filtrar)\n        self.botoes = []\n\n        self.montar_tela()\n        self.carregar_atalhos()\n\n    def montar_tela(self):\n        # Header\n        hdr = ttk.Frame(self, padding=20, bootstyle=\"secondary\")\n        hdr.pack(fill=X)\n        \n        ttk.Label(hdr, text=\"GERENCIADOR DE ACESSOS\", font=(\"Impact\", 20), bootstyle=\"inverse-secondary\").pack(side=LEFT)\n        \n        # Busca\n        bus_ent = ttk.Entry(hdr, textvariable=self.busca_var, width=30)\n        bus_ent.pack(side=RIGHT, padx=10)\n        ttk.Label(hdr, text=\"FILTRAR:\", bootstyle=\"inverse-secondary\").pack(side=RIGHT)\n\n        # Container de Botões\n        self.area_botoes = ScrolledFrame(self, autohide=True)\n        self.area_botoes.pack(fill=BOTH, expand=YES, padx=10, pady=10)\n\n        # Status Bar\n        self.status = ttk.Label(self, text=\"Pronto.\", font=(\"Consolas\", 10), padding=5)\n        self.status.pack(side=BOTTOM, fill=X)\n\n    def carregar_atalhos(self):\n        if not os.path.exists(PASTA_LOGINS): return\n        \n        arquivos = [f for f in os.listdir(PASTA_LOGINS) if f.lower().endswith('.lnk')]\n        arquivos.sort()\n\n        row, col = 0, 0\n        for arq in arquivos:\n            nome = arq.replace('.lnk', '')\n            path = os.path.join(PASTA_LOGINS, arq)\n            \n            f = ttk.Frame(self.area_botoes.container, padding=5)\n            f.grid(row=row, column=col, sticky=\"ew\")\n            \n            btn = ttk.Button(f, text=nome.upper(), width=25, bootstyle=\"outline-info\",\n                             command=lambda p=path, n=nome: self.lancar(p, n))\n            btn.pack(fill=X, ipady=5)\n            \n            self.botoes.append({\"frame\": f, \"nome\": nome.lower()})\n            \n            col += 1\n            if col > 2: col = 0; row += 1\n\n    def filtrar(self, *args):\n        b = self.busca_var.get().lower()\n        for i in self.botoes:\n            i[\"frame\"].grid_remove() if b not in i[\"nome\"] else i[\"frame\"].grid()\n\n    def lancar(self, caminho, nome):\n        threading.Thread(target=self._executar, args=(caminho, nome), daemon=True).start()\n\n    def _executar(self, caminho, nome):\n        self.status.config(text=f\"Limpando porta para {nome}...\", bootstyle=\"warning\")\n        \n        # AÇÃO CIRÚRGICA: Só mata quem está na porta 53232\n        try:\n            for conn in psutil.net_connections(kind='tcp'):\n                if conn.laddr.port == PORTA_CONFLITO:\n                    psutil.Process(conn.pid).kill()\n                    self.status.config(text=\"Porta 53232 liberada!\", bootstyle=\"success\")\n                    break\n        except: pass\n\n        # Reset de socket silencioso (Oculto)\n        si = subprocess.STARTUPINFO()\n        si.dwFlags |= subprocess.STARTF_USESHOWWINDOW\n        subprocess.run(\"netsh int ip reset\", startupinfo=si, stdout=subprocess.DEVNULL)\n\n        # Abre o sistema sem fechar os outros\n        try:\n            os.startfile(caminho)\n            self.status.config(text=f\"Sistema {nome} iniciado com sucesso!\", bootstyle=\"success\")\n        except:\n            messagebox.showerror(\"Erro\", f\"Não abriu o atalho de {nome}\")\n\nif __name__ == \"__main__\":\n    SmartLauncher().mainloop()"
    },
    {
        "caminho": "Scripts\\Kan-ban.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Kanban Pro Manager - Offline</title>\n    \n    <!-- Bootstrap 5 CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <!-- Ícones FontAwesome -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    \n    <style>\n        :root {\n            --bg-body: #f4f6f9;\n            --bg-column: #ebecf0;\n            --card-shadow: 0 2px 5px rgba(0,0,0,0.1);\n        }\n\n        body {\n            background-color: var(--bg-body);\n            font-family: 'Segoe UI', 'Roboto', Helvetica, Arial, sans-serif;\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n        }\n\n        /* Navbar */\n        .navbar {\n            background-color: #fff;\n            border-bottom: 1px solid #dcdcdc;\n            height: 60px;\n            flex-shrink: 0;\n            box-shadow: 0 1px 2px rgba(0,0,0,0.05);\n        }\n\n        /* Área do Board */\n        .board-container {\n            flex-grow: 1;\n            display: flex;\n            overflow-x: auto;\n            padding: 20px;\n            gap: 24px;\n            align-items: flex-start;\n        }\n\n        /* Colunas */\n        .kanban-column {\n            background-color: var(--bg-column);\n            min-width: 340px;\n            width: 340px;\n            border-radius: 10px;\n            display: flex;\n            flex-direction: column;\n            max-height: 100%;\n            border: 1px solid #dfe1e6;\n        }\n\n        .column-header {\n            padding: 14px 16px;\n            font-weight: 700;\n            color: #42526e;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 0.95rem;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n\n        .task-list {\n            padding: 0 10px 10px 10px;\n            flex-grow: 1;\n            overflow-y: auto;\n            min-height: 50px;\n        }\n\n        /* Cartões */\n        .kanban-card {\n            background-color: #fff;\n            border-radius: 6px;\n            padding: 12px;\n            margin-bottom: 10px;\n            box-shadow: var(--card-shadow);\n            cursor: pointer;\n            border-left: 4px solid #ccc;\n            transition: all 0.2s ease;\n            position: relative;\n        }\n\n        .kanban-card:hover {\n            transform: translateY(-3px);\n            box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n        }\n\n        /* Cores de Prioridade */\n        .priority-Baixa { border-left-color: #0dcaf0; }    /* Azul Ciano */\n        .priority-Média { border-left-color: #ffc107; }    /* Amarelo */\n        .priority-Alta { border-left-color: #fd7e14; }     /* Laranja */\n        .priority-Urgente { border-left-color: #dc3545; }  /* Vermelho */\n\n        .card-title {\n            font-weight: 600;\n            color: #333;\n            margin-bottom: 8px;\n            font-size: 1rem;\n            line-height: 1.4;\n        }\n\n        .card-footer-info {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 0.75rem;\n            color: #6c757d;\n            margin-top: 10px;\n            padding-top: 8px;\n            border-top: 1px solid #f0f0f0;\n        }\n\n        /* Badges de Código */\n        .code-badges {\n            display: flex;\n            gap: 5px;\n        }\n        \n        .code-badge {\n            font-size: 0.7rem;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-weight: 600;\n        }\n\n        .badge-sql { background-color: #e3f2fd; color: #0d47a1; }\n        .badge-html { background-color: #fff3e0; color: #e65100; }\n\n        /* Estilo do Código nos Modais */\n        .code-block {\n            background-color: #212529;\n            color: #e0e0e0;\n            padding: 15px;\n            border-radius: 6px;\n            white-space: pre-wrap;\n            font-family: 'Consolas', 'Monaco', monospace;\n            font-size: 0.85rem;\n            max-height: 250px;\n            overflow-y: auto;\n            border: 1px solid #444;\n            margin-top: 5px;\n        }\n        \n        .code-label {\n            font-size: 0.85rem;\n            font-weight: 700;\n            margin-bottom: 4px;\n            display: block;\n        }\n\n        /* Drag and Drop Visuals */\n        .dragging { opacity: 0.4; border: 2px dashed #999; }\n        .drag-over { background-color: #e2e4e9; }\n    </style>\n</head>\n<body>\n\n    <!-- Navbar -->\n    <nav class=\"navbar px-4\">\n        <div class=\"d-flex align-items-center\">\n            <i class=\"fas fa-project-diagram text-primary fa-lg me-2\"></i>\n            <span class=\"h5 mb-0 fw-bold text-dark\">Kanban Pro Manager</span>\n        </div>\n        <div>\n            <button class=\"btn btn-primary shadow-sm\" data-bs-toggle=\"modal\" data-bs-target=\"#modalCriar\">\n                <i class=\"fas fa-plus me-1\"></i> Novo Chamado\n            </button>\n            <button class=\"btn btn-outline-danger ms-2 shadow-sm\" onclick=\"limparTudo()\">\n                <i class=\"fas fa-trash-alt\"></i>\n            </button>\n        </div>\n    </nav>\n\n    <!-- Quadro Kanban -->\n    <div class=\"board-container\">\n        \n        <!-- Coluna: A Fazer -->\n        <div class=\"kanban-column\" data-status=\"todo\">\n            <div class=\"column-header\">\n                <span><i class=\"far fa-circle me-1 text-secondary\"></i> A Fazer</span>\n                <span class=\"badge bg-secondary rounded-pill\" id=\"count-todo\">0</span>\n            </div>\n            <div class=\"task-list\" id=\"todo-list\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\"></div>\n        </div>\n\n        <!-- Coluna: Em Andamento -->\n        <div class=\"kanban-column\" data-status=\"doing\">\n            <div class=\"column-header\">\n                <span><i class=\"fas fa-spinner me-1 text-primary\"></i> Em Andamento</span>\n                <span class=\"badge bg-primary rounded-pill\" id=\"count-doing\">0</span>\n            </div>\n            <div class=\"task-list\" id=\"doing-list\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\"></div>\n        </div>\n\n        <!-- Coluna: Testes -->\n        <div class=\"kanban-column\" data-status=\"testing\">\n            <div class=\"column-header\">\n                <span><i class=\"fas fa-vial me-1 text-warning\"></i> Testes / QA</span>\n                <span class=\"badge bg-warning text-dark rounded-pill\" id=\"count-testing\">0</span>\n            </div>\n            <div class=\"task-list\" id=\"testing-list\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\"></div>\n        </div>\n\n        <!-- Coluna: Concluído -->\n        <div class=\"kanban-column\" data-status=\"done\">\n            <div class=\"column-header\">\n                <span><i class=\"fas fa-check-circle me-1 text-success\"></i> Concluído</span>\n                <span class=\"badge bg-success rounded-pill\" id=\"count-done\">0</span>\n            </div>\n            <div class=\"task-list\" id=\"done-list\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\"></div>\n        </div>\n\n    </div>\n\n    <!-- MODAL: Criar Novo Chamado -->\n    <div class=\"modal fade\" id=\"modalCriar\" tabindex=\"-1\">\n        <div class=\"modal-dialog modal-lg\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header bg-light\">\n                    <h5 class=\"modal-title\"><i class=\"fas fa-plus-circle text-primary me-2\"></i>Novo Chamado</h5>\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n                </div>\n                <div class=\"modal-body\">\n                    <form id=\"formTarefa\">\n                        <div class=\"row\">\n                            <div class=\"col-md-8 mb-3\">\n                                <label class=\"form-label fw-bold\">Título</label>\n                                <input type=\"text\" class=\"form-control\" id=\"titulo\" required placeholder=\"Ex: Criar Landing Page\">\n                            </div>\n                            <div class=\"col-md-4 mb-3\">\n                                <label class=\"form-label fw-bold\">Prioridade</label>\n                                <select class=\"form-select\" id=\"prioridade\">\n                                    <option value=\"Baixa\">Baixa</option>\n                                    <option value=\"Média\" selected>Média</option>\n                                    <option value=\"Alta\">Alta</option>\n                                    <option value=\"Urgente\">Urgente</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        <div class=\"mb-3\">\n                            <label class=\"form-label fw-bold\">Descrição</label>\n                            <textarea class=\"form-control\" id=\"descricao\" rows=\"3\" placeholder=\"Detalhes da atividade...\"></textarea>\n                        </div>\n\n                        <!-- Abas para SQL e HTML -->\n                        <ul class=\"nav nav-tabs\" id=\"myTab\" role=\"tablist\">\n                            <li class=\"nav-item\" role=\"presentation\">\n                                <button class=\"nav-link active\" id=\"sql-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#tab-sql\" type=\"button\" role=\"tab\"><i class=\"fas fa-database me-1\"></i> SQL</button>\n                            </li>\n                            <li class=\"nav-item\" role=\"presentation\">\n                                <button class=\"nav-link\" id=\"html-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#tab-html\" type=\"button\" role=\"tab\"><i class=\"fab fa-html5 me-1\"></i> HTML</button>\n                            </li>\n                        </ul>\n                        <div class=\"tab-content border border-top-0 p-3 rounded-bottom bg-light\">\n                            <div class=\"tab-pane fade show active\" id=\"tab-sql\" role=\"tabpanel\">\n                                <label class=\"form-text mb-1\">Cole seu script SQL aqui:</label>\n                                <textarea class=\"form-control font-monospace\" id=\"codigoSql\" rows=\"4\" placeholder=\"SELECT * FROM clientes...\" style=\"font-size: 0.9rem;\"></textarea>\n                            </div>\n                            <div class=\"tab-pane fade\" id=\"tab-html\" role=\"tabpanel\">\n                                <label class=\"form-text mb-1\">Cole seu código HTML aqui:</label>\n                                <textarea class=\"form-control font-monospace\" id=\"codigoHtml\" rows=\"4\" placeholder=\"<div class='container'>...</div>\" style=\"font-size: 0.9rem;\"></textarea>\n                            </div>\n                        </div>\n\n                    </form>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancelar</button>\n                    <button type=\"button\" class=\"btn btn-primary\" onclick=\"salvarTarefa()\">Criar Chamado</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- MODAL: Editar Chamado (Cópia do criar, mas para edição) -->\n    <div class=\"modal fade\" id=\"modalEditar\" tabindex=\"-1\">\n        <div class=\"modal-dialog modal-lg\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header bg-warning-subtle\">\n                    <h5 class=\"modal-title\"><i class=\"fas fa-edit text-dark me-2\"></i>Editar Chamado</h5>\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n                </div>\n                <div class=\"modal-body\">\n                    <form id=\"formEditar\">\n                        <input type=\"hidden\" id=\"editId\">\n                        <div class=\"row\">\n                            <div class=\"col-md-8 mb-3\">\n                                <label class=\"form-label fw-bold\">Título</label>\n                                <input type=\"text\" class=\"form-control\" id=\"editTitulo\" required>\n                            </div>\n                            <div class=\"col-md-4 mb-3\">\n                                <label class=\"form-label fw-bold\">Prioridade</label>\n                                <select class=\"form-select\" id=\"editPrioridade\">\n                                    <option value=\"Baixa\">Baixa</option>\n                                    <option value=\"Média\">Média</option>\n                                    <option value=\"Alta\">Alta</option>\n                                    <option value=\"Urgente\">Urgente</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        <div class=\"mb-3\">\n                            <label class=\"form-label fw-bold\">Descrição</label>\n                            <textarea class=\"form-control\" id=\"editDescricao\" rows=\"3\"></textarea>\n                        </div>\n\n                        <ul class=\"nav nav-tabs\" id=\"editTab\" role=\"tablist\">\n                            <li class=\"nav-item\" role=\"presentation\">\n                                <button class=\"nav-link active\" id=\"edit-sql-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#edit-tab-sql\" type=\"button\"><i class=\"fas fa-database me-1\"></i> SQL</button>\n                            </li>\n                            <li class=\"nav-item\" role=\"presentation\">\n                                <button class=\"nav-link\" id=\"edit-html-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#edit-tab-html\" type=\"button\"><i class=\"fab fa-html5 me-1\"></i> HTML</button>\n                            </li>\n                        </ul>\n                        <div class=\"tab-content border border-top-0 p-3 rounded-bottom bg-light\">\n                            <div class=\"tab-pane fade show active\" id=\"edit-tab-sql\">\n                                <textarea class=\"form-control font-monospace\" id=\"editCodigoSql\" rows=\"4\"></textarea>\n                            </div>\n                            <div class=\"tab-pane fade\" id=\"edit-tab-html\">\n                                <textarea class=\"form-control font-monospace\" id=\"editCodigoHtml\" rows=\"4\"></textarea>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancelar</button>\n                    <button type=\"button\" class=\"btn btn-primary\" onclick=\"salvarEdicao()\">Salvar Alterações</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- MODAL: Visualizar Detalhes -->\n    <div class=\"modal fade\" id=\"modalVisualizar\" tabindex=\"-1\">\n        <div class=\"modal-dialog modal-lg\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h5 class=\"modal-title fw-bold\" id=\"viewTitulo\"></h5>\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n                </div>\n                <div class=\"modal-body\">\n                    <div class=\"d-flex justify-content-between mb-4 text-muted small border-bottom pb-2\">\n                        <span id=\"viewCodigo\" class=\"fw-bold text-dark\"></span>\n                        <span id=\"viewData\"></span>\n                    </div>\n\n                    <div class=\"mb-4\">\n                        <h6 class=\"fw-bold text-secondary text-uppercase\" style=\"font-size: 0.75rem;\">Descrição</h6>\n                        <p id=\"viewDescricao\" class=\"text-dark\" style=\"white-space: pre-wrap;\"></p>\n                    </div>\n\n                    <div id=\"boxSql\" class=\"mb-3\" style=\"display: none;\">\n                        <span class=\"code-label text-primary\"><i class=\"fas fa-database\"></i> Script SQL</span>\n                        <pre id=\"viewSql\" class=\"code-block\"></pre>\n                    </div>\n\n                    <div id=\"boxHtml\" class=\"mb-3\" style=\"display: none;\">\n                        <span class=\"code-label text-danger\"><i class=\"fab fa-html5\"></i> Código HTML</span>\n                        <pre id=\"viewHtml\" class=\"code-block\" style=\"color: #ffccbc; border-color: #d84315;\"></pre>\n                    </div>\n                </div>\n                <div class=\"modal-footer bg-light justify-content-between\">\n                    <button type=\"button\" class=\"btn btn-outline-danger btn-sm\" onclick=\"deletarTarefa()\">\n                        <i class=\"fas fa-trash-alt me-1\"></i> Excluir\n                    </button>\n                    <div>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm me-1\" data-bs-dismiss=\"modal\">Fechar</button>\n                        <button type=\"button\" class=\"btn btn-primary btn-sm\" onclick=\"abrirEdicao()\">\n                            <i class=\"fas fa-pen me-1\"></i> Editar\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Scripts -->\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n\n    <script>\n        // --- 1. ESTADO DA APLICAÇÃO ---\n        let tarefas = [];\n        let tarefaAtualId = null;\n\n        // --- 2. INICIALIZAÇÃO ---\n        document.addEventListener('DOMContentLoaded', () => {\n            carregarDoLocalStorage();\n            atualizarQuadro();\n        });\n\n        // --- 3. FUNÇÕES AUXILIARES ---\n        function gerarCodigo() {\n            return 'TK-' + Math.floor(Math.random() * 10000).toString().padStart(4, '0');\n        }\n\n        // --- 4. CRIAR TAREFA ---\n        function salvarTarefa() {\n            const titulo = document.getElementById('titulo').value;\n            if (!titulo) return alert(\"O título é obrigatório!\");\n\n            const novaTarefa = {\n                id: Date.now(),\n                codigo: gerarCodigo(),\n                titulo: titulo,\n                descricao: document.getElementById('descricao').value,\n                prioridade: document.getElementById('prioridade').value,\n                sql: document.getElementById('codigoSql').value, \n                html: document.getElementById('codigoHtml').value, // Campo Novo\n                status: 'todo',\n                data: new Date().toLocaleDateString('pt-BR')\n            };\n\n            tarefas.push(novaTarefa);\n            salvarEAtualizar();\n            \n            // Limpa e fecha\n            document.getElementById('formTarefa').reset();\n            bootstrap.Modal.getInstance(document.getElementById('modalCriar')).hide();\n        }\n\n        // --- 5. VISUALIZAR TAREFA ---\n        function abrirTarefa(id) {\n            tarefaAtualId = id;\n            const tarefa = tarefas.find(t => t.id === id);\n            if (!tarefa) return;\n\n            // Preenche Modal de Visualização\n            document.getElementById('viewTitulo').innerText = tarefa.titulo;\n            document.getElementById('viewCodigo').innerText = tarefa.codigo;\n            document.getElementById('viewData').innerText = \"Criado em: \" + tarefa.data;\n            document.getElementById('viewDescricao').innerText = tarefa.descricao || \"Sem descrição.\";\n            \n            // Lógica SQL\n            const boxSql = document.getElementById('boxSql');\n            if (tarefa.sql && tarefa.sql.trim() !== \"\") {\n                boxSql.style.display = 'block';\n                document.getElementById('viewSql').innerText = tarefa.sql;\n            } else {\n                boxSql.style.display = 'none';\n            }\n\n            // Lógica HTML (Novo)\n            const boxHtml = document.getElementById('boxHtml');\n            if (tarefa.html && tarefa.html.trim() !== \"\") {\n                boxHtml.style.display = 'block';\n                document.getElementById('viewHtml').innerText = tarefa.html;\n            } else {\n                boxHtml.style.display = 'none';\n            }\n\n            new bootstrap.Modal(document.getElementById('modalVisualizar')).show();\n        }\n\n        // --- 6. EDITAR TAREFA (NOVO) ---\n        function abrirEdicao() {\n            // Fecha modal visualizar e abre modal editar\n            bootstrap.Modal.getInstance(document.getElementById('modalVisualizar')).hide();\n            \n            const tarefa = tarefas.find(t => t.id === tarefaAtualId);\n            if (!tarefa) return;\n\n            // Preenche o formulário de edição com os dados atuais\n            document.getElementById('editId').value = tarefa.id;\n            document.getElementById('editTitulo').value = tarefa.titulo;\n            document.getElementById('editPrioridade').value = tarefa.prioridade;\n            document.getElementById('editDescricao').value = tarefa.descricao;\n            document.getElementById('editCodigoSql').value = tarefa.sql || \"\";\n            document.getElementById('editCodigoHtml').value = tarefa.html || \"\";\n\n            new bootstrap.Modal(document.getElementById('modalEditar')).show();\n        }\n\n        function salvarEdicao() {\n            const id = parseInt(document.getElementById('editId').value);\n            const titulo = document.getElementById('editTitulo').value;\n            \n            if (!titulo) return alert(\"Título é obrigatório\");\n\n            // Encontra a tarefa e atualiza os campos\n            const index = tarefas.findIndex(t => t.id === id);\n            if (index !== -1) {\n                tarefas[index].titulo = titulo;\n                tarefas[index].prioridade = document.getElementById('editPrioridade').value;\n                tarefas[index].descricao = document.getElementById('editDescricao').value;\n                tarefas[index].sql = document.getElementById('editCodigoSql').value;\n                tarefas[index].html = document.getElementById('editCodigoHtml').value;\n                \n                salvarEAtualizar();\n                bootstrap.Modal.getInstance(document.getElementById('modalEditar')).hide();\n                \n                // Reabre a visualização para conferir (opcional)\n                abrirTarefa(id);\n            }\n        }\n\n        // --- 7. EXCLUIR ---\n        function deletarTarefa() {\n            if (confirm(\"Tem certeza que deseja excluir permanentemente?\")) {\n                tarefas = tarefas.filter(t => t.id !== tarefaAtualId);\n                salvarEAtualizar();\n                bootstrap.Modal.getInstance(document.getElementById('modalVisualizar')).hide();\n            }\n        }\n\n        function limparTudo() {\n            if (confirm(\"ATENÇÃO: Isso apagará TODOS os projetos. Continuar?\")) {\n                tarefas = [];\n                salvarEAtualizar();\n            }\n        }\n\n        // --- 8. RENDERIZAÇÃO E DRAG & DROP ---\n        function atualizarQuadro() {\n            // Limpa colunas\n            ['todo', 'doing', 'testing', 'done'].forEach(status => {\n                document.getElementById(status + '-list').innerHTML = '';\n            });\n            \n            const contadores = { todo: 0, doing: 0, testing: 0, done: 0 };\n\n            tarefas.forEach(tarefa => {\n                contadores[tarefa.status]++;\n                \n                // Badges de ícones\n                let badges = '';\n                if (tarefa.sql && tarefa.sql.trim()) badges += `<span class=\"code-badge badge-sql me-1\"><i class=\"fas fa-database\"></i> SQL</span>`;\n                if (tarefa.html && tarefa.html.trim()) badges += `<span class=\"code-badge badge-html\"><i class=\"fab fa-html5\"></i> HTML</span>`;\n\n                const card = `\n                    <div class=\"kanban-card priority-${tarefa.prioridade}\" \n                         draggable=\"true\" \n                         ondragstart=\"drag(event)\" \n                         id=\"${tarefa.id}\"\n                         onclick=\"abrirTarefa(${tarefa.id})\">\n                        \n                        <div class=\"d-flex justify-content-between mb-2 align-items-center\">\n                            <span class=\"badge bg-light text-secondary border rounded-1\" style=\"font-size: 0.7rem\">${tarefa.codigo}</span>\n                            <div class=\"code-badges\">${badges}</div>\n                        </div>\n                        \n                        <div class=\"card-title\">${tarefa.titulo}</div>\n                        \n                        <div class=\"card-footer-info\">\n                            <span><i class=\"fas fa-flag me-1\"></i> ${tarefa.prioridade}</span>\n                            <span><i class=\"far fa-calendar-alt me-1\"></i> ${tarefa.data.substring(0,5)}</span>\n                        </div>\n                    </div>\n                `;\n                \n                const coluna = document.getElementById(`${tarefa.status}-list`);\n                if(coluna) coluna.innerHTML += card;\n            });\n\n            // Atualiza contadores\n            Object.keys(contadores).forEach(key => {\n                document.getElementById(`count-${key}`).innerText = contadores[key];\n            });\n        }\n\n        // Drag functions\n        function allowDrop(ev) { ev.preventDefault(); ev.currentTarget.classList.add('drag-over'); }\n        function drag(ev) { ev.dataTransfer.setData(\"text\", ev.target.id); ev.target.classList.add('dragging'); }\n        \n        function drop(ev) {\n            ev.preventDefault();\n            document.querySelectorAll('.task-list').forEach(el => el.classList.remove('drag-over'));\n            \n            const id = parseInt(ev.dataTransfer.getData(\"text\"));\n            const card = document.getElementById(id);\n            if(card) card.classList.remove('dragging');\n\n            let target = ev.target;\n            while (!target.classList.contains('kanban-column')) {\n                target = target.parentElement;\n                if(!target) return;\n            }\n\n            const novoStatus = target.getAttribute('data-status');\n            const index = tarefas.findIndex(t => t.id === id);\n            \n            if (index > -1 && tarefas[index].status !== novoStatus) {\n                tarefas[index].status = novoStatus;\n                salvarEAtualizar();\n            }\n        }\n        \n        // Remove efeito visual ao sair da área de drop\n        document.querySelectorAll('.task-list').forEach(el => {\n            el.addEventListener('dragleave', (e) => e.currentTarget.classList.remove('drag-over'));\n        });\n\n        // --- 9. PERSISTÊNCIA ---\n        function salvarEAtualizar() {\n            localStorage.setItem('kanbanProDB', JSON.stringify(tarefas));\n            atualizarQuadro();\n        }\n\n        function carregarDoLocalStorage() {\n            const dados = localStorage.getItem('kanbanProDB');\n            // Tenta migrar dados antigos se existirem (do código anterior)\n            const dadosAntigos = localStorage.getItem('kanbanSqlDB');\n            \n            if (dados) {\n                tarefas = JSON.parse(dados);\n            } else if (dadosAntigos) {\n                // Migração simples\n                tarefas = JSON.parse(dadosAntigos);\n                localStorage.setItem('kanbanProDB', JSON.stringify(tarefas));\n            }\n        }\n    </script>\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Leitor_SQL_Visualizador.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Visualizador SQL Fullscreen</title>\n    \n    <!-- Bibliotecas Externas -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css\">\n    <script src=\"https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js\"></script>\n\n    <style>\n        /* Reset e Configuração Básica */\n        body, html {\n            height: 100%;\n            margin: 0;\n            padding: 0;\n            overflow: hidden; /* Remove barras de rolagem da janela */\n            font-family: 'Segoe UI', sans-serif;\n            background-color: #f8f9fa;\n        }\n\n        /* Container Principal que divide a tela */\n        .app-container {\n            display: flex;\n            height: 100vh;\n            width: 100vw;\n        }\n\n        /* --- PAINEL ESQUERDO (CÓDIGO) --- */\n        .sidebar {\n            width: 400px;\n            background: #1e293b; /* Cor escura profissional */\n            color: white;\n            display: flex;\n            flex-direction: column;\n            transition: margin-left 0.3s ease;\n            z-index: 100;\n            flex-shrink: 0; /* Impede que ele encolha */\n            box-shadow: 2px 0 10px rgba(0,0,0,0.3);\n        }\n\n        .sidebar.closed {\n            margin-left: -400px; /* Esconde o painel puxando para esquerda */\n        }\n\n        .sidebar-header {\n            padding: 20px;\n            border-bottom: 1px solid #334155;\n            background: #0f172a;\n        }\n\n        .sidebar-content {\n            flex: 1;\n            padding: 20px;\n            display: flex;\n            flex-direction: column;\n        }\n\n        textarea {\n            flex: 1;\n            width: 100%;\n            background: #334155;\n            color: #e2e8f0;\n            border: 1px solid #475569;\n            border-radius: 6px;\n            padding: 10px;\n            font-family: monospace;\n            font-size: 13px;\n            resize: none;\n        }\n        textarea:focus { outline: 2px solid #3b82f6; }\n\n        /* --- ÁREA PRINCIPAL (DIAGRAMA) --- */\n        .main-content {\n            flex: 1; /* Ocupa todo o espaço restante */\n            position: relative;\n            background-color: white;\n            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);\n            background-size: 20px 20px;\n            display: flex;\n            flex-direction: column;\n        }\n\n        /* Onde o desenho vai aparecer */\n        #diagrama-wrapper {\n            flex: 1; /* Força altura total */\n            width: 100%;\n            height: 100%;\n            overflow: hidden; /* O zoom cuida da rolagem */\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n\n        /* Estilo para SVG ocupar tudo (CRUCIAL) */\n        #diagrama-wrapper svg {\n            width: 100%;\n            height: 100%;\n            max-width: none !important; /* Remove limites do Mermaid */\n        }\n\n        /* Botão Flutuante para Abrir Menu */\n        .toggle-btn {\n            position: absolute;\n            top: 20px;\n            left: 20px;\n            background: #2563eb;\n            color: white;\n            border: none;\n            width: 40px;\n            height: 40px;\n            border-radius: 8px;\n            cursor: pointer;\n            z-index: 50;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n        }\n        .toggle-btn:hover { background: #1d4ed8; }\n\n        /* Abas no topo do diagrama */\n        .top-tabs {\n            position: absolute;\n            top: 20px;\n            right: 20px;\n            background: white;\n            padding: 5px;\n            border-radius: 8px;\n            box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n            z-index: 50;\n            display: flex;\n            gap: 5px;\n        }\n        .tab-btn {\n            padding: 8px 15px;\n            border: none;\n            background: transparent;\n            cursor: pointer;\n            border-radius: 5px;\n            font-weight: 600;\n            color: #64748b;\n        }\n        .tab-btn.active { background: #eff6ff; color: #2563eb; }\n\n        /* Controles de Zoom no canto inferior */\n        .zoom-tools {\n            position: absolute;\n            bottom: 20px;\n            right: 20px;\n            display: flex;\n            flex-direction: column;\n            gap: 5px;\n            background: white;\n            padding: 5px;\n            border-radius: 8px;\n            box-shadow: 0 4px 10px rgba(0,0,0,0.1);\n            z-index: 50;\n        }\n        .tool-btn {\n            width: 35px;\n            height: 35px;\n            border: 1px solid #e2e8f0;\n            background: white;\n            border-radius: 5px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        .tool-btn:hover { background: #f8fafc; color: #2563eb; }\n        \n        /* Modal de Colunas */\n        #modalColunas {\n            position: absolute;\n            top: 70px; right: 20px; bottom: 20px; width: 400px;\n            background: white;\n            border-left: 1px solid #e2e8f0;\n            box-shadow: -5px 0 15px rgba(0,0,0,0.05);\n            z-index: 40;\n            padding: 20px;\n            overflow-y: auto;\n            display: none; /* Escondido por padrão */\n        }\n    </style>\n</head>\n<body>\n\n<div class=\"app-container\">\n    \n    <!-- 1. Painel Lateral (Código) -->\n    <div class=\"sidebar\" id=\"sidebar\">\n        <div class=\"sidebar-header\">\n            <h5 class=\"m-0 fw-bold\"><i class=\"bi bi-database me-2\"></i>Visualizador SQL</h5>\n        </div>\n        <div class=\"sidebar-content\">\n            <label class=\"form-label text-muted small\">COLE SEU SELECT AQUI:</label>\n            <textarea id=\"sqlInput\" placeholder=\"SELECT ... FROM ...\"></textarea>\n            \n            <button onclick=\"gerar()\" class=\"btn btn-primary w-100 mt-3 py-2 fw-bold\">\n                <i class=\"bi bi-play-fill me-1\"></i> DESMEMBRAR\n            </button>\n        </div>\n    </div>\n\n    <!-- 2. Área Principal -->\n    <div class=\"main-content\">\n        \n        <!-- Botão para reabrir o menu -->\n        <button class=\"toggle-btn\" onclick=\"toggleSidebar()\" title=\"Abrir/Fechar Código\">\n            <i class=\"bi bi-list\"></i>\n        </button>\n\n        <!-- Abas -->\n        <div class=\"top-tabs\">\n            <button class=\"tab-btn active\" onclick=\"showView('visual')\">Visual</button>\n            <button class=\"tab-btn\" onclick=\"showView('colunas')\">Colunas</button>\n        </div>\n\n        <!-- Onde o Diagrama Fica -->\n        <div id=\"diagrama-wrapper\">\n            <div class=\"text-muted text-center opacity-50\">\n                <i class=\"bi bi-arrow-left display-6\"></i><br>\n                Cole o SQL e clique em Desmembrar\n            </div>\n        </div>\n\n        <!-- Painel de Colunas (Sobreposto) -->\n        <div id=\"modalColunas\">\n            <h5 class=\"fw-bold mb-3\">Colunas do Relatório</h5>\n            <table class=\"table table-sm table-hover\" style=\"font-size: 0.9rem;\">\n                <thead class=\"table-light\"><tr><th>Nome Final</th><th>Tabela</th></tr></thead>\n                <tbody id=\"tbodyColunas\"></tbody>\n            </table>\n        </div>\n\n        <!-- Controles de Zoom -->\n        <div class=\"zoom-tools\" id=\"zoomTools\" style=\"display: none;\">\n            <button class=\"tool-btn\" onclick=\"zoomIn()\"><i class=\"bi bi-plus-lg\"></i></button>\n            <button class=\"tool-btn\" onclick=\"zoomOut()\"><i class=\"bi bi-dash-lg\"></i></button>\n            <button class=\"tool-btn\" onclick=\"fitZoom()\"><i class=\"bi bi-arrows-fullscreen\"></i></button>\n        </div>\n\n    </div>\n</div>\n\n<!-- SCRIPTS -->\n<script type=\"module\">\n    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';\n    mermaid.initialize({ startOnLoad: false, theme: 'base', securityLevel: 'loose' });\n    window.mermaid = mermaid;\n</script>\n\n<script>\n    let panZoomInstance = null;\n    let sidebarOpen = true;\n\n    function toggleSidebar() {\n        const sidebar = document.getElementById('sidebar');\n        sidebarOpen = !sidebarOpen;\n        if(sidebarOpen) sidebar.classList.remove('closed');\n        else sidebar.classList.add('closed');\n        \n        // Redimensionar após animação\n        setTimeout(() => { if(panZoomInstance) panZoomInstance.resize(); }, 350);\n    }\n\n    function showView(tipo) {\n        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));\n        event.target.classList.add('active');\n\n        if(tipo === 'colunas') {\n            document.getElementById('modalColunas').style.display = 'block';\n        } else {\n            document.getElementById('modalColunas').style.display = 'none';\n        }\n    }\n\n    async function gerar() {\n        const sql = document.getElementById('sqlInput').value;\n        if(!sql.trim()) return alert(\"Cole o SQL primeiro!\");\n\n        // Fecha sidebar para dar espaço\n        sidebarOpen = true; \n        toggleSidebar(); \n\n        // Limpeza básica\n        let cleanSql = sql.replace(/\\s+/g, ' ').trim();\n        \n        // Processar Tabelas e Ligações\n        const regexTabelas = /\\b(FROM|JOIN|LEFT OUTER JOIN|INNER JOIN)\\s+([a-zA-Z0-9_.]+)\\s+([a-zA-Z0-9_]+)/gi;\n        const regexOn = /\\bON\\s+([a-zA-Z0-9_.]+)\\s*=\\s*([a-zA-Z0-9_.]+)/gi;\n        const selectMatch = cleanSql.match(/SELECT\\s+(.+?)\\s+FROM/i);\n        const whereMatch = cleanSql.match(/WHERE\\s+(.+?)(?=\\s+(ORDER|GROUP)|$)/i);\n\n        let mapa = {};\n        let principal = \"\";\n        let aliasPrincipal = \"\";\n        let nos = [];\n        \n        let match;\n        while ((match = regexTabelas.exec(sql)) !== null) {\n            let nome = match[2];\n            let alias = match[3];\n            if(['AS','ON','WHERE'].includes(alias.toUpperCase())) continue;\n            \n            mapa[alias] = nome;\n            \n            if(match[1].toUpperCase() === 'FROM') {\n                principal = alias;\n                aliasPrincipal = alias;\n                nos.push(`${alias}[\"<b>TABELA PRINCIPAL</b><br/>${nome}\"]:::principal`);\n            } else {\n                nos.push(`${alias}[\"${nome}\"]:::secundaria`);\n            }\n        }\n\n        let ligacoes = [];\n        let matchOn;\n        while ((matchOn = regexOn.exec(sql)) !== null) {\n            let p1 = matchOn[1].split('.');\n            let p2 = matchOn[2].split('.');\n            if(p1.length === 2 && p2.length === 2) {\n                ligacoes.push(`${p1[0]} -->|${p1[1]}| ${p2[0]}`);\n            }\n        }\n\n        // Construir Gráfico\n        let graph = \"graph TD\\n\";\n        graph += \"classDef principal fill:#dcfce7,stroke:#15803d,stroke-width:2px;\\n\";\n        graph += \"classDef secundaria fill:#eff6ff,stroke:#2563eb;\\n\";\n        graph += \"classDef filtro fill:#fef9c3,stroke:#a16207,stroke-dasharray: 5 5;\\n\";\n\n        nos.forEach(n => graph += n + \"\\n\");\n        ligacoes.forEach(l => graph += l + \"\\n\");\n\n        if(whereMatch && aliasPrincipal) {\n            let filtro = whereMatch[1].substring(0, 60) + \"...\";\n            graph += `Filtro[\"Filtro: ${filtro}\"]:::filtro\\n`;\n            graph += `${aliasPrincipal} -.-> Filtro\\n`;\n        }\n\n        // Processar Colunas\n        let tbody = \"\";\n        if(selectMatch) {\n            let cols = selectMatch[1].split(/,(?![^(]*\\))/);\n            cols.forEach(c => {\n                let parts = c.split(/\\s+AS\\s+/i);\n                let nome = parts.length > 1 ? parts[1].trim() : parts[0].trim();\n                let origem = \"Calculado\";\n                let matchAlias = parts[0].trim().match(/^([a-zA-Z0-9_]+)\\./);\n                if(matchAlias && mapa[matchAlias[1]]) origem = mapa[matchAlias[1]];\n                \n                tbody += `<tr><td><b>${nome}</b></td><td class=\"text-muted\">${origem}</td></tr>`;\n            });\n        }\n        document.getElementById('tbodyColunas').innerHTML = tbody;\n\n        // Renderizar\n        await renderizar(graph);\n    }\n\n    async function renderizar(codigo) {\n        const wrapper = document.getElementById('diagrama-wrapper');\n        \n        // Limpar anterior\n        if(panZoomInstance) { panZoomInstance.destroy(); panZoomInstance = null; }\n        wrapper.innerHTML = '<div class=\"spinner-border text-primary\"></div>';\n\n        try {\n            const { svg } = await window.mermaid.render('meuGrafico', codigo);\n            wrapper.innerHTML = svg;\n\n            const svgElement = wrapper.querySelector('svg');\n            \n            // TRUQUE PARA CORRIGIR O CORTE\n            svgElement.style.width = '100%';\n            svgElement.style.height = '100%';\n            svgElement.removeAttribute('maxWidth'); \n            svgElement.removeAttribute('height'); // Remove altura fixa gerada pelo mermaid\n            \n            // Ativa o Zoom\n            panZoomInstance = svgPanZoom(svgElement, {\n                zoomEnabled: true,\n                controlIconsEnabled: false,\n                fit: true,\n                center: true,\n                minZoom: 0.1,\n                maxZoom: 20\n            });\n            \n            document.getElementById('zoomTools').style.display = 'flex';\n\n        } catch(e) {\n            wrapper.innerHTML = `<div class=\"alert alert-danger\">Erro no SQL: ${e.message}</div>`;\n        }\n    }\n\n    // Funções Globais para os botões HTML chamarem\n    window.zoomIn = () => panZoomInstance && panZoomInstance.zoomIn();\n    window.zoomOut = () => panZoomInstance && panZoomInstance.zoomOut();\n    window.fitZoom = () => {\n        if(panZoomInstance) {\n            panZoomInstance.resetZoom();\n            panZoomInstance.fit();\n            panZoomInstance.center();\n        }\n    };\n    window.toggleSidebar = toggleSidebar;\n    window.gerar = gerar;\n    window.showView = showView;\n\n</script>\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\mapeador_db.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>DB- Headsoft Edition</title>\n    \n    <!-- Bibliotecas Externas (CDN) -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <script crossorigin src=\"https://unpkg.com/react@18/umd/react.development.js\"></script>\n    <script crossorigin src=\"https://unpkg.com/react-dom@18/umd/react-dom.development.js\"></script>\n    <script src=\"https://unpkg.com/@babel/standalone/babel.min.js\"></script>\n    <script src=\"https://unpkg.com/lucide@latest\"></script>\n\n    <!-- Fontes -->\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap\" rel=\"stylesheet\">\n\n    <!-- ESTILOS GLOBAIS (CSS) -->\n    <style>\n        :root {\n            --bg-app: #f8fafc;\n            --bg-sidebar: #0f172a;\n            --primary: #2563eb;\n            --border-color: #e2e8f0;\n        }\n        \n        body { background-color: var(--bg-app); font-family: 'Inter', sans-serif; overflow: hidden; margin: 0; }\n        .font-mono { font-family: 'JetBrains Mono', monospace; }\n        \n        /* Scrollbar Premium */\n        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }\n        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }\n        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }\n        \n        /* Utilitários de Animação */\n        .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }\n        .animate-slide-in { animation: slideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }\n        \n        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }\n\n        /* Estilo para Cartões de Conexão */\n        .connection-card {\n            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n            border-left: 4px solid transparent;\n        }\n        .connection-card:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\n            border-left-color: var(--primary);\n        }\n\n        /* Tabs */\n        .tab-btn {\n            position: relative;\n            transition: all 0.2s;\n        }\n        .tab-btn.active {\n            color: var(--primary);\n            font-weight: 600;\n        }\n        .tab-btn.active::after {\n            content: '';\n            position: absolute;\n            bottom: -1px;\n            left: 0;\n            right: 0;\n            height: 2px;\n            background-color: var(--primary);\n        }\n\n        /* Destaque de busca */\n        .highlight-match {\n            background-color: #fef08a;\n            color: #854d0e;\n            padding: 0 2px;\n            border-radius: 2px;\n        }\n    </style>\n</head>\n<body>\n    <div id=\"root\"></div>\n\n    <script type=\"text/babel\">\n        // ==========================================\n        // MÓDULO 1: UTILITÁRIOS E CONSTANTES\n        // ==========================================\n        const { useState, useMemo, useEffect, useRef, useCallback } = React;\n\n        const Icon = ({ name, size = 16, className = \"\" }) => {\n            const ref = useRef(null);\n            useEffect(() => {\n                if (!window.lucide || !ref.current) return;\n                ref.current.innerHTML = `<i data-lucide=\"${name}\" width=\"${size}\" height=\"${size}\" class=\"${className}\"></i>`;\n                window.lucide.createIcons({ root: ref.current, attrs: { class: className, width: size, height: size } });\n            }, [name, size, className]);\n            return <span ref={ref} style={{ display: 'inline-flex', verticalAlign: 'middle' }}></span>;\n        };\n\n        // ==========================================\n        // MÓDULO 2: COMPONENTES UI\n        // ==========================================\n\n        const TableTypeBadge = ({ name }) => {\n            if (!name) return null;\n            if (name.startsWith('cad_')) return <span className=\"px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-emerald-100 text-emerald-700 border border-emerald-200\">Cadastro</span>;\n            if (name.startsWith('mov_')) return <span className=\"px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-amber-100 text-amber-700 border border-amber-200\">Movimentação</span>;\n            if (name.startsWith('aux_')) return <span className=\"px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-purple-100 text-purple-700 border border-purple-200\">Auxiliar</span>;\n            return <span className=\"px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-slate-100 text-slate-600 border border-slate-200\">Sistema</span>;\n        };\n\n        const SqlModal = ({ sql, onClose }) => {\n            if (!sql) return null;\n            const copy = () => { navigator.clipboard.writeText(sql); onClose(); };\n            return (\n                <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\">\n                    <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm animate-fade-in\" onClick={onClose}></div>\n                    <div className=\"relative bg-white rounded-xl shadow-2xl w-full max-w-2xl animate-fade-in overflow-hidden border border-slate-200\">\n                        <div className=\"flex justify-between items-center px-6 py-4 bg-slate-50 border-b border-slate-200\">\n                            <h3 className=\"font-bold text-slate-700 flex items-center gap-2\"><Icon name=\"code\" /> Gerador de SQL</h3>\n                            <button onClick={onClose} className=\"text-slate-400 hover:text-slate-600\"><Icon name=\"x\" /></button>\n                        </div>\n                        <div className=\"p-0 bg-[#1e293b]\"><pre className=\"text-emerald-400 font-mono text-sm p-6 overflow-x-auto whitespace-pre-wrap\">{sql}</pre></div>\n                        <div className=\"p-4 bg-white border-t border-slate-200 flex justify-end gap-3\">\n                            <button onClick={onClose} className=\"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg\">Fechar</button>\n                            <button onClick={copy} className=\"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 font-medium shadow-lg shadow-blue-500/30\"><Icon name=\"copy\" size={16} /> Copiar Código</button>\n                        </div>\n                    </div>\n                </div>\n            );\n        };\n\n        // Modal para Seleção de Tabela (Comparação)\n        const SelectionModal = ({ isOpen, onClose, tables, onSelect }) => {\n            const [filter, setFilter] = useState('');\n            if (!isOpen) return null;\n            \n            const filtered = tables.filter(t => t.name.toLowerCase().includes(filter.toLowerCase()));\n\n            return (\n                <div className=\"fixed inset-0 z-[70] flex items-center justify-center p-4\">\n                    <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm animate-fade-in\" onClick={onClose}></div>\n                    <div className=\"relative bg-white rounded-xl shadow-2xl w-full max-w-md animate-fade-in overflow-hidden border border-slate-200 flex flex-col max-h-[80vh]\">\n                        <div className=\"px-4 py-3 border-b border-slate-100 bg-slate-50\">\n                            <h3 className=\"font-bold text-slate-700 mb-2\">Comparar com qual tabela?</h3>\n                            <div className=\"relative\">\n                                <span className=\"absolute left-3 top-2.5 text-slate-400\"><Icon name=\"search\" size={14} /></span>\n                                <input autoFocus type=\"text\" placeholder=\"Buscar tabela...\" value={filter} onChange={e => setFilter(e.target.value)} className=\"w-full pl-9 pr-3 py-2 bg-white border border-slate-200 rounded text-sm focus:outline-none focus:border-blue-500\" />\n                            </div>\n                        </div>\n                        <div className=\"flex-1 overflow-y-auto custom-scrollbar p-2\">\n                            {filtered.map(t => (\n                                <button key={t.name} onClick={() => onSelect(t)} className=\"w-full text-left px-3 py-2 rounded text-xs font-mono hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2 transition-colors\">\n                                    <span className={`w-1.5 h-1.5 rounded-full ${t.name.startsWith('cad_') ? 'bg-emerald-400' : t.name.startsWith('mov_') ? 'bg-amber-400' : 'bg-slate-300'}`}></span>\n                                    {t.name}\n                                </button>\n                            ))}\n                        </div>\n                    </div>\n                </div>\n            );\n        };\n\n        const Drawer = ({ title, isOpen, onClose, children, width = \"w-[600px]\" }) => {\n            if (!isOpen) return null;\n            useEffect(() => {\n                const handleEsc = (e) => { if (e.key === 'Escape') onClose(); };\n                window.addEventListener('keydown', handleEsc);\n                return () => window.removeEventListener('keydown', handleEsc);\n            }, [onClose]);\n            return (\n                <div className=\"fixed inset-0 z-50 flex justify-end\">\n                    <div className=\"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity animate-fade-in\" onClick={onClose}></div>\n                    <div className={`relative ${width} h-full bg-white shadow-2xl animate-slide-in flex flex-col border-l border-slate-200`}>\n                        <div className=\"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50\">\n                            <h3 className=\"font-bold text-slate-800 text-lg truncate pr-4\">{title}</h3>\n                            <button onClick={onClose} className=\"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-500\"><Icon name=\"x\" size={20} /></button>\n                        </div>\n                        <div className=\"flex-1 overflow-y-auto p-0 bg-white custom-scrollbar\">{children}</div>\n                    </div>\n                </div>\n            );\n        };\n\n        const ContextMenu = ({ x, y, visible, targetName, onAction, onClose }) => {\n            const menuRef = useRef(null);\n            useEffect(() => {\n                const handleClickOutside = (event) => { if (menuRef.current && !menuRef.current.contains(event.target)) onClose(); };\n                if (visible) document.addEventListener(\"mousedown\", handleClickOutside);\n                return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n            }, [visible, onClose]);\n            if (!visible) return null;\n            return (\n                <div ref={menuRef} className=\"fixed bg-white border border-slate-200 shadow-2xl rounded-lg py-1 w-60 z-[100] animate-fade-in\" style={{ top: Math.min(y, window.innerHeight - 300), left: Math.min(x, window.innerWidth - 240) }}>\n                    <div className=\"px-4 py-2 border-b border-slate-100 bg-slate-50\">\n                        <span className=\"text-[10px] uppercase font-bold text-slate-400\">Ações para</span>\n                        <div className=\"font-bold text-slate-700 text-sm truncate\">{targetName}</div>\n                    </div>\n                    <div className=\"p-1 space-y-0.5\">\n                        <button onClick={() => onAction('navigate')} className=\"w-full text-left px-3 py-2 text-sm text-slate-600 hover:bg-blue-50 hover:text-blue-600 rounded flex items-center gap-2\"><Icon name=\"arrow-right-circle\" /> Ir para Tabela</button>\n                        <button onClick={() => onAction('favorite')} className=\"w-full text-left px-3 py-2 text-sm text-slate-600 hover:bg-amber-50 hover:text-amber-600 rounded flex items-center gap-2\"><Icon name=\"star\" /> Favoritar/Desfavoritar</button>\n                        <button onClick={() => onAction('sql')} className=\"w-full text-left px-3 py-2 text-sm text-slate-600 hover:bg-emerald-50 hover:text-emerald-600 rounded flex items-center gap-2\"><Icon name=\"code\" /> Gerar SQL Join</button>\n                        <div className=\"h-px bg-slate-100 my-1\"></div>\n                        <button onClick={() => onAction('copy')} className=\"w-full text-left px-3 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded flex items-center gap-2\"><Icon name=\"copy\" /> Copiar Nome</button>\n                    </div>\n                </div>\n            );\n        };\n\n        // ==========================================\n        // MÓDULO 3: APLICAÇÃO PRINCIPAL\n        // ==========================================\n\n        function App() {\n            // --- ESTADOS PERSISTENTES (LOCALSTORAGE) ---\n            const [tables, setTables] = useState(() => {\n                const saved = localStorage.getItem('db_architect_tables');\n                return saved ? JSON.parse(saved) : [];\n            });\n            const [favorites, setFavorites] = useState(() => {\n                const saved = localStorage.getItem('db_architect_favorites');\n                return saved ? JSON.parse(saved) : [];\n            });\n\n            // Recupera a última tabela selecionada\n            const [selectedTable, setSelectedTable] = useState(() => {\n                const savedName = localStorage.getItem('db_architect_selected_table_name');\n                if (savedName && tables.length > 0) {\n                    return tables.find(t => t.name === savedName) || null;\n                }\n                return null;\n            });\n\n            const [activeTab, setActiveTab] = useState(() => {\n                return localStorage.getItem('db_architect_active_tab') || 'structure';\n            });\n            \n            const [history, setHistory] = useState([]);\n\n            const [searchTerm, setSearchTerm] = useState(\"\");\n            const [columnSearch, setColumnSearch] = useState(\"\");\n            const [fileName, setFileName] = useState(\"\");\n            const [error, setError] = useState(null);\n            const [notification, setNotification] = useState(null);\n            const [generatedSql, setGeneratedSql] = useState(null);\n\n            const [previewTable, setPreviewTable] = useState(null); \n            const [previewMode, setPreviewMode] = useState('structure');\n            const [ctxMenu, setCtxMenu] = useState({ visible: false, x: 0, y: 0, target: null });\n            \n            const [isCompareSelectionOpen, setIsCompareSelectionOpen] = useState(false);\n            const [comparisonResult, setComparisonResult] = useState(null);\n\n            const fileInputRef = useRef(null);\n\n            // --- EFEITOS PARA PERSISTÊNCIA ---\n            useEffect(() => {\n                if (tables.length > 0) localStorage.setItem('db_architect_tables', JSON.stringify(tables));\n            }, [tables]);\n\n            useEffect(() => {\n                localStorage.setItem('db_architect_favorites', JSON.stringify(favorites));\n            }, [favorites]);\n\n            // Salva a tabela selecionada sempre que mudar\n            useEffect(() => {\n                if (selectedTable) {\n                    localStorage.setItem('db_architect_selected_table_name', selectedTable.name);\n                } else {\n                    localStorage.removeItem('db_architect_selected_table_name');\n                }\n                setColumnSearch(\"\"); // Limpa busca de coluna ao trocar\n            }, [selectedTable]);\n\n            // Salva a aba ativa (Estrutura/Ligações)\n            useEffect(() => {\n                localStorage.setItem('db_architect_active_tab', activeTab);\n            }, [activeTab]);\n\n            // --- LÓGICA DE DADOS ---\n            const toggleFavorite = (tableName) => {\n                setFavorites(prev => {\n                    if (prev.includes(tableName)) return prev.filter(t => t !== tableName);\n                    return [...prev, tableName];\n                });\n                if (!favorites.includes(tableName)) showNotification(`\"${tableName}\" adicionado aos favoritos`);\n            };\n\n            const clearData = () => {\n                if (confirm(\"Tem certeza? Isso apagará todas as tabelas e favoritos salvos.\")) {\n                    localStorage.removeItem('db_architect_tables');\n                    localStorage.removeItem('db_architect_favorites');\n                    localStorage.removeItem('db_architect_selected_table_name');\n                    localStorage.removeItem('db_architect_active_tab');\n                    setTables([]);\n                    setFavorites([]);\n                    setSelectedTable(null);\n                    setHistory([]);\n                    showNotification(\"Dados limpos com sucesso.\");\n                }\n            };\n\n            const handleFileUpload = (event) => {\n                const file = event.target.files[0];\n                if (!file) return;\n                setFileName(file.name);\n                setError(null);\n                \n                const reader = new FileReader();\n                reader.onload = (e) => {\n                    const text = e.target.result.trim();\n                    let parsedData = [];\n                    try {\n                        parsedData = JSON.parse(text);\n                    } catch (err) {\n                        try {\n                            const lines = text.split(/\\r?\\n/);\n                            lines.forEach(line => {\n                                const clean = line.trim().replace(/,$/, '');\n                                if(clean) parsedData.push(JSON.parse(clean));\n                            });\n                        } catch (err2) {\n                            const start = text.indexOf('[');\n                            const end = text.lastIndexOf('}');\n                            if (start > -1 && end > -1) {\n                                let fix = text.substring(start, end + 1);\n                                if (!fix.endsWith(']')) fix += ']';\n                                try { parsedData = JSON.parse(fix); } catch(e) {}\n                            }\n                        }\n                    }\n\n                    if (parsedData.length > 0) {\n                        processData(parsedData);\n                        showNotification(\"Tabelas importadas e salvas!\");\n                    }\n                    else setError(\"Arquivo inválido. Tente novamente.\");\n                };\n                reader.readAsText(file);\n            };\n\n            const processData = (rawData) => {\n                let dataArray = Array.isArray(rawData) ? rawData : (rawData.data || [rawData]);\n                const processed = [];\n                dataArray.forEach(item => {\n                    let tName = item.nomeTabela || item.Tabela || item.name;\n                    if (!tName) return;\n                    let cols = item.colunas || item.c || item.columns || [];\n                    const pCols = [];\n                    if (Array.isArray(cols)) {\n                        cols.forEach(c => {\n                            pCols.push({\n                                name: c.nomeColuna || c.Coluna || c.name,\n                                isPk: Boolean(c.isPk === true || c.isPk === 1 || c.IsPK === true),\n                                isFk: Boolean(c.isFk === true || c.isFk === 1 || c.IsFK === true)\n                            });\n                        });\n                    }\n                    if (pCols.length > 0) processed.push({ name: tName, columns: pCols });\n                });\n                setTables(processed.sort((a,b) => a.name.localeCompare(b.name)));\n            };\n\n            // --- ENGINE DE CONEXÕES ---\n            const getConnections = useCallback((currentTable) => {\n                if (!currentTable || !currentTable.columns) return [];\n                const links = [];\n                const tableMap = new Map(tables.map(t => [t.name.toLowerCase(), t]));\n\n                const findTable = (name) => {\n                    const clean = name.toLowerCase();\n                    if (tableMap.has(clean)) return tableMap.get(clean);\n                    if (tableMap.has(`cad_${clean}`)) return tableMap.get(`cad_${clean}`);\n                    if (tableMap.has(`mov_${clean}`)) return tableMap.get(`mov_${clean}`);\n                    if (tableMap.has(clean.replace(/s$/, ''))) return tableMap.get(clean.replace(/s$/, ''));\n                    return null;\n                };\n\n                currentTable.columns.forEach(col => {\n                    if (col.isFk || (col.name.startsWith(\"Id\") && !col.isPk)) {\n                        const baseName = col.name.replace(/^Id/, \"\");\n                        if (baseName.length > 1) {\n                            const target = findTable(baseName);\n                            if (target && target.name !== currentTable.name) {\n                                const targetCol = target.columns.find(c => c.name === col.name);\n                                if (targetCol) {\n                                    links.push({ otherTable: target.name, myCol: col.name, otherCol: targetCol.name, type: 'Link Direto' });\n                                }\n                            }\n                        }\n                    }\n                });\n\n                const myPk = currentTable.columns.find(c => c.isPk);\n                if (myPk) {\n                    tables.forEach(t => {\n                        if (t.name === currentTable.name) return;\n                        const matchingCol = t.columns.find(c => c.name === myPk.name);\n                        if (matchingCol) {\n                            links.push({ otherTable: t.name, myCol: myPk.name, otherCol: matchingCol.name, type: 'Referência' });\n                        }\n                    });\n                }\n\n                const unique = [];\n                const keys = new Set();\n                links.forEach(l => {\n                    const key = `${l.otherTable}-${l.myCol}-${l.otherCol}`;\n                    if (!keys.has(key)) { keys.add(key); unique.push(l); }\n                });\n                return unique.sort((a,b) => a.otherTable.localeCompare(b.otherTable));\n            }, [tables]);\n\n            // --- LÓGICA DE COMPARAÇÃO ---\n            const startComparison = (targetTable) => {\n                setIsCompareSelectionOpen(false);\n                if (!selectedTable || !targetTable) return;\n\n                const allConnections = getConnections(selectedTable);\n                const directLinks = allConnections.filter(c => c.otherTable === targetTable.name);\n                \n                const commonCols = [];\n                selectedTable.columns.forEach(cA => {\n                    const match = targetTable.columns.find(cB => cB.name === cA.name);\n                    if (match && !directLinks.find(l => l.myCol === cA.name)) {\n                        commonCols.push(cA.name);\n                    }\n                });\n\n                setComparisonResult({\n                    tableA: selectedTable,\n                    tableB: targetTable,\n                    directLinks,\n                    commonCols\n                });\n            };\n\n            // --- COMPUTADOS (FILTROS E FAVORITOS) ---\n            const { favTables, otherTables } = useMemo(() => {\n                const lower = searchTerm.toLowerCase();\n                const filtered = tables.filter(t => \n                    !searchTerm || \n                    t.name.toLowerCase().includes(lower) || \n                    t.columns.some(c => c.name.toLowerCase().includes(lower))\n                );\n\n                const favs = [];\n                const others = [];\n\n                filtered.forEach(t => {\n                    if (favorites.includes(t.name)) favs.push(t);\n                    else others.push(t);\n                });\n\n                return { favTables: favs, otherTables: others };\n            }, [tables, searchTerm, favorites]);\n\n            const currentConnections = useMemo(() => getConnections(selectedTable), [selectedTable, getConnections]);\n            const previewConnectionsList = useMemo(() => getConnections(previewTable), [previewTable, getConnections]);\n\n            const filteredColumns = useMemo(() => {\n                if (!selectedTable) return [];\n                if (!columnSearch) return selectedTable.columns;\n                return selectedTable.columns.filter(c => c.name.toLowerCase().includes(columnSearch.toLowerCase()));\n            }, [selectedTable, columnSearch]);\n\n            // --- AÇÕES ---\n            const selectAndNavigate = (table) => {\n                if (!table) return;\n                setHistory(prev => {\n                    const newHist = [...prev, table.name].filter((item, index, self) => self.indexOf(item) === index);\n                    if (newHist.length > 5) newHist.shift();\n                    return newHist;\n                });\n                setSelectedTable(table);\n            };\n\n            const generateSQL = (conn, sourceTableName) => {\n                if (!conn || !sourceTableName) return;\n                const sql = `-- Join gerado automaticamente\\nSELECT \\n    t1.*\\nFROM ${sourceTableName} t1\\nLEFT JOIN ${conn.otherTable} t2 ON t1.${conn.myCol} = t2.${conn.otherCol}`;\n                setGeneratedSql(sql);\n            };\n\n            const handleContextMenuAction = (action) => {\n                const targetName = ctxMenu.target;\n                setCtxMenu({ ...ctxMenu, visible: false });\n                const t = tables.find(x => x.name === targetName);\n\n                if (action === 'navigate') { if (t) selectAndNavigate(t); }\n                if (action === 'inspect') { if (t) { setPreviewTable(t); setPreviewMode('structure'); } }\n                if (action === 'preview') { if (t) { setPreviewTable(t); setPreviewMode('connections'); } }\n                if (action === 'copy') { navigator.clipboard.writeText(targetName); showNotification(`Nome copiado!`); }\n                if (action === 'favorite') { toggleFavorite(targetName); }\n                if (action === 'sql') { \n                    const conn = currentConnections.find(c => c.otherTable === targetName);\n                    if (conn) generateSQL(conn, selectedTable.name);\n                    else showNotification(\"Não foi possível determinar a chave para o SQL.\");\n                }\n            };\n\n            const showNotification = (msg) => {\n                setNotification(msg);\n                setTimeout(() => setNotification(null), 3000);\n            };\n\n            // --- RENDER ---\n            return (\n                <div className=\"flex h-screen w-full bg-slate-50 text-slate-800 font-sans overflow-hidden\">\n                    \n                    <ContextMenu \n                        visible={ctxMenu.visible} \n                        x={ctxMenu.x} \n                        y={ctxMenu.y} \n                        targetName={ctxMenu.target}\n                        onClose={() => setCtxMenu({ ...ctxMenu, visible: false })}\n                        onAction={handleContextMenuAction}\n                    />\n\n                    <SqlModal sql={generatedSql} onClose={() => setGeneratedSql(null)} />\n                    \n                    <SelectionModal \n                        isOpen={isCompareSelectionOpen} \n                        onClose={() => setIsCompareSelectionOpen(false)} \n                        tables={tables.filter(t => t.name !== selectedTable?.name)}\n                        onSelect={startComparison}\n                    />\n\n                    {notification && (\n                        <div className=\"fixed bottom-6 right-6 bg-slate-800 text-white px-4 py-2 rounded shadow-lg z-[200] animate-fade-in flex items-center gap-2\">\n                            <Icon name=\"check-circle\" size={16} className=\"text-emerald-400\" />\n                            {notification}\n                        </div>\n                    )}\n\n                    {/* DRAWER DE PREVIEW */}\n                    <Drawer \n                        title={previewMode === 'structure' ? `Estrutura: ${previewTable?.name}` : `Ligações: ${previewTable?.name}`} \n                        isOpen={!!previewTable} \n                        onClose={() => setPreviewTable(null)}\n                        width=\"w-[600px]\"\n                    >\n                        {previewTable && (\n                            <div className=\"p-6\">\n                                <div className=\"mb-4 p-3 bg-blue-50 text-blue-800 rounded text-sm border border-blue-100 flex items-center gap-2\">\n                                    <Icon name=\"info\" size={16} /> \n                                    <span>Visualização rápida. <button onClick={() => { selectAndNavigate(previewTable); setPreviewTable(null); }} className=\"underline font-bold\">Abrir Completo</button></span>\n                                </div>\n                                {previewMode === 'structure' ? (\n                                    <table className=\"w-full text-sm text-left border-collapse\">\n                                        <thead><tr className=\"border-b border-slate-200 text-slate-500\"><th className=\"py-2\">Coluna</th><th className=\"py-2 text-right\">Chaves</th></tr></thead>\n                                        <tbody>\n                                            {previewTable.columns.map((col, idx) => (\n                                                <tr key={idx} className=\"border-b border-slate-100 hover:bg-slate-50\">\n                                                    <td className=\"py-2 font-mono text-slate-700\">{col.name}</td>\n                                                    <td className=\"py-2 text-right\">\n                                                        {col.isPk && <span className=\"inline-block px-1.5 py-0.5 rounded bg-yellow-100 text-yellow-700 text-[10px] font-bold mr-1\">PK</span>}\n                                                        {col.isFk && <span className=\"inline-block px-1.5 py-0.5 rounded bg-blue-100 text-blue-700 text-[10px] font-bold\">FK</span>}\n                                                    </td>\n                                                </tr>\n                                            ))}\n                                        </tbody>\n                                    </table>\n                                ) : (\n                                    <div className=\"space-y-3\">\n                                        {previewConnectionsList.map((conn, idx) => (\n                                            <div key={idx} className=\"bg-white border border-slate-200 rounded p-3 flex items-center justify-between text-sm shadow-sm\">\n                                                <div className=\"flex flex-col\"><span className=\"text-[10px] uppercase text-slate-400 font-bold\">Origem</span><span className=\"font-mono text-blue-600 font-bold\">{conn.myCol}</span></div>\n                                                <Icon name=\"arrow-right\" className=\"text-slate-300\" />\n                                                <div className=\"flex flex-col items-end\"><span className=\"text-[10px] uppercase text-slate-400 font-bold\">Destino</span><span className=\"font-bold text-slate-700\">{conn.otherTable}</span></div>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        )}\n                    </Drawer>\n\n                    {/* DRAWER DE COMPARAÇÃO */}\n                    <Drawer \n                        title=\"Comparação de Tabelas\" \n                        isOpen={!!comparisonResult} \n                        onClose={() => setComparisonResult(null)}\n                        width=\"w-[700px]\"\n                    >\n                        {comparisonResult && (\n                            <div className=\"p-6\">\n                                <div className=\"flex items-center justify-between mb-8\">\n                                    <div className=\"text-center w-1/3\">\n                                        <div className=\"font-bold text-lg text-slate-800 break-all\">{comparisonResult.tableA.name}</div>\n                                        <div className=\"text-xs text-slate-400\">Tabela Atual</div>\n                                    </div>\n                                    <div className=\"text-slate-300\"><Icon name=\"arrow-right-left\" size={24} /></div>\n                                    <div className=\"text-center w-1/3\">\n                                        <div className=\"font-bold text-lg text-blue-700 break-all\">{comparisonResult.tableB.name}</div>\n                                        <div className=\"text-xs text-slate-400\">Tabela Comparada</div>\n                                    </div>\n                                </div>\n\n                                <div className=\"space-y-6\">\n                                    <div>\n                                        <h4 className=\"font-bold text-slate-600 mb-2 flex items-center gap-2 text-sm uppercase\"><Icon name=\"link\" size={14} /> Ligações Diretas (FK/PK)</h4>\n                                        {comparisonResult.directLinks.length > 0 ? (\n                                            <div className=\"space-y-2\">\n                                                {comparisonResult.directLinks.map((link, i) => (\n                                                    <div key={i} className=\"bg-blue-50 border border-blue-100 p-3 rounded-lg flex items-center justify-between text-sm\">\n                                                        <span className=\"font-mono font-bold text-slate-700\">{link.myCol}</span>\n                                                        <span className=\"text-blue-400 px-2 text-xs\">liga com</span>\n                                                        <span className=\"font-mono font-bold text-blue-700\">{link.otherCol}</span>\n                                                    </div>\n                                                ))}\n                                            </div>\n                                        ) : (\n                                            <div className=\"text-slate-400 italic text-sm\">Nenhuma chave estrangeira direta encontrada.</div>\n                                        )}\n                                    </div>\n\n                                    <div>\n                                        <h4 className=\"font-bold text-slate-600 mb-2 flex items-center gap-2 text-sm uppercase\"><Icon name=\"columns\" size={14} /> Colunas com mesmo nome</h4>\n                                        {comparisonResult.commonCols.length > 0 ? (\n                                            <div className=\"grid grid-cols-2 gap-2\">\n                                                {comparisonResult.commonCols.map((col, i) => (\n                                                    <div key={i} className=\"bg-slate-50 border border-slate-100 px-3 py-2 rounded text-xs font-mono text-slate-600 flex items-center gap-2\">\n                                                        <div className=\"w-1.5 h-1.5 bg-slate-300 rounded-full\"></div> {col}\n                                                    </div>\n                                                ))}\n                                            </div>\n                                        ) : (\n                                            <div className=\"text-slate-400 italic text-sm\">Nenhuma outra coluna em comum.</div>\n                                        )}\n                                    </div>\n                                </div>\n                            </div>\n                        )}\n                    </Drawer>\n\n                    {/* SIDEBAR */}\n                    <aside className=\"w-72 bg-[#0f172a] text-slate-300 flex flex-col shadow-xl z-10 shrink-0\">\n                        <div className=\"p-5 border-b border-slate-700/50 flex flex-col items-center relative\">\n                            <img src=\"https://headsoft.com.br/wp-content/uploads/2023/10/logo-PhotoRoom-1.png-PhotoRoom-1-1-768x768.png\" alt=\"Headsoft\" className=\"h-16 w-auto mb-2 opacity-90 hover:opacity-100 transition-opacity\" />\n                            <p className=\"text-xs text-slate-500 font-mono\">DB Headsoft v1.0</p>\n                            \n                            {/* BOTÃO DISCRETO DE SAIR/LIMPAR (SÓ APARECE SE TIVER DADOS) */}\n                            {tables.length > 0 && (\n                                <button \n                                    onClick={clearData}\n                                    title=\"Trocar Banco de Dados / Limpar Tudo\"\n                                    className=\"absolute top-4 right-4 text-slate-600 hover:text-red-400 transition-colors\"\n                                >\n                                    <Icon name=\"log-out\" size={16} />\n                                </button>\n                            )}\n                        </div>\n                        <div className=\"p-4\">\n                            <div className=\"relative\">\n                                <span className=\"absolute left-3 top-2.5 text-slate-500\"><Icon name=\"search\" size={14} /></span>\n                                <input type=\"text\" placeholder=\"Buscar tabela ou coluna...\" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} className=\"w-full pl-9 pr-3 py-2 bg-slate-800/50 border border-slate-700 rounded text-sm text-slate-200 focus:outline-none focus:border-blue-500 transition-colors\" />\n                            </div>\n                        </div>\n\n                        <div className=\"flex-1 overflow-y-auto custom-scrollbar px-2 space-y-0.5 pb-4\">\n                            {/* SEÇÃO FAVORITOS */}\n                            {favTables.length > 0 && (\n                                <div className=\"mb-4\">\n                                    <div className=\"px-3 py-2 text-[10px] uppercase font-bold text-amber-500 tracking-wider flex items-center gap-2\">\n                                        <Icon name=\"star\" size={10} className=\"fill-amber-500\" /> Favoritas\n                                    </div>\n                                    {favTables.map((t, idx) => (\n                                        <div key={t.name} className=\"relative group\">\n                                            <button \n                                                onClick={() => selectAndNavigate(t)} \n                                                className={`w-full text-left px-3 py-2 rounded text-xs font-mono transition-all flex items-center gap-3 border border-transparent \n                                                ${selectedTable?.name === t.name ? 'bg-amber-500/10 text-amber-400 border-amber-500/20' : 'hover:bg-slate-800 text-slate-300'}`}\n                                            >\n                                                <span onClick={(e) => { e.stopPropagation(); toggleFavorite(t.name); }} className=\"cursor-pointer hover:scale-110 transition-transform\"><Icon name=\"star\" size={12} className=\"text-amber-400 fill-amber-400\" /></span>\n                                                <span className=\"truncate flex-1\">{t.name}</span>\n                                            </button>\n                                        </div>\n                                    ))}\n                                    <div className=\"h-px bg-slate-700/50 my-2 mx-3\"></div>\n                                </div>\n                            )}\n\n                            {/* TODAS AS TABELAS */}\n                            {otherTables.length > 0 && (\n                                <div>\n                                    <div className=\"px-3 py-1 text-[10px] uppercase font-bold text-slate-500 tracking-wider\">Todas</div>\n                                    {otherTables.map((t, idx) => (\n                                        <div key={t.name} className=\"relative group\">\n                                            <button \n                                                onClick={() => selectAndNavigate(t)} \n                                                className={`w-full text-left px-3 py-2 rounded text-xs font-mono transition-all flex items-center gap-3 border border-transparent \n                                                ${selectedTable?.name === t.name ? 'bg-blue-600 text-white shadow-lg' : 'hover:bg-slate-800 text-slate-400 hover:text-slate-200'}`}\n                                            >\n                                                <span onClick={(e) => { e.stopPropagation(); toggleFavorite(t.name); }} className=\"cursor-pointer opacity-0 group-hover:opacity-100 hover:scale-110 transition-all text-slate-600 hover:text-amber-400\"><Icon name=\"star\" size={12} /></span>\n                                                <span className={`w-1.5 h-1.5 rounded-full shrink-0 group-hover:hidden ${t.name.startsWith('cad_') ? 'bg-emerald-400' : t.name.startsWith('mov_') ? 'bg-amber-400' : 'bg-slate-500'}`}></span>\n                                                <span className=\"truncate flex-1\">{t.name}</span>\n                                                {searchTerm && !t.name.toLowerCase().includes(searchTerm.toLowerCase()) && <span className=\"ml-auto text-[8px] bg-slate-700 px-1 rounded text-slate-300\">COL</span>}\n                                            </button>\n                                        </div>\n                                    ))}\n                                </div>\n                            )}\n                            \n                            {tables.length === 0 && <div className=\"text-center text-xs text-slate-600 mt-10\">Nenhuma tabela carregada.</div>}\n                        </div>\n\n                        {/* RODAPÉ DA SIDEBAR (SÓ APARECE SE NÃO TIVER TABELAS) */}\n                        {tables.length === 0 && (\n                            <div className=\"p-4 border-t border-slate-700/50 space-y-2\">\n                                <input type=\"file\" ref={fileInputRef} onChange={handleFileUpload} className=\"hidden\" accept=\".json,.txt\" />\n                                <button onClick={() => fileInputRef.current.click()} className=\"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-2\"><Icon name=\"upload-cloud\" size={14} /> Carregar Novo</button>\n                            </div>\n                        )}\n                    </aside>\n\n                    {/* MAIN AREA */}\n                    <main className=\"flex-1 flex flex-col bg-slate-50/50 relative overflow-hidden\">\n                        \n                        {/* BREADCRUMBS */}\n                        <div className=\"bg-white border-b border-slate-200 px-6 py-2 flex items-center gap-2 text-xs overflow-x-auto\">\n                            <span className=\"text-slate-400 font-bold uppercase mr-2\">Caminho:</span>\n                            {history.length === 0 && <span className=\"text-slate-400 italic\">Nenhuma seleção</span>}\n                            {history.map((h, i) => (\n                                <div key={i} className=\"flex items-center gap-2 whitespace-nowrap\">\n                                    <button onClick={() => selectAndNavigate(tables.find(t=>t.name===h))} className={`hover:text-blue-600 hover:underline ${selectedTable?.name === h ? 'font-bold text-blue-700' : 'text-slate-500'}`}>{h}</button>\n                                    {i < history.length - 1 && <Icon name=\"chevron-right\" size={12} className=\"text-slate-300\" />}\n                                </div>\n                            ))}\n                        </div>\n\n                        {error && (\n                            <div className=\"absolute top-12 left-1/2 -translate-x-1/2 bg-red-100 border border-red-300 text-red-800 px-6 py-3 rounded-full shadow-lg z-50 flex items-center gap-2 animate-bounce\">\n                                <Icon name=\"alert-triangle\" /> {error}\n                            </div>\n                        )}\n\n                        {selectedTable ? (\n                            <div className=\"flex-1 overflow-y-auto custom-scrollbar flex flex-col\">\n                                <div className=\"max-w-6xl mx-auto w-full p-8 animate-fade-in flex-1\">\n                                    \n                                    {/* HEADER TABELA */}\n                                    <div className=\"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-6 flex justify-between items-start relative overflow-hidden\">\n                                        <div className={`absolute top-0 left-0 w-1.5 h-full ${selectedTable.name.startsWith('cad_') ? 'bg-emerald-500' : selectedTable.name.startsWith('mov_') ? 'bg-amber-500' : 'bg-slate-500'}`}></div>\n                                        <div className=\"pl-4\">\n                                            <div className=\"flex items-center gap-3 mb-2\">\n                                                <h2 className=\"text-3xl font-bold text-slate-800 font-mono\">{selectedTable.name}</h2>\n                                                <TableTypeBadge name={selectedTable.name} />\n                                                <button onClick={() => toggleFavorite(selectedTable.name)} className=\"ml-2 hover:scale-110 transition-transform\">\n                                                    <Icon name=\"star\" size={24} className={favorites.includes(selectedTable.name) ? \"text-amber-400 fill-amber-400\" : \"text-slate-300\"} />\n                                                </button>\n                                                \n                                                {/* BOTÃO DE COMPARAÇÃO */}\n                                                <button \n                                                    onClick={() => setIsCompareSelectionOpen(true)}\n                                                    className=\"ml-2 flex items-center gap-2 px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-full text-xs font-bold transition-colors border border-slate-200\"\n                                                    title=\"Comparar com outra tabela\"\n                                                >\n                                                    <Icon name=\"scale\" size={14} /> Comparar\n                                                </button>\n                                            </div>\n                                            <div className=\"flex items-center gap-4 text-sm text-slate-500\">\n                                                <span className=\"flex items-center gap-1\"><Icon name=\"columns\" size={14} /> {selectedTable.columns.length} colunas</span>\n                                                <span className=\"w-1 h-1 bg-slate-300 rounded-full\"></span>\n                                                <span className=\"flex items-center gap-1\"><Icon name=\"link\" size={14} /> {currentConnections.length} conexões</span>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    {/* TABS */}\n                                    <div className=\"flex items-center border-b border-slate-200 mb-6 bg-white rounded-t-lg px-4 pt-2\">\n                                        <button onClick={() => setActiveTab('structure')} className={`tab-btn px-6 py-3 text-sm font-medium flex items-center gap-2 ${activeTab === 'structure' ? 'active' : 'text-slate-500 hover:text-slate-700'}`}><Icon name=\"layout-list\" size={16} /> Estrutura</button>\n                                        <button onClick={() => setActiveTab('connections')} className={`tab-btn px-6 py-3 text-sm font-medium flex items-center gap-2 ${activeTab === 'connections' ? 'active' : 'text-slate-500 hover:text-slate-700'}`}><Icon name=\"git-merge\" size={16} /> Ligações</button>\n                                    </div>\n\n                                    {/* TAB: ESTRUTURA */}\n                                    {activeTab === 'structure' && (\n                                        <div className=\"bg-white rounded-b-lg rounded-tr-lg border border-slate-200 shadow-sm overflow-hidden animate-fade-in flex flex-col\">\n                                            {/* BARRA DE BUSCA DE COLUNA */}\n                                            <div className=\"p-3 border-b border-slate-100 bg-slate-50 flex items-center\">\n                                                <div className=\"relative w-full max-w-sm\">\n                                                    <span className=\"absolute left-3 top-2.5 text-slate-400\"><Icon name=\"search\" size={14} /></span>\n                                                    <input \n                                                        type=\"text\" \n                                                        placeholder=\"Filtrar colunas...\" \n                                                        value={columnSearch}\n                                                        onChange={(e) => setColumnSearch(e.target.value)}\n                                                        className=\"w-full pl-9 pr-3 py-2 bg-white border border-slate-200 rounded text-sm focus:outline-none focus:border-blue-500 transition-colors\"\n                                                    />\n                                                </div>\n                                                <span className=\"ml-3 text-xs text-slate-400\">{filteredColumns.length} de {selectedTable.columns.length} colunas</span>\n                                            </div>\n\n                                            <table className=\"w-full text-sm text-left border-collapse\">\n                                                <thead className=\"bg-slate-50 text-slate-500 font-semibold border-b border-slate-200\">\n                                                    <tr><th className=\"px-6 py-3 w-16\">#</th><th className=\"px-6 py-3\">Nome da Coluna</th><th className=\"px-6 py-3 text-right\">Identificadores</th></tr>\n                                                </thead>\n                                                <tbody className=\"divide-y divide-slate-100\">\n                                                    {filteredColumns.map((col, idx) => {\n                                                        const isMatch = searchTerm && col.name.toLowerCase().includes(searchTerm.toLowerCase());\n                                                        return (\n                                                            <tr key={idx} className={`hover:bg-slate-50 transition-colors ${isMatch ? 'bg-yellow-50/50' : ''}`}>\n                                                                <td className=\"px-6 py-3 text-slate-400 font-mono text-xs\">{idx + 1}</td>\n                                                                <td className=\"px-6 py-3 font-mono text-slate-700 font-medium\">\n                                                                    {isMatch ? <span className=\"highlight-match\">{col.name}</span> : col.name}\n                                                                </td>\n                                                                <td className=\"px-6 py-3 text-right\">\n                                                                    {col.isPk && <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 text-xs font-bold border border-yellow-200 mr-2 shadow-sm\"><Icon name=\"key\" size={10} className=\"mr-1\"/> PK</span>}\n                                                                    {col.isFk && <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 text-blue-800 text-xs font-bold border border-blue-200 shadow-sm\"><Icon name=\"link\" size={10} className=\"mr-1\"/> FK</span>}\n                                                                </td>\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                    {filteredColumns.length === 0 && (\n                                                        <tr>\n                                                            <td colSpan=\"3\" className=\"px-6 py-8 text-center text-slate-400 italic\">\n                                                                Nenhuma coluna encontrada para \"{columnSearch}\".\n                                                            </td>\n                                                        </tr>\n                                                    )}\n                                                </tbody>\n                                            </table>\n                                        </div>\n                                    )}\n\n                                    {/* TAB: CONEXÕES */}\n                                    {activeTab === 'connections' && (\n                                        <div className=\"space-y-4 animate-fade-in\">\n                                            {currentConnections.length > 0 ? (\n                                                <div className=\"grid grid-cols-1 gap-4\">\n                                                    {currentConnections.map((conn, idx) => (\n                                                        <div key={idx} onContextMenu={(e) => { e.preventDefault(); setCtxMenu({ visible: true, x: e.pageX, y: e.pageY, target: conn.otherTable }); }} className=\"connection-card bg-white rounded-xl border border-slate-200 p-0 flex items-stretch justify-between group relative overflow-hidden shadow-sm\">\n                                                            <div className=\"flex flex-col justify-center items-start p-5 w-[35%] bg-slate-50/50 border-r border-slate-100\">\n                                                                <div className=\"text-[10px] text-slate-400 uppercase font-bold mb-1 flex items-center gap-1\">Origem</div>\n                                                                <div className=\"text-slate-500 font-medium text-sm mb-2 truncate w-full\">{selectedTable.name}</div>\n                                                                <div className=\"bg-white text-blue-700 font-mono text-xs px-2.5 py-1.5 rounded border border-blue-200 font-bold shadow-sm flex items-center gap-2\"><Icon name=\"key\" size={12} className=\"text-blue-400\" /> {conn.myCol}</div>\n                                                            </div>\n                                                            <div className=\"flex flex-col items-center justify-center px-2 w-[30%] text-slate-300 relative\">\n                                                                <div className=\"absolute top-2 text-[9px] uppercase font-bold text-blue-400 bg-blue-50 px-2 py-0.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity\">{conn.type}</div>\n                                                                <div className=\"flex items-center gap-2 w-full justify-center\">\n                                                                    <div className=\"h-[2px] w-full bg-slate-200 group-hover:bg-blue-200 transition-colors\"></div>\n                                                                    <button onClick={() => generateSQL(conn, selectedTable.name)} title=\"Gerar SQL Join\" className=\"p-2 rounded-full bg-slate-100 border border-slate-200 group-hover:bg-blue-600 group-hover:text-white group-hover:border-blue-700 transition-colors shadow-sm\"><Icon name=\"code\" size={16} /></button>\n                                                                    <div className=\"h-[2px] w-full bg-slate-200 group-hover:bg-blue-200 transition-colors\"></div>\n                                                                </div>\n                                                                <span className=\"absolute bottom-2 text-[9px] italic text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity\">Botão Direito para Opções</span>\n                                                            </div>\n                                                            <div className=\"flex flex-col justify-center items-end p-5 w-[35%]\">\n                                                                <div className=\"text-[10px] text-slate-400 uppercase font-bold mb-1 flex items-center gap-1\">Destino <Icon name=\"log-in\" size={10} /></div>\n                                                                <div className=\"text-slate-800 font-bold text-lg mb-2 truncate w-full text-right\">{conn.otherTable}</div>\n                                                                <div className=\"bg-slate-50 text-slate-600 font-mono text-xs px-2.5 py-1.5 rounded border border-slate-200 flex items-center gap-2\">{conn.otherCol} <Icon name=\"fingerprint\" size={12} className=\"text-slate-400\" /></div>\n                                                            </div>\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            ) : (\n                                                <div className=\"bg-white rounded-xl border-2 border-dashed border-slate-200 p-16 text-center text-slate-400 flex flex-col items-center\">\n                                                    <div className=\"bg-slate-50 p-4 rounded-full mb-4\"><Icon name=\"unlink\" size={32} className=\"text-slate-300\" /></div>\n                                                    <h3 className=\"text-lg font-medium text-slate-600\">Tabela Isolada</h3>\n                                                    <p className=\"max-w-xs mx-auto mt-2 text-sm text-slate-400\">Não foram encontradas chaves estrangeiras conectando esta tabela a outras mapeadas.</p>\n                                                </div>\n                                            )}\n                                        </div>\n                                    )}\n                                </div>\n                            </div>\n                        ) : (\n                            <div className=\"flex-1 flex flex-col items-center justify-center text-slate-400\">\n                                <div className=\"w-32 h-32 bg-white rounded-full flex items-center justify-center mb-8 shadow-xl shadow-slate-200/50 border border-slate-100\"><Icon name=\"database\" size={64} className=\"text-slate-300/50\" /></div>\n                                <h2 className=\"text-2xl font-bold text-slate-700 mb-2\">Pronto para Analisar</h2>\n                                <p className=\"max-w-md text-center text-slate-500 mb-8\">Seus dados estão salvos no navegador. Selecione uma tabela ou carregue um novo arquivo.</p>\n                                {!fileName && tables.length === 0 && <button onClick={() => fileInputRef.current.click()} className=\"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-full font-medium transition-all shadow-lg hover:shadow-blue-500/30 flex items-center gap-2\"><Icon name=\"upload\" size={18} /> Carregar Arquivo</button>}\n                            </div>\n                        )}\n                    </main>\n                </div>\n            );\n        }\n\n        const root = ReactDOM.createRoot(document.getElementById('root'));\n        root.render(<App />);\n    </script>\n</body>\n</html>\n<!-- Se você está lendo o código fonte, você é viado sim! 🫵 -->"
    },
    {
        "caminho": "Scripts\\Relatorio_Atividade_20260122_1325.txt",
        "conteudo": "TIMESTAMP | TIPO | DETALHE | PROCESSO | TEMPO_ATIVO\n13:25:26 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:25:29 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:03.205945\n13:25:29 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:25:33 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:04.058217\n13:25:33 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:25:58 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:24.659934\n13:25:58 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:26:04 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:06.140614\n13:26:04 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:26:09 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:05.112020\n13:26:09 | ACESSO  | PROGRAMA: Finalizar fatura | EXE: Desktop.exe\n13:26:13 | MUDANCA | Saiu de: Finalizar fatura | Ficou: 0:00:04.092570\n13:26:13 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:26:16 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:03.062968\n13:26:16 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [CRM] | EXE: Desktop.exe\n13:26:21 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [CRM] | Ficou: 0:00:04.078779\n13:26:21 | ACESSO  | PROGRAMA: Contrato logística | EXE: Desktop.exe\n13:26:22 | MUDANCA | Saiu de: Contrato logística | Ficou: 0:00:01.015138\n13:26:22 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [CRM] | EXE: Desktop.exe\n13:26:25 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [CRM] | Ficou: 0:00:03.042877\n13:26:25 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:26:32 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:07.114634\n13:26:32 | ACESSO  | PROGRAMA: Finalizar fatura | EXE: Desktop.exe\n13:26:51 | MUDANCA | Saiu de: Finalizar fatura | Ficou: 0:00:19.443107\n13:26:51 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:27:02 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:11.192737\n13:27:02 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:27:06 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:04.120683\n13:27:06 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:27:12 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:05.082691\n13:27:12 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:27:13 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:01.022545\n13:27:13 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:27:39 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:26.707326\n13:27:39 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:27:45 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:06.137950\n13:27:45 | ACESSO  | PROGRAMA: HeadCARGO SMX - [Log de tabelas] | EXE: Desktop.exe\n13:27:59 | MUDANCA | Saiu de: HeadCARGO SMX - [Log de tabelas] | Ficou: 0:00:13.312668\n13:27:59 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n13:28:04 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:00:05.112354\n13:28:04 | ACESSO  | PROGRAMA: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n13:28:22 | MUDANCA | Saiu de: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | Ficou: 0:00:18.469904\n13:28:22 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n13:28:30 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:00:07.143165\n13:28:30 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:28:33 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:03.098243\n13:28:33 | ACESSO  | PROGRAMA: Headsoft Service Desk - imagem10.png | EXE: chrome.exe\n13:28:40 | MUDANCA | Saiu de: Headsoft Service Desk - imagem10.png | Ficou: 0:00:07.115126\n13:28:40 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n13:29:02 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:00:21.921973\n13:29:02 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] (Não está respondendo) | EXE: dwm.exe\n13:29:03 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] (Não está respondendo) | Ficou: 0:00:01.013289\n13:29:03 | ACESSO  | PROGRAMA: [Janela de Sistema: Shell_TrayWnd] | EXE: explorer.exe\n13:29:19 | MUDANCA | Saiu de: [Janela de Sistema: Shell_TrayWnd] | Ficou: 0:00:16.225346\n13:29:19 | ACESSO  | PROGRAMA: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n13:29:22 | MUDANCA | Saiu de: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | Ficou: 0:00:03.056708\n13:29:22 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n13:29:43 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:00:20.918612\n13:29:43 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n13:31:01 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:01:17.993489\n13:31:01 | ACESSO  | PROGRAMA: Desconhecido | EXE: -\n13:31:02 | MUDANCA | Saiu de: Desconhecido | Ficou: 0:00:01.030164\n13:31:02 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n13:31:15 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:00:13.272664\n13:31:15 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:31:19 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:04.061511\n13:31:19 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n13:31:22 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:02.654937\n13:31:22 | ACESSO  | PROGRAMA: Chat | André Filipe Ribas Cordeiro | Microsoft Teams | EXE: ms-teams.exe\n13:39:43 | MUDANCA | Saiu de: Chat | André Filipe Ribas Cordeiro | Microsoft Teams | Ficou: 0:08:20.692786\n13:39:43 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:42:55 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:03:12.374433\n13:42:55 | ACESSO  | PROGRAMA: DB- Headsoft Edition - Google Chrome | EXE: chrome.exe\n13:42:56 | MUDANCA | Saiu de: DB- Headsoft Edition - Google Chrome | Ficou: 0:00:01.012963\n13:42:56 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n13:42:58 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:02.069614\n13:42:58 | ACESSO  | PROGRAMA: Vídeo Aula – Tracking – Base de Conhecimento - Google Chrome | EXE: chrome.exe\n13:42:59 | MUDANCA | Saiu de: Vídeo Aula – Tracking – Base de Conhecimento - Google Chrome | Ficou: 0:00:01.366190\n13:42:59 | ACESSO  | PROGRAMA: 黄昏のBAY CITY - YouTube - Google Chrome | EXE: chrome.exe\n13:43:05 | MUDANCA | Saiu de: 黄昏のBAY CITY - YouTube - Google Chrome | Ficou: 0:00:05.974972\n13:43:05 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:43:07 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:01.538825\n13:43:07 | ACESSO  | PROGRAMA: Chat | André Filipe Ribas Cordeiro | Microsoft Teams | EXE: ms-teams.exe\n13:43:08 | MUDANCA | Saiu de: Chat | André Filipe Ribas Cordeiro | Microsoft Teams | Ficou: 0:00:01.026381\n13:43:08 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n13:44:01 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:52.714670\n13:44:01 | ACESSO  | PROGRAMA: Chat | 👽 🇸🇺🇵🇵🇴🇷🇹 👽 | Microsoft Teams | EXE: ms-teams.exe\n13:44:07 | MUDANCA | Saiu de: Chat | 👽 🇸🇺🇵🇵🇴🇷🇹 👽 | Microsoft Teams | Ficou: 0:00:06.426127\n13:44:07 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n13:44:58 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:51.409429\n13:44:58 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:45:00 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:01.047310\n13:45:00 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n13:45:07 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:07.098347\n13:45:07 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:45:16 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:09.181768\n13:45:16 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n13:45:17 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:01.028377\n13:45:17 | ACESSO  | PROGRAMA: Dicionário de dados | (19/06/2024) - Google Chrome | EXE: chrome.exe\n13:45:20 | MUDANCA | Saiu de: Dicionário de dados | (19/06/2024) - Google Chrome | Ficou: 0:00:03.070657\n13:45:20 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:45:23 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:03.179775\n13:45:23 | ACESSO  | PROGRAMA: Dicionário de dados | (19/06/2024) - Google Chrome | EXE: chrome.exe\n13:45:25 | MUDANCA | Saiu de: Dicionário de dados | (19/06/2024) - Google Chrome | Ficou: 0:00:02.194177\n13:45:25 | ACESSO  | PROGRAMA: CITY POP 1984 – Tokyo Midnight Drive | 懐かしい日本シティポップ【Playlist 1】 - YouTube - Google Chrome | EXE: chrome.exe\n13:45:31 | MUDANCA | Saiu de: CITY POP 1984 – Tokyo Midnight Drive | 懐かしい日本シティポップ【Playlist 1】 - YouTube - Google Chrome | Ficou: 0:00:05.779181\n13:45:31 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:46:41 | MUDANCA | Saiu de: tawk.to | Ficou: 0:01:10.587101\n13:46:41 | ACESSO  | PROGRAMA: HeadSoft - Editor de consultas v1.1 | EXE: EditorConsulta.exe\n13:46:43 | MUDANCA | Saiu de: HeadSoft - Editor de consultas v1.1 | Ficou: 0:00:01.038132\n13:46:43 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:46:44 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:01.015716\n13:46:44 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:46:47 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:03.054933\n13:46:47 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:47:01 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:14.328771\n13:47:01 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:47:07 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:06.090003\n13:47:07 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:47:14 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:07.187964\n13:47:14 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:47:17 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:03.064297\n13:47:17 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:47:29 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:11.248589\n13:47:29 | ACESSO  | PROGRAMA: Informação | EXE: Desktop.exe\n13:47:30 | MUDANCA | Saiu de: Informação | Ficou: 0:00:01.012823\n13:47:30 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:47:32 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:02.056918\n13:47:32 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:47:36 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:04.074114\n13:47:36 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:47:40 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:04.139346\n13:47:40 | ACESSO  | PROGRAMA: Informação | EXE: Desktop.exe\n13:47:43 | MUDANCA | Saiu de: Informação | Ficou: 0:00:03.071921\n13:47:43 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:47:50 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:07.140775\n13:47:50 | ACESSO  | PROGRAMA: Pessoa | EXE: Desktop.exe\n13:47:52 | MUDANCA | Saiu de: Pessoa | Ficou: 0:00:02.059723\n13:47:52 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:48:08 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:15.389180\n13:48:08 | ACESSO  | PROGRAMA: Moeda | EXE: Desktop.exe\n13:48:09 | MUDANCA | Saiu de: Moeda | Ficou: 0:00:01.012784\n13:48:09 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:48:19 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:10.310984\n13:48:19 | ACESSO  | PROGRAMA: Cuidado | EXE: Desktop.exe\n13:48:21 | MUDANCA | Saiu de: Cuidado | Ficou: 0:00:02.031085\n13:48:21 | ACESSO  | PROGRAMA: HeadCARGO HEADSOFT TESTES - [Operacional] | EXE: Desktop.exe\n13:48:29 | MUDANCA | Saiu de: HeadCARGO HEADSOFT TESTES - [Operacional] | Ficou: 0:00:08.156038\n13:48:29 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:52:06 | MUDANCA | Saiu de: tawk.to | Ficou: 0:03:37.447936\n13:52:06 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n13:52:17 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:10.290878\n13:52:17 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:53:23 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:01:06.460963\n13:53:23 | ACESSO  | PROGRAMA: Chat | Vitor Araujo dos Santos | Microsoft Teams | EXE: ms-teams.exe\n13:53:26 | MUDANCA | Saiu de: Chat | Vitor Araujo dos Santos | Microsoft Teams | Ficou: 0:00:02.203604\n13:53:26 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:53:34 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:08.183462\n13:53:34 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:53:53 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:19.492922\n13:53:53 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:54:00 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:07.146995\n13:54:00 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:54:02 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:02.066695\n13:54:02 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n13:54:33 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:30.864740\n13:54:33 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n13:54:38 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:05.133639\n13:54:38 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:54:41 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:02.040375\n13:54:41 | ACESSO  | PROGRAMA: Dicionário de dados | (19/06/2024) - Google Chrome | EXE: chrome.exe\n13:54:43 | MUDANCA | Saiu de: Dicionário de dados | (19/06/2024) - Google Chrome | Ficou: 0:00:02.040035\n13:54:43 | ACESSO  | PROGRAMA: Login - Google Chrome | EXE: chrome.exe\n13:54:46 | MUDANCA | Saiu de: Login - Google Chrome | Ficou: 0:00:03.073993\n13:54:46 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:54:57 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:11.249816\n13:54:57 | ACESSO  | PROGRAMA: Login - Google Chrome | EXE: chrome.exe\n13:55:19 | MUDANCA | Saiu de: Login - Google Chrome | Ficou: 0:00:22.601607\n13:55:19 | ACESSO  | PROGRAMA: Telefones - Google Chrome | EXE: chrome.exe\n13:55:31 | MUDANCA | Saiu de: Telefones - Google Chrome | Ficou: 0:00:11.370481\n13:55:31 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n13:56:09 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:38.007641\n13:56:09 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:56:16 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:07.175589\n13:56:16 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n13:56:18 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:02.035398\n13:56:18 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n13:56:30 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:12.277487\n13:56:30 | ACESSO  | PROGRAMA: Telefones - Google Chrome | EXE: chrome.exe\n13:56:40 | MUDANCA | Saiu de: Telefones - Google Chrome | Ficou: 0:00:09.205222\n13:56:40 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n13:57:13 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:33.853164\n13:57:13 | ACESSO  | PROGRAMA: Telefones - Google Chrome | EXE: chrome.exe\n13:57:14 | MUDANCA | Saiu de: Telefones - Google Chrome | Ficou: 0:00:01.012968\n13:57:14 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n13:58:16 | MUDANCA | Saiu de: 3CX | Ficou: 0:01:01.620456\n13:58:16 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:58:19 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:03.090075\n13:58:19 | ACESSO  | PROGRAMA: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n13:58:20 | MUDANCA | Saiu de: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | Ficou: 0:00:01.034798\n13:58:20 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:58:24 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:04.087932\n13:58:24 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n13:58:30 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:06.112911\n13:58:30 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n13:58:47 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:16.475274\n13:58:47 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n13:58:55 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:08.196511\n13:58:55 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n13:59:42 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:47.292467\n13:59:42 | ACESSO  | PROGRAMA: [Janela de Sistema: Shell_TrayWnd] | EXE: explorer.exe\n13:59:43 | MUDANCA | Saiu de: [Janela de Sistema: Shell_TrayWnd] | Ficou: 0:00:01.056161\n13:59:43 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n13:59:49 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:00:05.092113\n13:59:49 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#3\n] | EXE: anydesk-5-5-3 2.exe\n14:00:13 | MUDANCA | Saiu de: [Janela de Sistema: popup#3\n] | Ficou: 0:00:24.516099\n14:00:13 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:00:14 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:01.022449\n14:00:14 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:00:16 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:02.051241\n14:00:16 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:00:17 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:00:01.023709\n14:00:17 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#3\n] | EXE: anydesk-5-5-3 2.exe\n14:00:31 | MUDANCA | Saiu de: [Janela de Sistema: popup#3\n] | Ficou: 0:00:14.343415\n14:00:31 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:00:38 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:00:06.642231\n14:00:38 | ACESSO  | PROGRAMA: Chat | Vitor Araujo dos Santos | Microsoft Teams | EXE: ms-teams.exe\n14:00:44 | MUDANCA | Saiu de: Chat | Vitor Araujo dos Santos | Microsoft Teams | Ficou: 0:00:06.142578\n14:00:44 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n14:00:47 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:03.150876\n14:00:47 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:02:05 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:01:17.439556\n14:02:05 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:02:08 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:03.048317\n14:02:08 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n14:02:11 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:03.553250\n14:02:11 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:02:12 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:01.021275\n14:02:12 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:04:16 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:02:03.780909\n14:04:16 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#32\n] | EXE: anydesk-5-5-3 2.exe\n14:04:18 | MUDANCA | Saiu de: [Janela de Sistema: popup#32\n] | Ficou: 0:00:02.052173\n14:04:18 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#35\n] | EXE: anydesk-5-5-3 2.exe\n14:04:19 | MUDANCA | Saiu de: [Janela de Sistema: popup#35\n] | Ficou: 0:00:01.014987\n14:04:19 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#42\n] | EXE: anydesk-5-5-3 2.exe\n14:04:21 | MUDANCA | Saiu de: [Janela de Sistema: popup#42\n] | Ficou: 0:00:02.032442\n14:04:21 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:04:22 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:00:01.020235\n14:04:22 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#43\n] | EXE: anydesk-5-5-3 2.exe\n14:04:28 | MUDANCA | Saiu de: [Janela de Sistema: popup#43\n] | Ficou: 0:00:06.130326\n14:04:28 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:04:31 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:00:02.047474\n14:04:31 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#51\n] | EXE: anydesk-5-5-3 2.exe\n14:04:33 | MUDANCA | Saiu de: [Janela de Sistema: popup#51\n] | Ficou: 0:00:02.039405\n14:04:33 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#53\n] | EXE: anydesk-5-5-3 2.exe\n14:04:34 | MUDANCA | Saiu de: [Janela de Sistema: popup#53\n] | Ficou: 0:00:01.019702\n14:04:34 | ACESSO  | PROGRAMA: [Janela de Sistema: popup#54\n] | EXE: anydesk-5-5-3 2.exe\n14:04:35 | MUDANCA | Saiu de: [Janela de Sistema: popup#54\n] | Ficou: 0:00:01.016106\n14:04:35 | ACESSO  | PROGRAMA: AnyDesk | EXE: anydesk-5-5-3 2.exe\n14:06:01 | MUDANCA | Saiu de: AnyDesk | Ficou: 0:01:25.907135\n14:06:01 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n14:06:19 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:18.459989\n14:06:19 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:06:21 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:02.044177\n14:06:21 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n14:06:26 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:05.502533\n14:06:26 | ACESSO  | PROGRAMA:  LOG_MULTIPLOS.txt - Bloco de notas | EXE: Notepad.exe\n14:06:28 | MUDANCA | Saiu de:  LOG_MULTIPLOS.txt - Bloco de notas | Ficou: 0:00:01.023062\n14:06:28 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n14:06:29 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:01.015365\n14:06:29 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n14:06:56 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:28.087603\n14:06:56 | ACESSO  | PROGRAMA: Desconhecido | EXE: -\n14:06:58 | MUDANCA | Saiu de: Desconhecido | Ficou: 0:00:01.034383\n14:06:58 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n14:07:06 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:08.194954\n14:07:06 | ACESSO  | PROGRAMA: Chat | Flauvi Klock Neto | Microsoft Teams | EXE: ms-teams.exe\n14:07:10 | MUDANCA | Saiu de: Chat | Flauvi Klock Neto | Microsoft Teams | Ficou: 0:00:04.207106\n14:07:10 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n14:07:12 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:02.067797\n14:07:12 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:07:14 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:02.057881\n14:07:14 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:07:15 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:01.013923\n14:07:15 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:07:17 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:02.035830\n14:07:17 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:07:24 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:07.103308\n14:07:24 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n14:07:34 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:00:09.225407\n14:07:34 | ACESSO  | PROGRAMA: [Janela de Sistema: Shell_TrayWnd] | EXE: explorer.exe\n14:07:35 | MUDANCA | Saiu de: [Janela de Sistema: Shell_TrayWnd] | Ficou: 0:00:01.011673\n14:07:35 | ACESSO  | PROGRAMA: HeadSoft - Editor de consultas v1.1 | EXE: EditorConsulta.exe\n14:07:38 | MUDANCA | Saiu de: HeadSoft - Editor de consultas v1.1 | Ficou: 0:00:03.105071\n14:07:38 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n14:07:44 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:06.104396\n14:07:44 | ACESSO  | PROGRAMA: [Janela de Sistema: #32770] | EXE: Lightshot.exe\n14:07:51 | MUDANCA | Saiu de: [Janela de Sistema: #32770] | Ficou: 0:00:07.169519\n14:07:51 | ACESSO  | PROGRAMA: 3CX | EXE: 3CXSoftphone.exe\n14:07:55 | MUDANCA | Saiu de: 3CX | Ficou: 0:00:04.067752\n14:07:55 | ACESSO  | PROGRAMA: HeadSoft - Editor de consultas v1.1 | EXE: EditorConsulta.exe\n14:07:56 | MUDANCA | Saiu de: HeadSoft - Editor de consultas v1.1 | Ficou: 0:00:01.018452\n14:07:56 | ACESSO  | PROGRAMA: HeadCARGO SMX - [CRM] | EXE: Desktop.exe\n14:10:07 | MUDANCA | Saiu de: HeadCARGO SMX - [CRM] | Ficou: 0:02:10.862461\n14:10:07 | ACESSO  | PROGRAMA: HeadCARGO SMX - [Operacional] | EXE: Desktop.exe\n14:10:12 | MUDANCA | Saiu de: HeadCARGO SMX - [Operacional] | Ficou: 0:00:05.107139\n14:10:12 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:10:16 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:04.085243\n14:10:16 | ACESSO  | PROGRAMA: HeadCARGO SMX - [Operacional] | EXE: Desktop.exe\n14:10:50 | MUDANCA | Saiu de: HeadCARGO SMX - [Operacional] | Ficou: 0:00:33.941094\n14:10:50 | ACESSO  | PROGRAMA: Finalizar fatura | EXE: Desktop.exe\n14:10:54 | MUDANCA | Saiu de: Finalizar fatura | Ficou: 0:00:04.063981\n14:10:54 | ACESSO  | PROGRAMA: HeadCARGO SMX - [Operacional] | EXE: Desktop.exe\n14:11:01 | MUDANCA | Saiu de: HeadCARGO SMX - [Operacional] | Ficou: 0:00:07.167707\n14:11:01 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:11:07 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:06.137878\n14:11:07 | ACESSO  | PROGRAMA:  LOG_MULTIPLOS.txt - Bloco de notas | EXE: Notepad.exe\n14:11:10 | MUDANCA | Saiu de:  LOG_MULTIPLOS.txt - Bloco de notas | Ficou: 0:00:02.049107\n14:11:10 | ACESSO  | PROGRAMA: * RELATORIO_DO_ERRO.txt - Bloco de notas | EXE: Notepad.exe\n14:11:29 | MUDANCA | Saiu de: * RELATORIO_DO_ERRO.txt - Bloco de notas | Ficou: 0:00:19.610264\n14:11:29 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:11:39 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:10.282702\n14:11:39 | ACESSO  | PROGRAMA: tawk.to | EXE: tawk.to.exe\n14:11:47 | MUDANCA | Saiu de: tawk.to | Ficou: 0:00:07.138669\n14:11:47 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:11:57 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:10.273724\n14:11:57 | ACESSO  | PROGRAMA: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | EXE: Code.exe\n14:12:04 | MUDANCA | Saiu de: Erro Fatura valor ou valor corrente de registro financeiro.sql - Scripts - Visual Studio Code | Ficou: 0:00:07.455132\n14:12:04 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n14:12:39 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:34.934125\n14:12:39 | ACESSO  | PROGRAMA: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | EXE: Code.exe\n14:12:51 | MUDANCA | Saiu de: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | Ficou: 0:00:11.698083\n14:12:51 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:12:56 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:05.105978\n14:12:56 | ACESSO  | PROGRAMA: HeadCARGO SMX - [Operacional] | EXE: Desktop.exe\n14:13:07 | MUDANCA | Saiu de: HeadCARGO SMX - [Operacional] | Ficou: 0:00:11.184333\n14:13:07 | ACESSO  | PROGRAMA: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | EXE: Code.exe\n14:13:43 | MUDANCA | Saiu de: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | Ficou: 0:00:36.261080\n14:13:43 | ACESSO  | PROGRAMA: Fazendo_agora.html - Scripts - Visual Studio Code | EXE: Code.exe\n14:13:52 | MUDANCA | Saiu de: Fazendo_agora.html - Scripts - Visual Studio Code | Ficou: 0:00:08.165483\n14:13:52 | ACESSO  | PROGRAMA: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:13:55 | MUDANCA | Saiu de: SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - SQLQuery24.sql - smx.sql.headcargo.com.br,9322.HeadCARGO_SMX (hc_headsoft_suporte (87))* - Microsoft SQL Server Management Studio | Ficou: 0:00:03.047529\n14:13:55 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:14:03 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | Ficou: 0:00:08.221565\n14:14:03 | ACESSO  | PROGRAMA: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | EXE: Code.exe\n14:14:17 | MUDANCA | Saiu de: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | Ficou: 0:00:14.307133\n14:14:17 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:14:55 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | Ficou: 0:00:38.069006\n14:14:55 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:14:56 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - Microsoft SQL Server Management Studio | Ficou: 0:00:01.024664\n14:14:56 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:15:15 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | Ficou: 0:00:18.572218\n14:15:15 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:15:16 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - Microsoft SQL Server Management Studio | Ficou: 0:00:01.018274\n14:15:16 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:17:16 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | Ficou: 0:02:00.415356\n14:17:16 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:17:17 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269)) Executando...* - Microsoft SQL Server Management Studio | Ficou: 0:00:01.016853\n14:17:17 | ACESSO  | PROGRAMA: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | EXE: SSMS.exe\n14:17:38 | MUDANCA | Saiu de: SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - SQLQuery23.sql - texcomex.sql.headcargo.com.br,9322.HeadCARGO_TEXCOMEX (hc_headsoft_suporte (269))* - Microsoft SQL Server Management Studio | Ficou: 0:00:20.557198\n14:17:38 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:18:09 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:30.940681\n14:18:09 | ACESSO  | PROGRAMA: [Janela de Sistema: XamlExplorerHostIslandWindow] | EXE: explorer.exe\n14:18:12 | MUDANCA | Saiu de: [Janela de Sistema: XamlExplorerHostIslandWindow] | Ficou: 0:00:03.083457\n14:18:12 | ACESSO  | PROGRAMA: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | EXE: Code.exe\n14:18:17 | MUDANCA | Saiu de: ● [Report.Header] • Untitled-1 - Scripts - Visual Studio Code | Ficou: 0:00:05.264773\n14:18:17 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:18:20 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:03.047867\n14:18:20 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:19:37 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:01:16.984315\n14:19:37 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:19:57 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:19.543917\n14:19:57 | ACESSO  | PROGRAMA: [Janela de Sistema: XamlExplorerHostIslandWindow] | EXE: explorer.exe\n14:19:59 | MUDANCA | Saiu de: [Janela de Sistema: XamlExplorerHostIslandWindow] | Ficou: 0:00:02.061135\n14:19:59 | ACESSO  | PROGRAMA: Downloads – Explorador de Arquivos | EXE: explorer.exe\n14:20:01 | MUDANCA | Saiu de: Downloads – Explorador de Arquivos | Ficou: 0:00:02.033701\n14:20:01 | ACESSO  | PROGRAMA: [Janela de Sistema: XamlExplorerHostIslandWindow] | EXE: explorer.exe\n14:20:03 | MUDANCA | Saiu de: [Janela de Sistema: XamlExplorerHostIslandWindow] | Ficou: 0:00:02.054642\n14:20:03 | ACESSO  | PROGRAMA: Downloads – Explorador de Arquivos | EXE: explorer.exe\n14:20:04 | MUDANCA | Saiu de: Downloads – Explorador de Arquivos | Ficou: 0:00:01.044641\n14:20:04 | ACESSO  | PROGRAMA: Área de Trabalho – Explorador de Arquivos | EXE: explorer.exe\n14:20:06 | MUDANCA | Saiu de: Área de Trabalho – Explorador de Arquivos | Ficou: 0:00:02.047567\n14:20:06 | ACESSO  | PROGRAMA: Logins – Explorador de Arquivos | EXE: explorer.exe\n14:20:09 | MUDANCA | Saiu de: Logins – Explorador de Arquivos | Ficou: 0:00:03.074422\n14:20:09 | ACESSO  | PROGRAMA: [Janela de Sistema: #32770] | EXE: Lightshot.exe\n14:20:11 | MUDANCA | Saiu de: [Janela de Sistema: #32770] | Ficou: 0:00:02.052455\n14:20:11 | ACESSO  | PROGRAMA: Logins – Explorador de Arquivos | EXE: explorer.exe\n14:20:12 | MUDANCA | Saiu de: Logins – Explorador de Arquivos | Ficou: 0:00:01.016564\n14:20:12 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:20:13 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:01.023113\n14:20:13 | ACESSO  | PROGRAMA: Logins – Explorador de Arquivos | EXE: explorer.exe\n14:20:14 | MUDANCA | Saiu de: Logins – Explorador de Arquivos | Ficou: 0:00:01.014864\n14:20:14 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:20:37 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:22.585060\n14:20:37 | ACESSO  | PROGRAMA: Logins – Explorador de Arquivos | EXE: explorer.exe\n14:20:49 | MUDANCA | Saiu de: Logins – Explorador de Arquivos | Ficou: 0:00:12.309651\n14:20:49 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n14:21:08 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:18.647681\n14:21:08 | ACESSO  | PROGRAMA: Logins – Explorador de Arquivos | EXE: explorer.exe\n14:21:13 | MUDANCA | Saiu de: Logins – Explorador de Arquivos | Ficou: 0:00:05.155397\n14:21:13 | ACESSO  | PROGRAMA: [Janela de Sistema: Shell_TrayWnd] | EXE: explorer.exe\n14:21:14 | MUDANCA | Saiu de: [Janela de Sistema: Shell_TrayWnd] | Ficou: 0:00:01.039469\n14:21:14 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:21:18 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:04.246874\n14:21:18 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:21:21 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:03.050828\n14:21:21 | ACESSO  | PROGRAMA: aeroportos.png - Google Chrome | EXE: chrome.exe\n14:21:38 | MUDANCA | Saiu de: aeroportos.png - Google Chrome | Ficou: 0:00:16.413666\n14:21:38 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:21:41 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:03.077733\n14:21:41 | ACESSO  | PROGRAMA: HeadSoft Service Desk - Google Chrome | EXE: chrome.exe\n14:21:43 | MUDANCA | Saiu de: HeadSoft Service Desk - Google Chrome | Ficou: 0:00:02.035071\n14:21:43 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n14:21:49 | MUDANCA | Saiu de: import psutil.py - Scripts - Visual Studio Code | Ficou: 0:00:06.164812\n14:21:49 | ACESSO  | PROGRAMA: Google Gemini - Google Chrome | EXE: chrome.exe\n14:21:54 | MUDANCA | Saiu de: Google Gemini - Google Chrome | Ficou: 0:00:05.201765\n14:21:54 | ACESSO  | PROGRAMA: import psutil.py - Scripts - Visual Studio Code | EXE: Code.exe\n"
    },
    {
        "caminho": "Scripts\\status proposta pedro Enterprise.chd",
        "conteudo": "[Campos]\nCampo[0].FieldName=IdOferta_Frete\nCampo[0].Origin=Ofr.IdOferta_Frete\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Situacao\nCampo[1].Origin=Pfr.Situacao\nCampo[1].DisplayLabel=Situação\nCampo[1].Width=80\nCampo[1].Items=1,2,3,4,5,6\nCampo[1].ItemsEx=\"AGUARDANDO APROVAÇÃO\",APROVADA,\"NÃO APROVADA\",\"NÃO ENVIADA\",ENVIADA,\"PRE PROPOSTA\"\nCampo[1].Alignment=0\nCampo[2].FieldName=Ref_Pricing\nCampo[2].Origin=Ofr.Referencia_Externa\nCampo[2].DisplayLabel=Ref.Pricing\nCampo[3].FieldName=Numero_Oferta\nCampo[3].Origin=Ofr.Numero_Oferta\nCampo[3].DisplayLabel=Nº Oferta\nCampo[4].FieldName=IdCliente\nCampo[4].Origin=Pfr.IdCliente\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Cliente\nCampo[4].Foreign.Campo=IdPessoa\nCampo[4].Foreign.Tabela=vis_Cliente\nCampo[4].Join.Enabled=1\nCampo[4].Join.Result=IdCliente\nCampo[4].Join.Search=IdProposta_Frete\nCampo[5].FieldName=Nome_Cliente\nCampo[5].Origin=Cli.Nome_Fantasia\nCampo[5].DisplayLabel=Cliente\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=Nome\nCampo[5].Join.Search=IdCliente\nCampo[5].Width=200\nCampo[6].FieldName=Servico\nCampo[6].Origin=Case When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 1 then 'Exportação Aérea' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 2 then 'Importação Aérea' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 3 then 'Nacional Aérea' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 1 then 'Exportação Marítima' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 2 then 'Importação Marítima' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 3 then 'Nacional Marítima' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 1 then 'Exportação Terrestre' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 2 then 'Importação Terrestre' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 3 then 'Nacional Terrestre' End\nCampo[6].DisplayLabel=Modalidade\nCampo[7].FieldName=Servico_Ab\nCampo[7].Origin=Case When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 1 then 'EA' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 2 then 'IA' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 3 then 'NA' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 1 then 'EM' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 2 then 'IM' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 3 then 'NM' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 1 then 'ET' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 2 then 'IT' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 3 then 'NT' End\nCampo[7].DisplayLabel=OP\nCampo[8].FieldName=IdVendedor\nCampo[8].Origin=Pfr.IdVendedor\nCampo[8].Foreign.Enabled=1\nCampo[8].Foreign.Divisao=Funcionario\nCampo[8].Foreign.Campo=IdPessoa\nCampo[8].Foreign.Tabela=vis_Funcionario\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=IdVendedor\nCampo[8].Join.Search=IdProposta_Frete\nCampo[9].FieldName=Vendedor\nCampo[9].Origin=Vnd.Nome_Fantasia\nCampo[9].DisplayLabel=Vendedor\nCampo[9].Join.Enabled=1\nCampo[9].Join.Result=Nome\nCampo[9].Join.Search=IdVendedor\nCampo[9].Width=200\nCampo[10].FieldName=Origem\nCampo[10].Origin=Org.Nome\nCampo[10].DisplayLabel=Origem\nCampo[11].FieldName=Destino\nCampo[11].Origin=Dst.Nome\nCampo[11].DisplayLabel=Destino\nCampo[12].FieldName=Motivo_Nao_Ap\nCampo[12].Origin=Nap.Descricao\nCampo[12].DisplayLabel=Motivo Não Fechamento\nCampo[13].FieldName=IdIncoterm\nCampo[13].Origin=Ofr.IdIncoterm\nCampo[13].Foreign.Enabled=1\nCampo[13].Foreign.Divisao=Incoterm\nCampo[13].Foreign.Campo=IdIncoterm\nCampo[13].Foreign.Tabela=cad_Incoterm\nCampo[13].Join.Enabled=1\nCampo[13].Join.Result=IdIncoterm\nCampo[13].Join.Search=IdOferta_Frete\nCampo[14].FieldName=Incoterm\nCampo[14].Origin=Ico.Nome\nCampo[14].DisplayLabel=Incoterm\nCampo[14].Join.Enabled=1\nCampo[14].Join.Result=Nome\nCampo[14].Join.Search=IdIncoterm\nCampo[14].Width=200\nCampo[15].FieldName=Lucro_Estimado\nCampo[15].Origin=Ofc.Lucro_Estimado\nCampo[15].DisplayLabel=Lucro\nCampo[15].DisplayFormat=#,0.00\nCampo[15].Width=100\nCampo[16].FieldName=Data_Proposta\nCampo[16].Origin=Pfr.Data_Proposta\nCampo[16].DisplayLabel=Data Abertura Proposta\nCampo[16].DisplayFormat=dd/mm/yyyy\nCampo[16].Width=100\n\n[Consulta]\nCampos=17\nCommandText=\"Declare @Max_Data Table (\",\"  Indice IdLongo Primary Key,\",\"  Data Date\",),\"Insert Into @Max_Data (\",\"  Indice,\",\"  Data\t\",),\"Select Distinct\",\"    1,\",\"\tData_Proposta\",\"From \",\"\tmov_Proposta_Frete\",where,\"    Data_Proposta = (select max(Data_Proposta) from mov_Proposta_Frete)\",,\"Declare @Min_Data Table (\",\"  Indice IdLongo Primary Key,\",\"  Data Date\",),\"Insert Into @Min_Data (\",\"  Indice,\",\"  Data\t\",),\"Select Distinct\",\"    1,\",\"\tData_Proposta\",\"From \",\"\tmov_Proposta_Frete\",where,\"    Data_Proposta = (select min(Data_Proposta) from mov_Proposta_Frete)\",,Select,\"\tOfr.IdOferta_Frete,\",\"\tOfr.Numero_Oferta,\",\"\tPfr.Situacao,\",\"\tPfr.Data_Proposta,\",\"\t(dateadd(ww, datediff(ww, 0, Mid.Data), 0)) As Segunda,\",\"        (dateadd(ww, datediff(ww, 0, Mad.Data), 0) + 4) As Sexta,\",\"\tMid.Data As Data_Inicio,\",\"\tMad.Data As Data_Termino,\",\"\tCASE Pfr.Situacao WHEN 1 THEN 'AGUARDANDO APROVAÇÃO' WHEN 2 THEN 'APROVADA' WHEN 3 THEN 'NÃO APROVADA' WHEN 4 THEN 'NÃO ENVIADA' WHEN 5 THEN 'NÃO ENVIADA' WHEN 6 THEN 'ENVIADA' END as Situacao_Proposta,\",\"\tCase When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 1 then 'Exportação Aérea' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 2 then 'Importação Aérea' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 3 then 'Nacional Aérea' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 1 then 'Exportação Marítima' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 2 then 'Importação Marítima' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 3 then 'Nacional Marítima' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 1 then 'Exportação Terrestre' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 2 then 'Importação Terrestre' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 3 then 'Nacional Terrestre' End Servico,\",\"\tCase When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 1 then 'EA' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 2 then 'IA' When Ofr.Modalidade_Processo = 1 and Ofr.Tipo_Operacao = 3 then 'NA' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 1 then 'EM' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 2 then 'IM' When Ofr.Modalidade_Processo = 2 and Ofr.Tipo_Operacao = 3 then 'NM' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 1 then 'ET' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 2 then 'IT' When Ofr.Modalidade_Processo = 3 and Ofr.Tipo_Operacao = 3 then 'NT' End as Servico_Ab,\",\"\tPfr.IdCliente,\",\"\tCli.Nome_Fantasia as Nome_Cliente,\",\"\tOrg.Nome as Origem,\",\"\tDst.Nome as Destino,\",\"\tNap.Descricao as Motivo_Nao_Ap,\",\"\tOfr.IdIncoterm,\",\"\tIco.Nome as Incoterm,\",\"\tPfr.IdVendedor,\",\"\tVnd.Nome_Fantasia as Vendedor,\",\"\tOfr.Referencia_Externa as Ref_Pricing,\",\"        Ofc.Lucro_Estimado\",FROM,\"\tmov_Oferta_Frete Ofr\",\"Left Outer Join \",\"\tmov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\",\"Left Outer Join\",\"\tvis_Cliente Cli on Cli.Idpessoa = Pfr.IdCliente\",\"Left Outer Join\",\"\tcad_Origem_Destino Org on Org.IdOrigem_Destino = Ofr.IdOrigem\",\"Left Outer Join\",\"\tcad_Origem_Destino Dst on Dst.IdOrigem_Destino = Ofr.IdDestino\",\"Left Outer Join\",\"\tcad_Motivo_Nao_Aprovacao_Proposta Nap on Nap.IdMotivo_Nao_Aprovacao_Proposta = Pfr.IdMotivo_Nao_Aprovacao_Proposta\",\"Left Outer Join\",\"\tcad_Incoterm Ico on Ico.IdIncoterm = Ofr.IdIncoterm\",\"Left Outer Join\",\"\tvis_Funcionario Vnd on Vnd.Idpessoa = Pfr.IdVendedor\",\"Left Outer Join\",\"  mov_Oferta_Frete_Fechamento Ofc on Ofc.IdOferta_Frete = Ofr.IdOferta_Frete And Ofc.IdMoeda = 110 \",\"Left Outer Join\",\"\t@Max_Data Mad on Mad.Indice = 1 /*Indice Max Data*/\",\"Left Outer Join\",\"\t@Min_Data Mid on Mid.Indice = 1 /*Indice Max Data*/\",/*WHERE*/,/*WHERE*/,Where,\"  Vnd.IdPessoa in(62938) /* Pedro Reis */\",\"ORDER BY (Pfr.Situacao),(Ofc.Lucro_Estimado)DESC\"\nCommandTextHash=99fdd244c557b2cda238f112231b1b40\n\n[FieldDefs]\nCount=22\nItems[0].Name=IdOferta_Frete\nItems[0].DataType=ftInteger\nItems[0].Precision=0\nItems[0].Size=0\nItems[1].Name=Numero_Oferta\nItems[1].DataType=ftString\nItems[1].Precision=0\nItems[1].Size=50\nItems[2].Name=Situacao\nItems[2].DataType=ftWord\nItems[2].Precision=0\nItems[2].Size=0\nItems[3].Name=Data_Proposta\nItems[3].DataType=ftDateTime\nItems[3].Precision=0\nItems[3].Size=0\nItems[4].Name=Segunda\nItems[4].DataType=ftDateTime\nItems[4].Precision=0\nItems[4].Size=0\nItems[5].Name=Sexta\nItems[5].DataType=ftDateTime\nItems[5].Precision=0\nItems[5].Size=0\nItems[6].Name=Data_Inicio\nItems[6].DataType=ftWideString\nItems[6].Precision=0\nItems[6].Size=10\nItems[7].Name=Data_Termino\nItems[7].DataType=ftWideString\nItems[7].Precision=0\nItems[7].Size=10\nItems[8].Name=Situacao_Proposta\nItems[8].DataType=ftString\nItems[8].Precision=0\nItems[8].Size=20\nItems[9].Name=Servico\nItems[9].DataType=ftString\nItems[9].Precision=0\nItems[9].Size=20\nItems[10].Name=Servico_Ab\nItems[10].DataType=ftString\nItems[10].Precision=0\nItems[10].Size=2\nItems[11].Name=IdCliente\nItems[11].DataType=ftInteger\nItems[11].Precision=0\nItems[11].Size=0\nItems[12].Name=Nome_Cliente\nItems[12].DataType=ftString\nItems[12].Precision=0\nItems[12].Size=50\nItems[13].Name=Origem\nItems[13].DataType=ftString\nItems[13].Precision=0\nItems[13].Size=50\nItems[14].Name=Destino\nItems[14].DataType=ftString\nItems[14].Precision=0\nItems[14].Size=50\nItems[15].Name=Motivo_Nao_Ap\nItems[15].DataType=ftString\nItems[15].Precision=0\nItems[15].Size=200\nItems[16].Name=IdIncoterm\nItems[16].DataType=ftSmallint\nItems[16].Precision=0\nItems[16].Size=0\nItems[17].Name=Incoterm\nItems[17].DataType=ftString\nItems[17].Precision=0\nItems[17].Size=50\nItems[18].Name=IdVendedor\nItems[18].DataType=ftInteger\nItems[18].Precision=0\nItems[18].Size=0\nItems[19].Name=Vendedor\nItems[19].DataType=ftString\nItems[19].Precision=0\nItems[19].Size=50\nItems[20].Name=Ref_Pricing\nItems[20].DataType=ftString\nItems[20].Precision=0\nItems[20].Size=25\nItems[21].Name=Lucro_Estimado\nItems[21].DataType=ftBCD\nItems[21].Precision=19\nItems[21].Size=2\n\n"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Agente Destino Operacional não pode ser diferente do Comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(CASE\n        WHEN Bloqueado = 1 THEN 'O Agente de Destino do Operacional é diferente do Agente de Destino do Comercial.'\n        ELSE NULL\n      END as VARCHAR(MAX))\n    FROM\n      (\n        SELECT\n          CAST(CASE\n            WHEN ISNULL(COALESCE(Prm.IdAgente_Destino_Tela, Lms.IdAgente_Destino), 0) &lt;&gt; ISNULL(Ofr.IdAgente_Destino, 0) THEN 1\n            ELSE 0\n          END as INT) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdAgente_Destino\"][1]/@Value', 'int') as IdAgente_Destino_Tela\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          JOIN mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master \n          LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\n      ) Blq\n  </CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\atividade_so_pode_ser_concluída_por_responsavel.sql",
        "conteudo": "<Dados_Registro><Mensagem>Atenção!!!</Mensagem><CommandText>\nSELECT\n@Mensagem =  'Atenção! Você não tem permissão para concluir esta tarefa!',\n@Condicao =\n    CASE\n      WHEN Atv.IdResponsavel IS NULL THEN 0 -- ID do responsavel for nulo/vazio, bloqueia.\n      WHEN Fcn.IdPessoa &lt;&gt; Atv.IdResponsavel THEN 0 -- ID da pessoa logada for diferente do responsavel, bloqueia.\n      ELSE 1 -- caso nenhuma condição acima seja verdadeiro libera.\n    END    \nFROM\n  mov_Atividade atv  -- tabela de atividade, onde verifica quando é feito alguma alteração no sistema.\nLeft Outer Join\n  cad_Pessoa Psa ON Psa.IdPessoa = Atv.IdResponsavel -- tabela de cad_pessoa para vincular com id_responsavel\nLeft Outer Join\n  #Global_Var Gvr ON Gvr.Variavel LIKE 'IdUsuario' -- variavel para buscar o IdUsuario\nJOIN\n  vis_Funcionario Fcn ON Fcn.IdUsuario_Correspondente = Cast(Gvr.Valor AS INT)\nWHERE\n  Atv.IdAtividade = @IdAtividade\n</CommandText></Dados_Registro>\n-- Kauan Lauer 10-11 - 10:20\n\n-- SMX - Projeto de tarefa \n-- DIVERGÊNCIA FINANCEIRA DE PAGAMENTO AO AGENTE \"DV.01\" Operacional deve cloncluir.\n-- PROCESSO COM DIVERGÊNCIA FINANCEIRA DEBIT EM ANÁLISE COM CS \"DV.02\" Financeiro, é uma DV de controle, é concluida junto com a DV.01.\n-- DIVERGÊNCIA FINANCEIRA CONCLUÍDA ANALISAR PARA SEGUIR COM O PAGAMENTO \"DV.03\" é gerada quando a DV.01/02 é concluida, mas operacional não pode concluir."
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio - Situação embarque processo Desembarcado #45213.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n      WHEN ISNULL(Bloqueado, 0) = 1 THEN 4\n      ELSE 0\n    END,\n  @Mensagem = CAST(CASE\n      WHEN ISNULL(Bloqueado, 0) = 1 THEN 'Fatura de Agente em processo FCL requer Conferência Operacional.'\n      ELSE NULL\n    END as VARCHAR(MAX))\nFROM (\n  SELECT CASE WHEN EXISTS (\n    SELECT 1\n    FROM mov_Logistica_House Lhs\n    INNER JOIN mov_Logistica_Fatura Lft ON Lft.IdLogistica_House = Lhs.IdLogistica_House\n    CROSS JOIN (\n        SELECT\n            P.value('(Item[@Nome=\"IdLogistica_Master\"]/@Value)[1]', 'INT') as IdMaster,\n            P.value('(Item[@Nome=\"Situacao_Embarque\"]/@Value)[1]', 'INT') as NovaSituacao\n        FROM @Parametros.nodes('/Parametros/Evento/Campos') as T(P)\n    ) Params\n    WHERE Lhs.IdLogistica_Master = Params.IdMaster\n      AND Params.NovaSituacao = 3\n      AND Lhs.Tipo_Carga = 3\n      AND Lft.Tipo_Fatura = 3\n      AND ISNULL(Lft.Conferido_Operacional, 0) = 0\n  ) THEN 1 ELSE 0 END AS Bloqueado\n) X\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio de Pessoa para nao alterar codigo_pessoa.sql",
        "conteudo": "<Dados_Registro>\n  <CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5 -- 5 = Bloquear\n        Else 0\n      END,\n      @Mensagem = CAST(\n        CASE\n          WHEN Bloqueado = 1 THEN 'Não é permitido alterar o campo do Codigo! #44877'\n          Else NULL\n        END as VARCHAR(MAX)\n      )\n    FROM\n      (\n        SELECT\n          CAST(\n            CASE\n             \n              WHEN Psa.IdPessoa IS NOT NULL THEN\n               CASE\n                  WHEN ISNULL(Psa.Codigo, '') &lt;&gt; ISNULL(Prm.Codigo_Pessoa, '') THEN 1 -- 1 = Bloquear\n                  ELSE 0 -- 0 = Permitir \n                END\n              ELSE 0\n            END as INT\n          ) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdPessoa\"][1]/@Value', 'int') as IdPessoa,\n              Prm.value('Item[@Nome=\"Codigo\"][1]/@Value', 'VarChar(Max)') as Codigo_Pessoa\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          LEFT OUTER JOIN cad_Pessoa Psa ON Psa.IdPessoa = Prm.IdPessoa\n      ) Blq\n  </CommandText>\n</Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio de taxa pagamento aereo.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */\n    ELSE 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN '[BLC] TESTE BLOCK AEREO'\n    ELSE NULL\n  END as VARCHAR(MAX))\nFROM\n  (SELECT\n    CAST(CASE\n      WHEN ((Prm.IdOferta_Frete_Taxa IS NOT NULL AND Ofr.Modalidade_Processo = 1) AND\n          (\n            (Prm.Valor_Pagamento_Unitario &lt;&gt; Prm.Old_Valor_Pagamento_Unitario) OR\n            (Prm.Valor_Pagamento_Total &lt;&gt; Prm.Old_Valor_Pagamento_Total) OR\n            (Prm.Quantidade_Pagamento &lt;&gt; Prm.Old_Quantidade_Pagamento) OR\n            (Prm.Modalidade_Pagamento &lt;&gt; Prm.Old_Modalidade_Pagamento) OR\n            (Prm.IdPessoa_Pagamento &lt;&gt; Prm.Old_IdPessoa_Pagamento) OR\n            (Prm.IdMoeda_Pagamento &lt;&gt; Prm.Old_IdMoeda_Pagamento) OR\n            (Prm.Tipo_Pagamento &lt;&gt; Prm.Old_Tipo_Pagamento) OR\n            (Prm.Pagar_Para &lt;&gt; Prm.Old_Pagar_Para)\n          )\n      ) THEN 1\n      ELSE 0\n    END as int) as Bloqueado\n  FROM\n    (SELECT\n      /*New*/\n      Prm.value('Item[@Nome=\"IdOferta_Frete_Taxa\"][1]/@Value', 'int') as IdOferta_Frete_Taxa,\n      Prm.value('Item[@Nome=\"IdOferta_Frete\"][1]/@Value', 'int') as IdOferta_Frete,\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Unitario\"][1]/@Value', 'Numeric') as Valor_Pagamento_Unitario,\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Total\"][1]/@Value', 'Numeric') as Valor_Pagamento_Total,\n      Prm.value('Item[@Nome=\"Quantidade_Pagamento\"][1]/@Value', 'Numeric') as Quantidade_Pagamento,\n      Prm.value('Item[@Nome=\"Modalidade_Pagamento\"][1]/@Value', 'int') as Modalidade_Pagamento,\n      Prm.value('Item[@Nome=\"IdPessoa_Pagamento\"][1]/@Value', 'int') as IdPessoa_Pagamento,\n      Prm.value('Item[@Nome=\"IdMoeda_Pagamento\"][1]/@Value', 'int') as IdMoeda_Pagamento,\n      Prm.value('Item[@Nome=\"Tipo_Pagamento\"][1]/@Value', 'int') as Tipo_Pagamento,\n      Prm.value('Item[@Nome=\"Pagar_Para\"][1]/@Value', 'int') as Pagar_Para,\n      /*Old*/\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Unitario\"][1]/@OldValue', 'Numeric') as Old_Valor_Pagamento_Unitario,\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Total\"][1]/@OldValue', 'Numeric') as Old_Valor_Pagamento_Total,\n      Prm.value('Item[@Nome=\"Quantidade_Pagamento\"][1]/@OldValue', 'Numeric') as Old_Quantidade_Pagamento,\n      Prm.value('Item[@Nome=\"Modalidade_Pagamento\"][1]/@OldValue', 'int') as Old_Modalidade_Pagamento,\n      Prm.value('Item[@Nome=\"IdPessoa_Pagamento\"][1]/@OldValue', 'int') as Old_IdPessoa_Pagamento,\n      Prm.value('Item[@Nome=\"IdMoeda_Pagamento\"][1]/@OldValue', 'int') as Old_IdMoeda_Pagamento,\n      Prm.value('Item[@Nome=\"Tipo_Pagamento\"][1]/@OldValue', 'int') as Old_Tipo_Pagamento,\n      Prm.value('Item[@Nome=\"Pagar_Para\"][1]/@OldValue', 'int') as Old_Pagar_Para     \n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\n  LEFT OUTER JOIN\n    mov_Oferta_Frete Ofr On Ofr.IdOferta_Frete = Prm.IdOferta_Frete\n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio embarque-seguro - EM - TEX.txt",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 2 /* Aviso*/\n    Else 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN 'FAVOR VERIFICAR SE FOI PREENCHIDO:\n- Contatos follow up / agente\n- Proposta nos arquivos\n- Seguro (caso houver)\n- Referência / invoice e PL'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n(\n  SELECT\n    CAST(CASE\n           WHEN Prm.Situacao = 2 /* Aprovada */ THEN 1\n      Else 0\n    END as Bit) as Bloqueado\n  FROM\n  (\n    SELECT\n      Prm.value('Item[@Nome=\"IdOferta_Frete\"][1]/@Value', 'int') as IdOferta_Frete,\n      Prm.value('Item[@Nome=\"IdProposta_Frete\"][1]/@Value', 'int') as IdProposta_Frete,\n      Prm.value('Item[@Nome=\"Situacao\"][1]/@Value', 'int') as Situacao\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n  ) Prm\n JOIN mov_Proposta_Frete Pfr ON Pfr.IdProposta_Frete = Prm.IdProposta_Frete \n LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\n) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio embarque-seguro - EM Importância segurada.sql",
        "conteudo": "<Dados_Registro><CommandText>\n/*REQ #34180*/\nSELECT\n  @Acao = CASE WHEN Bloqueado = 1 THEN 5 Else 0 END, /* 5 = bloqueio */ \n  @Mensagem = CAST(CASE Bloqueado\n    WHEN 1 THEN 'Processo com seguro e sem importância segurada lançada'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n  (\n  SELECT\n    CASE\n      WHEN Prm.Seguro = 1 AND (Lhs.Importancia_Segurada IS NULL OR Lhs.Importancia_Segurada Like '0.00') THEN 1\n      ELSE 0\n    END as Bloqueado\n  FROM\n    (\n    SELECT\n    Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n    Prm.value('Item[@Nome=\"Seguro\"][1]/@Value', 'Int') as Seguro\n    FROM\n        @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n  ) Prm\n  LEFT OUTER JOIN \n    mov_Logistica_House Lhs on Lhs.IdLogistica_House = Prm.IdLogistica_House\n) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio Modalidade Pagamento -VOX  #44983.sql",
        "conteudo": "<Dados_Registro>\n  <CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(\n        CASE\n          WHEN Bloqueado = 1 THEN 'A Modalidade de Pagamento selecionada diverge da Modalidade da Taxa'\n          ELSE NULL\n        END AS VARCHAR(MAX)\n      )\n    FROM\n      (\n        SELECT\n          CAST(\n            CASE \n              WHEN Prm.IdTaxa_Logistica_Exibicao IS NULL \n                   AND Prm.Modalidade_Pagamento IS NOT NULL \n                   AND Ltx.IdLogistica_Taxa IS NOT NULL THEN\n                CASE\n                   WHEN Prm.Modalidade_Pagamento = 3 AND Ltx.Modalidade_Pagamento &lt;&gt; 1 THEN 1\n                   WHEN Prm.Modalidade_Pagamento = 2 AND Ltx.Modalidade_Pagamento &lt;&gt; 2 THEN 1\n                   WHEN Prm.Modalidade_Pagamento = 4 AND Ltx.Modalidade_Pagamento NOT IN (3, 4) THEN 1\n\n                   ELSE 0\n                END\n              ELSE 0\n            END AS INT\n          ) AS Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') AS IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdTaxa_Logistica_Exibicao\"][1]/@Value', 'int') AS IdTaxa_Logistica_Exibicao,\n              Prm.value('Item[@Nome=\"Modalidade_Pagamento\"][1]/@Value', 'int') AS Modalidade_Pagamento\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') AS Parametros(Prm)\n          ) Prm\n          LEFT OUTER JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          LEFT OUTER JOIN mov_Logistica_Taxa Ltx ON Ltx.IdLogistica_House = Lhs.IdLogistica_House AND Ltx.IdTaxa_Logistica_Exibicao = 2 /*252*/\n      ) Blq\n  </CommandText>\n</Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Bloqueio taxa pegamento #45264.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */\n    ELSE 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN '[BLC] TESTE BLOCK AEREO'\n    ELSE NULL\n  END as VARCHAR(MAX))\nFROM\n  (SELECT\n    CAST(CASE\n      WHEN ((Prm.IdOferta_Frete_Taxa IS NOT NULL AND Ofr.Modalidade_Processo = 1) AND\n          (\n            (Prm.Valor_Pagamento_Unitario &lt;&gt; Prm.Old_Valor_Pagamento_Unitario) OR\n            (Prm.Valor_Pagamento_Total &lt;&gt; Prm.Old_Valor_Pagamento_Total) OR\n            (Prm.Quantidade_Pagamento &lt;&gt; Prm.Old_Quantidade_Pagamento) OR\n            (Prm.Modalidade_Pagamento &lt;&gt; Prm.Old_Modalidade_Pagamento) OR\n            (Prm.IdPessoa_Pagamento &lt;&gt; Prm.Old_IdPessoa_Pagamento) OR\n            (Prm.IdMoeda_Pagamento &lt;&gt; Prm.Old_IdMoeda_Pagamento) OR\n            (Prm.Tipo_Pagamento &lt;&gt; Prm.Old_Tipo_Pagamento) OR\n            (Prm.Pagar_Para &lt;&gt; Prm.Old_Pagar_Para)\n          )\n      ) THEN 1\n      ELSE 0\n    END as int) as Bloqueado\n  FROM\n    (SELECT\n      /*New*/\n      Prm.value('Item[@Nome=\"IdOferta_Frete_Taxa\"][1]/@Value', 'int') as IdOferta_Frete_Taxa,\n      Prm.value('Item[@Nome=\"IdOferta_Frete\"][1]/@Value', 'int') as IdOferta_Frete,\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Unitario\"][1]/@Value', 'Numeric') as Valor_Pagamento_Unitario,\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Total\"][1]/@Value', 'Numeric') as Valor_Pagamento_Total,\n      Prm.value('Item[@Nome=\"Quantidade_Pagamento\"][1]/@Value', 'Numeric') as Quantidade_Pagamento,\n      Prm.value('Item[@Nome=\"Modalidade_Pagamento\"][1]/@Value', 'int') as Modalidade_Pagamento,\n      Prm.value('Item[@Nome=\"IdPessoa_Pagamento\"][1]/@Value', 'int') as IdPessoa_Pagamento,\n      Prm.value('Item[@Nome=\"IdMoeda_Pagamento\"][1]/@Value', 'int') as IdMoeda_Pagamento,\n      Prm.value('Item[@Nome=\"Tipo_Pagamento\"][1]/@Value', 'int') as Tipo_Pagamento,\n      Prm.value('Item[@Nome=\"Pagar_Para\"][1]/@Value', 'int') as Pagar_Para,\n      /*Old*/\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Unitario\"][1]/@OldValue', 'Numeric') as Old_Valor_Pagamento_Unitario,\n      Prm.value('Item[@Nome=\"Valor_Pagamento_Total\"][1]/@OldValue', 'Numeric') as Old_Valor_Pagamento_Total,\n      Prm.value('Item[@Nome=\"Quantidade_Pagamento\"][1]/@OldValue', 'Numeric') as Old_Quantidade_Pagamento,\n      Prm.value('Item[@Nome=\"Modalidade_Pagamento\"][1]/@OldValue', 'int') as Old_Modalidade_Pagamento,\n      Prm.value('Item[@Nome=\"IdPessoa_Pagamento\"][1]/@OldValue', 'int') as Old_IdPessoa_Pagamento,\n      Prm.value('Item[@Nome=\"IdMoeda_Pagamento\"][1]/@OldValue', 'int') as Old_IdMoeda_Pagamento,\n      Prm.value('Item[@Nome=\"Tipo_Pagamento\"][1]/@OldValue', 'int') as Old_Tipo_Pagamento,\n      Prm.value('Item[@Nome=\"Pagar_Para\"][1]/@OldValue', 'int') as Old_Pagar_Para     \n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\n  LEFT OUTER JOIN\n    mov_Oferta_Frete Ofr On Ofr.IdOferta_Frete = Prm.IdOferta_Frete\n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Buscar pelo nome do bloqueio condicional.sql",
        "conteudo": "SELECT   \n    Ppl.Nome as Nome_Papel,  \n    Bcl.Dados_Registro.value('.', 'NVARCHAR(MAX)') AS Dados_Registro,  \n    SUBSTRING(  \n        CAST(Bcl.Dados_Registro AS NVARCHAR(MAX)),   \n        CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX))) + 1,   \n        CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX)), CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX))) + 1)   \n        - CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX))) - 1  \n    ) AS Mensagem_Bloqueio  \nFROM   \ncad_Bloqueio_Condicional Bcl  \nLEFT OUTER JOIN   \nsys_Papel Ppl ON Ppl.IdPapel = Bcl.IdPapel  \nWHERE   \n    CAST(Bcl.Dados_Registro AS NVARCHAR(MAX)) LIKE '%armador cobra pela emissão%'\n \n"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Buscar se é um bloqueio condicional.sql",
        "conteudo": "SELECT   \n    Ppl.Nome as Nome_Papel,  \n    Bcl.Dados_Registro.value('.', 'NVARCHAR(MAX)') AS Dados_Registro,  \n    SUBSTRING(  \n        CAST(Bcl.Dados_Registro AS NVARCHAR(MAX)),   \n        CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX))) + 1,   \n        CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX)), CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX))) + 1)   \n        - CHARINDEX('''', CAST(Bcl.Dados_Registro AS NVARCHAR(MAX))) - 1  \n    ) AS Mensagem_Bloqueio  \nFROM   \ncad_Bloqueio_Condicional Bcl  \nLEFT OUTER JOIN   \nsys_Papel Ppl ON Ppl.IdPapel = Bcl.IdPapel  \nWHERE   \n    CAST(Bcl.Dados_Registro AS NVARCHAR(MAX)) LIKE '%Aeroporto Destino%'\n "
    },
    {
        "caminho": "Scripts\\Bloqueio\\Cliente Operacional não pode ser diferente do Comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT \n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /*Bloqueio*/\n    Else 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN 'Atenção! Cliente do Operacional está divergente do Cliente Comercial.'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n(\n  SELECT\n    CAST(CASE\n      WHEN Lhs.IdCliente &lt;&gt; Pfr.IdCliente THEN 1\n      Else 0\n    END as Int) as Bloqueado\n  FROM\n    (\n    SELECT\n      Prm.value('Item[@Nome=\"IdLogistica_Master\"][1]/@Value', 'int') as IdLogistica_Master,\n      Prm.value('Item[@Nome=\"Data_Embarque\"][1]/@Value', 'Date') as Data_Embarque\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n  ) Prm\nLEFT OUTER JOIN \n  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Prm.IdLogistica_Master\nLEFT OUTER JOIN \n  mov_Logistica_House Lhs on Lhs.IdLogistica_Master = Lms.IdLogistica_Master \nLEFT OUTER JOIN \n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\nLEFT OUTER JOIN \n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Companhia Transporte Operacional não pode ser diferente do comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(CASE\n        WHEN Bloqueado = 1 THEN 'A Companhia Transporte do Operacional é diferente da Companhia Transporte do Comercial.'\n        ELSE NULL\n      END as VARCHAR(MAX))\n    FROM\n      (\n        SELECT\n          CAST(CASE\n            WHEN ISNULL(COALESCE(Prm.IdCompanhia_Transporte_Tela, Lms.IdCompanhia_Transporte ), 0) &lt;&gt; ISNULL(Ofr.IdCompanhia_Transporte, 0) THEN 1\n            ELSE 0\n          END as INT) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdCompanhia_Transporte_Tela\"][1]/@Value', 'int') as IdCompanhia_Transporte_Tela\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          JOIN mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master \n          JOIN mov_Logistica_Viagem Lvm ON Lvm.IdLogistica_House = Lhs.IdLogistica_House\n          LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\n      ) Blq\n  </CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\DESPACHANTE ADUANEIRO Operacional não pode ser diferente do Comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(CASE\n        WHEN Bloqueado = 1 THEN 'O DESPACHANTE ADUANEIRO do Operacional é diferente do DESPACHANTE ADUANEIRO do Comercial.'\n        ELSE NULL\n      END as VARCHAR(MAX))\n    FROM\n      (\n        SELECT\n          CAST(CASE\n            WHEN ISNULL(COALESCE(Prm.IdDespachante_Aduaneiro_Tela, Lhs.IdDespachante_Aduaneiro), 0) &lt;&gt; ISNULL(Ofr.IdDespachante_Aduaneiro, 0) THEN 1\n            ELSE 0\n          END as INT) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdDespachante_Aduaneiro\"][1]/@Value', 'int') as IdDespachante_Aduaneiro_Tela\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\n      ) Blq\n  </CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Essa proposta não tem nenhum contato externo OPERACIONAL AGENTE!.sql",
        "conteudo": "<Dados_Registro><CommandText>\n/*\nDesenvolvido por: Victor Oliveira\nChamado: 31489\nEditado por: Kauan Lauer\nChamado: 46230\n*/\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */\n    Else 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN '[002] Essa proposta não tem nenhum contato externo OPERACIONAL AGENTE!'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n  (\n  SELECT\n    CAST(CASE\n      WHEN Prm.IdLogistica_House IS NOT NULL\n        AND Prm.IdOferta_Frete IS NOT NULL\n        AND (Ofr.Tipo_Operacao = 2  /*1-Exportação  2-Importação  3-Nacional*/ AND Ofr.Modalidade_Processo = 2 /*1-Aéreo  2-Marítimo   3-Terrestre*/ AND Ofr.Master_Direto = 0) /*Não*/\n         AND (SELECT\n\t\t\t\tCOUNT(Pag.IdGrupo_Envio_Mensagem)\n\t\t\tFROM \n\t\t\t\tmov_Oferta_Frete Ofr \n\t\t\tLEFT OUTER JOIN \n\t\t\t\tmov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n\t\t\tLEFT OUTER JOIN\n\t\t\t\tmov_Projeto_Atividade_Contato Pac ON Pac.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\n\t\t\tLEFT OUTER JOIN\n\t\t\t\tmov_Projeto_Atividade_Grupo_Envio Pag On Pag.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato AND Pag.IdGrupo_Envio_Mensagem = 8 /* OPERACIONAL AGENTE*/\n\t\t\tWHERE\n\t\t\t\tOfr.IdOferta_Frete = Prm.IdOferta_Frete) = 0 THEN 1\n      ELSE 0\n    END as int) as Bloqueado\n  FROM\n    (\n    SELECT\n      Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n      Prm.value('Item[@Nome=\"IdOferta_Frete\"][1]/@Value', 'int') as IdOferta_Frete\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\nLEFT OUTER JOIN\n                mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Prm.IdOferta_Frete           \n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Exibe aviso caso atividade seja gerada sem Responsável.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 2 /*AVISO*/\n    ELSE 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN 'Atividade gerada sem responsável vinculado, favor verificar.'\n    ELSE NULL\n  END as VARCHAR(MAX))\nFROM\n  (SELECT\n    CAST(CASE\n      WHEN (Prm.IdAtividade IS NOT NULL AND Atv.IdAtividade IS NULL) AND Prm.IdResponsavel IS NULL THEN 1\n      ELSE 0\n    END as Bit) as Bloqueado\n  FROM\n    (SELECT\n      Prm.value('Item[@Nome=\"IdAtividade\"][1]/@Value', 'int') as IdAtividade,\n      Prm.value('Item[@Nome=\"IdTarefa\"][1]/@Value', 'int') as IdTarefa,\n      Prm.value('Item[@Nome=\"Situacao\"][1]/@Value', 'int') as Situacao,\n      Prm.value('Item[@Nome=\"IdResponsavel\"][1]/@Value', 'int') as IdResponsavel\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\n  LEFT OUTER JOIN \n    mov_Atividade Atv ON Atv.IdAtividade = Prm.IdAtividade\n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Exportador operacional não pode ser diferente do comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(CASE\n        WHEN Bloqueado = 1 THEN 'O Exportador do Operacional é diferente do Exportador do Comercial.'\n        ELSE NULL\n      END as VARCHAR(MAX))\n    FROM\n      (\n        SELECT\n          CAST(CASE\n            WHEN ISNULL(COALESCE(Prm.IdExportador_Tela, Lhs.IdExportador), 0) &lt;&gt; ISNULL(Ofr.IdExportador, 0) THEN 1\n            ELSE 0\n          END as INT) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdExportador\"][1]/@Value', 'int') as IdExportador_Tela\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\n      ) Blq\n  </CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Importador Operacional não pode ser diferente do Comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(CASE\n        WHEN Bloqueado = 1 THEN 'O Importador do Operacional é diferente do Importador do Comercial.'\n        ELSE NULL\n      END as VARCHAR(MAX))\n    FROM\n      (\n        SELECT\n          CAST(CASE\n            WHEN ISNULL(COALESCE(Prm.IdImportador_Tela, Lhs.IdImportador), 0) &lt;&gt; ISNULL(Ofr.IdImportador, 0) THEN 1\n            ELSE 0\n          END as INT) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdImportador\"][1]/@Value', 'int') as IdImportador_Tela\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\n      ) Blq\n  </CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\Notify Operacional não pode ser diferente do Comercial.sql",
        "conteudo": "<Dados_Registro><CommandText>\n    SELECT\n      @Acao = CASE\n        WHEN Bloqueado = 1 THEN 5\n        ELSE 0\n      END,\n      @Mensagem = CAST(CASE\n        WHEN Bloqueado = 1 THEN 'O Notify do Operacional é diferente do Notify do Comercial.'\n        ELSE NULL\n      END as VARCHAR(MAX))\n    FROM\n      (\n        SELECT\n          CAST(CASE\n            WHEN ISNULL(COALESCE(Prm.IdNotify_Tela, Lhs.IdNotify), 0) &lt;&gt; ISNULL(Ofr.IdNotify, 0) THEN 1\n            ELSE 0\n          END as INT) as Bloqueado\n        FROM\n          (\n            SELECT\n              Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n              Prm.value('Item[@Nome=\"IdNotify\"][1]/@Value', 'int') as IdNotify_Tela\n            FROM\n              @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n          ) Prm\n          JOIN mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n          LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\n      ) Blq\n  </CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\NÃO DEIXA GERAR PROPOSTA SEM VALOR DE MERCADORIA.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */\n    Else 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN 'Favor preencher o valor da mercadoria.'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n  (\n  SELECT\n    CAST(CASE\n      WHEN (Prm.IdLogistica_House IS NOT NULL) AND (Prm.Valor_Mercadoria IS NULL) THEN 1\n      ELSE 0\n    END as int) as Bloqueado\n  FROM\n    (\n    SELECT\n      Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n      Prm.value('Item[@Nome=\"Valor_Mercadoria\"][1]/@Value', 'numeric') as Valor_Mercadoria\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\n  JOIN \n    mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House\n  LEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\[002] Não insere processo sem contato externo com Grupo de envio OPERACIONAL AGENTE.sql",
        "conteudo": "<Dados_Registro><CommandText>\n/*\nDesenvolvido por: Victor Oliveira\nChamado: 31489\n*/\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */\n    Else 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN '[002] Essa proposta não tem nenhum contato externo OPERACIONAL AGENTE!'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n  (\n  SELECT\n    CAST(CASE\n      WHEN Prm.IdLogistica_House IS NOT NULL\n        AND Prm.IdOferta_Frete IS NOT NULL\n     \n        AND (Ofr.Tipo_Operacao = 2  /*1-Exportação  2-Importação  3-Nacional*/ AND Ofr.Modalidade_Processo = 2) /*1-Aéreo  2-Marítimo   3-Terrestre*/ \n         AND (SELECT\n\t\t\t\tCOUNT(Pag.IdGrupo_Envio_Mensagem)\n\t\t\tFROM \n\t\t\t\tmov_Oferta_Frete Ofr \n\t\t\tLEFT OUTER JOIN \n\t\t\t\tmov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n\t\t\tLEFT OUTER JOIN\n\t\t\t\tmov_Projeto_Atividade_Contato Pac ON Pac.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\n\t\t\tLEFT OUTER JOIN\n\t\t\t\tmov_Projeto_Atividade_Grupo_Envio Pag On Pag.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato AND Pag.IdGrupo_Envio_Mensagem = 8 /* OPERACIONAL AGENTE*/\n\t\t\tWHERE\n\t\t\t\tOfr.IdOferta_Frete = Prm.IdOferta_Frete) = 0 THEN 1\n      ELSE 0\n    END as int) as Bloqueado\n  FROM\n    (\n    SELECT\n      Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n      Prm.value('Item[@Nome=\"IdOferta_Frete\"][1]/@Value', 'int') as IdOferta_Frete\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\nLEFT OUTER JOIN\n                mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Prm.IdOferta_Frete           \n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Bloqueio\\[009] Não insere processo sem contato externo com Grupo de envio OPERACIONAL AGENTE.txt",
        "conteudo": "<Dados_Registro><CommandText>\n/*\nDesenvolvido por: Victor Oliveira\nChamado: 31489\n*/\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */\n    Else 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN '[009] Essa proposta não tem nenhum contato externo OPERACIONAL AGENTE!'\n    Else NULL\n  END as VARCHAR(MAX))\nFROM\n  (\n  SELECT\n    CAST(CASE\n      WHEN Prm.IdLogistica_House IS NOT NULL\n        AND Prm.IdOferta_Frete IS NOT NULL\n        AND (Ofr.Tipo_Operacao = 1) /*EXPORTACAO*/\n        AND (Ofr.Master_Direto = 0) /*NAO*/\n         AND (SELECT\n\t\t\t\tCOUNT(Pag.IdGrupo_Envio_Mensagem)\n\t\t\tFROM \n\t\t\t\tmov_Oferta_Frete Ofr \n\t\t\tLEFT OUTER JOIN \n\t\t\t\tmov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n\t\t\tLEFT OUTER JOIN\n\t\t\t\tmov_Projeto_Atividade_Contato Pac ON Pac.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\n\t\t\tLEFT OUTER JOIN\n\t\t\t\tmov_Projeto_Atividade_Grupo_Envio Pag On Pag.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato AND Pag.IdGrupo_Envio_Mensagem = 8 /*  OPERACIONAL AGENTE */\n\t\t\tWHERE\n\t\t\t\tOfr.IdOferta_Frete = Prm.IdOferta_Frete) = 0 THEN 1\n      ELSE 0\n    END as int) as Bloqueado\n  FROM\n    (\n    SELECT\n      Prm.value('Item[@Nome=\"IdLogistica_House\"][1]/@Value', 'int') as IdLogistica_House,\n      Prm.value('Item[@Nome=\"IdOferta_Frete\"][1]/@Value', 'int') as IdOferta_Frete\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n    ) Prm\nLEFT OUTER JOIN\n                mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Prm.IdOferta_Frete\n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Consultas\\AGL RELATORIO OUTSTANDING DEMURRAGE & DETENTION.sql",
        "conteudo": "SELECT\nLhs.IdLogistica_House,\nLmd.Lucro_Estimado,\nLmd.Total_Pago - Lmd.Total_Pagamento_Local AS Diferenca_Pagamento,\nLmd.Total_Pago,\nCASE \nWHEN Txa.Total_Recebimento IS NOT NULL THEN Lmd.Total_Recebido_Local + Txa.Total_Recebimento\nELSE Lmd.Total_Recebido_Local\nEND as Total_Fatura_Armador,\nSpl.Descricao,\nLhs.Observacao,\nLhe.Numero_Processo as Processo_Origem,\nVen.Nome AS Vendedor,\nOft.Numero_Oferta,\nLhs.Numero_Processo,\nRec.Pessoa_Recebimento,\nRec.Moeda_Recebimento,\nRec.Valor_Recebimento,\nLmd.Total_Recebimento_Local,\nCASE\nWHEN Rec.Data_Vencimento IS NOT NULL THEN\nCASE\nWHEN DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento) < 0 \nTHEN '-' + CAST(ABS(DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento)) AS VARCHAR) \nELSE '+' + CAST(DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento) AS VARCHAR)\nEND\nELSE NULL\nEND AS Dias_Vencimento,\nRec.Data_Vencimento,\nCia.Nome AS Cia_Transporte,\nLhs.Conhecimentos AS BL_House,\nLms.Numero_Conhecimento AS BL_Master\nFROM\nmov_Logistica_House Lhs\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master \nLEFT OUTER JOIN\nmov_Oferta_Frete Oft ON Oft.IdOferta_Frete = Lhs.IdOferta_Frete\nLEFT OUTER JOIN\nmov_Logistica_House Lhe ON Lhe.IdLogistica_House = Lhs.IdProcesso_Origem\nLEFT OUTER JOIN\ncad_Status_Processo_Logistico Spl on Spl.IdStatus_Processo_Logistico = Lhs.IdStatus_Processo_Logistico\nLEFT OUTER JOIN\ncad_Pessoa Ven ON Ven.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN\ncad_Pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN\t(\nSELECT \nROW_NUMBER() OVER(PARTITION BY Lho.IdLogistica_House ORDER BY Lho.IdLogistica_House) AS Indice,\nLho.IdLogistica_House,\nLda.Total_Recebimento\nFROM\nmov_Logistica_House Lho\nLEFT OUTER JOIN\t \nmov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lho.IdLogistica_House\nLEFT OUTER JOIN\t\nmov_Logistica_Master Lmt on Lmt.IdLogistica_Master = Lho.IdLogistica_Master\nLEFT OUTER JOIN\t\nmov_Logistica_Moeda Lda on Lda.IdLogistica_House = Lho.IdLogistica_House AND Lda.IdMoeda = 110 /*Real*/\nWHERE\nLtx.IdTaxa_Logistica_Exibicao = 168 /*reembolso*/\nAND \nLmt.IdCompanhia_Transporte = Ltx.IdPessoa_Recebimento\n) Txa on Txa.IdLogistica_House = Lhs.IdLogistica_House AND Txa.Indice = 1\nLEFT OUTER JOIN\nmov_Logistica_Moeda Lmd ON Lmd.IdLogistica_House = Lhs.IdLogistica_House AND Lmd.IdMoeda = 110 /*Real*/\nLEFT OUTER JOIN (\nSELECT\nROW_NUMBER() OVER(PARTITION BY Lft.IdLogistica_House ORDER BY Ffn.Data_Vencimento ASC) AS Indice,\nFfn.Data_Vencimento,\nPrc.Nome AS Pessoa_Recebimento,\nSUM(Ltx.Valor_Recebimento_Total) as Valor_Recebimento,\nMda.Sigla AS Moeda_Recebimento,\nLft.IdLogistica_House\nFROM\nmov_Logistica_Fatura Lft\nLEFT OUTER JOIN\nmov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\nmov_Logistica_Taxa Ltx ON Ltx.IdRegistro_Recebimento = Ffn.IdRegistro_Financeiro\nLEFT OUTER JOIN\nvis_Logistica_Fatura_Totais Lfs on Lfs.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\ncad_Pessoa Prc ON Prc.IdPessoa = Ltx.IdPessoa_Recebimento\nLEFT OUTER JOIN\ncad_Moeda Mda ON Mda.IdMoeda = Ltx.IdMoeda_Recebimento\nWHERE Ffn.Natureza = 1 /*Credito*/\nGROUP BY\nLft.IdLogistica_House,\nFfn.Data_Vencimento,\nPrc.Nome,\nMda.Sigla) Rec on Rec.IdLogistica_House = Lhs.IdLogistica_House AND Rec.Indice = 1\nLEFT OUTER JOIN (\nSELECT\nROW_NUMBER() OVER(PARTITION BY Lft.IdLogistica_House ORDER BY Ffn.Situacao DESC) AS Indice,\nLft.IdLogistica_House,\nLtx.IdPessoa_Pagamento,\nFfn.Situacao,\nFfn.Total_Pago_Corrente,\nFfn.Referencia_Externa\nFROM\nmov_Logistica_Fatura Lft\nLEFT OUTER JOIN\nmov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\nmov_Logistica_Taxa Ltx ON Ltx.IdRegistro_Pagamento = Ffn.IdRegistro_Financeiro\nWHERE\nFfn.Natureza = 0 /*Debito*/ AND Ltx.Pagar_Para = 5 /*Cia Transporte*/) Pag on Pag.IdLogistica_House = Lhs.IdLogistica_House AND Pag.Indice = 1 \n/*WHERE*/\nWHERE\nLhs.Situacao_Agenciamento NOT IN (7,4,3) /*Cancelado, Faturado, Liberado faturamento*/ \nAND\nLhs.Demurrage_Detention = 1 /*Sim*/\nAND\nLhs.Data_Abertura_Processo > '2020-01-01'\nAND\nLms.Tipo_Operacao = 2 /*Importação*/\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\ALTERAÇÃO NA MÉTRICA DO PESO CONSIDERADO - LCL LEADER.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then /*case When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else*/ '% sobre importância segurada' /*end*/\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'per Process'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'per KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'per KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'per KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'per CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'per HAWB' When 2 then 'per HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'per Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'per Volum'\n        When Oft.Tipo_Recebimento = 10 Then 'per CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'per ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'per TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'by percentage'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 17 Then \n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'per KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'per w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'per Ton' \n                Else ' per Ton or w/m' \n              End \n            Else 'por Ton or w/m' \n          End\n  end as Tipo_Recebimento_escrito_ingles,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 23 Then 'Por Ton' /*Peso bruto/ton adicionado 26-11*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End,Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Consultas\\Atividade Seguro.sql",
        "conteudo": "<Dados_Registro><Mensagem>Atenção!!!</Mensagem><CommandText>\nSelect\n  @Mensagem =  'Atenção! Necessário marcar o seguro na guia carga! #44611',\n @Condicao =\n    CASE\n      WHEN Pfc.Seguro= 0 THEN 0 -- verifica se o campo está em '0' se sim, bloqueia\n      ELSE 1 -- caso esteja flegado o campo de seguro '1' ele libera para concluir\n    END    \nFrom\n  mov_Atividade atv -- busca da atividade\nLeft Outer Join\n  mov_Proposta_Frete Pft on Pft.IdProjeto_Atividade = Atv.IdProjeto_Atividade -- faz a junção do idprojeto_atividade com, o mov_atividade\nLeft OUTER JOIN\n    mov_Proposta_Frete_Carga Pfc ON Pfc.IdProposta_Frete = Pft.IdProposta_Frete -- verifico qual é a proposta pelo id \nWhere\n  Atv.IdAtividade = @IdAtividade\n</CommandText></Dados_Registro>\n-- Kauan Lauer 10-11 16:44\n-- Kauan Lauer 11-11 10:00"
    },
    {
        "caminho": "Scripts\\Consultas\\Buscar Navios do processo com origem-destino.sql",
        "conteudo": "SELECT \n\tLhs.IdLogistica_House,\n\tLvg.IdLogistica_Viagem,\n\tNvi.Nome AS Navio,\n\tLvg.Numero_Controle AS Reserva,\n\tLvg.Viagem_Voo,\n\tOrg.Nome AS Origem,\n\tDst.Nome AS Destino,\n\tCoalesce(Lvg.Data_Previsao_DesEmbarque,Lvg.Data_Desembarque) as ETA,\n        Case When Lvg.Data_Embarque is null then Coalesce(Lvg.Data_Previsao_Embarque,Lvg.Data_Embarque) else Lvg.Data_Embarque End as ETD,\n\tDATEDIFF(dd,Lvg.Data_Previsao_Embarque, Lvg.Data_Previsao_Desembarque) AS Transit_Time\nFROM\n\tmov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tmov_Logistica_Viagem Lvg ON Lvg.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lvg.IdOrigem\nLEFT OUTER JOIN\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lvg.IdDestino\nJOIN\n  cad_Navio Nvi on Nvi.IdNavio = Lvg.IdNavio\nWhere\n  Atv.IdAtividade = 54172  --:IdAtividade\">\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\COM - OFERTA MARITIMA COM VALOR LEADER BKP.txt",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 20 Then 'U.N'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'per Process'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'per KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'per KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'per KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'per CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'per HAWB' When 2 then 'per HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'per Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'per Volum'\n        When Oft.Tipo_Recebimento = 10 Then 'per CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'per ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'per TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'by percentage'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 20 Then 'U.N'\n        When Oft.Tipo_Recebimento = 17 Then         \n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'per KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'per CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'per Ton' \n                Else ' per Ton or CBM' \n              End \n            Else 'por Ton or CBM' \n          End\n  end as Tipo_Recebimento_escrito_ingles,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 20 Then 'U.N'\n        When Oft.Tipo_Pagamento = 17 Then  \n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Origem_Taxa = 1 /*Frete*/\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Consultas\\COM - OFERTA MARITIMA COM VALOR LEADER.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 20 Then 'U.N'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'per Process'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'per KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'per KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'per KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'per CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'per HAWB' When 2 then 'per HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'per Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'per Volum'\n        When Oft.Tipo_Recebimento = 10 Then 'per CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'per ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'per TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'by percentage'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 20 Then 'U.N'\n        When Oft.Tipo_Recebimento = 17 Then         \n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'per KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'per CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'per Ton' \n                Else ' per Ton or CBM' \n              End \n            Else 'por Ton or CBM' \n          End\n  end as Tipo_Recebimento_escrito_ingles,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 20 Then 'U.N'\n        When Oft.Tipo_Pagamento = 17 Then  \n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Origem_Taxa = 1 /*Frete*/\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta - ABW2.sql",
        "conteudo": "SELECT\nLhs.Referencia_Cliente as Referencia_Cliente,\nLhs.Numero_Processo as Referencia_Tex,\nCne.Numero as Numero_BL_House,\nLms.Numero_Conhecimento as Numero_BL_Master,\nOrm.Nome as Origem,\nDst.Nome as Destino,\nPes.Nome as Nome_Cliente,\nCia.nome as Armador,\nNvi.Nome as Navio,\nLms.Data_Previsao_Embarque as ETD,\nLms.Data_Previsao_Desembarque as ETA,\nSUM(Lme.Quantidade) AS Quantidade_Ctnr,\nCAST(Lgt.Navio AS VARCHAR(MAX)) AS Navio_Transbordo,\nLmc.Free_Time_House as Free_Time_House,\nLmc.Number as Container,\nTf1.Descricao,\nCASE\nWHEN At1.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_Draft,\nTf2.Descricao,\nCASE\nWHEN At2.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_HBL,\nTf3.Descricao,\nCASE\nWHEN At3.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_OMBL,\nTf4.Descricao,\nCASE\nWHEN At4.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_Manifesto,\nCASE\nWHEN Lgp.Valor_Boleano IS NULL THEN 'Não' /*Não marcado*/\nWHEN Lgp.Valor_Boleano = 0 THEN 'Não' /*Não marcado*/\nELSE 'Sim'\nEND AS Ajuste_NCM,\nLgp2.Valor_Data AS Retificação_CE,\nLgp3.Valor_Data AS Conclusão_Retificacao\nFROM\nmov_logistica_house as Lhs\nleft outer join\ncad_Pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\nmov_Conhecimento_Embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Origem_Destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\t\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House \nleft outer join\ncad_Navio Nav ON Nav.IdNavio = Lms.IdCompanhia_Transporte\nLeft Outer Join\t(\nSELECT\nLmc.IdLogistica_House,\nSTRING_AGG(Lmc.Number, ' / ') as Number,\nLmc.Free_Time_House\nFROM\nmov_Logistica_Maritima_Container Lmc\nGROUP BY\nLmc.IdLogistica_House,\nLmc.Free_Time_House\n) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join(\nSELECT\t\nLgv.IdLogistica_House,\nSTRING_AGG(Nat.Nome, ' / ') as Navio\nFROM\nmov_Logistica_viagem Lgv\nleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgv.IdNavio\nWHERE\nLgv.Tipo_Viagem = 5\nGROUP BY\nLgv.IdLogistica_House\n)Lgt on Lgt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\nmov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\ncad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\nmov_Atividade At1 on At1.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At1.IdTarefa = 839 /*Envio do Draft ao cliente para aprovação*/\nLeft Outer Join\ncad_Tarefa Tf1 on Tf1.IdTarefa = At1.IdTarefa\nLeft Outer Join\nmov_Atividade At2 on At2.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At2.IdTarefa = 844 /*Enviar HBL original ao cliente*/\nLeft Outer Join\ncad_Tarefa Tf2 on Tf2.IdTarefa = At2.IdTarefa\nLeft Outer Join\nmov_Atividade At3 on At3.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At3.IdTarefa = 1266 /*Envio OMBL editado ao cliente (MAO)*/\nLeft Outer Join\ncad_Tarefa Tf3 on Tf3.IdTarefa = At3.IdTarefa\nLeft Outer Join\nmov_Atividade At4 on At4.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At4.IdTarefa = 1335 /*Envio do Manifesto de baldeação*/\nLeft Outer Join\ncad_Tarefa Tf4 on Tf4.IdTarefa = At4.IdTarefa\nleft outer join\nvis_logistica_prazo Lgp ON Lgp.IdLogistica_House = Lhs.IdLogistica_House and Lgp.IdConfiguracao_Campo_Livre = 216 /*Ajuste NCM*/\nleft outer join\nvis_logistica_prazo Lgp2 ON Lgp2.IdLogistica_House = Lhs.IdLogistica_House and Lgp2.IdConfiguracao_Campo_Livre = 215 /*Retificação de CE*/\nleft outer join\nvis_logistica_prazo Lgp3 ON Lgp3.IdLogistica_House = Lhs.IdLogistica_House and Lgp3.IdConfiguracao_Campo_Livre = 217 /*Conclusão retificação*/\n/*WHERE*/\nWHERE\nPes.IdPessoa = 49971 /*ABW*/\nAND\nLms.Modalidade_Processo = 2 /*Maritimo*/\nAND\nLms.Tipo_Operacao= 2 /*importacao*/\nGROUP BY\nLhs.Referencia_Cliente,\nLhs.Numero_Processo,\nCne.Numero,\nLms.Numero_Conhecimento,\nOrm.Nome,\nDst.Nome,\nPes.Nome,\nCia.nome,\nLms.Data_Previsao_Embarque,\nLms.Data_Previsao_Desembarque,\nLmc.Free_Time_House,\nTf1.Descricao,\nAt1.Situacao,\nTf2.Descricao,\nAt2.Situacao,\nTf3.Descricao,\nAt3.Situacao,\nTf4.Descricao,\nAt4.Situacao,\nLgp.Valor_Boleano,\nLgp2.Valor_Data,\nLgp3.Valor_Data,\nLgt.Navio,\nLmc.Number,\nNvi.Nome"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta AGL Dass.sql",
        "conteudo": "﻿SELECT\nLhs.Numero_Processo AS Referencia_Agente, /*Referencia Agente Origem*/\nLhs.Referencia_Cliente AS Referencia_Dass, /*Referencia Cliente*/\nCli.Nome AS Cliente, /*Cliente topo Pag*/\nDes.Nome AS Despachante, /*Despachante Adianeiro*/\nImp.Nome AS Importador, /*Importador**/\nExp.Nome AS Exportador, /*Exportador*/\n\tCASE\nWHEN Lhs.Tipo_Carga = 1 THEN 'Aereo'\nWHEN Lhs.Tipo_Carga = 3 THEN 'FCL'\nWHEN Lhs.Tipo_Carga = 4 THEN 'LCL'\n\tELSE NULL\n\tEND AS Tipo_Carga, /*Verificar tipo de carga*/\nLmc.Equipamento AS Equipamento, /*tem uma string para juntas os nomes dos equipamentos na mesma linha*/\nLmc.Number AS Container, /*tem uma string para juntas os numeros dos containeres na mesma linha*/\nLmm.Numero_CE, /*Mercante*/\nFORMAT(Lmm.Data_CE, 'dd-MM-yyyy') AS [Data CE],\nCia.Nome AS Armador, /*Armador transportadora pode ser pessoa*/\nLms.Numero_Conhecimento AS MBL, \nCne.Numero AS HBL,\n--FORMAT(Lms.Data_Previsao_Embarque, 'dd-MM-yyyy') AS [Previsao Embarque],\n--FORMAT(Lms.Data_Embarque, 'dd-MM-yyyy') AS [Data Embarque],\nOrm.Nome AS [Porto Origem],\nDst.Nome AS [Porto Destino],\n--FORMAT(Lms.Data_Previsao_Desembarque, 'dd-MM-yyyy') AS [Previsao Desembarque],\n--FORMAT(Lms.Data_Desembarque, 'dd-MM-yyyy') AS [Data Desembarque],\nLmc.Free_Time_House AS [Free Time House],\nLgt.[PREVISAO EMBARQUE],\nLgt.[DATA EMBARQUE],\nLgt.[PREVISAO DESEMBARQUE],\nLgt.[DATA DESEMBARQUE]\n\n\nFROM\nmov_logistica_house AS Lhs\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\ncad_pessoa Cli ON Cli.IdPessoa = Lhs.IdCliente\nleft outer join\ncad_pessoa Des ON Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nleft outer join\ncad_pessoa Imp ON Imp.IdPessoa = Lhs.IdImportador\nleft outer join\ncad_pessoa Agt ON Agt.IdPessoa = Lms.IdAgente_Origem\nleft outer join\ncad_pessoa Exp ON Exp.IdPessoa = Lhs.IdExportador\nleft outer join(\n\tSELECT\nLmc.IdLogistica_House,\nSTRING_AGG(Lmc.Number, ' / ') AS Number,\nLmc.Free_Time_House,\nSTRING_AGG(Eqm.Descricao, ' / ') AS Equipamento\n\tFROM\nmov_Logistica_Maritima_Container Lmc\nLeft Outer Join\ncad_equipamento_maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\n\tGROUP BY\nLmc.IdLogistica_House,\nLmc.Free_Time_House\n)Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\nmov_Logistica_Maritima_Master Lmm ON Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nleft outer join\nmov_conhecimento_embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_origem_destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_origem_destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\n\n\nleft outer join(\n\tSELECT\t\n\t\tLgv.IdLogistica_House,\n\t\tSTRING_AGG(Nat.Nome, ' / ') as Navio,\n\t\tSTRING_AGG(FORMAT(Lgv.Data_Previsao_Embarque, 'dd-MM-yyyy'), ' / ') AS [PREVISAO EMBARQUE],\n\t\tSTRING_AGG(CONVERT(VARCHAR(10), Lgv.Data_Embarque, 105), ' / ') AS [DATA EMBARQUE],\n\t\tSTRING_AGG(CONVERT(VARCHAR(10), Lgv.Data_Previsao_Desembarque, 105), ' / ') AS [PREVISAO DESEMBARQUE],\n\t\tSTRING_AGG(CONVERT(VARCHAR(10), Lgv.Data_Desembarque, 105), ' / ') AS [DATA DESEMBARQUE]\n\tFROM\n\t\tmov_Logistica_viagem Lgv\n\t\tleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgv.IdNavio\n\tWHERE\n\t\tLgv.Tipo_Viagem = 5\n\tGROUP BY\n\t\tLgv.IdLogistica_House,\n\t\tNat.Nome\n)Lgt on Lgt.IdLogistica_House = Lhs.IdLogistica_House\n\n\nWHERE\nLms.Modalidade_Processo = 2 /*Maritimo*/\nAND\nLhs.Referencia_Cliente LIKE '%Dass%'\n\n--AND\n--Lhs.Numero_Processo = 'IM0728-25' /*Processo para teste 'remover esse filtro no final do teste'*/"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta AGL Dass1.sql",
        "conteudo": "﻿SELECT\nLhs.Numero_Processo AS Referencia_Agente, /*Referencia Agente Origem*/\nLhs.Referencia_Cliente AS Referencia_Dass, /*Referencia Cliente*/\nCli.Nome AS Cliente, /*Cliente topo Pag*/\nDes.Nome AS Despachante, /*Despachante Adianeiro*/\nImp.Nome AS Importador, /*Importador**/\nExp.Nome AS Exportador, /*Exportador*/\n\tCASE\nWHEN Lhs.Tipo_CArga = 1 THEN 'A�reo'\nWHEN Lhs.Tipo_Carga = 3 THEN 'FCL'\nWHEN Lhs.Tipo_Carga = 4 THEN 'LCL'\n\tELSE NULL\n\tEND AS Tipo_Carga, /*Verificar tipo de carga*/\nLmc.Equipamento AS Equipamento, /*tem uma string para juntas os nomes dos equipamentos na mesma linha*/\nLmc.Number AS Container, /*tem uma string para juntas os numeros dos containeres na mesma linha*/\nLmm.Numero_CE, /*Mercante*/\nFORMAT(Lmm.Data_CE, 'dd-MM-yyyy') AS [Data CE],\nCia.Nome AS Armador, /*Armador transportadora pode ser pessoa*/\nLms.Numero_Conhecimento AS MBL, \nCne.Numero AS HBL,\nFORMAT(Lms.Data_Previsao_Embarque, 'dd-MM-yyyy') AS [Previs�o Embarque],\nFORMAT(Lms.Data_Embarque, 'dd-MM-yyyy') AS [Data Embarque],\nOrm.Nome AS [Porto Origem],\nDst.Nome AS [Porto Destino],\nFORMAT(Lms.Data_Previsao_Desembarque, 'dd-MM-yyyy') AS [Previsao Desembarque],\nFORMAT(Lms.Data_Desembarque, 'dd-MM-yyyy') AS [Data Desembarque],\nLmc.Free_Time_House AS [Free Time House],\nLgt.[PREVISAO EMBARQUE],\nLgt.[DATA EMBARQUE],\nLgt.[PREVISAO DESEMBARQUE],\nLgt.[DATA DESEMBARQUE]\n\n\nFROM\nmov_logistica_house AS Lhs\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\ncad_pessoa Cli ON Cli.IdPessoa = Lhs.IdCliente\nleft outer join\ncad_pessoa Des ON Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nleft outer join\ncad_pessoa Imp ON Imp.IdPessoa = Lhs.IdImportador\nleft outer join\ncad_pessoa Agt ON Agt.IdPessoa = Lms.IdAgente_Origem\nleft outer join\ncad_pessoa Exp ON Exp.IdPessoa = Lhs.IdExportador\nleft outer join(\n\tSELECT\nLmc.IdLogistica_House,\nSTRING_AGG(Lmc.Number, ' / ') AS Number,\nLmc.Free_Time_House,\nSTRING_AGG(Eqm.Descricao, ' / ') AS Equipamento\n\tFROM\nmov_Logistica_Maritima_Container Lmc\nLeft Outer Join\ncad_equipamento_maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\n\tGROUP BY\nLmc.IdLogistica_House,\nLmc.Free_Time_House\n)Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\nmov_Logistica_Maritima_Master Lmm ON Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nleft outer join\nmov_conhecimento_embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_origem_destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_origem_destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\n\n\nleft outer join(\n\tSELECT\t\n\t\tLgv.IdLogistica_House,\n\t\tSTRING_AGG(Nat.Nome, ' / ') as Navio,\n\t\tSTRING_AGG(FORMAT(Lgv.Data_Previsao_Embarque, 'dd-MM-yyyy'), ' / ') AS [PREVISAO EMBARQUE],\n\t\tSTRING_AGG(CONVERT(VARCHAR(10), Lgv.Data_Embarque, 105), ' / ') AS [DATA EMBARQUE],\n\t\tSTRING_AGG(CONVERT(VARCHAR(10), Lgv.Data_Previsao_Desembarque, 105), ' / ') AS [PREVISAO DESEMBARQUE],\n\t\tSTRING_AGG(CONVERT(VARCHAR(10), Lgv.Data_Desembarque, 105), ' / ') AS [DATA DESEMBARQUE]\n\tFROM\n\t\tmov_Logistica_viagem Lgv\n\t\tleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgv.IdNavio\n\tWHERE\n\t\tLgv.Tipo_Viagem = 5\n\tGROUP BY\n\t\tLgv.IdLogistica_House,\n\t\tNat.Nome\n)Lgt on Lgt.IdLogistica_House = Lhs.IdLogistica_House\n\n\nWHERE\nLms.Modalidade_Processo = 2 /*Maritimo*/\nAND\nLhs.Numero_Processo = 'IM0728-25' /*Processo para teste 'remover esse filtro no final do teste'*/\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta AGL Processos.sql",
        "conteudo": "DECLARE @Tabela      VARCHAR(MAX) = 'mov_Logistica_House'\nDECLARE @PK1_Nome    VARCHAR(200) = 'IdLogistica_House'\nDECLARE @PK1_Valor   VARCHAR(MAX) = '' -- VAZIO para pegar todos da lista\n\n-- Opcionais\nDECLARE @PK2_Nome    VARCHAR(200) = ''\nDECLARE @PK2_Valor   VARCHAR(MAX) = ''\nDECLARE @PK3_Nome    VARCHAR(200) = ''\nDECLARE @PK3_Valor   VARCHAR(MAX) = ''\n\nDECLARE @Data_Inicio_Texto  VARCHAR(20) = '01/01/2025' -- Data Ajustada\nDECLARE @Usar_Hoje_Termino  BIT         = 1            \nDECLARE @Data_Termino_Texto VARCHAR(20) = ''           \n\n-- ?? OUTROS FILTROS\nDECLARE @IdUsuario IdCurto  = 0  -- 0 = Todos\nDECLARE @Tipo      TipoFixo = 0  -- 0 = Todos\n\n/* -----------------------------------\n   ?? Variáveis internas (ESTRUTURA ORIGINAL MANTIDA)\n----------------------------------- */\nDECLARE\n  @Primary_Keys  XML,\n  @Data_Inicio   DATETIME,\n  @Data_Termino  DATETIME,\n  @SQL           NVARCHAR(MAX),\n  @Filtro_Tabela VARCHAR(MAX),\n  @Filtro_Campo  VARCHAR(MAX),\n  @Filtro_Tipo   VARCHAR(MAX),\n  @IdExprList    NVARCHAR(MAX),\n  @IdExprCount   INT,\n  @ExprId        NVARCHAR(MAX),\n  @OrderBy       NVARCHAR(MAX)\n\n-- Normaliza entradas\nSET @PK1_Nome  = NULLIF(LTRIM(RTRIM(@PK1_Nome)) , '')\nSET @PK1_Valor = NULLIF(LTRIM(RTRIM(@PK1_Valor)), '')\nSET @PK2_Nome  = NULLIF(LTRIM(RTRIM(@PK2_Nome)) , '')\nSET @PK2_Valor = NULLIF(LTRIM(RTRIM(@PK2_Valor)), '')\nSET @PK3_Nome  = NULLIF(LTRIM(RTRIM(@PK3_Nome)) , '')\nSET @PK3_Valor = NULLIF(LTRIM(RTRIM(@PK3_Valor)), '')\n\nSET @Data_Inicio_Texto  = NULLIF(LTRIM(RTRIM(@Data_Inicio_Texto)) , '')\nSET @Data_Termino_Texto = NULLIF(LTRIM(RTRIM(@Data_Termino_Texto)), '')\nSET @Tabela             = NULLIF(LTRIM(RTRIM(@Tabela))             , '')\n\n-- Monta a lista de PKs (Mantido estrutura original)\nDECLARE @PK_Input TABLE (Nome VARCHAR(200), Valor VARCHAR(MAX))\nIF @PK1_Nome IS NOT NULL AND @PK1_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK1_Nome, @PK1_Valor)\n\n-- Constrói o XML <PrimaryKeys>\nSET @Primary_Keys = (SELECT Nome AS [@Nome], Valor AS [@Value] FROM @PK_Input FOR XML PATH('Item'), ROOT('PrimaryKeys'), TYPE)\n\n-- Converte Datas\nSET @Data_Inicio = COALESCE(TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 103), TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 120))\nIF @Usar_Hoje_Termino = 1 SET @Data_Termino = GETDATE()\nELSE SET @Data_Termino = DATEADD(SECOND, 86399, COALESCE(TRY_CONVERT(DATETIME, @Data_Termino_Texto, 103), TRY_CONVERT(DATETIME, @Data_Termino_Texto, 120)))\n\n-- ?? Filtros dinâmicos básicos\nSET @Filtro_Tabela = ''\nIF @Tabela IS NOT NULL SET @Filtro_Tabela = '[@Nome=\"'+@Tabela+'\"]'\n\n/* ?? Expressão de Id segura (numérica) */\n-- AQUI EU GARANTO QUE O ID SEJA RECUPERADO CORRETAMENTE DO XML\nSET @ExprId = 'TRY_CONVERT(INT, CASE WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value'')=1 THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'') WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue'')=1 THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'') ELSE NULL END)'\n\n-- ORDER BY: Organizado por Processo\nSET @OrderBy = 'ORDER BY Lhs.Numero_Processo ASC, Ltb.Data_Inicio ASC'\n\n-- ?? Consulta dinâmica (AGORA SIM, CORRIGIDA E COMPLETA)\nSET @SQL = '\nSELECT\n    -- Dados do Processo\n    Lhs.Numero_Processo,\n    CONVERT(VARCHAR(10), Lhs.Data_Abertura_Processo, 103) AS Data_Abertura,\n    Pes.Nome AS Cliente,\n    \n    -- Status Traduzido\n    CASE Lhs.Situacao_Agenciamento\n        WHEN 1 THEN ''Processo aberto''\n        WHEN 2 THEN ''Em andamento''\n        WHEN 3 THEN ''Liberado faturamento''\n        WHEN 4 THEN ''Faturado''\n        WHEN 5 THEN ''Finalizado''\n        WHEN 6 THEN ''Auditado''\n        WHEN 7 THEN ''Cancelado''\n        ELSE CAST(Lhs.Situacao_Agenciamento AS VARCHAR)\n    END AS Situacao,\n\n    -- Dados do Log (Recuperando Tipo do XML corretamente)\n    Usr.Nome AS Usuario,\n    CONVERT(VARCHAR(10), Ltb.Data_Inicio , 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Inicio , 108) AS Data_Hora,\n    \n    CASE Dlg.value(''@Tipo'', ''SMALLINT'')\n         WHEN 1 THEN ''INSERÇÃO''\n         WHEN 2 THEN ''EXCLUSÃO''\n         WHEN 3 THEN ''ALTERAÇÃO''\n         ELSE CAST(Dlg.value(''@Tipo'', ''SMALLINT'') AS VARCHAR(10))\n    END AS Tipo,\n    \n    -- Campos Explodidos para Planilha\n    C.value(''@Nome'', ''VARCHAR(MAX)'') AS [Campo_Alterado],\n    C.value(''@OldValue'', ''VARCHAR(MAX)'') AS [Valor_Antigo_De],\n    C.value(''@Value'', ''VARCHAR(MAX)'') AS [Valor_Novo_Para],\n\n    -- ID Técnico\n    ' + @ExprId + ' AS IdLogistica_House\n\nFROM\n    sys_Log_Tabela Ltb\n    \n-- XML: Pega o nó principal\nCROSS APPLY\n    Ltb.Dados_Log.nodes(''/Log/Tabela' + @Filtro_Tabela + ''') AS DadosLog(Dlg)\n\n-- XML: Explode os campos (ISSO GERA AS LINHAS EXTRAS PARA O EXCEL)\nCROSS APPLY\n    Dlg.nodes(''Campo'') AS T(C)\n\n-- JOINS: Traz dados do usuário e do processo\nJOIN\n    sys_Usuario Usr ON Usr.IdUsuario = Ltb.IdUsuario\nLEFT JOIN \n    mov_Logistica_House Lhs ON Lhs.IdLogistica_House = ' + @ExprId + '\nLEFT JOIN \n    cad_Pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\n\nWHERE\n    ((@IdUsuario = 0) OR (Ltb.IdUsuario = @IdUsuario))\n    AND (Ltb.Data_Inicio BETWEEN @Data_Inicio AND @Data_Termino)\n    \n    -- LISTA DE PROCESSOS NO FILTRO\n    AND Lhs.Numero_Processo IN (\n        ''AGLIA0309-25'',\n        ''AGLIA1634-25'',\n        ''AGLIA2941-25'',\n        ''AGLIA3537-25'',\n        ''AGLIA3641-25'',\n        ''AGLIA3875-25'',\n        ''AGLIA2880-25'',\n        ''AGLIA4155-25'',\n        ''AGLIA3235-25'',\n        ''AGLIA3145-24 COMPLEMENTAR'',\n        ''AGLIA3259-25'',\n        ''AGLIA3119-25'',\n        ''AGLIA3035-25''\n    )\n    \n' + @OrderBy + '\n'\n\n-- ?? Execução\nEXEC sp_executesql \n  @SQL, \n  N'@Data_Inicio DATETIME, @Data_Termino DATETIME, @IdUsuario IdCurto',\n  @Data_Inicio  = @Data_Inicio,\n  @Data_Termino = @Data_Termino,\n  @IdUsuario    = @IdUsuario"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta AGL RELATORIO OUTSTANDING DEMURRAGE & DETENTION.sql",
        "conteudo": "SELECT\n    Lhs.IdLogistica_House,\n    Lmd.Lucro_Estimado,\n    Lmd.Total_Pago - Lmd.Total_Pagamento_Local AS Diferenca_Pagamento,\n    Lmd.Total_Pago,\n    CASE \n        WHEN Txa.Total_Recebimento IS NOT NULL THEN Lmd.Total_Recebido_Local + Txa.Total_Recebimento\n        ELSE Lmd.Total_Recebido_Local\n    END AS Total_Fatura_Armador,\n    Spl.Descricao,\n    Lhs.Observacao,\n    Lhe.Numero_Processo as Processo_Origem,\n    Ven.Nome AS Vendedor,\n    Oft.Numero_Oferta,\n    Lhs.Numero_Processo,\n    Rec.Pessoa_Recebimento,\n    Rec.Moeda_Recebimento,\n    Rec.Valor_Recebimento,\n    Lmd.Total_Recebimento_Local,\n    CASE\n        WHEN Rec.Data_Vencimento IS NOT NULL THEN\n            CASE\n                WHEN DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento) < 0 \n                THEN '-' + CAST(ABS(DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento)) AS VARCHAR) \n                ELSE '+' + CAST(DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento) AS VARCHAR)\n            END\n        ELSE NULL\n    END AS Dias_Vencimento,\n    Rec.Data_Vencimento,\n    Cia.Nome AS Cia_Transporte,\n    Lhs.Conhecimentos AS BL_House,\n    Lms.Numero_Conhecimento AS BL_Master,\n    Rec.Status_Fatura,\n    Rec.Situacao_Fatura\nFROM\n    mov_Logistica_House Lhs \nLEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master \nLEFT OUTER JOIN\n    mov_Oferta_Frete Oft ON Oft.IdOferta_Frete = Lhs.IdOferta_Frete\nLEFT OUTER JOIN\n    mov_Logistica_House Lhe ON Lhe.IdLogistica_House = Lhs.IdProcesso_Origem\nLEFT OUTER JOIN\n    cad_Status_Processo_Logistico Spl on Spl.IdStatus_Processo_Logistico = Lhs.IdStatus_Processo_Logistico\nLEFT OUTER JOIN\n    cad_Pessoa Ven ON Ven.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN\n    cad_Pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN (\n    SELECT \n        ROW_NUMBER() OVER(PARTITION BY Lho.IdLogistica_House ORDER BY Lho.IdLogistica_House) AS Indice,\n        Lho.IdLogistica_House,\n        Lda.Total_Recebimento\n    FROM\n        mov_Logistica_House Lho\n    LEFT OUTER JOIN  \n        mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lho.IdLogistica_House\n    LEFT OUTER JOIN \n        mov_Logistica_Master Lmt on Lmt.IdLogistica_Master = Lho.IdLogistica_Master\n    LEFT OUTER JOIN \n        mov_Logistica_Moeda Lda on Lda.IdLogistica_House = Lho.IdLogistica_House AND Lda.IdMoeda = 110 \n    WHERE\n        Ltx.IdTaxa_Logistica_Exibicao = 168 \n    AND \n        Lmt.IdCompanhia_Transporte = Ltx.IdPessoa_Recebimento\n) Txa on Txa.IdLogistica_House = Lhs.IdLogistica_House AND Txa.Indice = 1\nLEFT OUTER JOIN\n    mov_Logistica_Moeda Lmd ON Lmd.IdLogistica_House = Lhs.IdLogistica_House AND Lmd.IdMoeda = 110 \nLEFT OUTER JOIN (\n    SELECT\n        ROW_NUMBER() OVER(PARTITION BY Lft.IdLogistica_House ORDER BY Ffn.Data_Vencimento ASC) AS Indice,\n        Lft.IdLogistica_House,\n        Ffn.Data_Vencimento,\n        Prc.Nome AS Pessoa_Recebimento,\n        SUM(Ltx.Valor_Recebimento_Total) as Valor_Recebimento,\n        Mda.Sigla AS Moeda_Recebimento,\n        CASE\n            WHEN Ffn.IdRegistro_Unificador <> 0 THEN 'Fatura Unificada'\n            WHEN Ffn.Situacao In (2, 3) THEN 'Fatura com Baixa'\n            WHEN Ffn.Conferido = 1 THEN 'Fatura Conferida'\n            WHEN Rfn.Origem_Lancamento <> 1 AND Ffn.Tipo = 2 THEN 'Título'\n            ELSE 'Fatura Finalizada'\n        END AS Status_Fatura, /*Adicionado esse CASE para buscar o status que fica no operacial na guia da fatura*/\n         CASE\n        WHEN Ffn.Situacao = 1 THEN 'Em Aberto'\n        WHEN Ffn.Situacao = 2 THEN 'Quitada'\n        WHEN Ffn.Situacao = 3 THEN 'Parcialmente quitada'\n        WHEN Ffn.Situacao = 4 THEN 'Unificada'\n        WHEN Ffn.Situacao = 5 THEN 'Em cobrança'\n        WHEN Ffn.Situacao = 6 THEN 'Cancelada'\n        WHEN Ffn.Situacao = 7 THEN 'Em cobrança judicial'\n        WHEN Ffn.Situacao = 8 THEN 'Negativado'\n        WHEN Ffn.Situacao = 9 THEN 'Protestado'\n        WHEN Ffn.Situacao = 10 THEN 'Junk'\n        END AS Situacao_Fatura /*status para buscar o tipo de fatura*/\n    FROM\n        mov_Logistica_Fatura Lft\n    LEFT OUTER JOIN\n        mov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\n    LEFT OUTER JOIN \n        mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\n    LEFT OUTER JOIN\n        mov_Logistica_Taxa Ltx ON Ltx.IdRegistro_Recebimento = Ffn.IdRegistro_Financeiro\n    LEFT OUTER JOIN\n        vis_Logistica_Fatura_Totais Lfs on Lfs.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\n    LEFT OUTER JOIN\n        cad_Pessoa Prc ON Prc.IdPessoa = Ltx.IdPessoa_Recebimento\n    LEFT OUTER JOIN\n        cad_Moeda Mda ON Mda.IdMoeda = Ltx.IdMoeda_Recebimento\n    WHERE Ffn.Natureza = 1 /*Crédito*/\n    GROUP BY\n        Lft.IdLogistica_House,\n        Ffn.Data_Vencimento,\n        Prc.Nome,\n        Mda.Sigla,\n        Ffn.IdRegistro_Unificador,\n        Ffn.Situacao,\n        Ffn.Conferido,\n        Rfn.Origem_Lancamento,\n        Ffn.Tipo\n    ) Rec on Rec.IdLogistica_House = Lhs.IdLogistica_House AND Rec.Indice = 1\nLEFT OUTER JOIN (\n    SELECT\n        ROW_NUMBER() OVER(PARTITION BY Lft.IdLogistica_House ORDER BY Ffn.Situacao DESC) AS Indice,\n        Lft.IdLogistica_House,\n        Ltx.IdPessoa_Pagamento,\n        Ffn.Situacao,\n        Ffn.Total_Pago_Corrente,\n        Ffn.Referencia_Externa\n    FROM\n        mov_Logistica_Fatura Lft\n    LEFT OUTER JOIN\n        mov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\n    LEFT OUTER JOIN\n        mov_Logistica_Taxa Ltx ON Ltx.IdRegistro_Pagamento = Ffn.IdRegistro_Financeiro\n    WHERE\n        Ffn.Natureza = 0 AND Ltx.Pagar_Para = 5 ) Pag on Pag.IdLogistica_House = Lhs.IdLogistica_House AND Pag.Indice = 1 \nWHERE\n    Lhs.Situacao_Agenciamento NOT IN (7,4,3)  /*Cancelado, Faturado, Liberado faturamento*/\nAND\n    Lhs.Demurrage_Detention = 1 \nAND\n    Lhs.Data_Abertura_Processo > '2025-01-11' /*Data escolhida para filtrar*/\nAND\n    Lms.Tipo_Operacao = 2 /*Importação*/\n\n \n    "
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta de responsaveis e troca de responsaveis SMX.sql",
        "conteudo": "SELECT /*ok*/\n    max(case when Par.IdPapel_Projeto = 3 then Pes.IdPessoa end) as Id_Comercial,\n    max(case when Par.IdPapel_Projeto = 3 then Pes.Nome end) as Comercial,\n    max(case when Par.IdPapel_Projeto = 6 then Pes.IdPessoa end) as Id_Inside_Sales,\n    max(case when Par.IdPapel_Projeto = 6 then Pes.Nome end) as Inside_Sales,\n    Lhs.Numero_Processo\nFROM\n    mov_Projeto_Atividade_Responsavel Par\nLEFT OUTER JOIN\n    cad_Pessoa Pes on Pes.IdPessoa = Par.IdResponsavel\nLEFT OUTER JOIN\n    mov_Projeto_Atividade Pja on Pja.IdProjeto_Atividade = Par.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\nwhere\n    Lhs.Situacao_Agenciamento IN (1, 2, 3, 4)\ngroup by\n    Lhs.Numero_Processo\nhaving\n    max(case when Par.IdPapel_Projeto = 3 then Par.IdResponsavel end) = 54500\n\n\n\n    UPDATE /*ok*/\n    mov_Projeto_Atividade_Responsavel\nset\n    IdResponsavel = 55939\nwhere\n    IdPapel_Projeto = 6\n    AND IdResponsavel = 54726\n    AND IdProjeto_Atividade IN (\n        SELECT\n            Pja.IdProjeto_Atividade\n        FROM\n            mov_Projeto_Atividade Pja\n        INNER JOIN\n            mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\n        INNER JOIN\n            mov_Projeto_Atividade_Responsavel Par_Comercial on Par_Comercial.IdProjeto_Atividade = Pja.IdProjeto_Atividade\n        where\n            Lhs.Situacao_Agenciamento IN (1, 2, 3, 4)\n            AND Par_Comercial.IdPapel_Projeto = 3\n            AND Par_Comercial.IdResponsavel = 54500\n    )\n\n\n\n    UPDATE /*ok*/ \n    mov_Projeto_Atividade_Responsavel\nSET\n    IdResponsavel = 55939\nwhere\n    IdPapel_Projeto = 6\n    AND IdProjeto_Atividade IN (\n        SELECT\n            Pja.IdProjeto_Atividade\n        FROM\n            mov_Projeto_Atividade Pja\n        INNER JOIN\n            mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\n        INNER JOIN\n            mov_Projeto_Atividade_Responsavel Par_Comercial on Par_Comercial.IdProjeto_Atividade = Pja.IdProjeto_Atividade\n        where\n            Lhs.Situacao_Agenciamento IN (1, 2, 3, 4)\n            AND Par_Comercial.IdPapel_Projeto = 3\n            AND Par_Comercial.IdResponsavel = 54500\n    )\n\n\n\n\n\n\n    UPDATE Par\nSET \n    Par.IdResponsavel = 55939 /*kauan*/  /*aqui é onde vai inserir o novo responsavel?*/\nFROM \n    mov_Projeto_Atividade_Responsavel Par\nINNER JOIN \n    mov_Projeto_Atividade Pja on Pja.IdProjeto_Atividade = Par.IdProjeto_Atividade\nINNER JOIN \n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\nwhere \n    Lhs.Numero_Processo = 'EM0232-25'\n    AND Par.IdResponsavel = 54500 /*victor*/ /*aqui é onde ele vai buscar se o resposavel 'analista' é o responsavel?*/\n\n\n\n\n    SELECT\n    Par.IdResponsavel,\n    Pes.Nome,\n    Par.IdPapel_Projeto,\n    Lhs.Numero_Processo\nFROM\n    mov_Projeto_Atividade_Responsavel Par\nINNER JOIN\n    cad_Pessoa Pes on Pes.IdPessoa = Par.IdResponsavel\nINNER JOIN\n    mov_Projeto_Atividade Pja on Pja.IdProjeto_Atividade = Par.IdProjeto_Atividade\nINNER JOIN\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\nwhere\n    Lhs.Numero_Processo = 'EM0232-25'\n\n\n\n    SELECT\n     max(case when Par.IdPapel_Projeto = 2 then Pes.IdPessoa end) as Id_Analista,\n     max(case when Par.IdPapel_Projeto = 2 then Pes.Nome end) as Analista,\n     max(case when Par.IdPapel_Projeto = 5 then Pes.IdPessoa end) as Id_assistente,\n     max(case when Par.IdPapel_Projeto = 5 then Pes.Nome end) as assistente,\n   Lhs.Numero_Processo\nFROM\n    mov_Projeto_Atividade_Responsavel Par\nLeft Outer Join\n    cad_Pessoa Pes on Pes.IdPessoa = Par.IdResponsavel\nLeft Outer Join\n    mov_Projeto_Atividade Pja on Pja.IdProjeto_Atividade = Par.IdProjeto_Atividade\nLeft Outer Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\nwhere\n    Lhs.Situacao_Agenciamento IN (1, 2, 3, 4)\ngroup by\n    Lhs.Numero_Processo\nhaving\n    max(case when Par.IdPapel_Projeto = 2 then Par.IdResponsavel end) = 117117\n\n\n\n\nUPDATE Par\nSET\n    Par.IdResponsavel = 118757 /*fernanda*/ /*id que vai trocar*/\nFROM\n    mov_Projeto_Atividade_Responsavel Par\nINNER JOIN\n    mov_Projeto_Atividade Pja ON Pja.IdProjeto_Atividade = Par.IdProjeto_Atividade\nINNER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Pja.IdProjeto_Atividade\nINNER JOIN\n    mov_Projeto_Atividade_Responsavel Par_Analista ON Par_Analista.IdProjeto_Atividade = Pja.IdProjeto_Atividade\nWHERE\n    Lhs.Numero_Processo = 'SMXIM044631'\n    AND Par.IdPapel_Projeto = 5\n    AND Par_Analista.IdPapel_Projeto = 2\n    AND Par_Analista.IdResponsavel = 117117 /*andressa*/ /**/\n\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta FAM.sql",
        "conteudo": "SELECT\n    Sus.Nome AS Nome_User_HC,\n    Sus.Data_Criacao,\n    Pes.Data_Alteracao,\n    (SELECT\n        CASE\n            WHEN COUNT(P2.Data_Alteracao) > 0 THEN 'Sim'\n            ELSE 'Nao'\n        END\n    FROM cad_pessoa P2\n    WHERE P2.IdPessoa = Pes.IdPessoa\n) AS Foi_Alterado,\n    CASE \n   WHEN Trn.idpessoa IS NOT NULL THEN 'Sim'\n   ELSE 'Não' \nEND AS Vinculo_Trans_Terrestre,\n    CASE\n   WHEN Cia.IdPessoa IS NOT NULL THEN 'Sim'\n   ELSE 'Não'\nEND AS Vinculo_Cia,\n    CASE\n   WHEN Cli.IdPessoa IS NOT NULL THEN 'Sim'\n   ELSE 'Não'\nEND AS Vinculo_Cliente,\n    CASE\n  WHEN Tra.IdPessoa IS NOT NULL THEN 'Sim'\n  ELSE 'Não'\nEND AS Vinculo_Transportadora,\n    CASE\n  WHEN Fun.IdPessoa IS NOT NULL THEN 'Sim'\n  ELSE 'Não'\nEND AS Vinculo_Funcionario,\n    CASE\n    WHEN Seg.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Seguradora,\n    CASE\n    WHEN Emp.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Empresa,\n    CASE\n    WHEN Ban.Idpessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Bancario,\n    CASE\n    WHEN Ama.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Agen_Maritima_Aerea,\n    CASE\n    WHEN Atc.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Agencia_Carga,\n    CASE\n    WHEN Asi.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Asso_Internacional,\n    CASE\n    WHEN Dsa.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Desp_Aduaneiro,\n    CASE\n    WHEN Fbc.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Fabricante,\n    CASE\n    WHEN Fnd.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Fornecedor,\n    CASE\n    WHEN Nvc.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_NVOCC,\n    CASE\n    WHEN Rpc.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Rep_Colaborador,\n    CASE\n    WHEN Trc.IdPessoa IS NOT NULL THEN 'Sim'\n    ELSE 'Não'\nEND AS Vinculo_Terminal_Container,\nCASE\n     WHEN Pcl.IdPessoa IS NOT NULL THEN 'Sim'\n     ELSE 'Não'\nEND AS Vinculo_Pes_Cont_Logistica,\n    CASE\n    WHEN Cli.Cliente = 1 THEN 'Sim'\n      ELSE 'Não'\n       END AS Cliente,\n    CASE\n    WHEN Cli.Importador = 1 THEN 'Sim'\n    ELSE 'Não'\n       END AS Importador,\n    CASE\n     WHEN Cli.Exportador = 1 THEN 'Sim'\n      ELSE 'Não'\n       END AS Exportador,\n    CASE Cia.Tipo_Aerea\n    WHEN 1 THEN 'Sim'\n    WHEN 0 THEN 'Não'\n    ELSE 'Não'\n    END AS Transportadora_Aerea,\n    CASE Cia.Tipo_Maritima\n     WHEN 1 THEN 'Sim'\n    WHEN 0 THEN 'Não'\n    ELSE 'Não'\n    END AS Transportadora_Maritima,\n    CASE Cia.Tipo_Terrestre \n    WHEN 1 THEN 'Sim'\n    WHEN 0 THEN 'Não'\n    ELSE 'Não'\n    END AS Transportadora_Terrestre,\n    Pes.IdPessoa,\n    Pes.Codigo,\n    Cli.Ultima_Alteracao_Vendedor,\n    Sus.Data_Ultimo_Login AS Data_Ultimo_Login_Usuario,\n    Pes.Nome AS Pessoa,\n    Pes.Nome_Fantasia,\n    Lhsp.Numero_Processo AS Cliente_Processo,\n    Lhsi.Numero_Processo AS Importador_Processo,\n    Lhse.Numero_Processo AS Exportador_Processo,\n    Lms.Data_Processo,\n    Pes.cpf_cnpj AS CPF_CNPJ,\n    Pes.Rg_Inscricao_Estadual AS RG_IE,\n    COALESCE(Psg.Nome, 'SEM GRUPO') AS Nome_Grupo,\n    COALESCE(Stt.Nome, 'SEM SETOR') AS Setor,\n    Ctf.Descricao AS Contrato_Financeiro,\n    CASE\n\tWHEN Pes.Ativo = 1 THEN 'ATIVO'\n\tELSE 'DESATIVADO'\n\tEND AS Status_Ativo,\n    CASE Cli.Tipo_Cliente\n        WHEN 1 THEN 'Prospect'\n        WHEN 2 THEN 'Cliente'\n        WHEN 3 THEN 'CONta declinada'\n        WHEN 4 THEN 'Inativo'\n        WHEN 5 THEN 'Trabalhando'\n        WHEN 6 THEN 'CONta sONho'\n        WHEN 7 THEN 'Agente no exterior'\n        WHEN 8 THEN 'Pré-vendAS'\n        WHEN 9 THEN 'Sem interesse Cliente'\n        WHEN 10 THEN 'CadAStro Incompleto'\n        WHEN 11 THEN 'Oportunidade'\n        WHEN 12 THEN 'Churn'\n    END AS Tipo_Cliente\nFROM\n    cad_pessoa Pes\n    LEFT OUTER JOIN\n    mov_logistica_house Lhs ON Lhs.IdCliente = Pes.IdPessoa\n    LEFT OUTER JOIN\n    mov_logistica_mASter Lms ON Lms.IdLogistica_MASter = Lhs.IdLogistica_MASter\n    LEFT OUTER JOIN\n    cad_cliente Cli ON Cli.IdPessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Companhia_Transporte Cia ON Cia.IdPessoa  = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Pessoa_Grupo Psg ON Psg.IdPessoa_Grupo  = Pes.IdPessoa_Grupo\n    LEFT OUTER JOIN\n    cad_Setor Stt ON Stt.IdSetor = Pes.IdSetor\n    LEFT OUTER JOIN\n    cad_CONtrato_Financeiro Ctf ON Ctf.IdCONtrato_Financeiro  = Pes.IdCONtrato_Financeiro\n    LEFT OUTER JOIN\n    cad_transportadora Tra ON Tra.IdPessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_FunciONario Fun ON Fun.IdPessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_banco_agencia Ban ON Ban.IdPessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Agencia_Maritima_Aerea Ama ON Ama.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_agente_carga Atc ON Atc.Idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_ASsociacao_InternaciONal ASi ON ASi.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Despachante_Aduaneiro Dsa ON Dsa.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_fabricante Fbc ON Fbc.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_fornecedor Fnd ON Fnd.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_nvocc Nvc ON Nvc.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Representante_Colaborador Rpc ON Rpc.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Terminal_CONtainer Trc ON Trc.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN \n    cad_Pessoa_Contrato_Logistica Pcl ON Pcl.IdPessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    (SELECT\n        Lhs.IdCliente,\n        STRING_AGG(Lhs.Numero_Processo, ' / ') AS Numero_Processo\n    FROM\n        mov_Logistica_House Lhs\n    GROUP BY\n    Lhs.IdCliente) Lhsp ON Lhsp.IdCliente = Cli.IdPessoa\n    LEFT OUTER JOIN\n    (SELECT\n        Lhs.IdImportador,\n        STRING_AGG(Lhs.Numero_Processo, ' / ') AS Numero_Processo\n    FROM\n        mov_Logistica_House Lhs\n    GROUP BY\n    Lhs.IdImportador) Lhsi ON Lhsi.IdImportador = Pes.IdPessoa\n    LEFT OUTER JOIN\n    (SELECT\n        Lhs.IdExportador,\n        STRING_AGG(Lhs.Numero_Processo, ' / ') AS Numero_Processo\n    FROM\n        mov_Logistica_House Lhs\n    GROUP BY\n    Lhs.IdExportador) Lhse ON Lhse.IdExportador = Pes.IdPessoa\n    LEFT OUTER JOIN\n    sys_usuario Sus ON Sus.Idusuario = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_transportadora Trn ON  Trn.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_fornecedor Frn ON Frn.idpessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_Seguradora Seg ON Seg.IdPessoa = Pes.IdPessoa\n    LEFT OUTER JOIN\n    cad_empresa Emp ON Emp.IdPessoa = Pes.IdPessoa\n/*WHERE*/\nORDER BY\nLms.Numero_Processo ASC"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta Geral.sql",
        "conteudo": "SELECT\nLhs.Numero_Processo,\nLhs.Data_Abertura_Processo,\nPes.Nome AS Nome_Cliente,\nVen.Nome AS Vendedor,\n\nCASE\n\tWHEN Lms.Tipo_Operacao = 1 THEN 'Exportacao'\n\tWHEN Lms.Tipo_Operacao = 2 THEN 'Importacao'\n\tWHEN Lms.Tipo_Operacao = 3 THEN 'Nacional'\n\tEND AS Tipo_Operacao,\nCASE\n\tWHEN Lms.Modalidade_Processo = 1 THEN 'Aereo'\n\tWHEN Lms.Modalidade_Processo = 2 THEN 'Maritimo'\n\tWHEN Lms.Modalidade_Processo = 3 THEN 'Terrestre'\n\tEND AS Modalidade\nFROM\nmov_logistica_house Lhs\nleft outer join\ncad_pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\nleft outer join\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\ncad_pessoa Ven ON Ven.IdPessoa = Lhs.IdVendedor\nWHERE\nLms.Tipo_Operacao = 2 /*importação*/\nAND\nLms.Modalidade_Processo = 2 /*maritima*/\n\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\CONSULTA Notas Fiscais Emitidas.txt",
        "conteudo": "SELECT \n ROW_NUMBER() OVER(ORDER BY @@ROWCOUNT) as Indice,\n Lhs.IdLogistica_House,\n Lhs.Numero_Processo,\n Resp.Nome as Emissor_Nota,\n Cli.Nome,\n Nfs.Data_Emissao,\n Nfs.NFSe_Numero_Rps,\n Nfs.Valor_Liquido,\n Nfs.Valor_Servicos,\n Nfs.Valor_ISS AS Valor_ISS,\n Nfs.Valor_IR AS Valor_IR, \n Nfs.Valor_INSS AS Valor_INSS,\n Nfs.Valor_CSLL AS Valor_CSLL,\n Nfs.Valor_PIS AS Valor_PIS,\n Nfs.Valor_Cofins AS Valor_Cofins,\n -(Nfs.Valor_ISS + Nfs.Valor_IR + Nfs.Valor_INSS + Nfs.Valor_CSLL + Nfs.Valor_PIS + Nfs.Valor_Cofins) AS Total_Impostos,\n SUM(Ltx.Valor_Recebimento_Total) AS Valor_Total,\n SUM(Nfs.Valor_Liquido) AS Total_Liquido,\n SUM(Nfs.Valor_Servicos) AS Total_Servicos,\n SUM(Nfs.Valor_ISS) AS Total_ISS,\n SUM(Nfs.Valor_IR) AS Total_IR,\n SUM(Nfs.Valor_PIS) AS Total_PIS,\n SUM(Nfs.Valor_Cofins) AS Total_Cofins,\n ((Nfs.Valor_ISS + Nfs.Valor_IR + Nfs.Valor_INSS + Nfs.Valor_CSLL + Nfs.Valor_PIS + Nfs.Valor_Cofins) - SUM(Ltx.Valor_Recebimento_Total)) as Total_Geral,\n (Lgm.Total_Recebido - Lgm.Total_Pago) AS Adiantamento,\n Nfs.Situacao\nFROM \n  mov_Nota_Fiscal_Servico Nfs\nleft outer join \n  aux_Nota_Fiscal_Servico_Fatura Nfa on Nfa.IdNota_Fiscal_Servico = Nfs.IdNota_Fiscal_Servico\nleft outer join \n  vis_Logistica_Fatura Lft on Lft.IdRegistro_Financeiro = Nfa.IdRegistro_Financeiro\nleft outer join \n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Lft.IdLogistica_House\nleft outer join \n  cad_Pessoa Cli on Cli.IdPessoa = Lhs.IdCliente\nleft outer join \n  mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join \n  mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Ltx.IdLogistica_House and Lgm.IdMoeda = 110\nLeft Outer Join\n  mov_Log_Nota_Fiscal_Servico Nfl on Nfl.Referencia = Nfs.IdLote_Nota_Fiscal_Servico and Nfl.Tipo = 1\nLeft Outer Join\n  vis_Funcionario Fcn on Fcn.IdUsuario_Correspondente = Nfl.IdUsuario\nLeft Outer Join\n  cad_Pessoa Resp on Resp.IdPessoa = Fcn.IdPessoa\n/*WHERE*/ \n\nGROUP BY \n\tLhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n\tCli.Nome,\n\tCli.Cpf_Cnpj,\n\tResp.Nome,\n\tNfs.Data_Emissao,\n\tNfs.NFSe_Numero_Rps,\n\tNfs.Valor_Liquido,\n\tNfs.Valor_Servicos,\n\t(Nfs.Valor_ISS + Nfs.Valor_IR + Nfs.Valor_INSS + Nfs.Valor_CSLL + Nfs.Valor_PIS + Nfs.Valor_Cofins),\n\tNfs.Valor_ISS,\n\tNfs.Valor_IR, \n\tNfs.Valor_INSS,\n\tNfs.Valor_CSLL,\n\tNfs.Valor_PIS ,\n\tNfs.Valor_Cofins,\n\tNfs.Situacao,\n\t(Lgm.Total_Recebido - Lgm.Total_Pago)\nOrder by\n  Nfs.Data_Emissao\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta proposta de clientes.sql",
        "conteudo": "SELECT\nPes.Cpf_Cnpj as CNPJ,\nPes.Nome as Cliente,\nPpf.Data_Proposta, \nPpf.Data_Aprovacao,\nOft.Numero_Oferta,\ncase Ppf.Situacao when 1 then 'Aguardando Aprovação' when 2 then 'Aprovada' when 3 then 'Não Aprovada' when 4 then 'Não Enviada' when 5 then 'Pré-Proposta' when 6 then 'Enviada'else 'erro 711' end as Situacao,\ncase Oft.Tipo_Operacao when 1 then 'Exportação'  when 2 then 'Importação' when 3 then 'Nacional' end as Tipo_Operacao,\ncase Oft.Modalidade_Processo when 1 then 'Aéreo' when 2 then 'Marítimo' when 3 then 'Terrestre' when 4 then 'Air-Air' when 5 then 'Sea-Air' end as Modalidade_Processo\nFROM\nmov_Proposta_Frete Ppf\nLeft Outer Join\ncad_Pessoa Pes on Pes.IdPessoa = Ppf.IdCliente\nLeft Outer Join\ncad_Pessoa Ven on Ven.IdPessoa = Ppf.IdVendedor\nLeft Outer Join\nmov_Oferta_Frete Oft on Oft.IdProposta_Frete  = Ppf.IdProposta_Frete\n/*where*/\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta Tarifário Marítimo.sql",
        "conteudo": "SELECT\n\tROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\n\tIdTarifario_Maritimo,\n\tIdTarifario_Maritimo_Rota,\n\tIdTarifario_Maritimo_Agrupament,\n\tTipo_Operacao,\n\tTipo_Carga,\n\tNumero_Tarifario,\n\tTipo_Frete,\n\tArmador,\n\tPOL,\n\tPOD,\n\tMercadoria,\n\tTipo_Equipamento,\n\tAll_in,\n\tMoeda_Pagamento,\n\tContrato,\n\tData_Inicio_Vigencia,\n\tData_Validade,\n\tTransit_Time_Maximo,\n\tFree_Time_Master,\n\tFree_Time_Master_Exterior,\n\tObservacao\nFROM\n\t(\n\t/* TARIFÁRIOS DE ROTA */\nSELECT\n\tTmo.IdTarifario_Maritimo,\n\tTmr.IdTarifario_Maritimo_Rota,\n\tIdTarifario_Maritimo_Agrupament = NULL,\n\tCASE Tmo.Tipo_Operacao\n\t\tWHEN 1 THEN 'EXPORTAÇÃO'\n\t\tWHEN 2 THEN 'IMPORTAÇÃO'\n\t\tWHEN 3 THEN 'NACIONAL'\n\t\tELSE ''\n\tEND AS Tipo_Operacao,\n\tTmt.Tipo_Carga,\n\tTmo.Numero as Numero_Tarifario,\n\tCASE Tmo.Tipo_Frete\n\t\tWHEN 1 THEN 'FAK'\n\t\tWHEN 2 THEN 'NAC'\n\t\tWHEN 3 THEN 'BID'\n\t\tWHEN 4 THEN 'LONG TERM'\n\t\tWHEN 5 THEN 'SPOT'\n\t\tELSE ''\n\tEND AS Tipo_Frete,\n\tCia.Nome as Armador,\n\tPol.Nome as POL,\n\tPod.Nome as POD,\n\tMer.Nome AS Mercadoria,\n\tEmo.Descricao as Tipo_Equipamento,\n\tSUM(COALESCE(Tmt.All_In,0)) as All_In,\n\tMpg.Sigla as Moeda_Pagamento,\n\tCft.Numero_Contrato as Contrato,\n\tCOALESCE(Tmr.Data_Inicio_Vigencia, Tmo.Data_Inicio_Vigencia) AS Data_Inicio_Vigencia,\n\tCOALESCE(Tmr.Data_Validade, Tmo.Data_Validade) AS Data_Validade,\n\tTmr.Transit_Time_Maximo,\n\tTme.Free_Time_Master,\n\tTme.Free_Time_Master_Exterior,\n\tCAST(Tmo.Observacao AS VARCHAR(MAX)) AS Observacao\nFROM\n\tmov_Tarifario_Maritimo Tmo\nLEFT OUTER JOIN\n\tcad_Pessoa Cia on Cia.IdPessoa = Tmo.IdArmador\nLEFT OUTER JOIN\n\tmov_Tarifario_Maritimo_Rota Tmr on Tmr.IdTarifario_Maritimo = Tmo.IdTarifario_Maritimo And COALESCE(Tmr.Data_Validade, Tmo.Data_Validade) >= GETDATE() /*Rotas dentro da Validade*/\nLEFT OUTER JOIN\n\tcad_Origem_Destino Pol on Pol.IdOrigem_Destino = Tmr.IdPorto_Origem\nLEFT OUTER JOIN\n\tcad_Origem_Destino Pod on Pod.IdOrigem_Destino = Tmr.IdPorto_Destino\nLEFT OUTER JOIN(\nSELECT\nTod.IdTarifario_Origem_Destino,\nTrx.IdTarifario_Taxa,\nTrx.Valor_Pagamento_Unitario,\nTod.IdOrigem_Destino\nFROM\nmov_Tarifario_Origem_Destino Tod\nLEFT OUTER JOIN\nmov_Tarifario_Taxa Trx on Trx.IdTarifario_Origem_Destino = Tod.IdTarifario_Origem_Destino) toddynho on toddynho.IdOrigem_Destino = Pod.IdOrigem_Destino\n\nLEFT OUTER JOIN\n\tmov_Tarifario_Maritimo_Equipamento Tme on Tme.IdTarifario_Maritimo = Tmo.IdTarifario_Maritimo\nLEFT OUTER JOIN\n\tcad_Equipamento_Maritimo Emo on Emo.IdEquipamento_Maritimo = Tme.IdEquipamento_Maritimo\nLEFT OUTER JOIN\n\tmov_Tarifario_Maritimo_Mercadoria Tmm On Tmm.IdTarifario_Maritimo = Tmo.IdTarifario_Maritimo\nLEFT OUTER JOIN\n\tcad_Mercadoria Mer On Mer.IdMercadoria = Tmm.IdMercadoria\n\t/* TAXAS DO TARIFÁRIO */\nLEFT OUTER JOIN\n\t(SELECT\n\t\tTmr.IdTarifario_Maritimo_Rota,\n\t\tCOALESCE(Tte.Total_Pgto_Outros, 0) + COALESCE(Ttd.Total_Pgto_TEU, 0) AS All_in,\n\t\tCASE Tte.Tipo_Carga\n\t\t\tWHEN 2 THEN 'Break-Bulk'\n\t\t\tWHEN 3 THEN 'FCL'\n\t\t\tWHEN 4 THEN 'LCL'\n\t\t\tWHEN 5 THEN 'RO-RO'\n\t\t\tELSE '(Não especificado)'\n\t\tEND AS Tipo_Carga,\n\t\tTte.IdEquipamento_Maritimo,\n\t\tTte.IdMoeda_Pagamento\n\tFROM\n\t\tmov_Tarifario_Maritimo_Rota Tmr\n\tLEFT OUTER JOIN\n\t\t(SELECT\n\t\t\tTmt.IdTarifario_Maritimo_Rota,\n\t\t\tTmt.IdMoeda_Pagamento,\n\t\t\tTmt.Tipo_Carga,\n\t\t\tSUM(Tmt.Valor_Pagamento_Unitario) as Total_Pgto_Outros,\n\t\t\tCASE \n\t\t\t\tWHEN Tmt.IdEquipamento_Maritimo IS NOT NULL THEN Tmt.IdEquipamento_Maritimo\n\t\t\t\tWHEN Aem.IdEquipamento_Maritimo IS NOT NULL THEN  Aem.IdEquipamento_Maritimo\n\t\t\tEND AS IdEquipamento_Maritimo\n\t\tFROM\n\t\t\tmov_Tarifario_Maritimo_Taxa Tmt\n\t\tLEFT OUTER JOIN\n\t\t\tcad_Agrupamento_Equipamento_Maritimo_Item Aem On Aem.IdAgrup_Equipamento_Maritimo = Tmt.IdAgrup_Equipamento_Maritimo\n\t\tWHERE\n\t\t\tTmt.Tipo_Pagamento NOT IN (7, 12)\n\t\tGROUP BY\n\t\t\tTmt.IdTarifario_Maritimo_Rota, \n\t\t\tTmt.Tipo_Carga, \n\t\t\tCASE \n\t\t\t\tWHEN Tmt.IdEquipamento_Maritimo IS NOT NULL THEN Tmt.IdEquipamento_Maritimo\n\t\t\t\tWHEN Aem.IdEquipamento_Maritimo IS NOT NULL THEN  Aem.IdEquipamento_Maritimo\n\t\t\tEND, \n\t\t\tTmt.IdMoeda_Pagamento) Tte ON Tte.IdTarifario_Maritimo_Rota = Tmr.IdTarifario_Maritimo_Rota\n\tLEFT OUTER JOIN\n\t\t(SELECT\n\t\t\tTmt.IdTarifario_Maritimo_Rota,\n\t\t\tTmt.IdMoeda_Pagamento,\n\t\t\tTmt.Tipo_Carga,\n\t\t\tSUM(Tmt.Valor_Pagamento_Unitario * 2) as Total_Pgto_TEU\n\t\tFROM\n\t\t\tmov_Tarifario_Maritimo_Taxa Tmt\n\t\tWHERE\n\t\t\tTmt.Tipo_Pagamento = 12\n\t\tGROUP BY\n\t\t\tTmt.IdTarifario_Maritimo_Rota, Tmt.Tipo_Carga, Tmt.IdMoeda_Pagamento) Ttd ON Ttd.IdTarifario_Maritimo_Rota = Tmr.IdTarifario_Maritimo_Rota AND (Ttd.Tipo_Carga = Tte.Tipo_Carga AND Ttd.IdMoeda_Pagamento = Tte.IdMoeda_Pagamento)\n\t\t) Tmt on Tmt.IdTarifario_Maritimo_Rota = Tmr.IdTarifario_Maritimo_Rota AND (Tmt.IdEquipamento_Maritimo = Tme.IdEquipamento_Maritimo)\n\nLEFT OUTER JOIN\n\tmov_Contrato_Frete Cft on Cft.IdContrato_Frete = Tmo.IdContrato_Frete\nLEFT OUTER JOIN\n\tcad_Moeda Mpg on Mpg.IdMoeda = Tmt.IdMoeda_Pagamento\nWHERE\n\tTmo.Ativo = 1\nAND\n\tTmo.Data_Validade >= GETDATE() /*Tarifários dentro da Validade*/\nAND \n\tTmr.IdTarifario_Maritimo_Rota IS NOT NULL\nGROUP BY\n\tTmo.IdTarifario_Maritimo,\n\tTmr.IdTarifario_Maritimo_Rota,\n\tTmo.Tipo_Operacao,\n\tTmt.Tipo_Carga,\n\tTmo.Numero,\n\tTmo.Tipo_Frete,\n\tCia.Nome,\n\tPol.Nome,\n\tPod.Nome,\n\tEmo.Descricao,\n\tMpg.Sigla,\n\tCft.Numero_Contrato,\n\tCOALESCE(Tmr.Data_Inicio_Vigencia, Tmo.Data_Inicio_Vigencia),\n\tCOALESCE(Tmr.Data_Validade, Tmo.Data_Validade),\n\tTmr.Transit_Time_Maximo,\n\tTme.Free_Time_Master,\n\tTme.Free_Time_Master_Exterior,\n\tMer.Nome,\n\tCAST(Tmo.Observacao AS VARCHAR(MAX))\nUNION ALL\n\t/* TARIFÁRIOS DE AGRUPAMENTO */\n\tSELECT\n\tTmo.IdTarifario_Maritimo,\n\tIdTarifario_Maritimo_Rota = NULL,\n\tTma.IdTarifario_Maritimo_Agrupament,\n\tCASE Tmo.Tipo_Operacao\n\t\tWHEN 1 THEN 'EXPORTAÇÃO'\n\t\tWHEN 2 THEN 'IMPORTAÇÃO'\n\t\tWHEN 3 THEN 'NACIONAL'\n\t\tELSE ''\n\tEND AS Tipo_Operacao,\n\tTmt.Tipo_Carga,\n\tTmo.Numero as Numero_Tarifario,\n\tCASE Tmo.Tipo_Frete\n\t\tWHEN 1 THEN 'FAK'\n\t\tWHEN 2 THEN 'NAC'\n\t\tWHEN 3 THEN 'BID'\n\t\tWHEN 4 THEN 'LONG TERM'\n\t\tWHEN 5 THEN 'SPOT'\n\t\tELSE ''\n\tEND AS Tipo_Frete,\n\tCia.Nome as Armador,\n\tPol.Nome as Origem,\n\tPod.Nome as Destino,\n\tMer.Nome AS Mercadoria,\n\tEmo.Descricao as Tipo_Equipamento,\n\tSUM(COALESCE(Tmt.All_In,0)) as All_In,\n\tMpg.Sigla as Moeda_Pagamento,\n\tCft.Numero_Contrato as Contrato,\n\tTmo.Data_Inicio_Vigencia,\n\tTmo.Data_Validade,\n\tTransit_Time_Maximo = NULL,\n\tTme.Free_Time_Master,\n\tTme.Free_Time_Master_Exterior,\n\tCAST(Tmo.Observacao AS VARCHAR(MAX)) AS Observacao\nFrom\n\tmov_Tarifario_Maritimo Tmo\nLEFT OUTER JOIN\n\tcad_Pessoa Cia on Cia.IdPessoa = Tmo.IdArmador\nLEFT OUTER JOIN\n\tmov_Tarifario_Maritimo_Agrupamento Tma on Tma.IdTarifario_Maritimo = Tmo.IdTarifario_Maritimo\nLEFT OUTER JOIN\n\tmov_Tarifario_Agrupamento_Porto Apt on Apt.IdTarifario_Agrupamento_Porto = Tma.IdAgrupamento_Origem\nLEFT OUTER JOIN\n\tmov_Tarifario_Agrupamento_Porto Agp on Agp.IdTarifario_Agrupamento_Porto = Tma.IdAgrupamento_Destino\nLEFT OUTER JOIN\n\tmov_Tarifario_Maritimo_Equipamento Tme on Tme.IdTarifario_Maritimo = Tmo.IdTarifario_Maritimo\nLEFT OUTER JOIN\n\tcad_Equipamento_Maritimo Emo on Emo.IdEquipamento_Maritimo = Tme.IdEquipamento_Maritimo\nLEFT OUTER JOIN\n\tmov_Tarifario_Maritimo_Mercadoria Tmm On Tmm.IdTarifario_Maritimo = Tmo.IdTarifario_Maritimo\nLEFT OUTER JOIN\n\tcad_Mercadoria Mer On Mer.IdMercadoria = Tmm.IdMercadoria\nLEFT OUTER JOIN\n\tmov_Tarifario_Agrupamento_Item Org ON Org.IdTarifario_Agrupamento_Porto = Apt.IdTarifario_Agrupamento_Porto\nLEFT OUTER JOIN\n\tmov_Tarifario_Agrupamento_Item Dst ON Dst.IdTarifario_Agrupamento_Porto = Agp.IdTarifario_Agrupamento_Porto\nLEFT OUTER JOIN\n\tcad_Origem_Destino Pol ON Pol.IdOrigem_Destino = Org.IdOrigem_Destino\nLEFT OUTER JOIN\n\tcad_Origem_Destino Pod ON Pod.IdOrigem_Destino = Dst.IdOrigem_Destino\n\n\t/* TAXAS DO TARIFÁRIO */\nLEFT OUTER JOIN\n\t(SELECT\n\t\tTma.IdTarifario_Maritimo_Agrupament,\n\t\tSUM(COALESCE(Tte.Total_Pgto_Outros,0) + COALESCE(Ttd.Total_Pgto_TEU,0)) as All_In,\n\t\tCASE Tte.Tipo_Carga\n\t\t\tWHEN 2 THEN 'Break-Bulk'\n\t\t\tWHEN 3 THEN 'FCL'\n\t\t\tWHEN 4 THEN 'LCL'\n\t\t\tWHEN 5 THEN 'RO-RO'\n\t\t\tELSE '(Não especificado)'\n\t\tEND AS Tipo_Carga,\n\t\tTte.IdEquipamento_Maritimo,\n\t\tTte.IdMoeda_Pagamento\n\tFROM\n\t\tmov_Tarifario_Maritimo_Agrupamento Tma\n\tLEFT OUTER JOIN\n\t\t(SELECT\n\t\t\tTmt.IdTarifario_Maritimo_Agrupament,\n\t\t\tTmt.IdMoeda_Pagamento,\n\t\t\tTmt.Tipo_Carga,\n\t\t\tSUM(Tmt.Valor_Pagamento_Unitario) as Total_Pgto_Outros,\n\t\t\tCASE \n\t\t\t\tWHEN Tmt.IdEquipamento_Maritimo IS NOT NULL THEN Tmt.IdEquipamento_Maritimo\n\t\t\t\tWHEN Aem.IdEquipamento_Maritimo IS NOT NULL THEN  Aem.IdEquipamento_Maritimo\n\t\t\tEND AS IdEquipamento_Maritimo\n\t\tFROM\n\t\t\tmov_Tarifario_Maritimo_Taxa Tmt\n\t\tLEFT OUTER JOIN\n\t\t\tcad_Agrupamento_Equipamento_Maritimo_Item Aem On Aem.IdAgrup_Equipamento_Maritimo = Tmt.IdAgrup_Equipamento_Maritimo\n\t\tWHERE\n\t\t\tTmt.Tipo_Pagamento NOT IN (7, 12)\n\t\tGROUP BY\n\t\t\tTmt.IdTarifario_Maritimo_Agrupament, \n\t\t\tTmt.Tipo_Carga, \n\t\t\tCASE \n\t\t\t\tWHEN Tmt.IdEquipamento_Maritimo IS NOT NULL THEN Tmt.IdEquipamento_Maritimo\n\t\t\t\tWHEN Aem.IdEquipamento_Maritimo IS NOT NULL THEN  Aem.IdEquipamento_Maritimo\n\t\t\tEND, \n\t\t\tTmt.IdMoeda_Pagamento) Tte ON Tte.IdTarifario_Maritimo_Agrupament = Tma.IdTarifario_Maritimo_Agrupament\n\tLEFT OUTER JOIN\n\t\t(SELECT\n\t\t\tTmt.IdTarifario_Maritimo_Agrupament,\n\t\t\tTmt.IdMoeda_Pagamento,\n\t\t\tTmt.Tipo_Carga,\n\t\t\tSUM(Tmt.Valor_Pagamento_Unitario * 2) as Total_Pgto_TEU\n\t\tFROM\n\t\t\tmov_Tarifario_Maritimo_Taxa Tmt\n\t\tWHERE\n\t\t\tTmt.Tipo_Pagamento = 12\n\t\tGROUP BY\n\t\t\tTmt.IdTarifario_Maritimo_Agrupament, Tmt.Tipo_Carga, Tmt.IdMoeda_Pagamento) Ttd ON Ttd.IdTarifario_Maritimo_Agrupament = Tma.IdTarifario_Maritimo_Agrupament AND (Ttd.Tipo_Carga = CASE WHEN Ttd.Tipo_Carga IS NULL THEN NULL WHEN Ttd.Tipo_Carga IS NOT NULL THEN Tte.Tipo_Carga END AND Ttd.IdMoeda_Pagamento = CASE WHEN Ttd.IdMoeda_Pagamento IS NULL THEN NULL WHEN Ttd.IdMoeda_Pagamento IS NOT NULL THEN Tte.IdMoeda_Pagamento END)\n\tGROUP BY\n\t\tTma.IdTarifario_Maritimo_Agrupament,\n\t\tCASE Tte.Tipo_Carga\n\t\t\tWHEN 2 THEN 'Break-Bulk'\n\t\t\tWHEN 3 THEN 'FCL'\n\t\t\tWHEN 4 THEN 'LCL'\n\t\t\tWHEN 5 THEN 'RO-RO'\n\t\t\tELSE '(Não especificado)'\n\t\tEND,\n\t\tTte.IdEquipamento_Maritimo,\n\t\tTte.IdMoeda_Pagamento\n\t) Tmt ON Tmt.IdTarifario_Maritimo_Agrupament = Tma.IdTarifario_Maritimo_Agrupament AND (Tmt.IdEquipamento_Maritimo = Tme.IdEquipamento_Maritimo)\nLEFT OUTER JOIN\n\tmov_Contrato_Frete Cft on Cft.IdContrato_Frete = Tmo.IdContrato_Frete \nLEFT OUTER JOIN\n\tcad_Moeda Mpg on Mpg.IdMoeda = Tmt.IdMoeda_Pagamento\nWHERE\n\tTmo.Ativo = 1\nAND\n\tTmo.Data_Validade >= GETDATE() /*Tarifários dentro da Validade*/\nAND \n\tTma.IdTarifario_Maritimo_Agrupament IS NOT NULL\nGROUP BY\n\tTmo.IdTarifario_Maritimo,\n\tTma.IdTarifario_Maritimo_Agrupament,\n\tTmo.Tipo_Operacao,\n\tTmt.Tipo_Carga,\n\tTmo.Numero,\n\tTmo.Tipo_Frete,\n\tCia.Nome,\n\tPol.Nome,\n\tPod.Nome,\n\tEmo.Descricao,\n\tEmo.IdEquipamento_Maritimo,\n\tMpg.Sigla,\n\tCft.Numero_Contrato,\n\tTmo.Data_Inicio_Vigencia,\n\tTmo.Data_Validade,\n\tTme.Free_Time_Master,\n\tTme.Free_Time_Master_Exterior,\n\tMer.Nome,\n\tCAST(Tmo.Observacao AS VARCHAR(MAX))) Trf\n/*WHERE*/\nWHERE Contrato not like '%rox%' /*REQ #41406-->*/ and Tipo_Carga is not null\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta Tex ABW BKP.sql",
        "conteudo": "SELECT\nLhs.Referencia_Cliente as Referencia_Cliente,\nLhs.Numero_Processo as Referencia_Tex,\nCne.Numero as Numero_BL_House,\nLms.Numero_Conhecimento as Numero_BL_Master,\nOrm.Nome as Origem,\nDst.Nome as Destino,\nPes.Nome as Nome_Cliente,\nCia.nome as Armador,\nNvi.Nome as Navio,\nLms.Data_Previsao_Embarque as ETD,\nLms.Data_Previsao_Desembarque as ETA,\nSUM(Lme.Quantidade) AS Quantidade_Ctnr,\nCAST(Lgt.Navio AS VARCHAR(MAX)) AS Navio_Transbordo,\nLmc.Free_Time_House as Free_Time_House,\nLmc.Number as Container,\nTf1.Descricao,\nCASE\nWHEN At1.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_Draft,\nTf2.Descricao,\nCASE\nWHEN At2.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_HBL,\nTf3.Descricao,\nCASE\nWHEN At3.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_OMBL,\nTf4.Descricao,\nCASE\nWHEN At4.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_Manifesto,\nCASE\nWHEN Lgp.Valor_Boleano IS NULL THEN 'Não' /*Não marcado*/\nWHEN Lgp.Valor_Boleano = 0 THEN 'Não' /*Não marcado*/\nELSE 'Sim'\nEND AS Ajuste_NCM,\nLgp2.Valor_Data AS Retificação_CE,\nLgp3.Valor_Data AS Conclusão_Retificacao\nFROM\nmov_logistica_house as Lhs\nleft outer join\ncad_Pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\nmov_Conhecimento_Embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Origem_Destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\t\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House \nleft outer join\ncad_Navio Nav ON Nav.IdNavio = Lms.IdCompanhia_Transporte\nLeft Outer Join\t(\nSELECT\nLmc.IdLogistica_House,\nSTRING_AGG(Lmc.Number, ' / ') as Number,\nLmc.Free_Time_House\nFROM\nmov_Logistica_Maritima_Container Lmc\nGROUP BY\nLmc.IdLogistica_House,\nLmc.Free_Time_House\n) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join(\nSELECT\t\nLgv.IdLogistica_House,\nSTRING_AGG(Nat.Nome, ' / ') as Navio\nFROM\nmov_Logistica_viagem Lgv\nleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgv.IdNavio\nWHERE\nLgv.Tipo_Viagem = 5\nGROUP BY\nLgv.IdLogistica_House\n)Lgt on Lgt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\nmov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\ncad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\nmov_Atividade At1 on At1.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At1.IdTarefa = 839 /*Envio do Draft ao cliente para aprovação*/\nLeft Outer Join\ncad_Tarefa Tf1 on Tf1.IdTarefa = At1.IdTarefa\nLeft Outer Join\nmov_Atividade At2 on At2.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At2.IdTarefa = 844 /*Enviar HBL original ao cliente*/\nLeft Outer Join\ncad_Tarefa Tf2 on Tf2.IdTarefa = At2.IdTarefa\nLeft Outer Join\nmov_Atividade At3 on At3.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At3.IdTarefa = 1266 /*Envio OMBL editado ao cliente (MAO)*/\nLeft Outer Join\ncad_Tarefa Tf3 on Tf3.IdTarefa = At3.IdTarefa\nLeft Outer Join\nmov_Atividade At4 on At4.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At4.IdTarefa = 1335 /*Envio do Manifesto de baldeação*/\nLeft Outer Join\ncad_Tarefa Tf4 on Tf4.IdTarefa = At4.IdTarefa\nleft outer join\nvis_logistica_prazo Lgp ON Lgp.IdLogistica_House = Lhs.IdLogistica_House and Lgp.IdConfiguracao_Campo_Livre = 216 /*Ajuste NCM*/\nleft outer join\nvis_logistica_prazo Lgp2 ON Lgp2.IdLogistica_House = Lhs.IdLogistica_House and Lgp2.IdConfiguracao_Campo_Livre = 215 /*Retificação de CE*/\nleft outer join\nvis_logistica_prazo Lgp3 ON Lgp3.IdLogistica_House = Lhs.IdLogistica_House and Lgp3.IdConfiguracao_Campo_Livre = 217 /*Conclusão retificação*/\n/*WHERE*/\nWHERE\nPes.IdPessoa = 49971 /*ABW*/\nAND\nLms.Modalidade_Processo = 2 /*Maritimo*/\nAND\nLms.Tipo_Operacao= 2 /*importacao*/\nGROUP BY\nLhs.Referencia_Cliente,\nLhs.Numero_Processo,\nCne.Numero,\nLms.Numero_Conhecimento,\nOrm.Nome,\nDst.Nome,\nPes.Nome,\nCia.nome,\nLms.Data_Previsao_Embarque,\nLms.Data_Previsao_Desembarque,\nLmc.Free_Time_House,\nTf1.Descricao,\nAt1.Situacao,\nTf2.Descricao,\nAt2.Situacao,\nTf3.Descricao,\nAt3.Situacao,\nTf4.Descricao,\nAt4.Situacao,\nLgp.Valor_Boleano,\nLgp2.Valor_Data,\nLgp3.Valor_Data,\nLgt.Navio,\nLmc.Number,\nNvi.Nome\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta Tex ABW New.sql",
        "conteudo": "﻿SELECT\nLhs.Referencia_Cliente AS Referencia_Cliente,\nMAX(Tst.Sigla) as Sigla,\nMAX(Tst.Valor_Recebimento_Total) as Valor_Frete_Fcl,\nLhs.Numero_Processo AS Referencia_Tex,\nCne.Numero AS Numero_BL_House,\nLms.Numero_Conhecimento AS Numero_BL_Master,\nOrm.Nome AS Origem,\nDst.Nome AS Destino,\nPes.Nome AS Nome_Cliente,\nPsaAgencia.Nome AS Armador,\nNvi.Nome AS Navio,\nLms.Data_Previsao_Embarque AS ETD,\nLms.Data_Previsao_Desembarque AS ETA,\nSUM(Lme.Quantidade) AS Quantidade_Ctnr,\nCAST(Lgt.Navio AS VARCHAR(MAX)) AS Navio_Transbordo,\nCOALESCE(Fme.Free_Time_House_Destino, '0') AS Free_Time_House_Destino,\nLmc.Number AS Container,\nTf1.Descricao,\nCASE\nWHEN At1.Situacao = 1 THEN 'Não iniciada' \nWHEN At1.Situacao = 2 THEN 'Em andamento'\nWHEN At1.Situacao = 3 THEN 'Paralisada'\nWHEN At1.Situacao = 4 THEN 'Concluida'\nWHEN At1.Situacao = 5 THEN 'Não realizada'\nWHEN At1.Situacao = 6 THEN 'Cancelada'\nEND AS Concluida_Draft, /*Draft enviado?*/\nTf2.Descricao,\nCASE\nWHEN At2.Situacao = 1 THEN 'Não iniciada' \nWHEN At2.Situacao = 2 THEN 'Em andamento'\nWHEN At2.Situacao = 3 THEN 'Paralisada'\nWHEN At2.Situacao = 4 THEN 'Concluida'\nWHEN At2.Situacao = 5 THEN 'Não realizada'\nWHEN At2.Situacao = 6 THEN 'Cancelada'\nEND AS Concluida_HBL, /*OHBL enviado?*/\nTf3.Descricao,\nCASE\nWHEN At3.Situacao = 1 THEN 'Não iniciada' \nWHEN At3.Situacao = 2 THEN 'Em andamento'\nWHEN At3.Situacao = 3 THEN 'Paralisada'\nWHEN At3.Situacao = 4 THEN 'Concluida'\nWHEN At3.Situacao = 5 THEN 'Não realizada'\nWHEN At3.Situacao = 6 THEN 'Cancelada'\nEND AS Concluida_OMBL,/*MBL (MAO) enviado?*/\nTf4.Descricao,\nCASE\nWHEN At4.Situacao = 1 THEN 'Não iniciada' \nWHEN At4.Situacao = 2 THEN 'Em andamento'\nWHEN At4.Situacao = 3 THEN 'Paralisada'\nWHEN At4.Situacao = 4 THEN 'Concluida'\nWHEN At4.Situacao = 5 THEN 'Não realizada'\nWHEN At4.Situacao = 6 THEN 'Cancelada'\nEND AS Concluida_Manifesto,\nCASE\nWHEN At5.Situacao = 1 THEN 'Não iniciada' \nWHEN At5.Situacao = 2 THEN 'Em andamento'\nWHEN At5.Situacao = 3 THEN 'Paralisada'\nWHEN At5.Situacao = 4 THEN 'Concluida'\nWHEN At5.Situacao = 5 THEN 'Não realizada'\nWHEN At5.Situacao = 6 THEN 'Cancelada'\nEND AS Originais_Recebidos, /*Originais recebidos?*/\nCASE\nWHEN Lgp.Valor_Boleano IS NULL THEN 'Não' /*Não marcado*/\nWHEN Lgp.Valor_Boleano = 0 THEN 'Não' /*Não marcado*/\nELSE 'Sim'\nEND AS Ajuste_NCM,\nCONVERT(VARCHAR(10), Lgp2.Valor_Data, 103) AS Retificao_CE, /*Retificão CE*/\nCONVERT(VARCHAR(10), Lgp3.Valor_Data, 103) AS Conclusao_Retificacao, /*Alteração CE concluida*/\nCASE\n    WHEN Lhs.Situacao_Agenciamento = 1 THEN 'Processo aberto'\n    WHEN Lhs.Situacao_Agenciamento = 2 THEN 'Em andamento'\n    WHEN Lhs.Situacao_Agenciamento = 3 THEN 'Liberado faturamento'\n    WHEN Lhs.Situacao_Agenciamento = 4 THEN 'Faturado'\n    WHEN Lhs.Situacao_Agenciamento = 5 THEN 'Finalizado'\n    WHEN Lhs.Situacao_Agenciamento = 6 THEN 'Auditado'\n    WHEN Lhs.Situacao_Agenciamento = 7 THEN 'Cancelado'\n     END AS Situacao_Agenciamento\nFROM\nmov_logistica_house AS Lhs\nleft outer join\ncad_Pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\nmov_Conhecimento_Embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Origem_Destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\ncad_Agencia_Maritima_Aerea Ama ON Ama.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join \ncad_Pessoa PsaAgencia ON PsaAgencia.IdPessoa = Ama.IdPessoa\nLeft Outer Join\t\nmov_Logistica_Maritima_Equipamento Lme ON Lme.IdLogistica_House = Lhs.IdLogistica_House \nleft outer join\ncad_Navio Nav ON Nav.IdNavio = Lms.IdCompanhia_Transporte\nLeft Outer Join\t(\nSELECT\nLmc.IdLogistica_House,\nSTRING_AGG(Lmc.Number, ' / ') AS Number,\nLmc.Free_Time_House\nFROM\nmov_Logistica_Maritima_Container Lmc\nGROUP BY\nLmc.IdLogistica_House,\nLmc.Free_Time_House\n) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \n(SELECT\n    Lme.IdLogistica_House,\n    STRING_AGG(Lme.Free_Time_House_Destino, ' / ') AS Free_Time_House_Destino\nFROM\n    mov_Logistica_Maritima_Equipamento Lme\nGROUP BY\n    Lme.IdLogistica_House) Fme ON Fme.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\n(SELECT\t\nLgv.IdLogistica_House,\nSTRING_AGG(Nat.Nome, ' / ') AS Navio\nFROM\nmov_Logistica_viagem Lgv\nleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgv.IdNavio\nWHERE\nLgv.Tipo_Viagem = 5\nGROUP BY\nLgv.IdLogistica_House\n)Lgt ON Lgt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\nmov_Logistica_Maritima_Master Lmm ON Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\ncad_Navio Nvi ON Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\nmov_Atividade At1 ON At1.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At1.IdTarefa = 839 /*Envio do Draft ao cliente para aprova??o*/\nLeft Outer Join\ncad_Tarefa Tf1 ON Tf1.IdTarefa = At1.IdTarefa\nLeft Outer Join\nmov_Atividade At2 ON At2.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At2.IdTarefa = 844 /*Enviar HBL original ao cliente*/\nLeft Outer Join\ncad_Tarefa Tf2 ON Tf2.IdTarefa = At2.IdTarefa\nLeft Outer Join\nmov_Atividade At3 ON At3.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At3.IdTarefa = 1266 /*Envio OMBL editado ao cliente (MAO)*/\nLeft Outer Join\ncad_Tarefa Tf3 ON Tf3.IdTarefa = At3.IdTarefa\nLeft Outer Join\nmov_Atividade At4 ON At4.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At4.IdTarefa = 1335 /*Envio do Manifesto de baldea??o*/\nLeft Outer Join\nmov_Atividade At5 ON At5.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At5.IdTarefa = 946 /*Confirmar recebimento dos documentos originais*/\nLeft Outer Join\ncad_Tarefa Tf4 ON Tf4.IdTarefa = At4.IdTarefa\nleft outer join\nvis_logistica_prazo Lgp ON Lgp.IdLogistica_House = Lhs.IdLogistica_House and Lgp.IdConfiguracao_Campo_Livre = 216 /*Ajuste NCM*/\nleft outer join\nvis_logistica_prazo Lgp2 ON Lgp2.IdLogistica_House = Lhs.IdLogistica_House and Lgp2.IdConfiguracao_Campo_Livre = 215 /*Retifica??o de CE*/\nleft outer join\nvis_logistica_prazo Lgp3 ON Lgp3.IdLogistica_House = Lhs.IdLogistica_House and Lgp3.IdConfiguracao_Campo_Livre = 217 /*Conclus?o retifica??o*/\nleft outer join\n(select\nLtx.IdLogistica_House,\nLtx.Valor_Recebimento_Total,\nRcbto.Sigla\nfrom\n  mov_Logistica_Taxa Ltx\nleft outer join\n  cad_Moeda Rcbto on Rcbto.IdMoeda = Ltx.IdMoeda_Recebimento\n  Where Ltx.IdTaxa_Logistica_Exibicao = 2 /*frete*/) Tst on Tst.IdLogistica_House = Lhs.IdLogistica_House\n/*WHERE*/\nWHERE\nPes.IdPessoa IN (\n        62161,\n        58934,\n        59126,\n        59100,\n        59460,\n        59066,\n        62772,\n        49971 ) /*BEL MICRO E ABW*/\nAND\nLms.Modalidade_Processo = 2 /*Maritimo*/\nAND\nLms.Tipo_Operacao= 2 /*importacao*/\nGROUP BY\n    Lhs.Referencia_Cliente,\n    Lhs.Numero_Processo,\n    Cne.Numero,\n    Lms.Numero_Conhecimento,\n    Orm.Nome,\n    Dst.Nome,\n    Pes.Nome,\n    Cia.nome,\n    PsaAgencia.Nome,\n    Lms.Data_Previsao_Embarque,\n    Lms.Data_Previsao_Desembarque,\n    Lmc.Free_Time_House,\n    Tf1.Descricao,\n    At1.Situacao,\n    Tf2.Descricao,\n    At2.Situacao,\n    Tf3.Descricao,\n    At3.Situacao,\n    Tf4.Descricao,\n    At4.Situacao,\n    Lgp.Valor_Boleano,\n    Lgp2.Valor_Data,\n    Lgp3.Valor_Data,\n    Lgt.Navio,\n    Lmc.Number,\n    Nvi.Nome,\n    Pes.IdPessoa,\n    Lhs.Situacao_Agenciamento,\n    At5.Situacao,\n    Fme.Free_Time_House_Destino\nORDER BY\nLms.Data_Previsao_Desembarque DESC,\nPes.IdPessoa ASC"
    },
    {
        "caminho": "Scripts\\Consultas\\Consulta TEX CAGADA.sql",
        "conteudo": "DECLARE @Tabela    VARCHAR(MAX) = 'cad_Modelo_Mensagem'\nDECLARE @PK1_Nome  VARCHAR(200) = 'IdModelo_Mensagem'\nDECLARE @PK1_Valor VARCHAR(MAX) = '345'\n\n-- Opcionais, use apenas quando precisar se não, deixe-os em branco!\n\n--SELECT /*Para campos livres*/\n--*\n--FROM\n--vis_Logistica_campo_livre\n--WHERE\n--idcampo_livre = 3763\n\n\nDECLARE @PK2_Nome  VARCHAR(200) = ''\nDECLARE @PK2_Valor VARCHAR(MAX) = ''\nDECLARE @PK3_Nome  VARCHAR(200) = ''\nDECLARE @PK3_Valor VARCHAR(MAX) = ''\n\nDECLARE @Data_Inicio_Texto  VARCHAR(20) = '01/11/2025' -- dd/MM/yyyy\nDECLARE @Usar_Hoje_Termino  BIT         = 1            -- 1 = usar GETDATE(); 0 = usar @Data_Termino_Texto\nDECLARE @Data_Termino_Texto VARCHAR(20) = ''           -- dd/MM/yyyy (use se @Usar_Hoje_Termino = 0)\n\n-- ?? OUTROS FILTROS\n\nDECLARE @IdUsuario IdCurto  = 0  -- 0 = Todos\nDECLARE @Tipo      TipoFixo = 0  -- 0 = Todos | 1=Inserção | 2=Exclusão | 3=Alteração\n\n\n\n\n/* -----------------------------------\n   ?? Variáveis internas\n----------------------------------- */\nDECLARE\n  @Primary_Keys  XML,\n  @Data_Inicio   DATETIME,\n  @Data_Termino  DATETIME,\n  @SQL           NVARCHAR(MAX),\n  @Filtro_Tabela VARCHAR(MAX),\n  @Filtro_Campo  VARCHAR(MAX),\n  @Filtro_Tipo   VARCHAR(MAX),\n  @IdExprList    NVARCHAR(MAX),\n  @IdExprCount   INT,\n  @ExprId        NVARCHAR(MAX),\n  @OrderBy       NVARCHAR(MAX)\n\n-- Normaliza entradas\nSET @PK1_Nome  = NULLIF(LTRIM(RTRIM(@PK1_Nome)) , '')\nSET @PK1_Valor = NULLIF(LTRIM(RTRIM(@PK1_Valor)), '')\nSET @PK2_Nome  = NULLIF(LTRIM(RTRIM(@PK2_Nome)) , '')\nSET @PK2_Valor = NULLIF(LTRIM(RTRIM(@PK2_Valor)), '')\nSET @PK3_Nome  = NULLIF(LTRIM(RTRIM(@PK3_Nome)) , '')\nSET @PK3_Valor = NULLIF(LTRIM(RTRIM(@PK3_Valor)), '')\n\nSET @Data_Inicio_Texto  = NULLIF(LTRIM(RTRIM(@Data_Inicio_Texto)) , '')\nSET @Data_Termino_Texto = NULLIF(LTRIM(RTRIM(@Data_Termino_Texto)), '')\nSET @Tabela             = NULLIF(LTRIM(RTRIM(@Tabela))            , '')\n\n-- Monta a lista de PKs\nDECLARE @PK_Input TABLE (Nome VARCHAR(200), Valor VARCHAR(MAX))\nIF @PK1_Nome IS NOT NULL AND @PK1_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK1_Nome, @PK1_Valor)\nIF @PK2_Nome IS NOT NULL AND @PK2_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK2_Nome, @PK2_Valor)\nIF @PK3_Nome IS NOT NULL AND @PK3_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK3_Nome, @PK3_Valor)\n\n-- Constrói o XML <PrimaryKeys>\nSET @Primary_Keys = (\n  SELECT Nome AS [@Nome], Valor AS [@Value]\n  FROM @PK_Input\n  FOR XML PATH('Item'), ROOT('PrimaryKeys'), TYPE\n)\n\n-- Converte Data_Inicio\nSET @Data_Inicio =\n  COALESCE(\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 103),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 120),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto)\n  )\n\n-- Define Data_Termino (fim do dia quando informar texto)\nIF @Usar_Hoje_Termino = 1\n  SET @Data_Termino = GETDATE()\nELSE\n  SET @Data_Termino =\n    DATEADD(SECOND, 86399,\n      COALESCE(\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 103),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 120),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto)\n      )\n    )\n\n-- ?? Agrupar múltiplos valores por campo\nDECLARE @FiltroXml TABLE (Nome VARCHAR(MAX), VALUE VARCHAR(MAX))\nINSERT INTO @FiltroXml\nSELECT\n  Pks.value('@Nome',  'VARCHAR(MAX)') AS Nome,\n  Pks.value('@Value', 'VARCHAR(MAX)') AS Value\nFROM\n  @Primary_Keys.nodes('/PrimaryKeys/Item') AS PrimaryKeys(Pks)\n\n-- ?? Filtros dinâmicos\nSET @Filtro_Tabela = ''\nIF @Tabela IS NOT NULL\n  SET @Filtro_Tabela = '[@Nome=\"'+@Tabela+'\"]'\n\nSET @Filtro_Campo = ''\nSELECT @Filtro_Campo = @Filtro_Campo +\n  '[Campo[@Nome=\"'+Nome+'\" and (' +\n  STRING_AGG('@Value=\"'+VALUE+'\"', ' or ') +\n  ')]]'\nFROM @FiltroXml\nGROUP BY Nome\n\nSET @Filtro_Tipo = ''\nIF @Tipo <> 0\n  SET @Filtro_Tipo = '[@Tipo=\"'+CAST(@Tipo AS VARCHAR(MAX))+'\"]'\n\n/* ?? Expressão de Id segura (numérica) */\nSET @IdExprList  = ''\nSET @IdExprCount = 0\n\nIF @PK1_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK2_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK3_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @IdExprCount = 0\n  SET @ExprId = 'NULL'\nELSE IF @IdExprCount = 1\n  SET @ExprId = @IdExprList\nELSE\n  SET @ExprId = 'COALESCE(' + @IdExprList + ')'\n\n-- ORDER BY dinâmico (se não houver PK, ordena só pela data)\nIF @IdExprCount = 0\n  SET @OrderBy = 'ORDER BY Ltb.Data_Inicio'\nELSE\n  SET @OrderBy = 'ORDER BY ' + @ExprId + ', Ltb.Data_Inicio'\n\n-- ?? Consulta dinâmica\nSET @SQL = '\nSELECT\n    Usr.Nome AS Usuario,\n    CONVERT(VARCHAR(10), Ltb.Data_Inicio , 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Inicio , 108) AS Data_Inicio_Transacao,\n    CONVERT(VARCHAR(10), Ltb.Data_Termino, 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Termino, 108) AS Data_Termino_Transacao,\n    DATEDIFF(SECOND, Ltb.Data_Inicio, Ltb.Data_Termino) AS Tempo_Transacao,\n    Dlg.value(''../@WindowsUser'',  ''VARCHAR(MAX)'') AS Usuario_Windows,\n    Dlg.value(''../@ComputerName'', ''VARCHAR(MAX)'') AS Computador,\n    Dlg.value(''@Nome'',           ''VARCHAR(MAX)'')  AS Tabela,\n    ' + @ExprId + ' AS Id,\n    CASE Dlg.value(''@Tipo'', ''SMALLINT'')\n         WHEN 1 THEN ''INSERÇÃO''\n         WHEN 2 THEN ''EXCLUSÃO''\n         WHEN 3 THEN ''ALTERAÇÃO''\n         ELSE CAST(Dlg.value(''@Tipo'', ''SMALLINT'') AS VARCHAR(10))\n    END AS Tipo,\n    CONVERT(VARCHAR(10), CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 103)\n      + '' '' +\n    CONVERT(VARCHAR(8),  CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 108) AS Data,\n    Dlg.query(''<Campos>{Campo}</Campos>'') AS Campos\nFROM\n    sys_Log_Tabela Ltb\nCROSS APPLY\n    Ltb.Dados_Log.nodes(''/Log/Tabela' + @Filtro_Tabela + @Filtro_Tipo + @Filtro_Campo + ''') AS DadosLog(Dlg)\nJOIN\n    sys_Usuario Usr ON Usr.IdUsuario = Ltb.IdUsuario\nWHERE\n    ((@IdUsuario = 0) OR (Ltb.IdUsuario = @IdUsuario))\n    AND (\n        ((@Data_Inicio IS NULL) AND (@Data_Termino IS NULL)) OR\n        (Ltb.Data_Inicio  BETWEEN @Data_Inicio AND @Data_Termino) OR\n        (Ltb.Data_Termino BETWEEN @Data_Inicio AND @Data_Termino)\n    )\n' + @OrderBy + '\n'\n\n-- ?? Execução\nEXEC sp_executesql \n  @SQL, \n  N'@Data_Inicio DATETIME, @Data_Termino DATETIME, @IdUsuario IdCurto',\n  @Data_Inicio  = @Data_Inicio,\n  @Data_Termino = @Data_Termino,\n  @IdUsuario    = @IdUsuario\n "
    },
    {
        "caminho": "Scripts\\Consultas\\Consultar modalidade de pagamento e recebimentos master e house Comercial.sql",
        "conteudo": "SELECT\nCASE /*Buscar o tipo de modalidade do pagamento do comercial*/\nWHEN Oft.Modalidade_Pagamento = 0 THEN 'Não definida'\nWHEN Oft.Modalidade_Pagamento = 1 THEN 'Prepaid'\nWHEN Oft.Modalidade_Pagamento = 2 THEN 'Collect'\nWHEN Oft.Modalidade_Pagamento = 3 THEN 'Abroad'\nEND AS Modalidade_Pagamento,\nCASE /*Buscar o tipo de modalidade do recebimento do comercial*/\n        WHEN Oft.Modalidade_Recebimento = 0 THEN 'Não definida'\n        WHEN Oft.Modalidade_Recebimento = 1 THEN 'Prepaid'\n        WHEN Oft.Modalidade_Recebimento = 2 THEN 'Collect'\n        WHEN Oft.Modalidade_Recebimento = 3 THEN 'Abroad'\n        END AS Modalidade_Recebimento,\nCASE \n        WHEN Otf.Modalidade_Pagamento_Master = 0 THEN '(Não informado)'\n        WHEN Otf.Modalidade_Pagamento_Master = 1 THEN 'Collect/Prepaid'\n        WHEN Otf.Modalidade_Pagamento_Master = 2 THEN 'Collect'\n        WHEN Otf.Modalidade_Pagamento_Master = 3 THEN 'Prepaid'\n        WHEN Otf.Modalidade_Pagamento_Master = 4 THEN 'Prepaid abroad'\n        END AS Modalidade_Pagamento_Master,\nCASE \n        WHEN Otf.Modalidade_Pagamento_House = 0 THEN '(Não informado)'\n        WHEN Otf.Modalidade_Pagamento_House = 1 THEN 'Collect/Prepaid'\n        WHEN Otf.Modalidade_Pagamento_House = 2 THEN 'Collect'\n        WHEN Otf.Modalidade_Pagamento_House = 3 THEN 'Prepaid'\n        WHEN Otf.Modalidade_Pagamento_House = 4 THEN 'Prepaid abroad'\n        END AS Modalidade_Pagamento_House\nFROM\nmov_Logistica_Taxa Ltx\nLeft Outer Join\t\nmov_logistica_house Lhs ON Lhs.idLogistica_House = Ltx.idLogistica_House\nLeft Outer Join\t\nmov_oferta_frete_taxa Oft ON Oft.idoferta_frete_taxa = Ltx.idoferta_frete_taxa\nLeft Outer Join\t\nmov_oferta_frete Otf ON Otf.IdOferta_Frete = Oft.IdOferta_Frete\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Consultar modalidade de pagamento e recebimentos master e house Operacional.sql",
        "conteudo": "SELECT\nCASE\n\tWHEN Lhs.modalidade_pagamento = 1 THEN 'Collect/Prepaid'\n\tWHEN Lhs.modalidade_pagamento = 2 THEN 'Collect'\n\tWHEN Lhs.modalidade_pagamento = 3 THEN 'Prepaid'\n\tWHEN Lhs.modalidade_pagamento = 4 THEN 'Prepaid abroad'\n\tEND AS Modalidade_Pagamento_House,\n\tCASE\n\tWHEN Lms.modalidade_pagamento = 1 THEN 'Collect/Prepaid'\n\tWHEN Lms.modalidade_pagamento = 2 THEN 'Collect'\n\tWHEN Lms.modalidade_pagamento = 3 THEN 'Prepaid'\n\tWHEN Lms.modalidade_pagamento = 4 THEN 'Prepaid abroad'\n\tEND AS Modalidade_Pagamento_Master,\nCASE\n\tWHEN Ltx.Modalidade_Pagamento = 0 THEN 'Não definida'\n\tWHEN Ltx.Modalidade_Pagamento = 1 THEN 'Prepaid'\n\tWHEN Ltx.Modalidade_Pagamento = 2 THEN 'Collect'\n\tWHEN Ltx.Modalidade_Pagamento = 4 THEN 'Abroad'\n\tEND AS Modalidade_Pagamento_Taxa,\n\tCASE\n\tWHEN Ltx.Modalidade_Recebimento = 0 THEN 'Não definida'\n\tWHEN Ltx.Modalidade_Recebimento = 1 THEN 'Prepaid'\n\tWHEN Ltx.Modalidade_Recebimento = 2 THEN 'Collect'\n\tWHEN Ltx.Modalidade_Recebimento = 4 THEN 'Abroad'\n\tEND AS Modalidade_Recebimento_Taxa\nFROM\nmov_logistica_house Lhs\nLeft Outer Join\nmov_logistica_taxa Ltx ON Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\t\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Criação de consulta - ABW.sql",
        "conteudo": "SELECT\nLhs.Referencia_Cliente as Referencia_Cliente,\nLhs.Referencia_Interna as Referencia_Tex,\nCne.Numero as Numero_BL_House,\nLgv.Numero_Conhecimento as Numero_BL_Master,\nOrm.Nome as Origem,\nDst.Nome as Destino,\nPes.Nome as Nome_Cliente,\nCia.nome as Armador,\nLms.Data_Previsao_Embarque as ETD,\nLms.Data_Previsao_Desembarque as ETA,\nLmh.Containers as Containers,\nCOALESCE(Lmh.Total_Container_20, 0) + COALESCE(Lmh.Total_Container_40, 0) AS Quantidade_Containeres,\nNav.Nome as Navio,\nLmc.Free_Time_House as Free_Time_House,\nNat.Nome as Navio_Transbordo\n\nFROM\nmov_logistica_house as Lhs\nleft outer join\ncad_Pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\nmov_Conhecimento_Embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\nmov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Origem_Destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nleft outer join\nmov_Logistica_Maritima_House Lmh ON Lmh.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Navio Nav ON Nav.IdNavio = Lms.IdCompanhia_Transporte\nleft outer join\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\nmov_logistica_viagem Lgt ON Lgt.IdLogistica_House = Lhs.IdLogistica_House AND Lgt.Tipo_Viagem = 5\nleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgt.IdNavio\nwhere\nPes.IdPessoa = 49971\nAND\nLms.Modalidade_Processo = 2\nAND\nLms.Tipo_Operacao= 2\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Criação de consulta - ABW1.sql",
        "conteudo": "﻿SELECT\nLhs.Referencia_Cliente as Referencia_Cliente,\nLhs.Numero_Processo as Referencia_Tex,\nCne.Numero as Numero_BL_House,\nLms.Numero_Conhecimento as Numero_BL_Master,\nOrm.Nome as Origem,\nDst.Nome as Destino,\nPes.Nome as Nome_Cliente,\nCia.nome as Armador,\nLms.Data_Previsao_Embarque as ETD,\nLms.Data_Previsao_Desembarque as ETA,\nLmh.Containers as Containers,\nCOALESCE(Lmh.Total_Container_20, 0) + COALESCE(Lmh.Total_Container_40, 0) AS Quantidade_Containeres,\nLgt.Navio,\nLmc.Free_Time_House as Free_Time_House,\nTf1.Descricao,\nCASE\nWHEN At1.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_Draft,\nTf2.Descricao,\nCASE\nWHEN At2.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_HBL,\nTf3.Descricao,\nCASE\nWHEN At3.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_OMBL,\nTf4.Descricao,\nCASE\nWHEN At4.Situacao = 4 THEN 'Sim' /*concluida*/\nELSE 'Não'\nEND AS Concluida_Manifesto,\nCASE\nWHEN Lgp.Valor_Boleano IS NULL THEN 'Não' /*Não marcado*/\nWHEN Lgp.Valor_Boleano = 0 THEN 'Não' /*Não marcado*/\nELSE 'Sim'\nEND AS Ajuste_NCM,\nLgp2.Valor_Data AS Retificação_CE,\nLgp3.Valor_Data AS Conclusão_Retificacao\nFROM\nmov_logistica_house as Lhs\nleft outer join\ncad_Pessoa Pes ON Pes.IdPessoa = Lhs.IdCliente\nleft outer join\nmov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nleft outer join\nmov_Conhecimento_Embarque Cne ON Cne.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Origem_Destino Orm ON Orm.IdOrigem_Destino = Lms.IdOrigem\nleft outer join\ncad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nleft outer join\ncad_pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nleft outer join\nmov_Logistica_Maritima_House Lmh ON Lmh.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join\ncad_Navio Nav ON Nav.IdNavio = Lms.IdCompanhia_Transporte\nleft outer join\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nleft outer join(\nSELECT  \nLgv.IdLogistica_House,\nNat.Nome as Navio\nFROM\nmov_Logistica_viagem Lgv\nleft outer join\ncad_Navio Nat ON Nat.IdNavio = Lgv.IdNavio\nWHERE\nLgv.Tipo_Viagem = 5\n)Lgt on Lgt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\nmov_Atividade At1 on At1.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At1.IdTarefa = 839 /*Envio do Draft ao cliente para aprovação*/\nLeft Outer Join\ncad_Tarefa Tf1 on Tf1.IdTarefa = At1.IdTarefa\nLeft Outer Join\nmov_Atividade At2 on At2.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At2.IdTarefa = 844 /*Enviar HBL original ao cliente*/\nLeft Outer Join\ncad_Tarefa Tf2 on Tf2.IdTarefa = At2.IdTarefa\nLeft Outer Join\nmov_Atividade At3 on At3.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At3.IdTarefa = 1266 /*Envio OMBL editado ao cliente (MAO)*/\nLeft Outer Join\ncad_Tarefa Tf3 on Tf3.IdTarefa = At3.IdTarefa\nLeft Outer Join\nmov_Atividade At4 on At4.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and At4.IdTarefa = 1335 /*Envio do Manifesto de baldeação*/\nLeft Outer Join\ncad_Tarefa Tf4 on Tf4.IdTarefa = At4.IdTarefa\nleft outer join\nvis_logistica_prazo Lgp ON Lgp.IdLogistica_House = Lhs.IdLogistica_House and Lgp.IdConfiguracao_Campo_Livre = 216 /*Ajuste NCM*/\nleft outer join\nvis_logistica_prazo Lgp2 ON Lgp2.IdLogistica_House = Lhs.IdLogistica_House and Lgp2.IdConfiguracao_Campo_Livre = 215 /*Retificação de CE*/\nleft outer join\nvis_logistica_prazo Lgp3 ON Lgp3.IdLogistica_House = Lhs.IdLogistica_House and Lgp3.IdConfiguracao_Campo_Livre = 217 /*Conclusão retificação*/\n/*WHERE*/\nWHERE\nPes.IdPessoa = 49971 /*ABW*/\nAND\nLms.Modalidade_Processo = 2 /*Maritimo*/\nAND\nLms.Tipo_Operacao= 2 /*importacao*/\nAND\nLhs.IdLogistica_House = 31163"
    },
    {
        "caminho": "Scripts\\Consultas\\Criação de modelo de acompanhamento (Solicitar coleta) - EA.sql",
        "conteudo": "SELECT\nLgv.Local_Coleta,\nLgv.Local_Entrega,\nLgv.Data_Previsao_Embarque as Data_Coleta,\nLgv.Data_Previsao_Desembarque as Chegada,\ncase Lgv.Tipo_Servico when 2 then 'Dedicado / Consolidado / Cabotagem / Rodizio' when 1 then 'Back to back / Transbordo' when 0 then '(Não informado)' end as Tipo_Servico\nFROM\nmov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n\tmov_Logistica_Viagem Lgv on Lgv.IdLogistica_House = Lhs.IdLogistica_House\n  where\n  Atv.IdAtividade = 58162"
    },
    {
        "caminho": "Scripts\\Consultas\\Criação de modelo de acompanhamento (Solicitar coleta)(editado) - EA.sql",
        "conteudo": "SELECT DISTINCT\n    Atv.IdAtividade,\n    Lhs.IdLogistica_House,\n    Lms.IdLogistica_Master,\n    CAST(Lhs.Local_Coleta AS VARCHAR(MAX)) AS Local_Coleta,\n    CAST(Lhs.Local_Entrega AS VARCHAR(MAX)) AS Local_Entrega,\n    Lgv.Data_Previsao_Embarque as Data_Coleta,\n    Lgv.Data_Previsao_Desembarque as Chegada,\n    CASE Lgv.Tipo_Servico \n        WHEN 2 THEN 'Dedicado / Consolidado / Cabotagem / Rodizio' \n        WHEN 1 THEN 'Back to back / Transbordo' \n        WHEN 0 THEN '(Não informado)' \n    END as Tipo_Servico,\n    CAST(Mer.Nome AS VARCHAR(MAX)) as Mercadoria,\n    CAST(Moe.Nome AS VARCHAR(MAX)) as Moeda,\n    Lhs.Metros_Cubicos,\n    Lhs.Quantidade_Volumes,\n    Lhs.Valor_Mercadoria,\n    Lhs.Importancia_Segurada,\n    Lhs.Peso_Bruto,\n    CASE Lhs.Seguro WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Seguro,\n    CASE Lhs.Carga_Perigosa WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Carga_Perigosa,\n    Lah.Peso_taxado,\n    CAST(Tmb.Nome AS VARCHAR(MAX)) as Embalagemm,\n    Lgm.Quantidade as Quantidade_Emb,\n    Lgm.Altura as Altura_Emb,\n    Lgm.Largura as Largura_Emb,\n    Lgm.Comprimento as Comprimento_Emb,\n    Lgm.Metros_Cubicos as Met_Cub_Emb,\n    Lgm.Peso_Liquido as Peso_Liq_Emb,\n    Lgm.Peso_Bruto as Peso_But_Emb,\n    Lgm.Peso_Cubado as Peso_Cub_Emb,\n    Lhs.Numero_Processo,\n    Clv.Valor_Data\nFROM\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_House Lah ON Lah.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Mercadoria Mer ON Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN\n    cad_Moeda Moe ON Moe.IdMoeda = Lhs.IdMoeda_Mercadoria\nLEFT OUTER JOIN\n    mov_Logistica_Embalagem Lgm ON Lgm.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Tipo_Embalagem Tmb ON Tmb.IdTipo_Embalagem = Lgm.IdTipo_Embalagem\nLEFT OUTER JOIN\n    mov_Logistica_Campo_Livre Cml on Cml.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    mov_Campo_Livre Clv on Clv.IdCampo_Livre = Cml.IdCampo_Livre and IdConfiguracao_Campo_Livre= 141\nWHERE\n    Atv.IdAtividade = 1509438"
    },
    {
        "caminho": "Scripts\\Consultas\\Diagrama de tabelas.html",
        "conteudo": "<!DOCTYPE html>\n<html lang=\"pt-br\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Estrutura do Banco de Dados - Follow Up Enterprise</title>\n    <!-- Importando Bootstrap para estilo bonito e minimalista -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <style>\n        body {\n            background-color: #f8f9fa;\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        }\n        .container {\n            max-width: 1200px;\n            margin-top: 50px;\n            margin-bottom: 50px;\n        }\n        .card {\n            border: none;\n            border-radius: 15px;\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n            margin-bottom: 30px;\n        }\n        .card-header {\n            background-color: #2c3e50;\n            color: white;\n            border-radius: 15px 15px 0 0 !important;\n            padding: 20px;\n        }\n        .card-body {\n            padding: 30px;\n            background-color: white;\n            overflow-x: auto; /* Permite rolar se o diagrama for grande */\n        }\n        h2 {\n            font-weight: 600;\n            font-size: 1.5rem;\n        }\n        p {\n            color: #6c757d;\n        }\n        /* Estilo para centralizar o diagrama */\n        .mermaid {\n            display: flex;\n            justify-content: center;\n        }\n    </style>\n</head>\n<body>\n\n    <div class=\"container\">\n        <!-- Título Principal -->\n        <div class=\"text-center mb-5\">\n            <h1 class=\"display-5 fw-bold text-dark\">Estudo Visual: Follow-Up Enterprise</h1>\n            <p class=\"lead text-muted\">Diagrama das ligações SQL utilizadas no relatório corrigido.</p>\n        </div>\n\n        <!-- Bloco 1: Estrutura Principal -->\n        <div class=\"card\">\n            <div class=\"card-header\">\n                <h2>1. Estrutura Geral (DataSet Processo)</h2>\n            </div>\n            <div class=\"card-body\">\n                <p>Este diagrama mostra como o sistema busca os dados básicos (Cliente, Origem, Destino) a partir da atividade selecionada.</p>\n                <div class=\"mermaid\">\n                    erDiagram\n                        %% A Tabela Principal (O Gatilho)\n                        mov_Atividade {\n                            int IdAtividade PK \"Filtro Principal (:IdAtividade)\"\n                            int IdProjeto_Atividade FK\n                        }\n\n                        %% A Tabela do Processo (House)\n                        mov_Logistica_House {\n                            int IdLogistica_House PK\n                            string Numero_Processo\n                            int IdCliente FK\n                            int IdExportador FK\n                        }\n\n                        %% A Tabela Master\n                        mov_Logistica_Master {\n                            int IdLogistica_Master PK\n                            int IdOrigem FK\n                            int IdDestino FK\n                        }\n\n                        %% Tabelas de Cadastro (Cadastros Básicos)\n                        cad_Pessoa_Cliente {\n                            string Nome_Fantasia\n                        }\n                        cad_Origem_Destino {\n                            string Nome \"Nome da Cidade/Porto\"\n                        }\n\n                        %% AS LIGAÇÕES (JOINS)\n                        mov_Atividade ||--|| mov_Logistica_House : \"Liga pelo IdProjeto_Atividade\"\n                        mov_Logistica_House ||--|| mov_Logistica_Master : \"Liga pelo IdLogistica_Master\"\n                        \n                        mov_Logistica_House }|--|| cad_Pessoa_Cliente : \"Busca dados do Cliente\"\n                        mov_Logistica_Master }|--|| cad_Origem_Destino : \"Busca Origem e Destino\"\n                </div>\n            </div>\n        </div>\n\n        <!-- Bloco 2: O Loop dos Navios -->\n        <div class=\"card\">\n            <div class=\"card-header bg-success\"> <!-- Cor Verde para destacar a parte que arrumamos -->\n                <h2>2. A Lógica dos Múltiplos Navios (Correção Realizada)</h2>\n            </div>\n            <div class=\"card-body\">\n                <p>Aqui está o segredo da correção. Em vez de ligar direto no Navio, ligamos na tabela de <strong>Viagem (Transbordo)</strong>. Note o símbolo <code>}o--||</code> que significa \"Muitos para Um\".</p>\n                \n                <div class=\"mermaid\">\n                    erDiagram\n                        %% Tabela do Processo\n                        mov_Logistica_House {\n                            int IdLogistica_House PK\n                        }\n\n                        %% Tabela de Viagens (Pode ter várias linhas para 1 processo)\n                        mov_Logistica_Viagem {\n                            int IdLogistica_Viagem PK\n                            int IdLogistica_House FK\n                            int IdNavio FK\n                            date Data_Embarque\n                            date Data_Desembarque\n                        }\n\n                        %% Tabela de Navios\n                        cad_Navio {\n                            int IdNavio PK\n                            string Nome \"Nome do Navio\"\n                        }\n\n                        %% A LIGAÇÃO CRUCIAL\n                        mov_Logistica_House ||--|{ mov_Logistica_Viagem : \"1 Processo tem VÁRIAS Viagens (Loop)\"\n                        mov_Logistica_Viagem }|--|| cad_Navio : \"Cada Viagem busca seu Navio\"\n                </div>\n                <div class=\"alert alert-info mt-3\">\n                    <strong>Explicação:</strong> O comando <code>SubReport</code> que adicionamos no HTML serve justamente para percorrer a seta \"Várias Viagens\" acima. Ele desenha uma linha na tabela para cada caixa de <code>mov_Logistica_Viagem</code> encontrada.\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n    <!-- Script do Mermaid.js (Faz o desenho automático) -->\n    <script type=\"module\">\n        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';\n        mermaid.initialize({ startOnLoad: true });\n    </script>\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Consultas\\Fechamento AKHAVA.sql",
        "conteudo": "Select\n  ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) as Indice,\n  Tbl2.IdLogistica_House,\n  Tbl1.IdLogistica_Moeda,\n  Tbl1.Lucro_Efetivo,\n  Tbl1.Lucro_Estimado,\n  Tbl1.Comissao_Vendedor_Efetiva,\n  Tbl1.Comissao_Vendedor_Estimada,\n  Tbl1.Lucro_Efetivo + Coalesce(Tbl1.Comissao_Vendedor_Efetiva, 0) As Profit_Total_Efetivo,\n  Tbl1.Lucro_Estimado + Coalesce(Tbl1.Comissao_Vendedor_Estimada, 0) As Profit_Total_Estimado,\n  Tbl1.IdLogistica_House,\n  Tbl2.Numero_Processo as Tbl2_Numero_Processo,\n  Tbl2.Situacao_Agenciamento as Tbl2_Situacao_Agenciamento,\n  Tbl2.IdCliente as Tbl2_IdCliente,\n  Tbl3.IdPessoa as Tbl3_IdPessoa,\n  Tbl7.Nome as Tbl7_Nome,\n  Tbl2.IdEmpresa_Sistema as Tbl2_IdEmpresa_Sistema,\n  Tbl22.Nome as Tbl22_Nome,\n  Tbl22.IdEmpresa_Sistema as Tbl22_IdEmpresa_Sistema,\n  Tbl2.IdLogistica_Master as Tbl2_IdLogistica_Master,\n  Tbl30.Modalidade_Processo as Tbl30_Modalidade_Processo,\n  Tbl30.Situacao_Embarque as Tbl30_Situacao_Embarque,\n  Tbl30.Tipo_Operacao as Tbl30_Tipo_Operacao,\n  Tbl2.IdVendedor as Tbl2_IdVendedor,\n  Tbl52.IdPessoa as Tbl52_IdPessoa,\n  Lvn.Vendedor,\n  Lvn.Valor_Pagamento_Total,\n  Lcm.Outro_Vendedor,\n  Lcm.Valor_Comissao,\n  Lcm.Valor_Comissao as Outro_Comissao,\n  SUM(Lcm.Valor_Comissao) OVER () AS Outro_Comissao_Total,\n  Tbl1.IdMoeda,\n  Tbl69.Sigla as Tbl69_Sigla,\n  Tbl2.Peso_Cubado,\n  Lah.Peso_Taxado,\n  Tbl2.Peso_Bruto,\n  Tbl2.Metros_Cubicos,\n  Tbl2.Total_Conhecimentos,\n  Tbl2.Quantidade_Volumes,\n  Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40, 0) As Total_Equipamentos,\n  Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40 * 2, 0) As TEUS,\n  Tbl2.Peso_Considerado,\n  Case\n    When Tbl30.Tipo_Operacao = 2 /* Importação */ Then Coalesce(Tbl30.Data_Desembarque, Tbl30.Data_Previsao_Desembarque)\n    Else Coalesce(Tbl30.Data_Embarque, Tbl30.Data_Previsao_Embarque)\n  End As Data_Competencia\nFrom\n  mov_Logistica_Moeda Tbl1\nJoin\n  cad_Moeda Tbl69 on Tbl69.IdMoeda = Tbl1.IdMoeda And Tbl69.Moeda_Corrente = 1\nJoin\n  mov_Logistica_House Tbl2 on Tbl2.IdLogistica_House = Tbl1.IdLogistica_House\nLeft Outer Join\n  cad_Cliente Tbl3 on Tbl3.IdPessoa = Tbl2.IdCliente\nLeft Outer Join\n  cad_Pessoa Tbl7 on Tbl7.IdPessoa = Tbl3.IdPessoa\nLeft Outer Join\n  sys_Empresa_Sistema Tbl22 on Tbl22.IdEmpresa_Sistema = Tbl2.IdEmpresa_Sistema\nLeft Outer Join\n  mov_Logistica_Master Tbl30 on Tbl30.IdLogistica_Master = Tbl2.IdLogistica_Master\nLeft Outer Join\n  cad_Funcionario Tbl52 on Tbl52.IdPessoa = Tbl2.IdVendedor\nLeft Outer Join\n  cad_Pessoa Tbl56 on Tbl56.IdPessoa = Tbl52.IdPessoa\nLeft Outer Join\n  mov_Logistica_Maritima_House Lmh On Lmh.IdLogistica_House = Tbl2.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Aerea_House Lah On Lah.IdLogistica_House = Tbl2.IdLogistica_House\nLeft Outer Join (\nSelect\n  Ltx.IdLogistica_House,\n  Psr.Nome AS Vendedor,\n  Ltx.Valor_Pagamento_Total\nfrom\n  mov_Logistica_Taxa Ltx\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle ON Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Pessoa Psr ON Psr.IdPessoa = IdPessoa_Pagamento\nWhere\n  Ltx.IdTaxa_Logistica_Exibicao = 13 /*Comissao Vendedor*/\nAnd\n  Ltx.Pagar_Para = 7 /*Vendedor*/) Lvn ON Lvn.IdLogistica_House = Tbl2.IdLogistica_House\nLeft Outer Join (\nSelect\n  Ltx.IdLogistica_House,\n  Psr.Nome AS Outro_Vendedor,\n  Ltx.Valor_Pagamento_Total AS Valor_Comissao\nfrom\n  mov_Logistica_Taxa Ltx\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle ON Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Pessoa Psr ON Psr.IdPessoa = IdPessoa_Pagamento\nWhere\n  Ltx.IdTaxa_Logistica_Exibicao = 13 /*Comissao Vendedor*/\nAnd\n  Ltx.Pagar_Para = 4 /*Outro Vendedor*/) Lcm ON Lcm.IdLogistica_House = Tbl2.IdLogistica_House\n/*Where*/\nWhere\n  Tbl2.Situacao_Agenciamento <> 7\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Kauan Teste.sql",
        "conteudo": "SELECT\nPes.Nome as Cliente, Ven.Nome as Vendedor, Ppf.Data_Proposta, Ppf.Data_Aprovacao, case Ppf.Situacao when 1 then 'Aguardando Aprovação' when 2 then 'Aprovada' when 3 then 'Não Aprovada' when 4 then 'Não Enviada' when 5 then 'Pré-Proposta' when 6 then 'Enviada'\nelse 'erro 711' end as Situacao /*711 erro de coluna, nome errado, puxando errado*/\nFROM\nmov_Proposta_Frete Ppf\nLeft Outer Join\ncad_Pessoa Pes on Pes.IdPessoa = Ppf.IdCliente\nLeft Outer Join\ncad_Pessoa Ven on Ven.IdPessoa = Ppf.IdVendedor\n/*where*/\n"
    },
    {
        "caminho": "Scripts\\Consultas\\LINHA BASE EXTRAIDA DO SISTEMA PARA FATURAMENTO - INTERTRANS - 45913(bkp).sql",
        "conteudo": "SELECT \n  Tst.Numero_Processo,\n  Tst.Responsavel_Operacional,\n  Tst.Cliente,\n  Tst.Exportador,\n  Tst.Despachante,\n  Tst.Referencia_Cliente,\n  Tst.Consignatario,\n  Tst.Booking,\n  Tst.Conf,\n  Tst.Data_Retirada_Container,\n  Tst.Local_Retirada_Container,\n  Tst.Local_Entrega_Container,\n  Tst.Numero_Container,\n  Tst.Deadline_Draft,\n  '' as Dummy_1,\n  Tst.Envio_Draft_BL,\n  Tst.Liberacao_BL,\n  Tst.Deadline_VGM,\n  '' as Dummy_2,\n  Tst.Envio_VGM,\n  Tst.Deadline_Carga,\n  '' as Dummy_3,\n  Tst.Data_Deposito_Container,\n  Tst.Numero_MBL,\n  Tst.Numero_HBL,\n  Tst.Mercadoria,\n  Tst.Navio,\n  Tst.Viagem_Navio,\n  Tst.Origem,\n  Tst.Destino,\n  Tst.Pais_Destino,\n  Tst.Via,\n  Tst.Data_Saida,\n  Tst.Fatura_Frete_Compra,\n  Tst.Fatura_Locais_Compra,\n  Tst.Dias_Em_Aberto_C,\n  Tst.Fatura_Frete_Venda,\n  Tst.Fatura_Locais_Venda,\n  Tst.Data_Chegada,\n  Tst.Aviso_Chegada,\n  Tst.Companhia_Transporte,\n  Tst.Dias_Em_Aberto_V,\n  Tst.Agente_Internacional,\n  Tst.Valor_Compra_Unitario,\n  Tst.Valor_Compra_Total,\n  Tst.Free_Detention_Compra,\n  Tst.PP_CC_PA,\n  Tst.Valor_Venda_Unitaria,\n  Tst.Valor_Venda_Total,\n  Tst.Free_Dentention_Venda,\n  Tst.Qtde_Cntr,\n  Tst.Dias_Detention,\n  Tst.Profit_USD,\n  Tst.Equipamento,\n  Tst.Frete_Agente_Pgto,\n  Tst.BL_BRL_Pagamento,\n  Tst.THC_Pagamento,\n  Tst.Total_THC_Pagamento,\n  Tst.Taxas_BRL_Pagamento,\n  Tst.Taxas_USD_Pagamento,\n  Tst.Taxas_EUR_Pagamento,\n  Tst.Total_Detention_Pgto,\n  Tst.Taxa_Cambio_USD_Pgto,\n  Tst.Total_BRL_Pagamento,\n  Tst.Data_Pagamento,\n  Tst.Frete_Agente_Rcbto,\n  Tst.BL_BRL_Recebimento,\n  Tst.THC_Recebimento,\n  Tst.Total_THC_Recebimento,\n  Tst.Taxas_BRL_Recebimento,\n  Tst.Taxas_USD_Recebimento,\n  Tst.Taxas_EUR_Recebimento,\n  Tst.Total_Detention_Rcbto,\n  Tst.Taxa_Cambio_USD_Rcbto,\n  Tst.Outras_Taxas_BRL,\n  Tst.Total_BRL_Recebimento,\n  Tst.Data_Recebimento,\n  Tst.Frete_C,\n  Tst.Locais_C,\n  Tst.Fatura,\n  Tst.Vencimento_C,\n  Tst.Frete_V,\n  Tst.Locais_V,\n  Tst.Taxas_Banco,\n  Tst.Profit_Liquido,\n  Tst.Fatura_Cliente,\n  Tst.Vencimento_V,\n  Tst.Vendedor,\n  Tst.Data_Reserva,\n  Tst.Observaçoes\nFROM \n(SELECT \n  Lhs.Data_Abertura_Processo,\n  Lhs.Numero_Processo,\n  Rsp.Nome AS Responsavel_Operacional,\n  Cli.Nome AS Cliente,\n  Exp.Nome AS Exportador,\n  Dpc.Nome AS Despachante,\n  Lhs.Referencia_Cliente,\n  Imp.Nome AS Consignatario,\n  Lms.Numero_Reserva AS Booking,\n  CASE WHEN Lms.Numero_Reserva IS NULL THEN 'NÃO' ELSE 'SIM' END Conf,\n  Lmc.Data_Retirada_Container,\n  Trr.Nome AS Local_Retirada_Container,\n  Tra.Nome AS Local_Entrega_Container,\n  Lmc.Numero_Container,\n  Drc.Valor_Data as Deadline_Draft,\n  '' AS Envio_Draft_BL,\n  CASE \n    WHEN Bil.Originals = 1 THEN 'Destino' \n    WHEN Bil.Originals = 2 THEN 'Express release' \n    WHEN Bil.Originals = 3 THEN 'Origem' \n    WHEN Bil.Originals = 4 THEN 'Sea waybill' \n    WHEN Bil.Originals = 5 THEN 'Outro' \n  END AS Liberacao_BL,\n  '' AS Deadline_VGM,\n  '' AS Envio_VGM,\n  '' AS Deadline_Carga,\n  Lmc.Data_Deposito_Container,\n  Lms.Numero_Conhecimento AS Numero_MBL,\n  Lhs.Conhecimentos AS Numero_HBL,\n  Mer.Nome AS Mercadoria,\n  Nav.Nome AS Navio,\n  Lmm.Viagem_Navio,\n  Org.Nome AS Origem,\n  Dst.Nome AS Destino,\n  Pdt.Nome AS Pais_Destino,\n  Ult.Nome AS Via,\n  Lms.Data_Embarque AS Data_Saida,\n  '' AS Fatura_Frete_Compra,\n  '' AS Fatura_Locais_Compra,\n  '' AS Dias_Em_Aberto_C,\n  '' AS Fatura_Frete_Venda,\n  '' AS Fatura_Locais_Venda,\n  Lms.Data_Desembarque AS Data_Chegada,\n  Lms.Transit_Time AS Aviso_Chegada,\n  Cia.Nome AS Companhia_Transporte,\n  '' AS Dias_Em_Aberto_V, \n  Agd.Nome AS Agente_Internacional,\n  Vlp.Valor_Pagamento_Unitario AS Valor_Compra_Unitario,\n  Vlt.Valor_Compra_Total,\n  Lmc.Free_Detention_Compra,\n  CASE \n    WHEN Lms.Modalidade_Pagamento = 1 THEN 'Collect/Prepaid'\n    WHEN Lms.Modalidade_Pagamento = 2 THEN 'Collect'\n    WHEN Lms.Modalidade_Pagamento = 3 THEN 'Prepaid'\n    WHEN Lms.Modalidade_Pagamento = 4 THEN 'Prepaid abroad'\n  END AS PP_CC_PA,\n  Vlp.Valor_Recebimento_Unitario AS Valor_Venda_Unitaria,\n  Vlt.Valor_Venda_Total,\n  Lmc.Free_Dentention_Venda,\n  Cnt.Qtde_Cntr,\n  Lmc.Dias_Detention,\n  (Vlt.Valor_Venda_Total - Vlt.Valor_Compra_Total) AS Profit_USD,\n  Eqm.Descricao AS Equipamento,\n  Fra.Valor_Compra_Total AS Frete_Agente_Pgto,\n  Lib.Valor_Compra_Total AS BL_BRL_Pagamento,\n  Thc.Valor_Pagamento_Unitario AS THC_Pagamento,\n  Thc.Valor_Compra_Total AS Total_THC_Pagamento,\n  Txs.Taxas_BRL_Pagamento,\n  Txu.Taxas_USD_Pagamento,\n  Txe.Taxas_EUR_Pagamento,\n  Lmc.Total_Detention_Pagamento AS Total_Detention_Pgto,\n  '' AS Taxa_Cambio_USD_Pgto,\n  Ttb.Total_BRL_Pagamento,\n  '' AS Data_Pagamento,\n  Frv.Valor_Venda_Total AS Frete_Agente_Rcbto,\n  Lir.Valor_Venda_Total AS BL_BRL_Recebimento,\n  Thr.Valor_Recebimento_Unitario AS THC_Recebimento,\n  Thr.Valor_Venda_Total AS Total_THC_Recebimento,\n  Txr.Taxas_BRL_Recebimento, \n  Tru.Taxas_USD_Recebimento,\n  Tre.Taxas_EUR_Recebimento,\n  Lmc.Total_Detention_Recebimento AS Total_Detention_Rcbto,\n  '' AS Taxa_Cambio_USD_Rcbto,\n  '' AS Outras_Taxas_BRL,\n  Trc.Total_BRL_Recebimento,\n  '' AS Data_Recebimento,\n  '' AS Frete_C,\n  '' AS Locais_C, \n  '' AS Fatura,\n  '' AS Vencimento_C,\n  '' AS Frete_V,\n  '' AS Locais_V, \n  '' AS Taxas_Banco,\n  (Trc.Total_BRL_Recebimento - Ttb.Total_BRL_Pagamento) AS Profit_Liquido,\n  '' AS Fatura_Cliente,\n  '' AS Vencimento_V,\n  Vnd.Nome AS Vendedor,\n  '' AS Data_Reserva,\n  Ctf.Numero_Contrato AS Observaçoes \nFROM \n  mov_Logistica_House Lhs \nLEFT OUTER JOIN \n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN \n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLEFT OUTER JOIN \n  cad_Navio Nav on Nav.IdNavio = Lmm.IdNavio\nLEFT OUTER JOIN \n  vis_Bill_Lading Bil on Bil.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN \n  mov_Contrato_Frete Ctf on Ctf.IdContrato_Frete = Lhs.IdContrato_Frete\nLEFT OUTER JOIN\n  mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Lhs.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel Par on Par.IdProjeto_Atividade = Pat.IdProjeto_Atividade And Par.IdPapel_Projeto = 2 /*OPERACIONAL*/\nLEFT OUTER JOIN \n  cad_Pessoa Rsp on Rsp.IdPessoa = Par.IdResponsavel\nLEFT OUTER JOIN \n  cad_Pessoa Cli on Cli.IdPessoa = Lhs.IdCliente\nLEFT OUTER JOIN \n  cad_Pessoa Exp on Exp.IdPessoa = Lhs.IdExportador\nLEFT OUTER JOIN \n  cad_Pessoa Dpc on Dpc.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLEFT OUTER JOIN \n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador /*Consignatário*/\nLEFT OUTER JOIN \n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN \n  (SELECT \n    ROW_NUMBER() OVER(PARTITION BY Lmc.IdLogistica_House ORDER BY Lmc.IdLogistica_Maritima_Container DESC) AS Indice,\n    Lmc.IdLogistica_House,\n    Lmc.Data_Descarga_Retirada AS Data_Retirada_Container,\n    Lmc.Number AS Numero_Container,\n    Lmc.Data_Devolucao AS Data_Deposito_Container,\n    Lmc.Free_Time_Master AS Free_Detention_Compra,\n    Lmc.Free_Time_House AS Free_Dentention_Venda,\n    DATEDIFF(DAY, Lmc.Data_Descarga_Retirada, Lmc.Data_Devolucao) + 1 AS Dias_Detention,\n    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Pagamento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_Master) AS Total_Detention_Pagamento,\n    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Recebimento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_House) AS Total_Detention_Recebimento\n  FROM\n    mov_Logistica_Maritima_Container Lmc) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House AND Lmc.Indice = 1   \nLEFT OUTER JOIN \n  cad_Pessoa Tra on Tra.IdPessoa = Lmm.IdTerminal_Atracacao\nLEFT OUTER JOIN \n  cad_Pessoa Trr on Trr.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLEFT OUTER JOIN \n  vis_Logistica_Prazo Drc On (Drc.IdLogistica_House = Lhs.IdLogistica_House) And (Drc.Identificador Like 'DEADLINE_DRAFT_CLIENTE')\nLEFT OUTER JOIN \n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN \n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLEFT OUTER JOIN \n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino \nLEFT OUTER JOIN \n  cad_Pais Pdt on Pdt.IdPais = Dst.IdPais\nLEFT OUTER JOIN \n  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Lms.IdDestino_Final\nLEFT OUTER JOIN \n  mov_Logistica_Viagem Lvg on Lvg.IdLogistica_House = Lhs.IdLogistica_House AND Lvg.Ultima_Viagem = 1 \nLEFT OUTER JOIN \n  cad_Origem_Destino Ult on Ult.IdOrigem_Destino = Lvg.IdOrigem\nLEFT OUTER JOIN \n  cad_Pessoa Cia on Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN \n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\n/*VALOR UNITARIO DA TAXA DO FRETE*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    Tle.Nome As Taxa,\n    /*PAGAMENTO*/\n    Mpg.Sigla AS Moeda_Frete_Pagamento,\n    Ltx.Valor_Pagamento_Unitario,\n    Ltx.Valor_Pagamento_Total,\n    /*RECEBIMENTO*/\n    Mrc.Sigla AS Moead_Frete_Recebimento,\n    Ltx.Valor_Recebimento_Unitario,\n    Ltx.Valor_Recebimento_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  LEFT OUTER JOIN \n    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \n  LEFT OUTER JOIN \n    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\n  LEFT OUTER JOIN \n    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\n  WHERE \n    Tle.IdTaxa_Logistica_Exibicao = 2 /*FRETE MARITIMO*/) Vlp on Vlp.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN\n   (SELECT \n    Ltx.IdLogistica_House,\n    /*PAGAMENTO*/\n    SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total,\n    /*RECEBIMENTO*/\n    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  LEFT OUTER JOIN \n    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \n  LEFT OUTER JOIN \n    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\n  LEFT OUTER JOIN \n    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\n  WHERE \n    Ltx.Origem_Taxa = 1 /*Frete*/\n  GROUP BY \n    Ltx.IdLogistica_House) Vlt on Vlt.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \n  (SELECT \n     Lmc.IdLogistica_House,\n     COUNT(Lmc.IdLogistica_Maritima_Container) AS Qtde_Cntr\n   FROM \n     mov_Logistica_Maritima_Container Lmc \n   GROUP BY \n     Lmc.IdLogistica_House) Cnt on Cnt.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN  \n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN \n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Pagar_Para = 3 /*AGENTE NO DESTINO*/\nGROUP BY \n  Ltx.IdLogistica_House) Fra on Fra.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE PAGAMENTO PARA O AGENTE NO DESTINO*/\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lib on Lib.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA LIBERAÇÃO DE BL*/ \nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thc on Thc.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA THC ORIGEM*/ \nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_BRL_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Origem_Taxa = 2 /*ORIGEM*/\n  AND Ltx.IdMoeda_Pagamento = 20 /*BRL*/\n  AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\nGROUP BY \n  Ltx.IdLogistica_House) Txs on Txs.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM BRL*/\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_USD_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Origem_Taxa = 2 /*ORIGEM*/\n  AND Ltx.IdMoeda_Pagamento = 141 /*USD*/\nGROUP BY \n  Ltx.IdLogistica_House) Txu on Txu.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM USD*/\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_EUR_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Origem_Taxa = 2 /*ORIGEM*/\n  /*AND Ltx.IdMoeda_Pagamento = 43 /*EUR*/ REQ #45683*/\nGROUP BY \n  Ltx.IdLogistica_House) Txe on Txe.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM EUR*/\nLEFT OUTER JOIN\n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Corrente) AS Total_BRL_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nGROUP BY \n  Ltx.IdLogistica_House) Ttb on Ttb.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Receber_De = 2 /*AGENTE NO DESTINO*/\n  GROUP BY \n    Ltx.IdLogistica_House) Frv on Frv.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE RECEBIMENTO PARA O AGENTE NO DESTINO*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lir on Lir.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA LIBERAÇÃO DE BL*/ \nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    Ltx.Valor_Recebimento_Unitario,\n    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thr on Thr.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA THC ORIGEM*/ \nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_BRL_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Origem_Taxa = 2 /*ORIGEM*/\n    AND Ltx.IdMoeda_Recebimento = 20 /*BRL*/\n    AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\n  GROUP BY \n    Ltx.IdLogistica_House) Txr on Txr.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM BRL*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_USD_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Origem_Taxa = 2 /*ORIGEM*/\n    AND Ltx.IdMoeda_Recebimento = 141 /*USD*/\n  GROUP BY \n    Ltx.IdLogistica_House) Tru on Tru.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM USD*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_EUR_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Origem_Taxa = 2 /*ORIGEM*/\n    /*AND Ltx.IdMoeda_Recebimento = 43 /*EUR*/ REQ #45683*/\n  GROUP BY \n    Ltx.IdLogistica_House) Tre on Tre.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIEMNTO DAS TAXAS DE ORIGEM EM EUR*/\nLEFT OUTER JOIN\n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Corrente) AS Total_BRL_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  GROUP BY \n    Ltx.IdLogistica_House) Trc on Trc.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\n  WHERE \n    Lms.Data_Embarque >= DATEADD(DAY, -30, GETDATE())\n) Tst\n/*WHERE*/\n"
    },
    {
        "caminho": "Scripts\\Consultas\\LINHA BASE EXTRAIDA DO SISTEMA PARA FATURAMENTO - INTERTRANS - 45913.sql",
        "conteudo": "SELECT \n  Tst.Numero_Processo,\n  Tst.Responsavel_Operacional,\n  Tst.Cliente,\n  Tst.Exportador,\n  Tst.Despachante,\n  Tst.Referencia_Cliente,\n  Tst.Consignatario,\n  Tst.Booking,\n  Tst.Conf,\n  Tst.Data_Retirada_Container,\n  Tst.Local_Retirada_Container,\n  Tst.Local_Entrega_Container,\n  Tst.Numero_Container,\n  Tst.Deadline_Draft,\n  '' as Dummy_1,\n  Tst.Envio_Draft_BL,\n  Tst.Liberacao_BL, /*deve buscar house*/\n  Tst.Deadline_VGM,\n  '' as Dummy_2,\n  Tst.Envio_VGM,\n  Tst.Deadline_Carga,\n  '' as Dummy_3,\n  Tst.Data_Deposito_Container,\n  Tst.Numero_MBL,\n  Tst.Numero_HBL,\n  Tst.Mercadoria,\n  Tst.Navio,\n  Tst.Viagem_Navio,\n  Tst.Origem,\n  Tst.Destino,\n  Tst.Pais_Destino,\n  Tst.Via,\n  Tst.Data_Saida,\n  Tst.Fatura_Frete_Compra,\n  Tst.Fatura_Locais_Compra,\n  Tst.Dias_Em_Aberto_C,\n  Tst.Fatura_Frete_Venda,\n  Tst.Fatura_Locais_Venda,\n  Tst.Data_Chegada,\n  Tst.Aviso_Chegada,\n  Tst.Companhia_Transporte,\n  Tst.Dias_Em_Aberto_V,\n  Tst.Agente_Internacional,\n  Tst.Valor_Compra_Unitario,\n  Tst.Valor_Compra_Total,\n  Tst.Free_Detention_Compra,\n  Tst.PP_CC_PA,\n  Tst.Valor_Venda_Unitaria,\n  Tst.Valor_Venda_Total,\n  Tst.Free_Dentention_Venda,\n  Tst.Qtde_Cntr,\n  Tst.Dias_Detention,\n  Tst.Profit_USD,\n  Tst.Equipamento,\n  Tst.Frete_Agente_Pgto,\n  Tst.BL_BRL_Pagamento,\n  Tst.THC_Pagamento,\n  Tst.Total_THC_Pagamento,\n  Tst.Taxas_BRL_Pagamento,\n  Tst.Taxas_USD_Pagamento,\n  Tst.Taxas_EUR_Pagamento,\n  Tst.Total_Detention_Pgto,\n  Tst.Taxa_Cambio_USD_Pgto,\n  Tst.Total_BRL_Pagamento,\n  Tst.Data_Pagamento,\n  Tst.Frete_Agente_Rcbto,\n  Tst.BL_BRL_Recebimento,\n  Tst.THC_Recebimento,\n  Tst.Total_THC_Recebimento,\n  Tst.Taxas_BRL_Recebimento,\n  Tst.Taxas_USD_Recebimento,\n  Tst.Taxas_EUR_Recebimento,\n  Tst.Total_Detention_Rcbto,\n  Tst.Taxa_Cambio_USD_Rcbto,\n  Tst.Outras_Taxas_BRL,\n  Tst.Total_BRL_Recebimento,\n  Tst.Data_Recebimento,\n  Tst.Frete_C,\n  Tst.Locais_C,\n  Tst.Fatura,\n  Tst.Vencimento_C,\n  Tst.Frete_V,\n  Tst.Locais_V,\n  Tst.Taxas_Banco,\n  Tst.Profit_Liquido,\n  Tst.Fatura_Cliente,\n  Tst.Vencimento_V,\n  Tst.Vendedor,\n  Tst.Data_Reserva,\n  Tst.Observaçoes\nFROM \n(SELECT \n  Lhs.Data_Abertura_Processo,\n  Lhs.Numero_Processo,\n  Rsp.Nome AS Responsavel_Operacional,\n  Cli.Nome AS Cliente,\n  Exp.Nome AS Exportador,\n  Dpc.Nome AS Despachante,\n  Lhs.Referencia_Cliente,\n  Imp.Nome AS Consignatario,\n  Lms.Numero_Reserva AS Booking,\n  CASE WHEN Lms.Numero_Reserva IS NULL THEN 'NÃO' ELSE 'SIM' END Conf,\n  Lmc.Data_Retirada_Container,\n  Trr.Nome AS Local_Retirada_Container,\n  Tra.Nome AS Local_Entrega_Container,\n  Lmc.Numero_Container,\n  Drc.Valor_Data as Deadline_Draft,\n  '' AS Envio_Draft_BL,\n  CASE \n    WHEN Bil.Originals = 1 THEN 'Destino' \n    WHEN Bil.Originals = 2 THEN 'Express release' \n    WHEN Bil.Originals = 3 THEN 'Origem' \n    WHEN Bil.Originals = 4 THEN 'Sea waybill' \n    WHEN Bil.Originals = 5 THEN 'Outro' \n  END AS Liberacao_BL,\n  '' AS Deadline_VGM,\n  '' AS Envio_VGM,\n  '' AS Deadline_Carga,\n  Lmc.Data_Deposito_Container,\n  Lms.Numero_Conhecimento AS Numero_MBL,\n  Lhs.Conhecimentos AS Numero_HBL,\n  Mer.Nome AS Mercadoria,\n  Nav.Nome AS Navio,\n  Lmm.Viagem_Navio,\n  Org.Nome AS Origem,\n  Dst.Nome AS Destino,\n  Pdt.Nome AS Pais_Destino,\n  Ult.Nome AS Via,\n  Lms.Data_Embarque AS Data_Saida,\n  '' AS Fatura_Frete_Compra,\n  '' AS Fatura_Locais_Compra,\n  '' AS Dias_Em_Aberto_C,\n  '' AS Fatura_Frete_Venda,\n  '' AS Fatura_Locais_Venda,\n  Lms.Data_Desembarque AS Data_Chegada,\n  Lms.Data_Previsao_Desembarque as Data_Previsao_Chegada, /*campo adicionado*/\n  Lms.Transit_Time AS Aviso_Chegada,\n  Cia.Nome AS Companhia_Transporte,\n  '' AS Dias_Em_Aberto_V, \n  Agd.Nome AS Agente_Internacional,\n  Vlp.Valor_Pagamento_Unitario AS Valor_Compra_Unitario,\n  Vlt.Valor_Compra_Total,\n  Lmc.Free_Detention_Compra,\n  CASE \n    WHEN Lms.Modalidade_Pagamento = 1 THEN 'Collect/Prepaid'\n    WHEN Lms.Modalidade_Pagamento = 2 THEN 'Collect'\n    WHEN Lms.Modalidade_Pagamento = 3 THEN 'Prepaid'\n    WHEN Lms.Modalidade_Pagamento = 4 THEN 'Prepaid abroad'\n  END AS PP_CC_PA,\n  Vlp.Valor_Recebimento_Unitario AS Valor_Venda_Unitaria,\n  Vlt.Valor_Venda_Total,\n  Lmc.Free_Dentention_Venda,\n  Cnt.Qtde_Cntr,\n  Lmc.Dias_Detention,\n  (Vlt.Valor_Venda_Total - Vlt.Valor_Compra_Total) AS Profit_USD,\n  Eqm.Descricao AS Equipamento,\n  Fra.Valor_Compra_Total AS Frete_Agente_Pgto,\n  Lib.Valor_Compra_Total AS BL_BRL_Pagamento,\n  Thc.Valor_Pagamento_Unitario AS THC_Pagamento,\n  Thc.Valor_Compra_Total AS Total_THC_Pagamento,\n  Txs.Taxas_BRL_Pagamento,\n  Txu.Taxas_USD_Pagamento,\n  Txe.Taxas_EUR_Pagamento,\n  Lmc.Total_Detention_Pagamento AS Total_Detention_Pgto,\n  '' AS Taxa_Cambio_USD_Pgto,\n  Ttb.Total_BRL_Pagamento,\n  '' AS Data_Pagamento,\n  Frv.Valor_Venda_Total AS Frete_Agente_Rcbto,\n  Lir.Valor_Venda_Total AS BL_BRL_Recebimento,\n  Thr.Valor_Recebimento_Unitario AS THC_Recebimento,\n  Thr.Valor_Venda_Total AS Total_THC_Recebimento,\n  Txr.Taxas_BRL_Recebimento, \n  Tru.Taxas_USD_Recebimento,\n  Tre.Taxas_EUR_Recebimento,\n  Lmc.Total_Detention_Recebimento AS Total_Detention_Rcbto,\n  '' AS Taxa_Cambio_USD_Rcbto,\n  '' AS Outras_Taxas_BRL,\n  Trc.Total_BRL_Recebimento,\n  '' AS Data_Recebimento,\n  '' AS Frete_C,\n  '' AS Locais_C, \n  '' AS Fatura,\n  '' AS Vencimento_C,\n  '' AS Frete_V,\n  '' AS Locais_V, \n  '' AS Taxas_Banco,\n  (Trc.Total_BRL_Recebimento - Ttb.Total_BRL_Pagamento) AS Profit_Liquido,\n  '' AS Fatura_Cliente,\n  '' AS Vencimento_V,\n  Vnd.Nome AS Vendedor,\n  '' AS Data_Reserva,\n  Ctf.Numero_Contrato AS Observaçoes \nFROM \n  mov_Logistica_House Lhs \nLEFT OUTER JOIN \n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN \n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLEFT OUTER JOIN \n  cad_Navio Nav on Nav.IdNavio = Lmm.IdNavio\nLEFT OUTER JOIN \n  vis_Bill_Lading Bil on Bil.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN \n  mov_Contrato_Frete Ctf on Ctf.IdContrato_Frete = Lhs.IdContrato_Frete\nLEFT OUTER JOIN\n  mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Lhs.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel Par on Par.IdProjeto_Atividade = Pat.IdProjeto_Atividade And Par.IdPapel_Projeto = 2 /*OPERACIONAL*/\nLEFT OUTER JOIN \n  cad_Pessoa Rsp on Rsp.IdPessoa = Par.IdResponsavel\nLEFT OUTER JOIN \n  cad_Pessoa Cli on Cli.IdPessoa = Lhs.IdCliente\nLEFT OUTER JOIN \n  cad_Pessoa Exp on Exp.IdPessoa = Lhs.IdExportador\nLEFT OUTER JOIN \n  cad_Pessoa Dpc on Dpc.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLEFT OUTER JOIN \n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador /*Consignatário*/\nLEFT OUTER JOIN \n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN \n  (SELECT \n    ROW_NUMBER() OVER(PARTITION BY Lmc.IdLogistica_House ORDER BY Lmc.IdLogistica_Maritima_Container DESC) AS Indice,\n    Lmc.IdLogistica_House,\n    Lmc.Data_Descarga_Retirada AS Data_Retirada_Container,\n    Lmc.Number AS Numero_Container,\n    Lmc.Data_Devolucao AS Data_Deposito_Container,\n    Lmc.Free_Time_Master AS Free_Detention_Compra,\n    Lmc.Free_Time_House AS Free_Dentention_Venda,\n    DATEDIFF(DAY, Lmc.Data_Descarga_Retirada, Lmc.Data_Devolucao) + 1 AS Dias_Detention,\n    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Pagamento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_Master) AS Total_Detention_Pagamento,\n    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Recebimento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_House) AS Total_Detention_Recebimento\n  FROM\n    mov_Logistica_Maritima_Container Lmc) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House AND Lmc.Indice = 1   \nLEFT OUTER JOIN \n  cad_Pessoa Tra on Tra.IdPessoa = Lmm.IdTerminal_Atracacao\nLEFT OUTER JOIN \n  cad_Pessoa Trr on Trr.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLEFT OUTER JOIN \n  vis_Logistica_Prazo Drc On (Drc.IdLogistica_House = Lhs.IdLogistica_House) And (Drc.Identificador Like 'DEADLINE_DRAFT_CLIENTE')\nLEFT OUTER JOIN \n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN \n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLEFT OUTER JOIN \n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino \nLEFT OUTER JOIN \n  cad_Pais Pdt on Pdt.IdPais = Dst.IdPais\nLEFT OUTER JOIN \n  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Lms.IdDestino_Final\nLEFT OUTER JOIN \n  mov_Logistica_Viagem Lvg on Lvg.IdLogistica_House = Lhs.IdLogistica_House AND Lvg.Ultima_Viagem = 1 \nLEFT OUTER JOIN \n  cad_Origem_Destino Ult on Ult.IdOrigem_Destino = Lvg.IdOrigem\nLEFT OUTER JOIN \n  cad_Pessoa Cia on Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN \n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\n/*VALOR UNITARIO DA TAXA DO FRETE*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    Tle.Nome As Taxa,\n    /*PAGAMENTO*/\n    Mpg.Sigla AS Moeda_Frete_Pagamento,\n    Ltx.Valor_Pagamento_Unitario,\n    Ltx.Valor_Pagamento_Total,\n    /*RECEBIMENTO*/\n    Mrc.Sigla AS Moead_Frete_Recebimento,\n    Ltx.Valor_Recebimento_Unitario,\n    Ltx.Valor_Recebimento_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  LEFT OUTER JOIN \n    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \n  LEFT OUTER JOIN \n    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\n  LEFT OUTER JOIN \n    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\n  WHERE \n    Tle.IdTaxa_Logistica_Exibicao = 2 /*FRETE MARITIMO*/) Vlp on Vlp.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN\n   (SELECT \n    Ltx.IdLogistica_House,\n    /*PAGAMENTO*/\n    SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total,\n    /*RECEBIMENTO*/\n    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  LEFT OUTER JOIN \n    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \n  LEFT OUTER JOIN \n    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\n  LEFT OUTER JOIN \n    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\n  WHERE \n    Ltx.Origem_Taxa = 1 /*Frete*/\n  GROUP BY \n    Ltx.IdLogistica_House) Vlt on Vlt.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \n  (SELECT \n     Lmc.IdLogistica_House,\n     COUNT(Lmc.IdLogistica_Maritima_Container) AS Qtde_Cntr\n   FROM \n     mov_Logistica_Maritima_Container Lmc \n   GROUP BY \n     Lmc.IdLogistica_House) Cnt on Cnt.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN  \n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House \nLEFT OUTER JOIN \n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Pagar_Para = 3 /*AGENTE NO DESTINO*/\nGROUP BY \n  Ltx.IdLogistica_House) Fra on Fra.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE PAGAMENTO PARA O AGENTE NO DESTINO*/\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lib on Lib.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA LIBERAÇÃO DE BL*/ \nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thc on Thc.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA THC ORIGEM*/ \nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_BRL_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Origem_Taxa = 2 /*ORIGEM*/\n  AND Ltx.IdMoeda_Pagamento = 20 /*BRL*/\n  AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\nGROUP BY \n  Ltx.IdLogistica_House) Txs on Txs.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM BRL*/\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_USD_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Origem_Taxa = 2 /*ORIGEM*/\n  AND Ltx.IdMoeda_Pagamento = 141 /*USD*/\nGROUP BY \n  Ltx.IdLogistica_House) Txu on Txu.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM USD*/\nLEFT OUTER JOIN \n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_EUR_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nWHERE \n  Ltx.Origem_Taxa = 2 /*ORIGEM*/\n  /*AND Ltx.IdMoeda_Pagamento = 43 /*EUR*/ REQ #45683*/\nGROUP BY \n  Ltx.IdLogistica_House) Txe on Txe.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM EUR*/\nLEFT OUTER JOIN\n  (SELECT \n  Ltx.IdLogistica_House,\n  SUM(Ltx.Valor_Pagamento_Corrente) AS Total_BRL_Pagamento\nFROM \n  vis_Logistica_taxa Ltx\nGROUP BY \n  Ltx.IdLogistica_House) Ttb on Ttb.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Receber_De = 2 /*AGENTE NO DESTINO*/\n  GROUP BY \n    Ltx.IdLogistica_House) Frv on Frv.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE RECEBIMENTO PARA O AGENTE NO DESTINO*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lir on Lir.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA LIBERAÇÃO DE BL*/ \nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    Ltx.Valor_Recebimento_Unitario,\n    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thr on Thr.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA THC ORIGEM*/ \nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_BRL_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Origem_Taxa = 2 /*ORIGEM*/\n    AND Ltx.IdMoeda_Recebimento = 20 /*BRL*/\n    AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\n  GROUP BY \n    Ltx.IdLogistica_House) Txr on Txr.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM BRL*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_USD_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Origem_Taxa = 2 /*ORIGEM*/\n    AND Ltx.IdMoeda_Recebimento = 141 /*USD*/\n  GROUP BY \n    Ltx.IdLogistica_House) Tru on Tru.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM USD*/\nLEFT OUTER JOIN \n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_EUR_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  WHERE \n    Ltx.Origem_Taxa = 2 /*ORIGEM*/\n    /*AND Ltx.IdMoeda_Recebimento = 43 /*EUR*/ REQ #45683*/\n  GROUP BY \n    Ltx.IdLogistica_House) Tre on Tre.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIEMNTO DAS TAXAS DE ORIGEM EM EUR*/\nLEFT OUTER JOIN\n  (SELECT \n    Ltx.IdLogistica_House,\n    SUM(Ltx.Valor_Recebimento_Corrente) AS Total_BRL_Recebimento\n  FROM \n    vis_Logistica_taxa Ltx\n  GROUP BY \n    Ltx.IdLogistica_House) Trc on Trc.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\n  WHERE \n    Lms.Data_Embarque >= DATEADD(DAY, -30, GETDATE())\n) Tst\n/*WHERE*/\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Mapeamento sistema novo.chd",
        "conteudo": "[Consulta]\n=eft Outer Join\nvis_Logistica_Prazo Pr1 on Pr1.IdLogistica_House=Lhs.IdLogistica_House and Pr1.Identificador = 'Coleta_Origem'\nvis_Logistica_Prazo Pr2 on Pr2.IdLogistica_House=Lhs.IdLogistica_House and Pr2.Identificador = 'Coleta_Destino'\",\"LEFT OUTER JOIN\",(,\"  SELECT \",\"  Lft.IdLogistica_House, \",\"  Ffn.Data_Vencimento,\",\"  Lft.Data_Faturamento,\",\"  Rfn.Data_Referencia,\",\"  Ffn.Data_Pagamento,\",\"  Sum(Ffn.Valor) Total_Valores \",\"  FROM \",\"  mov_Fatura_Financeira Ffn\",\"  LEFT OUTER JOIN\",\"    mov_Logistica_Fatura Lft ON Lft.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro and Lft.Tipo_Fatura = 1 /*Pagamento Armador*/\",\"  LEFT OUTER JOIN\",\"    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"  GROUP BY Lft.IdLogistica_House, Ffn.Data_Vencimento,Lft.Data_Faturamento,Rfn.Data_Referencia, Ffn.Data_Pagamento\",\") Prm ON Prm.IdLogistica_House = Lhs.IdLogistica_House\",\"/*TODOS OS SUBSELECT REFERENTE A ATIVIDADES, ABAIXO*/\",\"LEFT OUTER JOIN (\",SELECT ,\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Taf.Descricao AS Tarefa_Booking,\",\"  Atv.Data_Inicio AS Data_Inicio_Booking,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Booking,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Booking,\",\"  Atv.Data_Termino AS Data_Termino_Booking\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa = 361 /*SOLICITAR BOOKING*/ \",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Soc on Soc.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Taf.Descricao AS Tarefa_Draft,\",\"  Atv.Previsao_Inicio Previsao_Inicio_Draft,\",\"  Atv.Data_Inicio AS Data_Inicio_Draft,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Draft,\",\"  Atv.Data_Termino AS Data_Termino_Draft\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa = 474 /*SOLICITAR DRAFT*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Dra on Dra.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Recebimento,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Recebimento,\",\"  Atv.Data_Inicio AS Data_Inicio_Recebimento,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Recebimento,\",\"  Atv.Data_Termino AS Data_Termino_Recebimento\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  713 /*CONFIRMAR RECEBIMENTO DO DRAFT*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Crd on Crd.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Trans,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Trans,\",\"  Atv.Data_Inicio AS Data_Inicio_Trans,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Trans,\",\"  Atv.Data_Termino AS Data_Termino_Trans\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  475 /*ENVIO DO DRAFT PARA COMPANHIA DE TRANSPORTE*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Ctd on Ctd.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_VGM,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_VGM,\",\"  Atv.Data_Inicio AS Data_Inicio_VGM,\",\"  Atv.Previsao_Termino AS Previsao_Termino_VGM,\",\"  Atv.Data_Termino AS Data_Termino_VGM\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  894 /*Envio do VGM para a companhia de transporte*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Vgm on Vgm.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_DUE,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_DUE,\",\"  Atv.Data_Inicio AS Data_Inicio_DUE,\",\"  Atv.Previsao_Termino AS Previsao_Termino_DUE,\",\"  Atv.Data_Termino AS Data_Termino_DUE\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  876 /*DUE Desembaraçada*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Due on Due.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Armador,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Armador,\",\"  Atv.Data_Inicio Data_Inicio_Armador,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Armador,\",\"  Atv.Data_Termino AS Data_Termino_Armador\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  938 /*Booking Recebido do armador*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Bra on Bra.IdLogistica_House = Lhs.IdLogistica_House\",,\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Destino,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Destino,\",\"  Atv.Data_Inicio AS Data_Inicio_Destino,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Destino,\",\"  Atv.Data_Termino AS Data_Termino_Destino\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  373 /*Confirmação de desembarque no destino*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Cdd on Cdd.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Fatura,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Fatura,\",\"  Atv.Data_Inicio AS Data_Inicio_Fatura,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Fatura,\",\"  Atv.Data_Termino AS Data_Termino_Fatura\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  529 /*Faturar Processo*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Fat on Fat.IdLogistica_House = Lhs.IdLogistica_House\",\"Left Outer Join \",\"  (SELECT\",\"  Lhs.IdLogistica_House,\",\"  Lms.IdLogistica_Master,\",\"  Ori.Nome AS Porto_Transbordo,\",\"  Lmt.Data_Previsao_Chegada AS Data_Prev_Chegada_Trb,\",\"  Lmt.Data_Previsao_Embarque AS Data_Prev_Embarque_Trb,\",\"  Lmt.Data_Previsao_Desembarque AS Data_Prev_Desembarque_Trb,\",\"  Lmt.Data_Desembarque AS Data_Desembarque_Trb,\",\"  Lmt.Data_Chegada AS Data_Chegada_Trb\",FROM,\"  mov_Logistica_House Lhs\",\"Left Outer Join\",\"  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",\"Left Outer Join\",\"  mov_Logistica_Maritima_Transbordo Lmt ON Lmt.IdLogistica_Master = Lms.IdLogistica_Master\",\"Left Outer Join\",\"   cad_Origem_Destino Ori ON Ori.IdOrigem_Destino = Lmt.IdPorto_Transbordo\",\"Left Outer Join\",\"   cad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lmt.IdPorto_Desembarque) Prt ON Prt.IdLogistica_House = Lhs.IdLogistica_House /*Porto Transbordo*/\",\"/*INICIO CAMPO LIVRE*/\",\"Left Outer Join (\",\"  SELECT\",\"  Lhs.IdLogistica_House,\",\"  Mcl.Valor_Data AS Valor_Data_Dpg\",FROM,\"  mov_Campo_Livre Mcl\",\"Left Outer Join\",\"  mov_Logistica_prazo Lpz ON Lpz.IdCampo_Livre = Mcl.IdCampo_Livre\",\"Left Outer Join\",\"  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Lpz.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",Where,\"  Mcl.IdConfiguracao_Campo_Livre = 152) Dpg ON Dpg.IdLogistica_House = Lhs.IdLogistica_House /*Data Pagamento*/\",\"Left Outer Join (\",\"  SELECT\",\"  Lhs.IdLogistica_House,\",\"  Mcl.Valor_Data AS Valor_Data_Drb\",FROM,\"  mov_Campo_Livre Mcl\",\"Left Outer Join\",\"  mov_Logistica_prazo Lpz ON Lpz.IdCampo_Livre = Mcl.IdCampo_Livre\",\"Left Outer Join\",\"  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Lpz.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",Where,\"  Mcl.IdConfiguracao_Campo_Livre = 153) Drb ON Drb.IdLogistica_House = Lhs.IdLogistica_House /*Data Pagamento*/\",/*WHERE*/\nCampos=64\nCommandTextHash=212d34674a52ce9815400836d4339dbc\nCommandText=SELECT,\"\tROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"\tLhs.Data_Abertura_Processo,\",\"\tLhs.Referencia_Cliente,\",\"\tLhs.Observacao as Status,\",\"\tVnd.Nome as Vendedor,\",\"\tCli.Nome as Cliente,\",\"\tInc.Nome as Incoterm,\",\"\tAgd.Nome as Agente_Destino,\",\"\tCASE WHEN Lms.Master_Direto = 0 Then 'Não'WHEN Lms.Master_Direto = 1 Then 'Sim'END AS Master_Direto,\",\"\tLms.Numero_Conhecimento,\",\"\t(Lmh.Total_Container_20 + Lmh.Total_Container_40) AS Total_Containers,\",\"\tLmh.Equipamentos,\",\"\tCtt.Nome as Armador,\",\"\tOft.Numero_Oferta,\",\"\tLhs.Data_Validade_Taxas,\",\"\tCtf.Observacao as Contrato_Frete,\",\"\tLhs.Referencia_Interna,\",\"\tCASE WHEN Lms.Modalidade_Pagamento = 2 Then 'Collect' WHEN Lms.Modalidade_Pagamento = 3 Then 'Prepaid' WHEN Lms.Modalidade_Pagamento = 4 Then 'Prepaid Abroad' End AS Modalidade_Pagamento,\",\"\tCASE WHEN Lms.Situacao_Embarque = 0 Then 'Pré-processo' WHEN Lms.Situacao_Embarque = 1 Then 'Aguardando embarque' WHEN Lms.Situacao_Embarque = 2 Then 'Embarcado' WHEN Lms.Situacao_Embarque = 3 Then 'Desembarcado' WHEN Lms.Situacao_Embarque = 4 Then 'Cancelado' WHEN Lms.Situacao_Embarque = 5 Then 'Pendente' WHEN Lms.Situacao_Embarque = 6 Then 'Autorizado' WHEN Lms.Situacao_Embarque = 7 Then 'Coletado' WHEN Lms.Situacao_Embarque = 8 Then 'Entregue' WHEN Lms.Situacao_Embarque = 9 Then 'Aguardando prontidão da mercadoria' WHEN Lms.Situacao_Embarque = 10 Then 'Aguardando Booking' WHEN Lms.Situacao_Embarque = 11 Then 'Finalizado' WHEN Lms.Situacao_Embarque = 12 Then 'Aguardando coleta' WHEN Lms.Situacao_Embarque = 13 Then 'Aguardando entrega'End AS Situacao_Embarque,\",\"\tLms.Numero_Reserva,\",\"\tLhs.Numero_Processo,\",\"\tOrg.Nome AS Origem,\",\"\tDst.Nome AS Destino,\",\"\tNvi.Nome as Navio,\",\"\tLmm.Viagem_Navio,\",\"\tLms.Data_Previsao_Embarque,\",\"\tLms.Data_Previsao_Desembarque,\",\"\tLms.Data_Embarque,\",\"\tLms.Data_Desembarque,\",\"\tLmm.Data_CE,\",\"\tLhs.Data_Averbacao,\",\"\tLhs.Data_Entrega,\",\"\tLhs.Data_Recebimento_Local as Data_Recebimento_Fat,\",\"\tAtv.Data_Inicio as Data_Env_Conf,\",\"\tAtd.Data_Inicio as Data_Sol_G_Light,\",\"\tAte.Data_Inicio as Data_Conf_Emb_Cli,\",\"\tAta.Data_Inicio as Data_Conf_Emb_Ag,\",\"\tAti.Data_Inicio as Data_Conf_Des,\",\"\tDdc.Valor_Data as Dl_Cliente,\",\"\tDcc.Valor_Data AS Dl_Carga,\",\"\tDda.Valor_Data as Dl_Armador,\",\"\tCASE WHEN Lms.Local_Emissao = 1 THEN 'Destino' WHEN Lms.Local_Emissao = 2 THEN 'Express Release' WHEN Lms.Local_Emissao = 3 THEN 'Origem' WHEN Lms.Local_Emissao = 4 THEN 'Sea Waybill' END Local_Emissao,\",\"\tLmm.Data_CE,\",\"\tPrm.Data_Referencia,\",\"\tPrt.Porto_Transbordo,\",\"\tPrt.Data_Prev_Chegada_Trb,\",\"\tPrt.Data_Prev_Embarque_Trb,\",\"\tPrt.Data_Prev_Desembarque_Trb,\",\"\tPrt.Data_Desembarque_Trb,\",\"\tPrt.Data_Chegada_Trb,\",\"\t/*Solicitar Booking*/\",\"\tSoc.Tarefa_Booking,\",\"\tSoc.Data_Inicio_Booking,\",\"\tSoc.Data_Termino_Booking,\",\"\t/*Solicitar Draft*/\",\"\tDra.Tarefa_Draft,\",\"\tDra.Data_Inicio_Draft,\",\"\tDra.Data_Termino_Draft,\",\"\t/*CONFIRMAR RECEBIMENTO DE DRAFT*/\",\"\tCrd.Tarefa_Recebimento,\",\"\tCrd.Data_Inicio_Recebimento,\",\"\tCrd.Data_Termino_Recebimento,\",\"\t/*Envio do Draft para a companhia de transporte*/\",\"\tCtd.Tarefa_Trans,\",\"\tCtd.Data_Inicio_Trans,\",\"\tCtd.Data_Termino_Trans,\",\"\t/*Envio do VGM para a companhia de transporte*/\",\"\tVgm.Tarefa_VGM,\",\"\tVgm.Data_Inicio_VGM,\",\"\tVgm.Data_Termino_VGM,\",\"\t/*DUE Desembaraçada*/\",\"\tDue.Tarefa_DUE,\",\"\tDue.Data_Inicio_DUE,\",\"\tDue.Data_Termino_DUE,\",\"\t/*Confirmação de desembarque no destino*/\",\"\tCdd.Tarefa_Destino,\",\"\tCdd.Data_Inicio_Destino,\",\"\tCdd.Data_Termino_Destino,\",\"\t/*Booking Recebido do armador*/\",\"\tBra.Tarefa_Armador,\",\"\tBra.Data_Inicio_Armador,\",\"\tBra.Data_Termino_Armador,\",\"\t/*Faturar Processo*/\",\"\tFat.Tarefa_Fatura,\",\"\tFat.Data_Inicio_Fatura,\",\"\tFat.Data_Termino_Fatura,\",\"\t/*Valor Fixo Coleta Origem*/\",\"\tPr1.Valor_Data as Valor_Fixo_Cog ,\",\"\t/*Valor Fixo Coleta Destino*/\",\"\t Pr2.Valor_Data as Valor_Fixo_Cds,\",\"\t/*Data Pagamento*/\",\"\tDpg.Valor_Data_Dpg,\",\"\t/*Data Recebimento*/\",\"\tDrb.Valor_Data_Drb,\",\"\tLhs.Referencia_Externa,\",\"\tImp.Nome as Importador,\",\"\t/*PRAZO BOOKING*/\",\"\tETDb.Valor_Data as Booking_ETD,\",\"\tETAb.Valor_Data as Booking_ETA,\",\"\tFtr.Valor_Data as FUP_Tracking,\",\"\t/**/\",\"\tPrt.Data_Embarque_Trb,\",\"\tPrt.Data_Prev_Desembarque_Trb,\",\"\tPrt.Data_Desembarque_Trb\",,FROM,\"\tmov_Logistica_House Lhs\",\"LEFT OUTER JOIN\",\"\tmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",\"LEFT OUTER JOIN\",\"\tmov_Logistica_Moeda Lmd ON Lmd.IdLogistica_House = Lhs.IdLogistica_House AND Lmd.IdMoeda = 110\",\"LEFT OUTER JOIN\",\"\tcad_Pessoa Vnd ON Vnd.IdPessoa = Lhs.IdVendedor\",\"LEFT OUTER JOIN\",\"\tmov_Logistica_Maritima_Master Lmm ON Lmm.IdLogistica_Master = Lms.IdLogistica_Master\",\"LEFT OUTER JOIN\",\"\tmov_Logistica_Maritima_House Lmh on Lmh.IdLogistica_House= Lhs.IdLogistica_House\",\"LEFT OUTER JOIN\",\"\tcad_Empresa Emp ON Emp.IdEmpresa_Sistema = Lhs.IdEmpresa_Sistema\",\"LEFT OUTER JOIN \",\"\tcad_Pessoa Agd ON Agd.IdPessoa = Lms.IdAgente_Destino\",\"LEFT OUTER JOIN\",\"\tcad_Pessoa Eps ON Eps.IdPessoa = Emp.IdPessoa\",\"LEFT OUTER JOIN\",\"\tcad_Pessoa Imp ON Imp.IdPessoa = Lhs.IdImportador\",\"LEFT OUTER JOIN\",\"\tcad_Pessoa Cli ON Cli.IdPessoa = Lhs.IdCliente\",\"LEFT OUTER JOIN\",\"\tcad_Incoterm Inc ON Inc.IdIncoterm = Lhs.IdIncoterm\",\"LEFT OUTER JOIN\",\"\tcad_Pessoa Ctt ON Ctt.IdPessoa = Lms.IdCompanhia_Transporte\",\"LEFT OUTER JOIN\",\"\tmov_Oferta_Frete Oft ON Oft.IdOferta_Frete = Lhs.IdOferta_Frete\",\"LEFT OUTER JOIN\",\"\tmov_Contrato_Frete Ctf ON Ctf.IdContrato_Frete = Oft.IdContrato_Frete\",\"LEFT OUTER JOIN\",\"\tcad_Origem_Destino Org ON Org.IdOrigem_Destino = Lms.IdOrigem\",\"LEFT OUTER JOIN\",\"\tcad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\",\"LEFT OUTER JOIN\",\"\tcad_Navio Nvi ON Nvi.IdNavio = Lmm.IdNavio\",\"LEFT OUTER JOIN\",\"\tmov_Atividade Atv ON Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND Atv.IdTarefa = 362\",\"LEFT OUTER JOIN\",\"\tmov_Atividade Atd ON Atd.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND Atd.IdTarefa = 873\",\"LEFT OUTER JOIN\",\"\tmov_Atividade Ate ON Ate.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND Ate.IdTarefa = 365\",\"LEFT OUTER JOIN\",\"\tmov_Atividade Ata ON Ata.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND Ata.IdTarefa = 369\",\"LEFT OUTER JOIN\",\"\tmov_Atividade Ati ON Ati.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND Ati.IdTarefa = 28\",\"LEFT OUTER JOIN\",\"\tvis_Logistica_Prazo Ddc ON Ddc.IdLogistica_House = Lhs.IdLogistica_House AND Ddc.Identificador = 'Deadline_Draft_Cliente'\",\"LEFT OUTER JOIN\",\"\tvis_Logistica_Prazo Dda ON Dda.IdLogistica_House = Lhs.IdLogistica_House AND Dda.Identificador = 'DeadLine_Draft_Armador'\",\"LEFT OUTER JOIN\",\"\tvis_Logistica_Prazo Dcc ON Dcc.IdLogistica_House = Lhs.IdLogistica_House AND Dcc.Identificador = 'Deadline_Lib_Carga_Cliente'\",\"Left Outer Join\",\"    vis_Logistica_Prazo Pr1 on Pr1.IdLogistica_House = Lhs.IdLogistica_House and Pr1.Identificador = 'Coleta_Origem'\",\"Left Outer Join\",\"    vis_Logistica_Prazo Pr2 on Pr2.IdLogistica_House = Lhs.IdLogistica_House and Pr2.Identificador = 'Coleta_Destino'\",\"Left Outer Join\",\"    vis_Logistica_Prazo ETDb on ETDb.IdLogistica_House = Lhs.IdLogistica_House and ETDb.Identificador = 'ETD_Booking'\",\"Left Outer Join\",\"    vis_Logistica_Prazo ETAb on ETAb.IdLogistica_House = Lhs.IdLogistica_House and ETAb.Identificador = 'ETA_Booking'\",\"LEFT OUTER JOIN\",(,\"  SELECT \",\"  Lft.IdLogistica_House, \",\"  Ffn.Data_Vencimento,\",\"  Lft.Data_Faturamento,\",\"  Rfn.Data_Referencia,\",\"  Ffn.Data_Pagamento,\",\"  Sum(Ffn.Valor) Total_Valores \",\"  FROM \",\"  mov_Fatura_Financeira Ffn\",\"  LEFT OUTER JOIN\",\"    mov_Logistica_Fatura Lft ON Lft.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro and Lft.Tipo_Fatura = 1 /*Pagamento Armador*/\",\"  LEFT OUTER JOIN\",\"    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"  GROUP BY Lft.IdLogistica_House, Ffn.Data_Vencimento,Lft.Data_Faturamento,Rfn.Data_Referencia, Ffn.Data_Pagamento\",\") Prm ON Prm.IdLogistica_House = Lhs.IdLogistica_House\",\"/*TODOS OS SUBSELECT REFERENTE A ATIVIDADES, ABAIXO*/\",\"LEFT OUTER JOIN (\",\"\tSELECT \",\"\t  Lhs.IdLogistica_House,\",\"\t  Lhs.Numero_Processo,\",\"\t  Taf.Descricao AS Tarefa_Booking,\",\"\t  Atv.Data_Inicio AS Data_Inicio_Booking,\",\"\t  Atv.Previsao_Inicio AS Previsao_Inicio_Booking,\",\"\t  Atv.Previsao_Termino AS Previsao_Termino_Booking,\",\"\t  Atv.Data_Termino AS Data_Termino_Booking\",\"\tFROM \",\"\t  mov_Logistica_House Lhs\",\"\tleft outer join \",\"\t  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa = 361 /*SOLICITAR BOOKING*/ \",\"\tleft outer join \",\"\t  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Soc on Soc.IdLogistica_House = Lhs.IdLogistica_House\",\"\tleft outer join \",\"\t  (SELECT \",\"\t  Lhs.IdLogistica_House,\",\"\t  Lhs.Numero_Processo,\",\"\t  Taf.Descricao AS Tarefa_Draft,\",\"\t  Atv.Previsao_Inicio Previsao_Inicio_Draft,\",\"\t  Atv.Data_Inicio AS Data_Inicio_Draft,\",\"\t  Atv.Previsao_Termino AS Previsao_Termino_Draft,\",\"\t  Atv.Data_Termino AS Data_Termino_Draft\",\"\tFROM \",\"\t  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa = 474 /*SOLICITAR DRAFT*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Dra on Dra.IdLogistica_House = Lhs.IdLogistica_House\",\"Left Outer Join\",\"  mov_Conhecimento_Embarque Cem on Cem.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Recebimento,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Recebimento,\",\"  Atv.Data_Inicio AS Data_Inicio_Recebimento,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Recebimento,\",\"  Atv.Data_Termino AS Data_Termino_Recebimento\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  713 /*CONFIRMAR RECEBIMENTO DO DRAFT*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Crd on Crd.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Trans,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Trans,\",\"  Atv.Data_Inicio AS Data_Inicio_Trans,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Trans,\",\"  Atv.Data_Termino AS Data_Termino_Trans\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  475 /*ENVIO DO DRAFT PARA COMPANHIA DE TRANSPORTE*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Ctd on Ctd.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_VGM,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_VGM,\",\"  Atv.Data_Inicio AS Data_Inicio_VGM,\",\"  Atv.Previsao_Termino AS Previsao_Termino_VGM,\",\"  Atv.Data_Termino AS Data_Termino_VGM\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  894 /*Envio do VGM para a companhia de transporte*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Vgm on Vgm.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_DUE,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_DUE,\",\"  Atv.Data_Inicio AS Data_Inicio_DUE,\",\"  Atv.Previsao_Termino AS Previsao_Termino_DUE,\",\"  Atv.Data_Termino AS Data_Termino_DUE\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  876 /*DUE Desembaraçada*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Due on Due.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Armador,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Armador,\",\"  Atv.Data_Inicio Data_Inicio_Armador,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Armador,\",\"  Atv.Data_Termino AS Data_Termino_Armador\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  938 /*Booking Recebido do armador*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Bra on Bra.IdLogistica_House = Lhs.IdLogistica_House\",,\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Destino,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Destino,\",\"  Atv.Data_Inicio AS Data_Inicio_Destino,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Destino,\",\"  Atv.Data_Termino AS Data_Termino_Destino\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  373 /*Confirmação de desembarque no destino*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Cdd on Cdd.IdLogistica_House = Lhs.IdLogistica_House\",\"left outer join \",\"  (SELECT \",\"  Lhs.IdLogistica_House,\",\"  Lhs.Numero_Processo,\",\"  Atv.IdTarefa,\",\"  Taf.Descricao AS Tarefa_Fatura,\",\"  Atv.Previsao_Inicio AS Previsao_Inicio_Fatura,\",\"  Atv.Data_Inicio AS Data_Inicio_Fatura,\",\"  Atv.Previsao_Termino AS Previsao_Termino_Fatura,\",\"  Atv.Data_Termino AS Data_Termino_Fatura\",FROM ,\"  mov_Logistica_House Lhs\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade and Atv.IdTarefa =  529 /*Faturar Processo*/\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa) Fat on Fat.IdLogistica_House = Lhs.IdLogistica_House\",\"Left Outer Join(\",\"  SELECT\",\"    Lgv.IdLogistica_Viagem,\",\"    Lgv.IdLogistica_House,\",\"    Lgv.Numero_Controle,\",\"    Lgv.Numero_Conhecimento,\",\"    Lgv.Situacao_Embarque,\",\"    Lgv.Data_Previsao_Embarque as Data_Prev_Embarque_Trb,\",\"    Lgv.Data_Previsao_Desembarque as Data_Prev_Desembarque_Trb,\",\"    Nvi.Nome as Navio_Transbordo,\",\"    Lgv.Data_Embarque as Data_Embarque_Trb,\",\"    Van.Data_Previsao_Desembarque AS Data_Prev_Chegada_Trb,\",\"    Van.Data_Desembarque AS Data_Chegada,\",\"    Lgv.Viagem_Voo as Viagem,\",\"    Lgv.Data_Desembarque as Data_Desembarque_Trb,\",\"    Lgv.Data_Desembarque as Data_Chegada_Trb,\",\"    Lgv.Observacao,\",\"    Org.Nome as Porto_Transbordo,\",\"    Dst.Nome as Porto_Desembarque,\",\"    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.IdLogistica_House, Van.Data_Previsao_Desembarque Desc, Lgv.IdLogistica_Viagem)As Ranking\",\"  FROM\",\"    mov_Logistica_Viagem Lgv\",\"  JOIN\",\"    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Sequencia - 1\",\"  Left Outer Join\",\"    cad_Navio Nvi on Nvi.IdNavio = Lgv.IdNavio\",\"  Left Outer Join\",\"    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\",\"  Left Outer Join\",\"    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\",\"  Where\",\"  Lgv.Tipo_Viagem = 5 /*Transbordo Escala*/) Prt on Prt.IdLogistica_House = Lhs.IdLogistica_House And Prt.Ranking = 1\",\"/*INICIO CAMPO LIVRE*/\",\"Left Outer Join (\",\"  SELECT\",\"  Lhs.IdLogistica_House,\",\"  Mcl.Valor_Data AS Valor_Data_Dpg\",FROM,\"  mov_Campo_Livre Mcl\",\"Left Outer Join\",\"  mov_Logistica_prazo Lpz ON Lpz.IdCampo_Livre = Mcl.IdCampo_Livre\",\"Left Outer Join\",\"  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Lpz.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",Where,\"  Mcl.IdConfiguracao_Campo_Livre = 152) Dpg ON Dpg.IdLogistica_House = Lhs.IdLogistica_House /*Data Pagamento*/\",\"Left Outer Join (\",\"  SELECT\",\"  Lhs.IdLogistica_House,\",\"  Mcl.Valor_Data AS Valor_Data_Drb\",FROM,\"  mov_Campo_Livre Mcl\",\"Left Outer Join\",\"  mov_Logistica_prazo Lpz ON Lpz.IdCampo_Livre = Mcl.IdCampo_Livre\",\"Left Outer Join\",\"  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Lpz.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",Where,\"  Mcl.IdConfiguracao_Campo_Livre = 153) Drb ON Drb.IdLogistica_House = Lhs.IdLogistica_House /*Data Pagamento*/\",\"Left Outer Join\",\"    vis_Logistica_Prazo Ftr on Ftr.IdLogistica_House = Lhs.IdLogistica_House and Ftr.Identificador = 'FUP_Tracking'\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].PrimaryKey=1\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[1].FieldName=Data_Abertura_Processo\nCampo[1].DisplayLabel=Data Handover\nCampo[1].Origin=Lhs.Data_Abertura_Processo\nCampo[1].Width=100\nCampo[1].DisplayFormat=DD/MM/YYYY\nCampo[2].FieldName=Data_Termino_Booking\nCampo[2].DisplayLabel=Solicitação Booking Armador\nCampo[2].Origin=Soc.Data_Termino_Booking\nCampo[2].Width=100\nCampo[2].DisplayFormat=dd/MM/yyyy\nCampo[3].FieldName=Data_Termino_Armador\nCampo[3].DisplayLabel=Booking Recebido Armador\nCampo[3].Origin=Bra.Data_Termino_Armador\nCampo[3].Width=100\nCampo[3].DisplayFormat=dd/MM/yyyy\nCampo[4].FieldName=Data_Env_Conf\nCampo[4].DisplayLabel=Confirmação de Booking Cliente\nCampo[4].Origin=Atv.Data_Inicio\nCampo[4].DisplayFormat=dd/MM/yyyy\nCampo[4].Width=50\nCampo[5].FieldName=Referencia_Cliente\nCampo[5].DisplayLabel=Assunto/Referência do Cliente\nCampo[5].Origin=Lhs.Referencia_Cliente\nCampo[5].Width=20\nCampo[6].FieldName=Status\nCampo[6].DisplayLabel=Status\nCampo[6].Origin=Lhs.Observacao\nCampo[6].Width=120\nCampo[7].FieldName=Vendedor\nCampo[7].DisplayLabel=Vendedor\nCampo[7].Origin=Vnd.Nome\nCampo[7].Width=120\nCampo[8].FieldName=Cliente\nCampo[8].DisplayLabel=Cliente\nCampo[8].Origin=Cli.Nome\nCampo[8].Width=120\nCampo[9].FieldName=Incoterm\nCampo[9].DisplayLabel=Incoterm\nCampo[9].Origin=Inc.Nome\nCampo[9].Width=120\nCampo[10].FieldName=Master_Direto\nCampo[10].DisplayLabel=Master Direto\nCampo[10].Width=50\nCampo[10].Origin=CASE WHEN Lms.Master_Direto = 0 Then 'Não'WHEN Lms.Master_Direto = 1 Then 'Sim'END\nCampo[11].FieldName=Total_Containers\nCampo[11].DisplayLabel=Total Containers\nCampo[11].Origin=(Lmh.Total_Container_20 + Lmh.Total_Container_40)\nCampo[11].Width=200\nCampo[12].FieldName=Equipamentos\nCampo[12].DisplayLabel=Tipo de Containers\nCampo[12].Origin=Lmh.Equipamentos\nCampo[12].Width=150\nCampo[13].FieldName=Armador\nCampo[13].DisplayLabel=Armador\nCampo[13].Origin=Ctt.Nome\nCampo[13].Width=150\nCampo[14].FieldName=Referencia_Interna\nCampo[14].DisplayLabel=Proposta Armador\nCampo[14].Origin=Lhs.Referencia_Interna\nCampo[14].Width=150\nCampo[15].FieldName=Data_Validade_Taxas\nCampo[15].DisplayLabel=Validade das Taxas\nCampo[15].Origin=Lhs.Data_Validade_Taxas\nCampo[15].Width=50\nCampo[15].DisplayFormat=dd/MM/yyyy\nCampo[16].FieldName=Modalidade_Pagamento\nCampo[16].DisplayLabel=Modalidade de Pagamento\nCampo[16].Origin=CASE WHEN Lms.Modalidade_Pagamento = 2 Then 'Collect' WHEN Lms.Modalidade_Pagamento = 3 Then 'Prepaid' WHEN Lms.Modalidade_Pagamento = 4 Then 'Prepaid Abroad' End\nCampo[16].Width=100\nCampo[17].FieldName=Situacao_Embarque\nCampo[17].DisplayLabel=Situação do embarque\nCampo[17].Origin=CASE WHEN Lms.Situacao_Embarque = 0 Then 'Pré-processo' WHEN Lms.Situacao_Embarque = 1 Then 'Aguardando embarque' WHEN Lms.Situacao_Embarque = 2 Then 'Embarcado' WHEN Lms.Situacao_Embarque = 3 Then 'Desembarcado' WHEN Lms.Situacao_Embarque = 4 Then 'Cancelado' WHEN Lms.Situacao_Embarque = 5 Then 'Pendente' WHEN Lms.Situacao_Embarque = 6 Then 'Autorizado' WHEN Lms.Situacao_Embarque = 7 Then 'Coletado' WHEN Lms.Situacao_Embarque = 8 Then 'Entregue' WHEN Lms.Situacao_Embarque = 9 Then 'Aguardando prontidão da mercadoria' WHEN Lms.Situacao_Embarque = 10 Then 'Aguardando Booking' WHEN Lms.Situacao_Embarque = 11 Then 'Finalizado' WHEN Lms.Situacao_Embarque = 12 Then 'Aguardando coleta' WHEN Lms.Situacao_Embarque = 13 Then 'Aguardando entrega'End\nCampo[17].Width=100\nCampo[18].FieldName=Numero_Reserva\nCampo[18].DisplayLabel=Booking Armador\nCampo[18].Origin=Lms.Numero_Reserva\nCampo[18].Width=150\nCampo[19].FieldName=Numero_Processo\nCampo[19].DisplayLabel=Booking Exalog\nCampo[19].Origin=Lhs.Numero_Processo\nCampo[19].Width=150\nCampo[20].FieldName=Numero_Oferta\nCampo[20].DisplayLabel=Número da Oferta\nCampo[20].Origin=Oft.Numero_Oferta\nCampo[20].Width=100\nCampo[21].FieldName=Numero_Conhecimento\nCampo[21].DisplayLabel=Número MBL\nCampo[21].Origin=Lms.Numero_Conhecimento\nCampo[21].Width=150\nCampo[22].FieldName=Origem\nCampo[22].DisplayLabel=Origem\nCampo[22].Origin=Org.Nome\nCampo[22].Width=150\nCampo[23].FieldName=Destino\nCampo[23].DisplayLabel=Destino\nCampo[23].Origin=Dst.Nome\nCampo[23].Width=150\nCampo[24].FieldName=Navio\nCampo[24].DisplayLabel=Navio\nCampo[24].Origin=Nvi.Nome\nCampo[24].Width=150\nCampo[25].FieldName=Viagem_Navio\nCampo[25].DisplayLabel=Viagem\nCampo[25].Origin=Lmm.Viagem_Navio\nCampo[25].Width=150\nCampo[26].FieldName=Data_Previsao_Embarque\nCampo[26].DisplayLabel=ETD\nCampo[26].Origin=Lms.Data_Previsao_Embarque\nCampo[26].Width=150\nCampo[27].FieldName=Data_Previsao_Desembarque\nCampo[27].DisplayLabel=ETA\nCampo[27].Origin=Lms.Data_Previsao_Desembarque\nCampo[27].Width=150\nCampo[28].FieldName=Valor_Fixo_Cog\nCampo[28].DisplayLabel=Coleta/Entrega Origem\nCampo[28].Origin=Pr1.Valor_Data\nCampo[28].Width=100\nCampo[29].FieldName=Valor_Fixo_Cds\nCampo[29].DisplayLabel=Coleta/Entrega Destino\nCampo[29].Origin=Pr2.Valor_Data\nCampo[29].Width=100\nCampo[30].FieldName=Data_Termino_Draft\nCampo[30].DisplayLabel=Solicitar Draft para o cliente\nCampo[30].Origin=Dra.Data_Termino_Draft\nCampo[30].Width=100\nCampo[30].DisplayFormat=dd/MM/yyyy\nCampo[31].FieldName=Data_Termino_Recebimento\nCampo[31].DisplayLabel=Confirmar recebimento de Draft\nCampo[31].Origin=Crd.Data_Termino_Recebimento\nCampo[31].Width=100\nCampo[31].DisplayFormat=dd/MM/yyyy\nCampo[32].FieldName=Data_Termino_Trans\nCampo[32].DisplayLabel=Envio do Draft para a companhia de transporte\nCampo[32].Origin=Ctd.Data_Termino_Trans\nCampo[32].Width=100\nCampo[32].DisplayFormat=dd/MM/yyyy\nCampo[33].FieldName=Data_Termino_VGM\nCampo[33].DisplayLabel=Envio do VGM para a companhia de transporte\nCampo[33].Origin=Vgm.Data_Termino_VGM\nCampo[33].Width=100\nCampo[33].DisplayFormat=dd/MM/yyyy\nCampo[34].FieldName=Dl_Cliente\nCampo[34].DisplayLabel=DRAFT CLIENTE\nCampo[34].Origin=Ddc.Valor_Data\nCampo[34].Width=20\nCampo[34].DisplayFormat=dd/MM/yyyy HH:mm:ss\nCampo[35].FieldName=Dl_Armador\nCampo[35].DisplayLabel=DRAFT ARMADOR\nCampo[35].Origin=Dda.Valor_Data\nCampo[35].Width=20\nCampo[35].DisplayFormat=dd/MM/yyyy HH:mm:ss\nCampo[36].FieldName=Dl_Carga\nCampo[36].DisplayLabel=Dead Line de Carga\nCampo[36].Origin=Dcc.Valor_Data\nCampo[36].Width=150\nCampo[37].FieldName=Data_Termino_DUE\nCampo[37].DisplayLabel=DUE desembaraçada\nCampo[37].Origin=Due.Data_Termino_DUE\nCampo[37].Width=100\nCampo[37].DisplayFormat=dd/MM/yyyy\nCampo[38].FieldName=Data_Sol_G_Light\nCampo[38].DisplayLabel=Pré Alerta\nCampo[38].Origin=Atd.Data_Inicio\nCampo[38].Width=50\nCampo[38].DisplayFormat=dd/MM/yyyy\nCampo[39].FieldName=Data_Embarque\nCampo[39].DisplayLabel=Data de Embarque\nCampo[39].Origin=Lms.Data_Embarque\nCampo[39].Width=100\nCampo[39].DisplayFormat=dd/MM/yyyy\nCampo[40].FieldName=Data_Conf_Emb_Cli\nCampo[40].DisplayLabel=Confirmação de Embarque Cliente\nCampo[40].Origin=Ate.Data_Inicio\nCampo[40].Width=50\nCampo[40].DisplayFormat=dd/MM/yyyy\nCampo[41].FieldName=Data_Termino_Fatura\nCampo[41].DisplayLabel=Faturar o Processo\nCampo[41].Origin=Fat.Data_Termino_Fatura\nCampo[41].Width=100\nCampo[41].DisplayFormat=dd/MM/yyyy\nCampo[42].FieldName=Valor_Data_Dpg\nCampo[42].DisplayLabel=Data Pagamento\nCampo[42].Origin=Dpg.Valor_Data_Dpg\nCampo[42].Width=100\nCampo[42].DisplayFormat=dd/mm/yyyy\nCampo[43].FieldName=Valor_Data_Drb\nCampo[43].DisplayLabel=Data Recebimento\nCampo[43].Origin=Drb.Valor_Data_Drb\nCampo[43].Width=100\nCampo[43].DisplayFormat=dd/mm/yyyy\nCampo[44].FieldName=Data_Conf_Emb_Ag\nCampo[44].DisplayLabel=Pré Alerta Destino\nCampo[44].Origin=Ata.Data_Inicio\nCampo[44].Width=50\nCampo[44].DisplayFormat=dd/MM/yyyy\nCampo[45].FieldName=Data_CE\nCampo[45].DisplayLabel=Seawaybil/Original\nCampo[45].Origin=Lmm.Data_CE\nCampo[45].Width=50\nCampo[45].DisplayFormat=dd/MM/yyyy\nCampo[46].FieldName=Local_Emissao\nCampo[46].DisplayLabel=Seawaybil/Original\nCampo[46].Origin=CASE WHEN Lms.Local_Emissao = 1 THEN 'Destino' WHEN Lms.Local_Emissao = 2 THEN 'Express Release' WHEN Lms.Local_Emissao = 3 THEN 'Origem' WHEN Lms.Local_Emissao = 4 THEN 'Sea Waybill' END\nCampo[46].Width=150\nCampo[47].FieldName=Porto_Transbordo\nCampo[47].DisplayLabel=Porto de Transbordo\nCampo[47].Origin=Prt.Porto_Transbordo\nCampo[47].Width=100\nCampo[48].FieldName=Data_Prev_Chegada_Trb\nCampo[48].DisplayLabel=Previsão de chegada Transbordo\nCampo[48].Origin=Prt.Data_Prev_Chegada_Trb\nCampo[48].Width=150\nCampo[49].FieldName=Data_Chegada_Trb\nCampo[49].DisplayLabel=Data Chegada do Transbordo\nCampo[49].Origin=Prt.Data_Chegada_Trb\nCampo[49].Width=150\nCampo[50].FieldName=Data_Prev_Embarque_Trb\nCampo[50].DisplayLabel=Previsao de embarque transbordo\nCampo[50].Origin=Prt.Data_Prev_Embarque_Trb\nCampo[50].Width=150\nCampo[51].FieldName=Data_Embarque_Trb\nCampo[51].DisplayLabel=Data Embarque Transbordo\nCampo[51].Origin=Prt.Data_Embarque_Trb\nCampo[51].Width=150\nCampo[52].FieldName=Data_Prev_Desembarque_Trb\nCampo[52].DisplayLabel=Data Previsão Desembarque Transbordo\nCampo[52].Origin=Prt.Data_Prev_Desembarque_Trb\nCampo[52].Width=150\nCampo[53].FieldName=Data_Desembarque_Trb\nCampo[53].DisplayLabel=Data Desembarque Transbordo\nCampo[53].Origin=Prt.Data_Desembarque_Trb\nCampo[53].Width=150\nCampo[54].FieldName=Data_Desembarque\nCampo[54].DisplayLabel=Data de Desembarque\nCampo[54].Origin=Lms.Data_Desembarque\nCampo[54].Width=100\nCampo[54].DisplayFormat=dd/MM/yyyy\nCampo[55].FieldName=Data_Termino_Destino\nCampo[55].DisplayLabel=Confirmação de desembarque no destino\nCampo[55].Origin=Cdd.Data_Termino_Destino\nCampo[55].Width=100\nCampo[55].DisplayFormat=dd/MM/yyyy\nCampo[56].FieldName=Data_Entrega\nCampo[56].DisplayLabel=Data de Entrega Carga no Destino\nCampo[56].Origin=Lhs.Data_Entrega\nCampo[56].Width=100\nCampo[56].DisplayFormat=dd/MM/yyyy\nCampo[57].FieldName=Data_Averbacao\nCampo[57].DisplayLabel=Data Averbação\nCampo[57].Origin=Lhs.Data_Averbacao\nCampo[57].Width=100\nCampo[57].DisplayFormat=dd/mm/yyyy\nCampo[58].FieldName=Agente_Destino\nCampo[58].DisplayLabel=Agente no Destino\nCampo[58].Origin=Agd.Nome\nCampo[58].Width=100\nCampo[59].FieldName=Referencia_Externa\nCampo[59].DisplayLabel=Referencia_Externa\nCampo[59].Origin=Lhs.Referencia_Externa\nCampo[59].Width=100\nCampo[60].FieldName=Importador\nCampo[60].DisplayLabel=Importador\nCampo[60].Origin=Imp.Nome\nCampo[60].Width=120\nCampo[61].FieldName=Booking_ETD\nCampo[61].DisplayLabel=ETD Booking\nCampo[61].Origin=ETDb.Valor_Data\nCampo[61].Width=100\nCampo[61].DisplayFormat=dd/mm/yyyy\nCampo[62].FieldName=Booking_ETA\nCampo[62].DisplayLabel=ETA Booking\nCampo[62].Origin=ETAb.Valor_Data\nCampo[62].Width=100\nCampo[62].DisplayFormat=dd/mm/yyyy\nCampo[63].FieldName=FUP_Tracking\nCampo[63].DisplayLabel=FUP Tracking\nCampo[63].Origin=Ftr.Valor_Data\nCampo[63].Width=100\nCampo[63].DisplayFormat=dd/mm/yyyy\n\n[FieldDefs]\nCount=89\nItems[0].Name=Indice\nItems[0].DataType=ftLargeint\nItems[0].Precision=0\nItems[0].Size=0\nItems[1].Name=Data_Abertura_Processo\nItems[1].DataType=ftDateTime\nItems[1].Precision=0\nItems[1].Size=0\nItems[2].Name=Referencia_Cliente\nItems[2].DataType=ftString\nItems[2].Precision=0\nItems[2].Size=400\nItems[3].Name=Status\nItems[3].DataType=ftMemo\nItems[3].Precision=0\nItems[3].Size=0\nItems[4].Name=Vendedor\nItems[4].DataType=ftString\nItems[4].Precision=0\nItems[4].Size=75\nItems[5].Name=Cliente\nItems[5].DataType=ftString\nItems[5].Precision=0\nItems[5].Size=75\nItems[6].Name=Incoterm\nItems[6].DataType=ftString\nItems[6].Precision=0\nItems[6].Size=50\nItems[7].Name=Agente_Destino\nItems[7].DataType=ftString\nItems[7].Precision=0\nItems[7].Size=75\nItems[8].Name=Master_Direto\nItems[8].DataType=ftString\nItems[8].Precision=0\nItems[8].Size=3\nItems[9].Name=Numero_Conhecimento\nItems[9].DataType=ftString\nItems[9].Precision=0\nItems[9].Size=50\nItems[10].Name=Total_Containers\nItems[10].DataType=ftSmallint\nItems[10].Precision=0\nItems[10].Size=0\nItems[11].Name=Equipamentos\nItems[11].DataType=ftMemo\nItems[11].Precision=0\nItems[11].Size=0\nItems[12].Name=Armador\nItems[12].DataType=ftString\nItems[12].Precision=0\nItems[12].Size=75\nItems[13].Name=Numero_Oferta\nItems[13].DataType=ftString\nItems[13].Precision=0\nItems[13].Size=50\nItems[14].Name=Data_Validade_Taxas\nItems[14].DataType=ftDateTime\nItems[14].Precision=0\nItems[14].Size=0\nItems[15].Name=Contrato_Frete\nItems[15].DataType=ftMemo\nItems[15].Precision=0\nItems[15].Size=0\nItems[16].Name=Referencia_Interna\nItems[16].DataType=ftString\nItems[16].Precision=0\nItems[16].Size=25\nItems[17].Name=Modalidade_Pagamento\nItems[17].DataType=ftString\nItems[17].Precision=0\nItems[17].Size=14\nItems[18].Name=Situacao_Embarque\nItems[18].DataType=ftString\nItems[18].Precision=0\nItems[18].Size=34\nItems[19].Name=Numero_Reserva\nItems[19].DataType=ftString\nItems[19].Precision=0\nItems[19].Size=25\nItems[20].Name=Numero_Processo\nItems[20].DataType=ftString\nItems[20].Precision=0\nItems[20].Size=25\nItems[21].Name=Origem\nItems[21].DataType=ftString\nItems[21].Precision=0\nItems[21].Size=50\nItems[22].Name=Destino\nItems[22].DataType=ftString\nItems[22].Precision=0\nItems[22].Size=50\nItems[23].Name=Navio\nItems[23].DataType=ftString\nItems[23].Precision=0\nItems[23].Size=50\nItems[24].Name=Viagem_Navio\nItems[24].DataType=ftString\nItems[24].Precision=0\nItems[24].Size=25\nItems[25].Name=Data_Previsao_Embarque\nItems[25].DataType=ftDateTime\nItems[25].Precision=0\nItems[25].Size=0\nItems[26].Name=Data_Previsao_Desembarque\nItems[26].DataType=ftDateTime\nItems[26].Precision=0\nItems[26].Size=0\nItems[27].Name=Data_Embarque\nItems[27].DataType=ftDateTime\nItems[27].Precision=0\nItems[27].Size=0\nItems[28].Name=Data_Desembarque\nItems[28].DataType=ftDateTime\nItems[28].Precision=0\nItems[28].Size=0\nItems[29].Name=Data_CE\nItems[29].DataType=ftDateTime\nItems[29].Precision=0\nItems[29].Size=0\nItems[30].Name=Data_Averbacao\nItems[30].DataType=ftDateTime\nItems[30].Precision=0\nItems[30].Size=0\nItems[31].Name=Data_Entrega\nItems[31].DataType=ftDateTime\nItems[31].Precision=0\nItems[31].Size=0\nItems[32].Name=Data_Recebimento_Fat\nItems[32].DataType=ftDateTime\nItems[32].Precision=0\nItems[32].Size=0\nItems[33].Name=Data_Env_Conf\nItems[33].DataType=ftDateTime\nItems[33].Precision=0\nItems[33].Size=0\nItems[34].Name=Data_Sol_G_Light\nItems[34].DataType=ftDateTime\nItems[34].Precision=0\nItems[34].Size=0\nItems[35].Name=Data_Conf_Emb_Cli\nItems[35].DataType=ftDateTime\nItems[35].Precision=0\nItems[35].Size=0\nItems[36].Name=Data_Conf_Emb_Ag\nItems[36].DataType=ftDateTime\nItems[36].Precision=0\nItems[36].Size=0\nItems[37].Name=Data_Conf_Des\nItems[37].DataType=ftDateTime\nItems[37].Precision=0\nItems[37].Size=0\nItems[38].Name=Dl_Cliente\nItems[38].DataType=ftDateTime\nItems[38].Precision=0\nItems[38].Size=0\nItems[39].Name=Dl_Carga\nItems[39].DataType=ftDateTime\nItems[39].Precision=0\nItems[39].Size=0\nItems[40].Name=Dl_Armador\nItems[40].DataType=ftDateTime\nItems[40].Precision=0\nItems[40].Size=0\nItems[41].Name=Local_Emissao\nItems[41].DataType=ftString\nItems[41].Precision=0\nItems[41].Size=15\nItems[42].Name=Data_CE_1\nItems[42].DataType=ftDateTime\nItems[42].Precision=0\nItems[42].Size=0\nItems[43].Name=Data_Referencia\nItems[43].DataType=ftDateTime\nItems[43].Precision=0\nItems[43].Size=0\nItems[44].Name=Porto_Transbordo\nItems[44].DataType=ftString\nItems[44].Precision=0\nItems[44].Size=50\nItems[45].Name=Data_Prev_Chegada_Trb\nItems[45].DataType=ftDateTime\nItems[45].Precision=0\nItems[45].Size=0\nItems[46].Name=Data_Prev_Embarque_Trb\nItems[46].DataType=ftDateTime\nItems[46].Precision=0\nItems[46].Size=0\nItems[47].Name=Data_Prev_Desembarque_Trb\nItems[47].DataType=ftDateTime\nItems[47].Precision=0\nItems[47].Size=0\nItems[48].Name=Data_Desembarque_Trb\nItems[48].DataType=ftDateTime\nItems[48].Precision=0\nItems[48].Size=0\nItems[49].Name=Data_Chegada_Trb\nItems[49].DataType=ftDateTime\nItems[49].Precision=0\nItems[49].Size=0\nItems[50].Name=Tarefa_Booking\nItems[50].DataType=ftString\nItems[50].Precision=0\nItems[50].Size=200\nItems[51].Name=Data_Inicio_Booking\nItems[51].DataType=ftDateTime\nItems[51].Precision=0\nItems[51].Size=0\nItems[52].Name=Data_Termino_Booking\nItems[52].DataType=ftDateTime\nItems[52].Precision=0\nItems[52].Size=0\nItems[53].Name=Tarefa_Draft\nItems[53].DataType=ftString\nItems[53].Precision=0\nItems[53].Size=200\nItems[54].Name=Data_Inicio_Draft\nItems[54].DataType=ftDateTime\nItems[54].Precision=0\nItems[54].Size=0\nItems[55].Name=Data_Termino_Draft\nItems[55].DataType=ftDateTime\nItems[55].Precision=0\nItems[55].Size=0\nItems[56].Name=Tarefa_Recebimento\nItems[56].DataType=ftString\nItems[56].Precision=0\nItems[56].Size=200\nItems[57].Name=Data_Inicio_Recebimento\nItems[57].DataType=ftDateTime\nItems[57].Precision=0\nItems[57].Size=0\nItems[58].Name=Data_Termino_Recebimento\nItems[58].DataType=ftDateTime\nItems[58].Precision=0\nItems[58].Size=0\nItems[59].Name=Tarefa_Trans\nItems[59].DataType=ftString\nItems[59].Precision=0\nItems[59].Size=200\nItems[60].Name=Data_Inicio_Trans\nItems[60].DataType=ftDateTime\nItems[60].Precision=0\nItems[60].Size=0\nItems[61].Name=Data_Termino_Trans\nItems[61].DataType=ftDateTime\nItems[61].Precision=0\nItems[61].Size=0\nItems[62].Name=Tarefa_VGM\nItems[62].DataType=ftString\nItems[62].Precision=0\nItems[62].Size=200\nItems[63].Name=Data_Inicio_VGM\nItems[63].DataType=ftDateTime\nItems[63].Precision=0\nItems[63].Size=0\nItems[64].Name=Data_Termino_VGM\nItems[64].DataType=ftDateTime\nItems[64].Precision=0\nItems[64].Size=0\nItems[65].Name=Tarefa_DUE\nItems[65].DataType=ftString\nItems[65].Precision=0\nItems[65].Size=200\nItems[66].Name=Data_Inicio_DUE\nItems[66].DataType=ftDateTime\nItems[66].Precision=0\nItems[66].Size=0\nItems[67].Name=Data_Termino_DUE\nItems[67].DataType=ftDateTime\nItems[67].Precision=0\nItems[67].Size=0\nItems[68].Name=Tarefa_Destino\nItems[68].DataType=ftString\nItems[68].Precision=0\nItems[68].Size=200\nItems[69].Name=Data_Inicio_Destino\nItems[69].DataType=ftDateTime\nItems[69].Precision=0\nItems[69].Size=0\nItems[70].Name=Data_Termino_Destino\nItems[70].DataType=ftDateTime\nItems[70].Precision=0\nItems[70].Size=0\nItems[71].Name=Tarefa_Armador\nItems[71].DataType=ftString\nItems[71].Precision=0\nItems[71].Size=200\nItems[72].Name=Data_Inicio_Armador\nItems[72].DataType=ftDateTime\nItems[72].Precision=0\nItems[72].Size=0\nItems[73].Name=Data_Termino_Armador\nItems[73].DataType=ftDateTime\nItems[73].Precision=0\nItems[73].Size=0\nItems[74].Name=Tarefa_Fatura\nItems[74].DataType=ftString\nItems[74].Precision=0\nItems[74].Size=200\nItems[75].Name=Data_Inicio_Fatura\nItems[75].DataType=ftDateTime\nItems[75].Precision=0\nItems[75].Size=0\nItems[76].Name=Data_Termino_Fatura\nItems[76].DataType=ftDateTime\nItems[76].Precision=0\nItems[76].Size=0\nItems[77].Name=Valor_Fixo_Cog\nItems[77].DataType=ftDateTime\nItems[77].Precision=0\nItems[77].Size=0\nItems[78].Name=Valor_Fixo_Cds\nItems[78].DataType=ftDateTime\nItems[78].Precision=0\nItems[78].Size=0\nItems[79].Name=Valor_Data_Dpg\nItems[79].DataType=ftDateTime\nItems[79].Precision=0\nItems[79].Size=0\nItems[80].Name=Valor_Data_Drb\nItems[80].DataType=ftDateTime\nItems[80].Precision=0\nItems[80].Size=0\nItems[81].Name=Referencia_Externa\nItems[81].DataType=ftString\nItems[81].Precision=0\nItems[81].Size=50\nItems[82].Name=Importador\nItems[82].DataType=ftString\nItems[82].Precision=0\nItems[82].Size=75\nItems[83].Name=Booking_ETD\nItems[83].DataType=ftDateTime\nItems[83].Precision=0\nItems[83].Size=0\nItems[84].Name=Booking_ETA\nItems[84].DataType=ftDateTime\nItems[84].Precision=0\nItems[84].Size=0\nItems[85].Name=FUP_Tracking\nItems[85].DataType=ftDateTime\nItems[85].Precision=0\nItems[85].Size=0\nItems[86].Name=Data_Embarque_Trb\nItems[86].DataType=ftDateTime\nItems[86].Precision=0\nItems[86].Size=0\nItems[87].Name=Data_Prev_Desembarque_Trb_1\nItems[87].DataType=ftDateTime\nItems[87].Precision=0\nItems[87].Size=0\nItems[88].Name=Data_Desembarque_Trb_1\nItems[88].DataType=ftDateTime\nItems[88].Precision=0\nItems[88].Size=0\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Pedir senha para clientes, importadores e exportadores.sql",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 4 /*SOLICITAR SENHA*/\n    WHEN Bloqueado = 2 THEN 4 /*SOLICITAR SENHA*/\n    WHEN Bloqueado = 3 THEN 4 /*SOLICITAR SENHA*/\n    ELSE 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN '[#43999] Cliente'+CHAR(10)+Cast(Blq.Cliente as varchar(max))+CHAR(10)+'precisa de aprovação para seguir com o processo, checar com a gerência.'\n    WHEN Bloqueado = 2 THEN '[#43999] Importador'+CHAR(10)+Cast(Blq.Importador as varchar(max))+CHAR(10)+'precisa de aprovação para seguir com o processo, checar com a gerência.'\n    WHEN Bloqueado = 3 THEN '[#43999] Cliente/Importador'+CHAR(10)+Cast(Blq.Cliente as varchar(max))+CHAR(10)+'precisa de aprovação para seguir com o processo, checar com a gerência.'\n    ELSE null\n  END as varchar(MAX))\nFROM (\n  SELECT\n    CAST(CASE\n      WHEN Prm.Situacao = 2\n      and ISNULL(Pfr.Situacao, 0) &lt;&gt; 2\n      and (Pfr.IdCliente in (54495/*BELL VALLEY*/, 56376/*SS IMPORTACAO*/, 64549 /*IQBC PRODUTOS*/, 67645 /*MONDO CHILE*/, 68933 /*SEI DO BRASI*/)\n      and COALESCE(Ofr.IdImportador, 0) not in (54495/*BELL VALLEY*/, 56376/*SS IMPORTACAO*/, 64549 /*IQBC PRODUTOS*/, 67645 /*MONDO CHILE*/, 68933 /*SEI DO BRASI*/)) THEN 1 /*CLIENTE*/\n      WHEN Prm.Situacao = 2\n      and ISNULL(Pfr.Situacao, 0) &lt;&gt; 2\n      and (COALESCE(Ofr.IdImportador, 0) in (54495/*BELL VALLEY*/, 56376/*SS IMPORTACAO*/, 64549 /*IQBC PRODUTOS*/, 67645 /*MONDO CHILE*/, 68933 /*SEI DO BRASI*/)\n      and Pfr.IdCliente not in (54495/*BELL VALLEY*/, 56376/*SS IMPORTACAO*/, 64549 /*IQBC PRODUTOS*/, 67645 /*MONDO CHILE*/, 68933 /*SEI DO BRASI*/)) THEN 2 /*IMPORTADOR*/\n      WHEN Prm.Situacao = 2\n      and ISNULL(Pfr.Situacao, 0) &lt;&gt; 2\n      and (COALESCE(Ofr.IdImportador, 0) in (54495/*BELL VALLEY*/, 56376/*SS IMPORTACAO*/, 64549 /*IQBC PRODUTOS*/, 67645 /*MONDO CHILE*/, 68933 /*SEI DO BRASI*/)\n      and Pfr.IdCliente in (54495/*BELL VALLEY*/, 56376/*SS IMPORTACAO*/, 64549 /*IQBC PRODUTOS*/, 67645 /*MONDO CHILE*/, 68933 /*SEI DO BRASI*/)) THEN 3 /*CLIENTE E IMPORTADOR*/\n      ELSE 0\n    END as int) as Bloqueado,\n    Cli.Nome as Cliente,\n    Imp.Nome as Importador\n  FROM (\n    SELECT\n      Prm.value('Item[@Nome=\"IdProposta_Frete\"][1]/@Value', 'int') as IdProposta_Frete,\n\t    Prm.value('Item[@Nome=\"Situacao\"][1]/@Value', 'int') as Situacao\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n) Prm\nLEFT OUTER JOIN\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Prm.IdProposta_Frete\nLEFT OUTER JOIN\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Prm.IdProposta_Frete\nLEFT OUTER JOIN\n  cad_Pessoa Cli on Cli.IdPessoa = Pfr.IdCliente\nLEFT OUTER JOIN\n  cad_Pessoa Imp on Imp.IdPessoa = Ofr.IdImportador\n) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Consultas\\Por tonelada.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then /*case When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else*/ '% sobre importância segurada' /*end*/\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'per Process'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'per KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'per KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'per KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'per CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'per HAWB' When 2 then 'per HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'per Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'per Volum'\n        When Oft.Tipo_Recebimento = 10 Then 'per CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'per ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'per TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'by percentage'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 17 Then \n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'per KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'per w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'per Ton' \n                Else ' per Ton or w/m' \n              End \n            Else 'por Ton or w/m' \n          End\n  end as Tipo_Recebimento_escrito_ingles,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then \n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End,Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>\n  "
    },
    {
        "caminho": "Scripts\\Consultas\\python criar_exe.py",
        "conteudo": "import PyInstaller.__main__\nimport customtkinter\nimport os\n\n# 1. Pega o caminho onde o customtkinter está instalado no seu PC\n# Isso é necessário para incluir os temas e imagens da biblioteca no executável\ncaminho_ctk = os.path.dirname(customtkinter.__file__)\n\n# 2. Configura e roda o PyInstaller\nprint(\"Iniciando a criação do executável...\")\n\nPyInstaller.__main__.run([\n    'buscador.py',                          # Nome do seu arquivo principal\n    '--name=ScriptHunter',                  # Nome que o .exe terá\n    '--onefile',                            # Cria um arquivo único (.exe) em vez de uma pasta cheia de coisas\n    '--noconsole',                          # Não mostra aquela janela preta de terminal ao abrir\n    f'--add-data={caminho_ctk};customtkinter', # Copia os dados do customtkinter (Essencial no Windows)\n    '--clean',                              # Limpa arquivos temporários antigos\n])\n\nprint(\"\\n\\n✅ SUCESSO! Seu executável foi criado.\")\nprint(\"👉 Verifique a pasta 'dist' que apareceu no seu projeto.\")"
    },
    {
        "caminho": "Scripts\\Consultas\\RELATÓRIO CONSOLIDADA #45519.sql",
        "conteudo": "Select\n  ROW_NUMBER() OVER(ORDER BY @@ROWCOUNT) AS Indice,\n  Cli.Nome as Cliente,\n  Lhs.Numero_Processo,\n  Lhs.Data_Abertura_Processo,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Ago.Nome as Agente_Origem,\n  Agd.Nome as Agente_Destino,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Bruto,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Case Lah.Tipo_Servico_Aereo When 0 Then '(Não informado)' When 1 Then 'Back to Back' When 2 Then 'Consolidado' End as Tipo_Servico,\n  Nvs.Descricao as Nivel_Servico,\n  Case Lhs.Situacao_Agenciamento When 1 Then 'Processo aberto' When 2 Then 'Em andamento' When 3 Then 'Liberado faturamento' When 4 Then 'Faturado' When 5 Then 'Auditado' When 6 Then 'Finalizado' When 7 Then 'Cancelado' End as Situacao_Agenciamento,\n  Lhs.Data_Coleta,\n  Lhs.Data_Entrega\nFrom\n  mov_Logistica_House Lhs \nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Cli on Cli.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  mov_Logistica_Aerea_House Lah on Lah.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Nivel_Servico_Aereo Nvs on Nvs.IdNivel_Servico_Aereo = Lah.IdNivel_Servico_Aereo\n/*WHERE*/\nWhere\n  Year(Lhs.Data_Abertura_Processo) >= 2023 \nAnd \n  (Lms.Modalidade_Processo = 1 /*AÉREO*/ and Lms.Tipo_Operacao = 2 /*IMPO*/)\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Solicitar coleta(EA) TEX.sql",
        "conteudo": "Select DISTINCT\n    Atv.IdAtividade,\n    Lhs.IdLogistica_House,\n    Lms.IdLogistica_Master,\n    CAST(Lhs.Local_Coleta AS VARCHAR(MAX)) AS Local_Coleta,\n    CAST(Lhs.Local_Entrega_Origem AS VARCHAR(MAX)) AS Local_Entrega,\n    Lhs.Data_Coleta as Data_Coleta,\n    Lhs.Data_Entrega_Origem as Chegada,\n    CASE Lgv.Tipo_Servico \n        WHEN 2 THEN 'Dedicado / Consolidado / Cabotagem / Rodizio' \n        WHEN 1 THEN 'Back to back / Transbordo' \n        WHEN 0 THEN '(Não informado)' \n    END as Tipo_Servico,\n    CAST(Mer.Nome AS VARCHAR(MAX)) as Mercadoria,\n    CAST(Moe.Nome AS VARCHAR(MAX)) as Moeda,\n    Lhs.Metros_Cubicos,\n    Lhs.Quantidade_Volumes,\n    Lhs.Valor_Mercadoria,\n    Lhs.Importancia_Segurada,\n    CASE Lhs.Seguro WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Seguro,\n    CASE Lhs.Carga_Perigosa WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Carga_Perigosa,\n    Lah.Peso_taxado,\n    Lhs.Peso_Bruto,\n    Lhs.Numero_Processo,\n    Lgp.Valor_Data as Deadline\nFROM\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_House Lah ON Lah.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Mercadoria Mer ON Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN\n    cad_Moeda Moe ON Moe.IdMoeda = Lhs.IdMoeda_Mercadoria\nLEFT OUTER JOIN\nvis_logistica_prazo Lgp ON Lgp.IdLogistica_House = Lhs.IdLogistica_House and Lgp.IdConfiguracao_Campo_Livre = 141\nWHERE\nAtv.IdAtividade = 1511981\n\n\nSelect\n    CAST(Tmb.Nome AS VARCHAR(MAX)) as Embalagemm,\n    Lgm.Quantidade as Quantidade_Emb,\n    Lgm.Altura as Altura_Emb,\n    Lgm.Largura as Largura_Emb,\n    Lgm.Comprimento as Comprimento_Emb,\n    Lgm.Metros_Cubicos as Met_Cub_Emb,\n    Lgm.Peso_Liquido as Peso_Liq_Emb,\n    Lgm.Peso_Bruto as Peso_But_Emb,\n    Lgm.Peso_Cubado as Peso_Cub_Emb\nFROM\n    mov_Atividade Atv\nJOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJOIN\n    mov_Logistica_Embalagem Lgm ON Lgm.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Tipo_Embalagem Tmb ON Tmb.IdTipo_Embalagem = Lgm.IdTipo_Embalagem\nWHERE\n    Atv.IdAtividade =1511981\n\n\n\n\n\n\n\n\n    Select\n    Lte.Nome as Taxa_Nome,\n    Mop.Sigla as Moeda,\n    Ltx.Valor_Pagamento_Unitario as Valor_Unitario,\n    SUM(Ltx.Valor_Pagamento_Unitario) OVER() as Total_Pagamento_Unitario,\n     SUM(Ltx.Valor_Pagamento_Total) OVER() as Total_Pagamento_Total,\n    Ltx.valor_Pagamento_Minimo as Valor_Minimo,\n    Txl.Tipo\nFROM\n    mov_Atividade Atv\nJOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJOIN\n    mov_Logistica_Taxa Ltx ON Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLEFT JOIN\n    cad_Taxa_Logistica_Exibicao Lte ON Lte.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLEFT JOIN\n    cad_Moeda Mop ON Mop.IdMoeda = Ltx.IdMoeda_Pagamento\nLEFT JOIN\n    cad_Taxa_Logistica Txl on Txl.IdTaxa_Logistica =  Lte.IdTaxa_Logistica\nWHERE\n    Atv.IdAtividade = 1512932\nAND\nLtx.Origem_Taxa = 1\nORDER BY Lte.Nome\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Solicitar reserva de embarque - EA TEX.sql",
        "conteudo": "SELECT DISTINCT\nAtv.IdAtividade,\nLhs.IdLogistica_House,\nLms.IdLogistica_Master,\nLms.Numero_Conhecimento,\nLhs.Referencia_Externa,\nOro.Nome as Origem,\nOrd.Nome as Destino,\nLvo.Data_Previsao_Embarque,\nLhs.Numero_Processo,\n/*Carga*/\n'' as CARGA,\nCAST(Mer.Nome AS VARCHAR(MAX)) as Mercadoria,\nLms.Peso_bruto,\nLam.Peso_Taxado,\nLms.Quantidade_Volumes as Volumes,\n    CAST(Moe.Nome AS VARCHAR(MAX)) as Moeda,\n    Lhs.Metros_Cubicos,\n    Lhs.Quantidade_Volumes,\n    Lhs.Valor_Mercadoria,\n    Lhs.Importancia_Segurada,\n    Lhs.Peso_Bruto,\n    CASE Lhs.Seguro WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Seguro,\n    CASE Lhs.Carga_Perigosa WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Carga_Perigosa,\n    Lah.Peso_taxado,\n'' as EMBALAGEM,\n    CAST(Tmb.Nome AS VARCHAR(MAX)) as Embalagemm,\n    Lgm.Quantidade as Quantidade_Emb,\n    Lgm.Altura as Altura_Emb,\n    Lgm.Largura as Largura_Emb,\n    Lgm.Comprimento as Comprimento_Emb,\n    Lgm.Metros_Cubicos as Met_Cub_Emb,\n    Lgm.Peso_Liquido as Peso_Liq_Emb,\n    Lgm.Peso_Bruto as Peso_But_Emb,\n    Lgm.Peso_Cubado as Peso_Cub_Emb,\n    Lhs.Numero_Processo,\n'' as TAXAS,\n/*Taxas*/\nLte.Nome as Taxa,\nMop.Sigla as Moeda_Pagamento,\nLtx.Valor_Pagamento_Unitario,\nLtx.Valor_Pagamento_Minimo,\n\ncase lms.Modalidade_Pagamento when 1 then 'Collect/Prepaid' when 2 then 'Collect' when 3 then 'Prepaid' when 4 then 'Prepaid abroad' end as Modalidade_Pagamento\nFROM\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n   mov_Logistica_Viagem Lvo on Lvo.IdLogistica_house = Lhs.IdLogistica_House and Lvo.Tipo_Viagem = 4\nLEFT OUTER JOIN\n    cad_Origem_Destino Oro on Oro.IdOrigem_Destino = Lvo.IdOrigem\nLEFT OUTER JOIN\n    cad_Origem_Destino Ord on Ord.IdOrigem_Destino = Lvo.IdDestino\nLEFT OUTER JOIN\n    cad_Mercadoria Mer ON Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN\n    cad_Moeda Moe ON Moe.IdMoeda = Lhs.IdMoeda_Mercadoria\nLEFT OUTER JOIN\n    mov_Logistica_Embalagem Lgm ON Lgm.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Tipo_Embalagem Tmb ON Tmb.IdTipo_Embalagem = Lgm.IdTipo_Embalagem\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n   cad_Taxa_Logistica_Exibicao Lte on Lte.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao AND Lte.IdTaxa_Logistica_Exibicao = 4\nLEFT OUTER JOIN\n    cad_Moeda Mop on Mop.IdMoeda = Ltx.IdMoeda_Pagamento\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_House Lah ON Lah.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\nAtv.IdAtividade = 56107\n\n\n\nSelect\n      Lte.Nome as Taxa_Nome,\n      Mop.Sigla as Moeda,\n      Ltx.Valor_Pagamento_Unitario as Valor_Unitario,\n      SUM(Ltx.Valor_Pagamento_Unitario) OVER() as Total_Pagamento_Unitario,\n      Ltx.valor_Pagamento_Minimo as Valor_Minimo,\n      Txl.Tipo\nFROM\n    mov_Atividade Atv\nJOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJOIN\n    mov_Logistica_Taxa Ltx ON Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLEFT JOIN\n    cad_Taxa_Logistica_Exibicao Lte ON Lte.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLEFT JOIN\n    cad_Moeda Mop ON Mop.IdMoeda = Ltx.IdMoeda_Pagamento\nLEFT JOIN\n    cad_Taxa_Logistica Txl on Txl.IdTaxa_Logistica =  Lte.IdTaxa_Logistica\nWHERE\n    Atv.IdAtividade = :IdAtividade\nAND\nLtx.Origem_Taxa = 1\nORDER BY Lte.Nome\">"
    },
    {
        "caminho": "Scripts\\Consultas\\Sql original OUTSTANDING DEMURRAGE.sql",
        "conteudo": "SELECT\nLhs.IdLogistica_House,\nLmd.Lucro_Estimado,\nLmd.Total_Pago - Lmd.Total_Pagamento_Local AS Diferenca_Pagamento,\nLmd.Total_Pago,\nCASE \nWHEN Txa.Total_Recebimento IS NOT NULL THEN Lmd.Total_Recebido_Local + Txa.Total_Recebimento\nELSE Lmd.Total_Recebido_Local\nEND as Total_Fatura_Armador,\nSpl.Descricao,\nLhs.Observacao,\nLhe.Numero_Processo as Processo_Origem,\nVen.Nome AS Vendedor,\nOft.Numero_Oferta,\nLhs.Numero_Processo,\nRec.Pessoa_Recebimento,\nRec.Moeda_Recebimento,\nRec.Valor_Recebimento,\nLmd.Total_Recebimento_Local,\nCASE\nWHEN Rec.Data_Vencimento IS NOT NULL THEN\nCASE\nWHEN DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento) < 0 \nTHEN '-' + CAST(ABS(DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento)) AS VARCHAR) \nELSE '+' + CAST(DATEDIFF(DAY, GETDATE(), Rec.Data_Vencimento) AS VARCHAR)\nEND\nELSE NULL\nEND AS Dias_Vencimento,\nRec.Data_Vencimento,\nCia.Nome AS Cia_Transporte,\nLhs.Conhecimentos AS BL_House,\nLms.Numero_Conhecimento AS BL_Master\nFROM\nmov_Logistica_House Lhs\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master \nLEFT OUTER JOIN\nmov_Oferta_Frete Oft ON Oft.IdOferta_Frete = Lhs.IdOferta_Frete\nLEFT OUTER JOIN\nmov_Logistica_House Lhe ON Lhe.IdLogistica_House = Lhs.IdProcesso_Origem\nLEFT OUTER JOIN\ncad_Status_Processo_Logistico Spl on Spl.IdStatus_Processo_Logistico = Lhs.IdStatus_Processo_Logistico\nLEFT OUTER JOIN\ncad_Pessoa Ven ON Ven.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN\ncad_Pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN\t(\nSELECT \nROW_NUMBER() OVER(PARTITION BY Lho.IdLogistica_House ORDER BY Lho.IdLogistica_House) AS Indice,\nLho.IdLogistica_House,\nLda.Total_Recebimento\nFROM\nmov_Logistica_House Lho\nLEFT OUTER JOIN\t \nmov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lho.IdLogistica_House\nLEFT OUTER JOIN\t\nmov_Logistica_Master Lmt on Lmt.IdLogistica_Master = Lho.IdLogistica_Master\nLEFT OUTER JOIN\t\nmov_Logistica_Moeda Lda on Lda.IdLogistica_House = Lho.IdLogistica_House AND Lda.IdMoeda = 110 /*Real*/\nWHERE\nLtx.IdTaxa_Logistica_Exibicao = 168 /*reembolso*/\nAND \nLmt.IdCompanhia_Transporte = Ltx.IdPessoa_Recebimento\n) Txa on Txa.IdLogistica_House = Lhs.IdLogistica_House AND Txa.Indice = 1\nLEFT OUTER JOIN\nmov_Logistica_Moeda Lmd ON Lmd.IdLogistica_House = Lhs.IdLogistica_House AND Lmd.IdMoeda = 110 /*Real*/\nLEFT OUTER JOIN (\nSELECT\nROW_NUMBER() OVER(PARTITION BY Lft.IdLogistica_House ORDER BY Ffn.Data_Vencimento ASC) AS Indice,\nFfn.Data_Vencimento,\nPrc.Nome AS Pessoa_Recebimento,\nSUM(Ltx.Valor_Recebimento_Total) as Valor_Recebimento,\nMda.Sigla AS Moeda_Recebimento,\nLft.IdLogistica_House\nFROM\nmov_Logistica_Fatura Lft\nLEFT OUTER JOIN\nmov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\nmov_Logistica_Taxa Ltx ON Ltx.IdRegistro_Recebimento = Ffn.IdRegistro_Financeiro\nLEFT OUTER JOIN\nvis_Logistica_Fatura_Totais Lfs on Lfs.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\ncad_Pessoa Prc ON Prc.IdPessoa = Ltx.IdPessoa_Recebimento\nLEFT OUTER JOIN\ncad_Moeda Mda ON Mda.IdMoeda = Ltx.IdMoeda_Recebimento\nWHERE Ffn.Natureza = 1 /*Credito*/\nGROUP BY\nLft.IdLogistica_House,\nFfn.Data_Vencimento,\nPrc.Nome,\nMda.Sigla) Rec on Rec.IdLogistica_House = Lhs.IdLogistica_House AND Rec.Indice = 1\nLEFT OUTER JOIN (\nSELECT\nROW_NUMBER() OVER(PARTITION BY Lft.IdLogistica_House ORDER BY Ffn.Situacao DESC) AS Indice,\nLft.IdLogistica_House,\nLtx.IdPessoa_Pagamento,\nFfn.Situacao,\nFfn.Total_Pago_Corrente,\nFfn.Referencia_Externa\nFROM\nmov_Logistica_Fatura Lft\nLEFT OUTER JOIN\nmov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\nmov_Logistica_Taxa Ltx ON Ltx.IdRegistro_Pagamento = Ffn.IdRegistro_Financeiro\nWHERE\nFfn.Natureza = 0 /*Debito*/ AND Ltx.Pagar_Para = 5 /*Cia Transporte*/) Pag on Pag.IdLogistica_House = Lhs.IdLogistica_House AND Pag.Indice = 1 \n/*WHERE*/\nWHERE\nLhs.Situacao_Agenciamento NOT IN (7,4,3) /*Cancelado, Faturado, Liberado faturamento*/ \nAND\nLhs.Demurrage_Detention = 1 /*Sim*/\nAND\nLhs.Data_Abertura_Processo > '2020-01-01'\nAND\nLms.Tipo_Operacao = 2 /*Importação*/\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\SQLQuery20.sql",
        "conteudo": "SELECT\nIdOferta_frete_taxa,\nValor_pagamento_total,\n*\nFROM\nmov_logistica_taxa Ltx\nLeft Outer Join\nmov_Logistica_house Lhs ON Lhs.Idlogistica_house = Ltx.Idlogistica_house\nWhere\nnumero_processo like '%IM1880-25%'\nAND\nIdTaxa_logistica_exibicao = 252"
    },
    {
        "caminho": "Scripts\\Consultas\\SQLQuery21.sql",
        "conteudo": "--SELECT\n--Moe.Sigla,\n--Lhs.Numero_Processo,\n--Ltx.Valor_Pagamento_Unitario\n--FROM\n--mov_Atividade Atv\n--Left Outer Join\n--mov_logistica_house Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\n\n--Left Outer Join\n--cad_moeda Moe ON Moe.IdMoeda = Ltx.IdMoeda_Pagamento\n--WHERE\n--Ltx.IdTaxa_Logistica_Exibicao IN (6,/*BL FEE*/ 85 /*EX*/)\n--AND\n--Lhs.Numero_Processo like '%AGLIM4022-25%'\n\n\n\nSELECT DISTINCT\n  Tx1.IdLogistica_House,\n  Tx1.Pessoa_Fatura AS Pessoa_BL,\n  Tx1.Moeda AS Moeda_BL,\n  Tx1.Taxa_Internacional AS Taxa_Internacional_BL,\n  Tx1.Fator AS Fator_BL,\n  Tx2.Moeda AS Moeda_EX,\n  Tx2.Taxa_Internacional AS Taxa_Internacional_EX,\n  Tx2.Fator AS Fator_EX,\n  Tx1.Email,\n  Tx1.Numero_Processo\nFROM\n  mov_Atividade Atv\n  Left Outer Join mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  Left outer join cad_pessoa Eml ON Eml.IdPessoa = Lhs.IdCliente\n  \n  -- SUB-CONSULTA 1 (TAXA 6) COM DISTINCT\n  Left Outer Join (\n    SELECT DISTINCT\n      Ltx.IdLogistica_House,\n      Pes.Nome as Pessoa_Fatura,\n      Mrc.Sigla AS Moeda,\n      Tle.Nome_Internacional AS Taxa_Internacional,\n      Cast(\n        Case\n          When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n          Else 0\n        End As Float\n      ) As Fator,\n      Tle.IdTaxa_Logistica_Exibicao,\n      Pes.email,\n      Lhs.Numero_Processo\n    FROM\n      mov_Logistica_Taxa Ltx\n      Left Outer Join cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\n      Left Outer Join vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\n      Left Outer Join mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\n      Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Left Outer Join mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n      And (\n        (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n        Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem)\n      )\n      Left Outer Join cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n      left outer join cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\n    Where\n      Lft.IdPessoa = Lms.IdCompanhia_Transporte\n      AND Tle.IdTaxa_Logistica_Exibicao IN (6)\n  ) Tx1 on Tx1.IdLogistica_House = Lhs.IdLogistica_House\n  \n  -- SUB-CONSULTA 2 (TAXA 85) COM DISTINCT\n  Left Outer Join (\n    SELECT DISTINCT\n      Ltx.IdLogistica_House,\n      Pes.Nome as Pessoa_Fatura,\n      Mrc.Sigla AS Moeda,\n      Tle.Nome_Internacional AS Taxa_Internacional,\n      Cast(\n        Case\n          When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n          Else 0\n        End As Float\n      ) As Fator,\n      Tle.IdTaxa_Logistica_Exibicao\n    FROM\n      mov_Logistica_Taxa Ltx\n      Left Outer Join cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\n      Left Outer Join vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\n      Left Outer Join mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\n      Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Left Outer Join mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n      And (\n        (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n        Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem)\n      )\n      Left Outer Join cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n      left outer join cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\n    WHERE\n      Lft.IdPessoa = Lms.IdCompanhia_Transporte\n      AND Tle.IdTaxa_Logistica_Exibicao IN (85)\n  ) Tx2 on Tx2.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\nAtv.IdAtividade = 2908006\n  --Lhs.Numero_Processo like '%AGLIM4022-25%'"
    },
    {
        "caminho": "Scripts\\Consultas\\SQLQuery23.sql",
        "conteudo": "SELECT\nCASE /*Buscar o tipo de modalidade do pagamento do comercial*/\nWHEN Oft.Modalidade_Pagamento = 0 THEN 'Não definida'\nWHEN Oft.Modalidade_Pagamento = 1 THEN 'Prepaid'\nWHEN Oft.Modalidade_Pagamento = 2 THEN 'Collect'\nWHEN Oft.Modalidade_Pagamento = 3 THEN 'Abroad'\nEND AS Modalidade_Pagamento,\nCASE /*Buscar o tipo de modalidade do recebimento do comercial*/\n        WHEN Oft.Modalidade_Recebimento = 0 THEN 'Não definida'\n        WHEN Oft.Modalidade_Recebimento = 1 THEN 'Prepaid'\n        WHEN Oft.Modalidade_Recebimento = 2 THEN 'Collect'\n        WHEN Oft.Modalidade_Recebimento = 3 THEN 'Abroad'\n        END AS Modalidade_Recebimento,\nCASE \n        WHEN Otf.Modalidade_Pagamento_Master = 0 THEN '(Não informado)'\n        WHEN Otf.Modalidade_Pagamento_Master = 1 THEN 'Collect/Prepaid'\n        WHEN Otf.Modalidade_Pagamento_Master = 2 THEN 'Collect'\n        WHEN Otf.Modalidade_Pagamento_Master = 3 THEN 'Prepaid'\n        WHEN Otf.Modalidade_Pagamento_Master = 4 THEN 'Prepaid abroad'\n        END AS Modalidade_Pagamento_Master,\nCASE \n        WHEN Otf.Modalidade_Pagamento_House = 0 THEN '(Não informado)'\n        WHEN Otf.Modalidade_Pagamento_House = 1 THEN 'Collect/Prepaid'\n        WHEN Otf.Modalidade_Pagamento_House = 2 THEN 'Collect'\n        WHEN Otf.Modalidade_Pagamento_House = 3 THEN 'Prepaid'\n        WHEN Otf.Modalidade_Pagamento_House = 4 THEN 'Prepaid abroad'\n        END AS Modalidade_Pagamento_House\nFROM\nmov_Logistica_Taxa Ltx\nLeft Outer Join\t\nmov_logistica_house Lhs ON Lhs.idLogistica_House = Ltx.idLogistica_House\nLeft Outer Join\t\nmov_oferta_frete_taxa Oft ON Oft.idoferta_frete_taxa = Ltx.idoferta_frete_taxa\nLeft Outer Join\t\nmov_oferta_frete Otf ON Otf.IdOferta_Frete = Oft.IdOferta_Frete\n\n"
    },
    {
        "caminho": "Scripts\\Consultas\\SQLQuery24.sql",
        "conteudo": "SELECT\n  Lms.Modalidade_Pagamento AS Master_Original,\n  Ltx.Modalidade_Pagamento AS Taxa_Original,\n  CASE \n     WHEN Ltx.Modalidade_Pagamento = 1 THEN 3\n     WHEN Ltx.Modalidade_Pagamento = 2 THEN 2 \n     WHEN Ltx.Modalidade_Pagamento = 3 THEN 4 \n     ELSE Ltx.Modalidade_Pagamento\n  END AS Taxa_Traduzida,\n\n  CASE\n    WHEN Lms.Modalidade_Pagamento <> \n         CASE \n           WHEN Ltx.Modalidade_Pagamento = 1 THEN 3\n           WHEN Ltx.Modalidade_Pagamento = 2 THEN 2\n           WHEN Ltx.Modalidade_Pagamento = 3 THEN 4\n           ELSE Ltx.Modalidade_Pagamento\n         END\n    THEN 'Diferente'\n    ELSE 'Igual'\n  END AS Status_Bloqueio\n\nFROM\n  mov_logistica_taxa Ltx\n  LEFT OUTER JOIN mov_logistica_house Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\n  LEFT OUTER JOIN mov_logistica_master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nWHERE\n  Lhs.Numero_Processo LIKE '%IM0945-25%'\n  AND Ltx.IdTaxa_Logistica_Exibicao = 252"
    },
    {
        "caminho": "Scripts\\Consultas\\Status fatura.sql",
        "conteudo": "/* Bloqueio */\n(\nSelect\nFfn.IdRegistro_Financeiro,\nMin(Ffn.Tipo) As Tipo,\nMax(\nCase\nWhen Ffn.IdRegistro_Unificador <> 0 Then 4\n/* Fatura Unificada */\nWhen Ffn.Situacao In (2, 3) Then 3\n/* Fatura com Baixa */\nWhen Ffn.Conferido = 1 Then 2\n/* Fatura Conferida */\nWhen (\nRfn.Origem_Lancamento <> 1\n/* Interno */\n)\nAnd (\nFfn.Tipo = 2\n/* Título */\n) Then 1\n/* Fatura Finalizada */\nElse 0\nEnd\n) As Bloqueio\nFrom\nmov_Fatura_Financeira Ffn\nJoin mov_Registro_Financeiro Rfn On Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\nGroup By\nFfn.IdRegistro_Financeiro\n) Blq On Blq.IdRegistro_Financeiro = Rfn.IdRegistro_Financeiro"
    },
    {
        "caminho": "Scripts\\Consultas\\Taxas estimadas x efetivas.sql",
        "conteudo": "DECLARE\n  @Data_Inicial DateTime,\n  @Data_Final DateTime,\n  @IdMoeda_Corrente Integer\n\nSET @Data_Inicial = '2025-01-01'\nSET @Data_Final = '2026-12-31'\nSET @IdMoeda_Corrente = (SELECT IdMoeda FROM cad_Moeda WHERE Moeda_Corrente = 1)\n\n;WITH Taxas_Processo AS (\nSELECT\n  Txs.IdLogistica_Taxa,\n  Txs.IdTaxa_Logistica_Exibicao,\n  Lft.IdRegistro_Financeiro,\n  ROUND(ROUND(Txs.Valor\n    * CASE\n    WHEN Txs.IdMoeda = Rfn.IdMoeda THEN 1\n    WHEN Lfc.IdMoeda_Origem = Txs.IdMoeda AND Lfc.IdMoeda_Destino = Rfn.IdMoeda THEN Lfc.Fator_Conversao\n    WHEN Lfc.IdMoeda_Origem = Rfn.IdMoeda AND Lfc.IdMoeda_Destino = Txs.IdMoeda AND COALESCE(Lfc.Fator_Conversao, 0) <> 0 THEN ROUND(1 / Lfc.Fator_Conversao, 6)\n    END, 2) / Rfn.Valor_Total * 100, 6) AS Percentual,\n  Txs.Natureza\nFROM\n  (SELECT\n    Ltx.IdLogistica_Taxa,\n    Ltx.IdTaxa_Logistica_Exibicao,\n    Ltx.IdRegistro_Pagamento AS IdRegistro_Financeiro,\n    Ltx.IdMoeda_Pagamento AS IdMoeda,\n    -Ltx.Valor_Pagamento_Total AS Valor,\n    0 AS Natureza\n  FROM\n    mov_Logistica_Taxa Ltx\n  WHERE\n    Ltx.IdRegistro_Pagamento IS NOT NULL\n  AND\n    Ltx.Valor_Pagamento_Total <> 0\n  UNION ALL\n  SELECT\n    Ltx.IdLogistica_Taxa,\n    Ltx.IdTaxa_Logistica_Exibicao,\n    Ltx.IdRegistro_Recebimento AS IdRegistro_Financeiro,\n    Ltx.IdMoeda_Recebimento AS IdMoeda,\n    Ltx.Valor_Recebimento_Total AS Valor,\n    1 AS Natureza\n  FROM\n    mov_Logistica_Taxa Ltx\n  WHERE\n    Ltx.IdRegistro_Recebimento IS NOT NULL\n  AND\n    Ltx.Valor_Recebimento_Total <> 0\n  ) AS Txs\nJOIN\n  mov_Logistica_Fatura Lft ON Lft.IdRegistro_Financeiro = Txs.IdRegistro_Financeiro\nJOIN\n  mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLEFT OUTER JOIN\n  mov_Logistica_Fatura_Conversao Lfc ON Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro\n    AND ((Lfc.IdMoeda_Origem = Txs.IdMoeda AND Lfc.IdMoeda_Destino = Rfn.IdMoeda)\n      OR (Lfc.IdMoeda_Origem = Rfn.IdMoeda AND Lfc.IdMoeda_Destino = Txs.IdMoeda))\nWHERE\n  Rfn.Valor_Total <> 0\n), Percentuais AS (\nSELECT\n  Txs.IdLogistica_Taxa,\n  Txs.IdTaxa_Logistica_Exibicao,\n  Txs.IdRegistro_Financeiro,\n  Txs.Natureza,\n  CASE\n    WHEN ROW_NUMBER() OVER(PARTITION BY Txs.IdRegistro_Financeiro ORDER BY Txs.Percentual DESC, Txs.IdLogistica_Taxa) = 1 THEN\n      CASE\n        WHEN Txs.Percentual < 0 THEN Txs.Percentual - (100 - ABS(Ttl.Percentual_Total))\n        ELSE Txs.Percentual + (100 - ABS(Ttl.Percentual_Total))\n      END\n    ELSE Txs.Percentual\n  END AS Percentual\nFROM\n  Taxas_Processo Txs\nLEFT OUTER JOIN\n  (SELECT\n    Txs.IdRegistro_Financeiro,\n    SUM(Txs.Percentual) AS Percentual_Total\n  FROM\n    Taxas_Processo Txs\n  GROUP BY\n    Txs.IdRegistro_Financeiro\n  ) Ttl ON Ttl.IdRegistro_Financeiro = Txs.IdRegistro_Financeiro\n), Taxas_Calculadas AS (\nSELECT\n  Prc.IdLogistica_Taxa,\n  Prc.IdTaxa_Logistica_Exibicao,\n  Prc.Natureza,\n  Ffn.IdRegistro_Financeiro,\n  Mfn.IdMovimentacao_Financeira,\n  Mfn.Valor_Corrente AS Total_Corrente,\n  ABS(ROUND((Prc.Percentual * Ffb.Valor_Total * Ffb.Fator_Conversao * Mfn.Fator_Corrente) / 100, 2)) AS Valor_Corrente\nFROM\n  mov_Movimentacao_Financeira Mfn\nJOIN\n  mov_Fatura_Financeira_Baixa Ffb ON Ffb.IdMovimentacao_Financeira = Mfn.IdMovimentacao_Financeira\nJOIN\n  mov_Fatura_Financeira Ffn ON Ffn.IdFatura_Financeira = Ffb.IdFatura_Financeira\nJOIN\n  Percentuais Prc ON Prc.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\nWHERE\n  Mfn.Valor > 0\nAND \n  Mfn.IdConta_Corrente <> 17 /* (BANCO BAIXAS CUSTO FINANCEIRO)*/\n), Taxas AS (\n  SELECT\n  Txs.IdMovimentacao_Financeira,\n  Txs.IdLogistica_Taxa,\n  Txs.IdTaxa_Logistica_Exibicao,\n  Txs.IdRegistro_Financeiro,\n  CASE\n    WHEN ROW_NUMBER() OVER(PARTITION BY Txs.IdMovimentacao_Financeira ORDER BY Txs.Valor_Corrente DESC, Txs.IdLogistica_Taxa) = 1 THEN\n    Txs.Valor_Corrente + (Txs.Total_Corrente - Ttl.Total)\n    ELSE\n    Txs.Valor_Corrente\n  END AS Valor\n  FROM\n  Taxas_Calculadas Txs\n  JOIN\n  (SELECT\n    Tcl.IdMovimentacao_Financeira,\n    SUM(Tcl.Valor_Corrente) AS Total\n  FROM\n    Taxas_Calculadas Tcl\n  GROUP BY\n    Tcl.IdMovimentacao_Financeira\n  ) Ttl ON Ttl.IdMovimentacao_Financeira = Txs.IdMovimentacao_Financeira\n), Variacoes AS (\nSELECT\n  Ltx.IdLogistica_House,\n  Ltx.IdLogistica_Taxa,\n  Ltx.IdMoeda_Pagamento,\n  Ltx.IdMoeda_Recebimento,\n  Ltx.IdRegistro_Pagamento,\n  Ltx.IdRegistro_Recebimento,\n  Tle.Nome AS Taxa,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Recebimento_Total,\n  CASE\n    WHEN Ltx.IdMoeda_Pagamento = @IdMoeda_Corrente THEN 1\n    WHEN Fpg.IdMoeda_Origem = Ltx.IdMoeda_Pagamento AND Fpg.IdMoeda_Destino = @IdMoeda_Corrente THEN Fpg.Fator_Conversao\n    WHEN Fpg.IdMoeda_Origem = @IdMoeda_Corrente AND Fpg.IdMoeda_Destino = Ltx.IdMoeda_Pagamento AND ISNULL(Fpg.Fator_Conversao, 0) <> 0 THEN ROUND(1 / Fpg.Fator_Conversao, 6)\n    ELSE 0\n  END AS Fator_Pagamento,\n  CASE\n    WHEN Ltx.IdMoeda_Recebimento = @IdMoeda_Corrente THEN 1\n    WHEN Frc.IdMoeda_Origem = Ltx.IdMoeda_Recebimento AND Frc.IdMoeda_Destino = @IdMoeda_Corrente THEN Frc.Fator_Conversao\n    WHEN Frc.IdMoeda_Origem = @IdMoeda_Corrente AND Frc.IdMoeda_Destino = Ltx.IdMoeda_Recebimento AND ISNULL(Frc.Fator_Conversao, 0) <> 0 THEN ROUND(1 / Frc.Fator_Conversao, 6)\n    ELSE 0\n  END AS Fator_Recebimento,\n  CASE\n    WHEN Ffp.Data_Pagamento > Lfr.Data_Faturamento THEN Ffp.Data_Pagamento\n    ELSE Lfr.Data_Faturamento\n  END AS Data,\n  COALESCE(NULLIF(Lhs.Referencia_Externa, ''), Lhs.Numero_Processo) AS Referencia\nFROM\n  mov_Logistica_Taxa Ltx\nJOIN\n  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\nJOIN\n  cad_Taxa_Logistica_Exibicao Tle ON Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nJOIN\n  cad_Taxa_Logistica Tlg ON Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLEFT OUTER JOIN\n  mov_Logistica_Fatura_Conversao Fpg ON Fpg.IdLogistica_Fatura = Ltx.IdRegistro_Pagamento\n    AND ((Fpg.IdMoeda_Origem = Ltx.IdMoeda_Pagamento AND Fpg.IdMoeda_Destino = @IdMoeda_Corrente)\n    OR (Fpg.IdMoeda_Origem = @IdMoeda_Corrente AND Fpg.IdMoeda_Destino = Ltx.IdMoeda_Pagamento))\nLEFT OUTER JOIN\n  mov_Logistica_Fatura_Conversao Frc ON Frc.IdLogistica_Fatura = Ltx.IdRegistro_Recebimento\n    AND ((Frc.IdMoeda_Origem = Ltx.IdMoeda_Recebimento AND Frc.IdMoeda_Destino = @IdMoeda_Corrente)\n    OR (Frc.IdMoeda_Origem = @IdMoeda_Corrente AND Frc.IdMoeda_Destino = Ltx.IdMoeda_Recebimento))\nLEFT OUTER JOIN\n  vis_Logistica_Fatura Lfr ON Lfr.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLEFT OUTER JOIN\n  mov_Fatura_Financeira Ffp ON Ffp.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\nWHERE\n  Tlg.Tributavel = 0\nAND\n  (Ltx.Tipo_Pagamento <> 1 /* SEM COBRANÇA */)\nAND\n  (Ltx.Tipo_Recebimento <> 1 /* SEM COBRANÇA */)\nAND\n  ((ISNULL(Ltx.Valor_Pagamento_Total, 0) <> ISNULL(Ltx.Valor_Recebimento_Total, 0))\n  OR\n  (ISNULL(Ltx.IdMoeda_Pagamento, 0) <> ISNULL(Ltx.IdMoeda_Recebimento, 0))\n  OR\n  ((ISNULL(Ltx.IdMoeda_Pagamento, 0) = ISNULL(Ltx.IdMoeda_Recebimento, 0))\n  AND (ISNULL(Ltx.Valor_Pagamento_Total, 0) = ISNULL(Ltx.Valor_Recebimento_Total, 0))))\nAND\n  (CASE\n    WHEN Ffp.Data_Pagamento > Lfr.Data_Faturamento THEN Ffp.Data_Pagamento\n    ELSE Lfr.Data_Faturamento\n  END BETWEEN @Data_Inicial AND @Data_Final)\n  ), Comissao_Agente AS (\nSELECT\n  Txs.IdMovimentacao_Financeira,\n  Txs.IdLogistica_Taxa,\n  Txs.Valor\nFROM\n  Taxas Txs\nWHERE\n  Txs.IdTaxa_Logistica_Exibicao = 11 /* COMISSÃO AGENTE */\n)\n\nSELECT\n  Lft.Numero AS Numero_Fatura,\n  Tle.Nome As Taxa,\n  CASE Txs.Natureza\n    WHEN 0 THEN 'Débito' \n    WHEN 1 THEN 'Crédito'\n  END Natureza,\n\n  CASE Txs.Natureza \n    WHEN 0 THEN Mrp.Sigla \n    WHEN 1 THEN Mrc.Sigla\n  END AS Moeda,\n\n  CASE Txs.Natureza \n    WHEN 0 THEN Ltx.Valor_Pagamento_Total \n    WHEN 1 THEN Ltx.Valor_Recebimento_Total\n  END AS Valor_Total_Estimado,\n\n  CASE Txs.Natureza \n    WHEN 0 THEN Ltx.Fator_Pagamento_Corrente \n    WHEN 1 THEN Ltx.Fator_Recebimento_Corrente\n  END AS Fator_Corrente_Estimado,\n\n  CASE Txs.Natureza \n    WHEN 0 THEN Ltx.Valor_Pagamento_Corrente\n    WHEN 1 THEN Ltx.Valor_Recebimento_Corrente\n  END AS Valor_Corrente_Estimado,\n\n  Txs.Valor_Corrente AS Valor_Corrente_Efetivo,\n  Txs.Total_Corrente AS Total_Movimentacao,\n  Lhs.Numero_Processo,\n  Lhs.Data_Abertura_Processo,\n  Ffn.Valor AS Valor_Fatura,\n  Ffn.Total_Pago AS Total_Pago_Fatura,\n  Ffn.Total_Pago_Corrente AS Total_Pago_Corrente_Fatura,\n  Ffn.Total_Multa AS Total_Multa_Fatura,\n  Ffn.Total_Juros AS Total_Juros_Fatura,\n  Ffn.Total_Acrescimo AS Total_Acrescimo_Fatura,\n  Ffn.Total_Desconto AS Total_Desconto_Fatura,\n  Ffn.Total_Abatimento AS Total_Abatimento_Fatura\nFROM\n  Taxas_Calculadas Txs\nJOIN\n  vis_Logistica_Taxa Ltx ON Ltx.IdLogistica_Taxa = Txs.IdLogistica_Taxa\nJOIN \n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nJOIN \n  cad_Moeda Mrp on Mrp.IdMoeda = Ltx.IdMoeda_Pagamento\nJOIN \n  cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nJOIN \n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\nLEFT OUTER JOIN \n  vis_Logistica_Fatura Lft on Lft.IdRegistro_Financeiro = Txs.IdRegistro_Financeiro\nLEFT OUTER JOIN \n  mov_Fatura_Financeira Ffn on Ffn.IdRegistro_Financeiro = Txs.IdRegistro_Financeiro\nWHERE \n  Lhs.Data_Abertura_Processo > '2025-10-01' \nORDER BY\n  Txs.IdMovimentacao_Financeira\n"
    },
    {
        "caminho": "Scripts\\Consultas\\Teste Primeira cotação.chd",
        "conteudo": "[FieldDefs]\nCount=5\nItems[0].Name=Cliente\nItems[0].DataType=ftString\nItems[0].Precision=0\nItems[0].Size=75\nItems[1].Name=Vendedor\nItems[1].DataType=ftString\nItems[1].Precision=0\nItems[1].Size=75\nItems[2].Name=Data_Proposta\nItems[2].DataType=ftDateTime\nItems[2].Precision=0\nItems[2].Size=0\nItems[3].Name=Data_Aprovacao\nItems[3].DataType=ftDateTime\nItems[3].Precision=0\nItems[3].Size=0\nItems[4].Name=Situacao\nItems[4].DataType=ftString\nItems[4].Precision=0\nItems[4].Size=20\n\n[Consulta]\nCampos=9\nCommandTextHash=e6d41cccb29c0831dd3a093496376044\nCommandText=SELECT,\"Pes.Cpf_Cnpj as CNPJ,\",\"CASE Pes.Ativo when 0 then 'Inativo' when 1 then 'Ativo' end as Ativo,\",\"Pes.Nome as Cliente,\",\"Ppf.Data_Proposta, \",\"Ppf.Data_Aprovacao,\",\"Oft.Numero_Oferta,\",\"case Ppf.Situacao when 1 then 'Aguardando Aprovação' when 2 then 'Aprovada' when 3 then 'Não Aprovada' when 4 then 'Não Enviada' when 5 then 'Pré-Proposta' when 6 then 'Enviada'else 'erro 711' end as Situacao,\",\"case Oft.Tipo_Operacao when 1 then 'Exportação'  when 2 then 'Importação' when 3 then 'Nacional' end as Tipo_Operacao,\",\"case Oft.Modalidade_Processo when 1 then 'Aéreo' when 2 then 'Marítimo' when 3 then 'Terrestre' when 4 then 'Air-Air' when 5 then 'Sea-Air' end as Modalidade_Processo\",FROM,\"mov_Proposta_Frete Ppf\",\"Left Outer Join\",\"cad_Pessoa Pes on Pes.IdPessoa = Ppf.IdCliente\",\"Left Outer Join\",\"cad_Pessoa Ven on Ven.IdPessoa = Ppf.IdVendedor\",\"Left Outer Join\",\"mov_Oferta_Frete Oft on Oft.IdProposta_Frete  = Ppf.IdProposta_Frete\",/*where*/\n\n[Campos]\nCampo[0].FieldName=CNPJ\nCampo[0].DisplayLabel=CNPJ\nCampo[0].Origin=Pes.Cpf_Cnpj\nCampo[0].Width=100\nCampo[1].FieldName=Ativo\nCampo[1].DisplayLabel=Cliente Situação\nCampo[1].Origin=CASE Pes.Ativo when 0 then 'Inativo' when 1 then 'Ativo' end\nCampo[1].Width=100\nCampo[2].FieldName=Cliente\nCampo[2].DisplayLabel=Cliente\nCampo[2].Origin=Pes.Nome\nCampo[2].Width=100\nCampo[3].FieldName=Data_Proposta\nCampo[3].DisplayLabel=Data Proposta\nCampo[3].Origin=Ppf.Data_Proposta\nCampo[3].Width=100\nCampo[3].DisplayFormat=dd/MM/yyyy\nCampo[4].FieldName=Data_Aprovacao\nCampo[4].DisplayLabel=Data Aprovacao\nCampo[4].Origin=Ppf.Data_Aprovacao\nCampo[4].Width=100\nCampo[4].DisplayFormat=dd/MM/yyyy\nCampo[5].FieldName=Numero_Oferta\nCampo[5].DisplayLabel=Nímero Oferta\nCampo[5].Origin=Oft.Numero_Oferta\nCampo[5].Width=100\nCampo[6].FieldName=Situacao\nCampo[6].DisplayLabel=Situação\nCampo[6].Origin=case Ppf.Situacao when 1 then 'Aguardando Aprovação' when 2 then 'Aprovada' when 3 then 'Não Aprovada' when 4 then 'Não Enviada' when 5 then 'Pré-Proposta' when 6 then 'Enviada'else 'erro 711' end\nCampo[6].Width=100\nCampo[7].FieldName=Tipo_Operacao\nCampo[7].DisplayLabel=Tipo Operação\nCampo[7].Origin=case Oft.Tipo_Operacao when 1 then 'Exportação'  when 2 then 'Importação' when 3 then 'Nacional' end\nCampo[7].Width=100\nCampo[8].FieldName=Modalidade_Processo\nCampo[8].DisplayLabel=Modalidade Processo\nCampo[8].Origin=case Oft.Modalidade_Processo when 1 then 'Aéreo' when 2 then 'Marítimo' when 3 then 'Terrestre' when 4 then 'Air-Air' when 5 then 'Sea-Air' end\nCampo[8].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\2023 - TRANSBORDO - TEX - Alterei a parte da PREVISAO DE CHEGADA NO DESTINO FINAL.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n    CASE\n  WHEN Trt.Nome IS NOT NULL AND Lhs.Tipo_Carga = 4 /*LCL*/ THEN CONCAT(' (',Trt.Nome,') ') ELSE '' END as Tipo_Terminal,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'Variavel_Armador'\n  else 'Variavel_Modalidade'\n  end as Variavel,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'ARMADOR:'\n  else 'MODALIDADE:'\n  end as Titulo_Variavel,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 59162 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 48952 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n   CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971)  THEN 'Titulo_Referencia'\n  else 'Referencia_Titulo'\n  end as Referencia_Variavel,\n  COALESCE(Agm.Nome,Ctr.Nome) as Armador_Nome,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Nvi.Nome as Navio,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Agm on Agm.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Tabela_transbordo_OLD\" Sql=\"Select\n  CASE\n  WHEN Nvit.Nome IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Nvit.Nome as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Ptr.Nome as Origem_Completa,\n  Ptd.Nome as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Nvit.Nome As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt On Lmt.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\n  cad_Origem_Destino Ptd on Ptd.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Navio Nvit On Nvit.IdNavio = Lmt.IdNavio\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nWhere\n  Atv.IdAtividade= :IdAtividade\n  order by Lmt.Data_Previsao_Embarque desc\">\n\n<DataSet Name=\"Tabela_transbordo\" Sql=\"Select\n  CASE\n    WHEN Lmt.Navio IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Lmt.Navio as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Lmt.Porto_Transbordo as Origem_Completa,\n  Lmt.Porto_Desembarque as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lmt.Navio As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join(\n  SELECT\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.Data_Desembarque Desc)As Ranking,\n    Lgv.IdLogistica_House,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Van.Data_Desembarque as Data_Chegada,\n    Van.Data_Previsao_Desembarque as Data_Previsao_Chegada,\n    Nvo.Nome as Navio,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.IdLogistica_Viagem,\n    Lgv.Numero_Controle as Numero_BL,\n    Lgv.Data_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque, \n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Case\n      When Lgv.Tipo_Servico = 0 Then 'Não informado'\n      When Lgv.Tipo_Servico = 1 Then 'Transbordo'\n      When Lgv.Tipo_Servico = 2 Then 'Cabotagem'\n      End As Tipo\n  From\n    mov_Logistica_Viagem Lgv\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  JOIN \n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Precedencia - 1\n  Left Outer Join\n    cad_Navio Nvo on Nvo.IdNavio = Lgv.IdNavio\n  ) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade= :IdAtividade\norder by \n  Lmt.IdLogistica_Viagem asc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga_Detalhada\" Sql=\"Select \nEqm.Rank,\nLhs.IdLogistica_House,\nEqm.Quantidade,\nLmc.Free_Time_Master,\nLmc.Free_Time_House,\nEmr.IdEquipamento_Maritimo,\nLmc.Number,\nDateadd(Day, Lmc.Free_Time_House, Lms.Data_Desembarque) As Data_Devolucao,\nSUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1) AS Tamanho_Equipamento,\nCase\n  When Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\n  When Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\n  When Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 13 Then '' /**/\n  When Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd AS Equipamento\nFROM \nmov_Atividade Atv\nLEFT OUTER JOIN \nmov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \ncad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nLeft Outer Join(\nSelect\nRank() OVER(PARTITION BY IdLogistica_House ORDER BY Eqm.Descricao) AS Rank,\nLme.IdLogistica_House,\nEqm.Descricao as Equipamento,\nLme.Quantidade\nFrom\nmov_Logistica_Maritima_Equipamento Lme\nLeft Outer Join\ncad_Equipamento_Maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\n) Eqm ON Eqm.IdLogistica_House = Lhs.IdLogistica_House and Eqm.Rank = 1\nWHERE \nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \nLhs.IdLogistica_House,\nLme.Quantidade,\nLme.Free_Time_House_Destino,\nEmr.Descricao as Cntr,\nCONCAT(Lme.Quantidade,'x', SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1), ' ' , Case\nWhen Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\nWhen Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\nWhen Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 13 Then '' /**/\nWhen Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd, ' (', Lme.Free_Time_House_Destino, ' Dias)') AS Equipamento\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n\n  \n  <title>FOLLOW UP</title>\n\n  <meta charset=\"utf-8\"> \n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> \n  <meta http-equiv=\"pragma\" content=\"no-cache\"> \n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0\"> \n  <meta name=\"google\" value=\"notranslate\">\n  <meta name=\"format-detection\" content=\"telephone=no\">\n  <meta name=\"scriptVer\" content=\"20231117004.14\">\n  <meta name=\"hashedPath\" content=\"\">\n  <meta name=\"physicalRing\" content=\"WW\">\n  <meta name=\"environment\" content=\"Prod\">\n  <meta name=\"bootFlights\" content=\"localStorageOwaPrefix,fwk-analytics-addons,cal-getTimeZoneOffsetsV2,acctPersistenceSourceIdV2,dev-offlineMultiAccountDB,auth-getAuthTokenV2,cal-publishedCalendarV2,shellmultiorigin:394927,limitfoldersonboot:474919,oobe-welcome-spinner:407828,react18:477911\"> \n  <meta name=\"cdnUrl\" content=\"//res.cdn.office.net/\">\n  <meta name=\"backupCdnUrl\" content=\"//res-h3.public.cdn.office.net/\">\n  <meta name=\"cdnContainer\" content=\"owamail/\">\n  <meta name=\"devCdnUrl\" content=\"\">\n  <meta name=\"ariaUrl\" content=\"\">\n  <meta name=\"webServerForest\" content=\"lamp152\">\n  <meta name=\"webServerClique\" content=\"CLLAMP152CPQ00\"> \n  <meta name=\"compactAriaUrl\" content=\"\">\n  <meta name=\"wcssFrameUrl\" content=\"https://webshell.suite.office.com\">\n  <meta name=\"wcssFrameUrls\" content=\"{'DefaultUrl':'https://webshell.suite.office.com','WwdbUrl':'https://wwdb.webshell.suite.office.com','EudbUrl':'https://eudb.webshell.suite.office.com'}\"> \n  <meta name=\"scriptPath\" content=\"react18/scripts/\">\n  <meta name=\"owaIsAuthenticated\" content=\"{{IsAuthenticated}}\">\n  <meta name=\"jsTimestamp\" content=\"1701290110391\"> \n  <meta name=\"publicUrl\" content=\"https://outlook.office.com\">\n\n  <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n  <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap\" rel=\"stylesheet\">\n  <style media=\"screen and (prefers-reduced-motion: reduce)\" data-make-styles-bucket=\"m\"></style>\n  <style media=\"(forced-colors: active)\" data-make-styles-bucket=\"m\"></style>\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    body,td,tr,p{ font-family: 'Montserrat', sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n      \n    .box_color_yellow { text-align: center; font-weight:700 ; border-width: 30px; background: rgb(255, 221, 114); color: black;}\n    .box_color_grey { text-align: center; border: 10px; background: #808080; color: white;}\n    .grey { color: #808080; }\n    .espacamento-20 {padding: 20px; box-sizing: border-box;}\n    .destacado {font-weight: 600;}\n    .borda-espacada{ border-style:solid; border-color: #808080; border-width: 1px 1px 1px 1px; padding: 2.5px;} \n    .destacado-grey {font-weight: 600; color: #808080;}\n    .borda_sem_baixo{ text-align: center; border-top:solid; border-right:solid; border-left:solid; border-width: 1px 1px 1px 1px; border-color:#808080;}\n    .borda_sem_direita_acomp{ border-bottom:solid; border-top:solid; border-left:solid; border-color: #808080; color: #808080; border-width: 1px 1px 1px 1px}\n    .box_color_noright { border-bottom:solid; border-top:solid; border-right:solid; border-width: 0.2px; color:#808080; border-color: rgb(128, 128, 128);}\n    .text-center-20 { text-align: center; font-size: 20px; font-weight: bold; color: #808080;}\n\n\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<SubReport NameField=\"Referencia_Variavel\" NameSource=\"Processo\">\n[Subject.Footer]\n  \n  \n[Report.Detail]\n<SubReport Name =\"Logo_Andre\" Dataset=\"Processo\">\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>  \n    <td width=\"775\" class=\"box_color_yellow\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n  </tr>\n</table>\n\n<br>\n<br>\n\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td>CLIENTE:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n      <td>DATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td width=\"12%\">TEX#:</td>\n      <td width=\"38%\" class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td>REF:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>\n    <td class=\"box_color_grey\" colspan=\"4\">INFORMAÇÕES DE EMBARQUE</td>\n  </tr>\n</table>\n<br>\n\n<table class=\"borda-espacada\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"20%\" class=\"grey\">EXPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n    <td width=\"20%\" class=\"grey\">IMPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">HBL:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"grey\">NAVIO/VIAGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  </tr>\n  <tr>\n      <td class=\"grey\">ORIGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"grey\">DESTINO:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">ETD:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"grey\">ETA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">EMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"destacado-grey\">DESEMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MBL:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Titulo_Variavel\"></td>\n      <td class=\"grey\"><SubReport NameField=\"Variavel\" NameSource=\"Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MERCADORIA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"grey\">TIPO (FREE TIME):</td>\n      <td class=\"grey\"><SubReport Name=\"Equipamento_Sub\" Dataset=\"Carga\"></td>\n  </tr>\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DA CARGA</td>\n  </tr>\n</table>\n\n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">TIPOS DE EQUIPAMENTOS:</td>\n    <td class=\"grey\">CONTAINERS:</td>\n    <td class=\"grey\">LIMITE DE DEVOLUÇÃO:</td>\n  </tr>\n\n  <SubReport Name=\"Carga_Detalhada_Sub\" Dataset=\"Carga_Detalhada\">\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DE TRANSBORDO</td>\n  </tr>\n</table>\n \n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">PORTO TRANSBORDO</td>\n    <td class=\"grey\">PORTO DESEMBARQUE</td>\n    <td class=\"grey\">NAVIO/VIAGEM</td>\n    <td class=\"grey\">PREV. CHEGADA</td>\n    <td class=\"grey\">CONF. CHEGADA</td>\n    <td class=\"grey\">PREV. EMBARQUE</td>\n    <td class=\"grey\">CONF. EMBARQUE</td>\n  </tr>\n <SubReport Name=\"Transbordo\" Dataset=\"Tabela_transbordo\">\n </table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"20\">\n  <tr>\n    <td class=\"text-center-20\">HISTÓRICO</td>\n  </tr>\n</table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"borda_sem_direita_acomp\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n    <td class=\"box_color_noright\" width=\"80%\"><span class=\"negrito\">DESCRITIVO</span></td>\n  </tr>\n\n    <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n    <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      \n  <tr>\n    <td colspan=\"6\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Logo_Andre.Detail]\n<td colspan=\"2\">\n    <img src=<Print Dataset=\"Processo\" FieldName=\"Logo_Variavel\"> class=\"display-none\"/>\n</td>\n\n[Variavel_Armador.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Armador_Nome\">\n \n[Variavel_Modalidade.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Tipo_Carga_Detalhe\"> <Print Dataset=\"Processo\" FieldName=\"Tipo_Terminal\">\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n\n[Titulo_Referencia]\nTransbordo - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\"> - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> \n\n[Referencia_Titulo]\nTransbordo - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">\n\n\n\n[Transbordo.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Origem_Completa\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Destino_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Navio_Completo\"> / <Print Dataset=\"Tabela_transbordo\" FieldName=\"Viagem_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Embarque_Completa\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n\n[Carga_Detalhada_Sub.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Tamanho_Equipamento\">' <Print Dataset=\"Carga_Detalhada\" FieldName=\"Equipamento\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Number\"></td>\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Data_Devolucao\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n[Equipamento_Sub.Detail]\n<Print Dataset=\"Carga\" FieldName=\"Equipamento\">, \n\n[Report.Footer]\n</body>\n</html>\t"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Ajuste mensagem automática - Chegada no transbordo bkp.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n    CASE\n  WHEN Trt.Nome IS NOT NULL AND Lhs.Tipo_Carga = 4 /*LCL*/ THEN CONCAT(' (',Trt.Nome,') ') ELSE '' END as Tipo_Terminal,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'Variavel_Armador'\n  else 'Variavel_Modalidade'\n  end as Variavel,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'ARMADOR:'\n  else 'MODALIDADE:'\n  end as Titulo_Variavel,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 59162 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 48952 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n   CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971)  THEN 'Titulo_Referencia'\n  else 'Referencia_Titulo'\n  end as Referencia_Variavel,\n  COALESCE(Agm.Nome,Ctr.Nome) as Armador_Nome,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Nvi.Nome as Navio,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Agm on Agm.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Tabela_transbordo_OLD\" Sql=\"Select\n  CASE\n  WHEN Nvit.Nome IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Nvit.Nome as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Ptr.Nome as Origem_Completa,\n  Ptd.Nome as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Nvit.Nome As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt On Lmt.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\n  cad_Origem_Destino Ptd on Ptd.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Navio Nvit On Nvit.IdNavio = Lmt.IdNavio\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nWhere\n  Atv.IdAtividade= :IdAtividade\n  order by Lmt.Data_Previsao_Embarque desc\">\n\n<DataSet Name=\"Tabela_transbordo\" Sql=\"Select\n  CASE\n    WHEN Lmt.Navio IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Lmt.Navio as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Lmt.Porto_Transbordo as Origem_Completa,\n  Lmt.Porto_Desembarque as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lmt.Navio As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join(\n  SELECT\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.Data_Desembarque Desc)As Ranking,\n    Lgv.IdLogistica_House,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Van.Data_Desembarque as Data_Chegada,\n    Van.Data_Previsao_Desembarque as Data_Previsao_Chegada,\n    Nvo.Nome as Navio,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.IdLogistica_Viagem,\n    Lgv.Numero_Controle as Numero_BL,\n    Lgv.Data_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque, \n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Case\n      When Lgv.Tipo_Servico = 0 Then 'Não informado'\n      When Lgv.Tipo_Servico = 1 Then 'Transbordo'\n      When Lgv.Tipo_Servico = 2 Then 'Cabotagem'\n      End As Tipo\n  From\n    mov_Logistica_Viagem Lgv\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  JOIN \n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Precedencia - 1\n  Left Outer Join\n    cad_Navio Nvo on Nvo.IdNavio = Lgv.IdNavio\n  ) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade= :IdAtividade\norder by \n  Lmt.IdLogistica_Viagem asc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga_Detalhada\" Sql=\"Select \nEqm.Rank,\nLhs.IdLogistica_House,\nEqm.Quantidade,\nLmc.Free_Time_Master,\nLmc.Free_Time_House,\nEmr.IdEquipamento_Maritimo,\nLmc.Number,\nDateadd(Day, Lmc.Free_Time_House, Lms.Data_Desembarque) As Data_Devolucao,\nSUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1) AS Tamanho_Equipamento,\nCase\n  When Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\n  When Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\n  When Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 13 Then '' /**/\n  When Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd AS Equipamento\nFROM \nmov_Atividade Atv\nLEFT OUTER JOIN \nmov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \ncad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nLeft Outer Join(\nSelect\nRank() OVER(PARTITION BY IdLogistica_House ORDER BY Eqm.Descricao) AS Rank,\nLme.IdLogistica_House,\nEqm.Descricao as Equipamento,\nLme.Quantidade\nFrom\nmov_Logistica_Maritima_Equipamento Lme\nLeft Outer Join\ncad_Equipamento_Maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\n) Eqm ON Eqm.IdLogistica_House = Lhs.IdLogistica_House and Eqm.Rank = 1\nWHERE \nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \nLhs.IdLogistica_House,\nLme.Quantidade,\nLme.Free_Time_House_Destino,\nEmr.Descricao as Cntr,\nCONCAT(Lme.Quantidade,'x', SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1), ' ' , Case\nWhen Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\nWhen Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\nWhen Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 13 Then '' /**/\nWhen Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd, ' (', Lme.Free_Time_House_Destino, ' Dias)') AS Equipamento\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n\n  \n  <title>FOLLOW UP</title>\n\n  <meta charset=\"utf-8\"> \n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> \n  <meta http-equiv=\"pragma\" content=\"no-cache\"> \n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0\"> \n  <meta name=\"google\" value=\"notranslate\">\n  <meta name=\"format-detection\" content=\"telephone=no\">\n  <meta name=\"scriptVer\" content=\"20231117004.14\">\n  <meta name=\"hashedPath\" content=\"\">\n  <meta name=\"physicalRing\" content=\"WW\">\n  <meta name=\"environment\" content=\"Prod\">\n  <meta name=\"bootFlights\" content=\"localStorageOwaPrefix,fwk-analytics-addons,cal-getTimeZoneOffsetsV2,acctPersistenceSourceIdV2,dev-offlineMultiAccountDB,auth-getAuthTokenV2,cal-publishedCalendarV2,shellmultiorigin:394927,limitfoldersonboot:474919,oobe-welcome-spinner:407828,react18:477911\"> \n  <meta name=\"cdnUrl\" content=\"//res.cdn.office.net/\">\n  <meta name=\"backupCdnUrl\" content=\"//res-h3.public.cdn.office.net/\">\n  <meta name=\"cdnContainer\" content=\"owamail/\">\n  <meta name=\"devCdnUrl\" content=\"\">\n  <meta name=\"ariaUrl\" content=\"\">\n  <meta name=\"webServerForest\" content=\"lamp152\">\n  <meta name=\"webServerClique\" content=\"CLLAMP152CPQ00\"> \n  <meta name=\"compactAriaUrl\" content=\"\">\n  <meta name=\"wcssFrameUrl\" content=\"https://webshell.suite.office.com\">\n  <meta name=\"wcssFrameUrls\" content=\"{'DefaultUrl':'https://webshell.suite.office.com','WwdbUrl':'https://wwdb.webshell.suite.office.com','EudbUrl':'https://eudb.webshell.suite.office.com'}\"> \n  <meta name=\"scriptPath\" content=\"react18/scripts/\">\n  <meta name=\"owaIsAuthenticated\" content=\"{{IsAuthenticated}}\">\n  <meta name=\"jsTimestamp\" content=\"1701290110391\"> \n  <meta name=\"publicUrl\" content=\"https://outlook.office.com\">\n\n  <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n  <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap\" rel=\"stylesheet\">\n  <style media=\"screen and (prefers-reduced-motion: reduce)\" data-make-styles-bucket=\"m\"></style>\n  <style media=\"(forced-colors: active)\" data-make-styles-bucket=\"m\"></style>\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    body,td,tr,p{ font-family: 'Montserrat', sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n      \n    .box_color_yellow { text-align: center; font-weight:700 ; border-width: 30px; background: rgb(255, 221, 114); color: black;}\n    .box_color_grey { text-align: center; border: 10px; background: #808080; color: white;}\n    .grey { color: #808080; }\n    .espacamento-20 {padding: 20px; box-sizing: border-box;}\n    .destacado {font-weight: 600;}\n    .borda-espacada{ border-style:solid; border-color: #808080; border-width: 1px 1px 1px 1px; padding: 2.5px;} \n    .destacado-grey {font-weight: 600; color: #808080;}\n    .borda_sem_baixo{ text-align: center; border-top:solid; border-right:solid; border-left:solid; border-width: 1px 1px 1px 1px; border-color:#808080;}\n    .borda_sem_direita_acomp{ border-bottom:solid; border-top:solid; border-left:solid; border-color: #808080; color: #808080; border-width: 1px 1px 1px 1px}\n    .box_color_noright { border-bottom:solid; border-top:solid; border-right:solid; border-width: 0.2px; color:#808080; border-color: rgb(128, 128, 128);}\n    .text-center-20 { text-align: center; font-size: 20px; font-weight: bold; color: #808080;}\n\n\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<SubReport NameField=\"Referencia_Variavel\" NameSource=\"Processo\">\n[Subject.Footer]\n  \n  \n[Report.Detail]\n<SubReport Name =\"Logo_Andre\" Dataset=\"Processo\">\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>  \n    <td width=\"775\" class=\"box_color_yellow\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n  </tr>\n</table>\n\n<br>\n<br>\n\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td>CLIENTE:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n      <td>DATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td width=\"12%\">TEX#:</td>\n      <td width=\"38%\" class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td>REF:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>\n    <td class=\"box_color_grey\" colspan=\"4\">INFORMAÇÕES DE EMBARQUE</td>\n  </tr>\n</table>\n<br>\n\n<table class=\"borda-espacada\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"20%\" class=\"grey\">EXPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n    <td width=\"20%\" class=\"grey\">IMPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">HBL:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"grey\">NAVIO/VIAGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  </tr>\n  <tr>\n      <td class=\"grey\">ORIGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"grey\">DESTINO:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">ETD:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"grey\">ETA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">EMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"destacado-grey\">DESEMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MBL:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Titulo_Variavel\"></td>\n      <td class=\"grey\"><SubReport NameField=\"Variavel\" NameSource=\"Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MERCADORIA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"grey\">TIPO (FREE TIME):</td>\n      <td class=\"grey\"><SubReport Name=\"Equipamento_Sub\" Dataset=\"Carga\"></td>\n  </tr>\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DA CARGA</td>\n  </tr>\n</table>\n\n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">TIPOS DE EQUIPAMENTOS:</td>\n    <td class=\"grey\">CONTAINERS:</td>\n    <td class=\"grey\">LIMITE DE DEVOLUÇÃO:</td>\n  </tr>\n\n  <SubReport Name=\"Carga_Detalhada_Sub\" Dataset=\"Carga_Detalhada\">\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DE TRANSBORDO</td>\n  </tr>\n</table>\n \n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">PORTO TRANSBORDO</td>\n    <td class=\"grey\">PORTO DESEMBARQUE</td>\n    <td class=\"grey\">NAVIO/VIAGEM</td>\n    <td class=\"grey\">PREV. CHEGADA</td>\n    <td class=\"grey\">CONF. CHEGADA</td>\n    <td class=\"grey\">PREV. EMBARQUE</td>\n    <td class=\"grey\">CONF. EMBARQUE</td>\n  </tr>\n <SubReport Name=\"Transbordo\" Dataset=\"Tabela_transbordo\">\n </table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"20\">\n  <tr>\n    <td class=\"text-center-20\">HISTÓRICO</td>\n  </tr>\n</table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"borda_sem_direita_acomp\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n    <td class=\"box_color_noright\" width=\"80%\"><span class=\"negrito\">DESCRITIVO</span></td>\n  </tr>\n\n    <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n    <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      \n  <tr>\n    <td colspan=\"6\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Logo_Andre.Detail]\n<td colspan=\"2\">\n    <img src=<Print Dataset=\"Processo\" FieldName=\"Logo_Variavel\"> class=\"display-none\"/>\n</td>\n\n[Variavel_Armador.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Armador_Nome\">\n \n[Variavel_Modalidade.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Tipo_Carga_Detalhe\"> <Print Dataset=\"Processo\" FieldName=\"Tipo_Terminal\">\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n\n[Titulo_Referencia]\nTransbordo - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\"> - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> \n\n[Referencia_Titulo]\nTransbordo - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">\n\n\n\n[Transbordo.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Origem_Completa\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Destino_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Navio_Completo\"> / <Print Dataset=\"Tabela_transbordo\" FieldName=\"Viagem_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Embarque_Completa\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n\n[Carga_Detalhada_Sub.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Tamanho_Equipamento\">' <Print Dataset=\"Carga_Detalhada\" FieldName=\"Equipamento\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Number\"></td>\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Data_Devolucao\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n[Equipamento_Sub.Detail]\n<Print Dataset=\"Carga\" FieldName=\"Equipamento\">, \n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Ajuste mensagem automática - Chegada no transbordo.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'Variavel_Armador'\n  else 'Variavel_Modalidade'\n  end as Variavel,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'ARMADOR:'\n  else 'MODALIDADE:'\n  end as Titulo_Variavel,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 59162 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 48952 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n   CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971)  THEN 'Titulo_Referencia'\n  else 'Referencia_Titulo'\n  end as Referencia_Variavel,\n  COALESCE(Agm.Nome,Ctr.Nome) as Armador_Nome,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Nvi.Nome as Navio,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Agm on Agm.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Tabela_transbordo_OLD\" Sql=\"Select\n  CASE\n  WHEN Nvit.Nome IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Nvit.Nome as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Ptr.Nome as Origem_Completa,\n  Ptd.Nome as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Nvit.Nome As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt On Lmt.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\n  cad_Origem_Destino Ptd on Ptd.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Navio Nvit On Nvit.IdNavio = Lmt.IdNavio\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nWhere\n  Atv.IdAtividade= :IdAtividade\n  order by Lmt.Data_Previsao_Embarque desc\">\n\n<DataSet Name=\"Tabela_transbordo\" Sql=\"Select\n  CASE\n    WHEN Lmt.Navio IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Lmt.Navio as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Lmt.Porto_Transbordo as Origem_Completa,\n  Lmt.Porto_Desembarque as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lmt.Navio As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join(\n  SELECT\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.Data_Desembarque Desc)As Ranking,\n    Lgv.IdLogistica_House,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Van.Data_Desembarque as Data_Chegada,\n    Van.Data_Previsao_Desembarque as Data_Previsao_Chegada,\n    Nvo.Nome as Navio,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.IdLogistica_Viagem,\n    Lgv.Numero_Controle as Numero_BL,\n    Lgv.Data_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque, \n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Case\n      When Lgv.Tipo_Servico = 0 Then 'Não informado'\n      When Lgv.Tipo_Servico = 1 Then 'Transbordo'\n      When Lgv.Tipo_Servico = 2 Then 'Cabotagem'\n      End As Tipo\n  From\n    mov_Logistica_Viagem Lgv\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  JOIN \n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Precedencia - 1\n  Left Outer Join\n    cad_Navio Nvo on Nvo.IdNavio = Lgv.IdNavio\n  ) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade= :IdAtividade\norder by \n  Lmt.IdLogistica_Viagem asc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga_Detalhada\" Sql=\"Select \nEqm.Rank,\nLhs.IdLogistica_House,\nEqm.Quantidade,\nLmc.Free_Time_Master,\nLmc.Free_Time_House,\nEmr.IdEquipamento_Maritimo,\nLmc.Number,\nDateadd(Day, Lmc.Free_Time_House, Lms.Data_Desembarque) As Data_Devolucao,\nSUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1) AS Tamanho_Equipamento,\nCase\n  When Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\n  When Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\n  When Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 13 Then '' /**/\n  When Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd AS Equipamento\nFROM \nmov_Atividade Atv\nLEFT OUTER JOIN \nmov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \ncad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nLeft Outer Join(\nSelect\nRank() OVER(PARTITION BY IdLogistica_House ORDER BY Eqm.Descricao) AS Rank,\nLme.IdLogistica_House,\nEqm.Descricao as Equipamento,\nLme.Quantidade\nFrom\nmov_Logistica_Maritima_Equipamento Lme\nLeft Outer Join\ncad_Equipamento_Maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\n) Eqm ON Eqm.IdLogistica_House = Lhs.IdLogistica_House and Eqm.Rank = 1\nWHERE \nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \nLhs.IdLogistica_House,\nLme.Quantidade,\nLme.Free_Time_House_Destino,\nEmr.Descricao as Cntr,\nCONCAT(Lme.Quantidade,'x', SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1), ' ' , Case\nWhen Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\nWhen Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\nWhen Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 13 Then '' /**/\nWhen Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd, ' (', Lme.Free_Time_House_Destino, ' Dias)') AS Equipamento\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n\n  \n  <title>FOLLOW UP</title>\n\n  <meta charset=\"utf-8\"> \n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> \n  <meta http-equiv=\"pragma\" content=\"no-cache\"> \n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0\"> \n  <meta name=\"google\" value=\"notranslate\">\n  <meta name=\"format-detection\" content=\"telephone=no\">\n  <meta name=\"scriptVer\" content=\"20231117004.14\">\n  <meta name=\"hashedPath\" content=\"\">\n  <meta name=\"physicalRing\" content=\"WW\">\n  <meta name=\"environment\" content=\"Prod\">\n  <meta name=\"bootFlights\" content=\"localStorageOwaPrefix,fwk-analytics-addons,cal-getTimeZoneOffsetsV2,acctPersistenceSourceIdV2,dev-offlineMultiAccountDB,auth-getAuthTokenV2,cal-publishedCalendarV2,shellmultiorigin:394927,limitfoldersonboot:474919,oobe-welcome-spinner:407828,react18:477911\"> \n  <meta name=\"cdnUrl\" content=\"//res.cdn.office.net/\">\n  <meta name=\"backupCdnUrl\" content=\"//res-h3.public.cdn.office.net/\">\n  <meta name=\"cdnContainer\" content=\"owamail/\">\n  <meta name=\"devCdnUrl\" content=\"\">\n  <meta name=\"ariaUrl\" content=\"\">\n  <meta name=\"webServerForest\" content=\"lamp152\">\n  <meta name=\"webServerClique\" content=\"CLLAMP152CPQ00\"> \n  <meta name=\"compactAriaUrl\" content=\"\">\n  <meta name=\"wcssFrameUrl\" content=\"https://webshell.suite.office.com\">\n  <meta name=\"wcssFrameUrls\" content=\"{'DefaultUrl':'https://webshell.suite.office.com','WwdbUrl':'https://wwdb.webshell.suite.office.com','EudbUrl':'https://eudb.webshell.suite.office.com'}\"> \n  <meta name=\"scriptPath\" content=\"react18/scripts/\">\n  <meta name=\"owaIsAuthenticated\" content=\"{{IsAuthenticated}}\">\n  <meta name=\"jsTimestamp\" content=\"1701290110391\"> \n  <meta name=\"publicUrl\" content=\"https://outlook.office.com\">\n\n  <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n  <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap\" rel=\"stylesheet\">\n  <style media=\"screen and (prefers-reduced-motion: reduce)\" data-make-styles-bucket=\"m\"></style>\n  <style media=\"(forced-colors: active)\" data-make-styles-bucket=\"m\"></style>\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    body,td,tr,p{ font-family: 'Montserrat', sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n      \n    .box_color_yellow { text-align: center; font-weight:700 ; border-width: 30px; background: rgb(255, 221, 114); color: black;}\n    .box_color_grey { text-align: center; border: 10px; background: #808080; color: white;}\n    .grey { color: #808080; }\n    .espacamento-20 {padding: 20px; box-sizing: border-box;}\n    .destacado {font-weight: 600;}\n    .borda-espacada{ border-style:solid; border-color: #808080; border-width: 1px 1px 1px 1px; padding: 2.5px;} \n    .destacado-grey {font-weight: 600; color: #808080;}\n    .borda_sem_baixo{ text-align: center; border-top:solid; border-right:solid; border-left:solid; border-width: 1px 1px 1px 1px; border-color:#808080;}\n    .borda_sem_direita_acomp{ border-bottom:solid; border-top:solid; border-left:solid; border-color: #808080; color: #808080; border-width: 1px 1px 1px 1px}\n    .box_color_noright { border-bottom:solid; border-top:solid; border-right:solid; border-width: 0.2px; color:#808080; border-color: rgb(128, 128, 128);}\n    .text-center-20 { text-align: center; font-size: 20px; font-weight: bold; color: #808080;}\n\n\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<SubReport NameField=\"Referencia_Variavel\" NameSource=\"Processo\">\n[Subject.Footer]\n  \n  \n[Report.Detail]\n<SubReport Name =\"Logo_Andre\" Dataset=\"Processo\">\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>  \n    <td width=\"775\" class=\"box_color_yellow\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n  </tr>\n</table>\n\n<br>\n<br>\n\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td>CLIENTE:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n      <td>DATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td width=\"12%\">TEX#:</td>\n      <td width=\"38%\" class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td>REF:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>\n    <td class=\"box_color_grey\" colspan=\"4\">INFORMAÇÕES DE EMBARQUE</td>\n  </tr>\n</table>\n<br>\n\n<table class=\"borda-espacada\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"20%\" class=\"grey\">EXPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n    <td width=\"20%\" class=\"grey\">IMPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">HBL:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"grey\">NAVIO/VIAGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  </tr>\n  <tr>\n      <td class=\"grey\">ORIGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"grey\">DESTINO:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">ETD:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"grey\">ETA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">EMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"destacado-grey\">DESEMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MBL:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Titulo_Variavel\"></td>\n      <td class=\"grey\"><SubReport NameField=\"Variavel\" NameSource=\"Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MERCADORIA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"grey\">TIPO (FREE TIME):</td>\n      <td class=\"grey\"><SubReport Name=\"Equipamento_Sub\" Dataset=\"Carga\"></td>\n  </tr>\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DA CARGA</td>\n  </tr>\n</table>\n\n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">TIPOS DE EQUIPAMENTOS:</td>\n    <td class=\"grey\">CONTAINERS:</td>\n    <td class=\"grey\">LIMITE DE DEVOLUÇÃO:</td>\n  </tr>\n\n  <SubReport Name=\"Carga_Detalhada_Sub\" Dataset=\"Carga_Detalhada\">\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DE TRANSBORDO</td>\n  </tr>\n</table>\n \n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">PORTO TRANSBORDO</td>\n    <td class=\"grey\">PORTO DESEMBARQUE</td>\n    <td class=\"grey\">NAVIO/VIAGEM</td>\n    <td class=\"grey\">PREV. CHEGADA</td>\n    <td class=\"grey\">CONF. CHEGADA</td>\n    <td class=\"grey\">PREV. EMBARQUE</td>\n    <td class=\"grey\">CONF. EMBARQUE</td>\n  </tr>\n <SubReport Name=\"Transbordo\" Dataset=\"Tabela_transbordo\">\n </table>\n <br>\n\n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n      <td class=\"grey\">Previsão de chegada no destino final: <Print Dataset=\"Processo\" FieldName=\"Destino\"> no dia: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">.</td>\n  </tr>\n </table>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"20\">\n  <tr>\n    <td class=\"text-center-20\">HISTÓRICO</td>\n  </tr>\n</table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"borda_sem_direita_acomp\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n    <td class=\"box_color_noright\" width=\"80%\"><span class=\"negrito\">DESCRITIVO</span></td>\n  </tr>\n\n    <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n    <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      \n  <tr>\n    <td colspan=\"6\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Logo_Andre.Detail]\n<td colspan=\"2\">\n    <img src=<Print Dataset=\"Processo\" FieldName=\"Logo_Variavel\"> class=\"display-none\"/>\n</td>\n\n[Variavel_Armador.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Armador_Nome\">\n \n[Variavel_Modalidade.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Tipo_Carga_Detalhe\">\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n\n[Titulo_Referencia]\nTransbordo - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\"> - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> \n\n[Referencia_Titulo]\nTransbordo - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">\n\n\n\n[Transbordo.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Origem_Completa\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Destino_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Navio_Completo\"> / <Print Dataset=\"Tabela_transbordo\" FieldName=\"Viagem_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Embarque_Completa\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n\n[Carga_Detalhada_Sub.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Tamanho_Equipamento\">' <Print Dataset=\"Carga_Detalhada\" FieldName=\"Equipamento\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Number\"></td>\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Data_Devolucao\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n[Equipamento_Sub.Detail]\n<Print Dataset=\"Carga\" FieldName=\"Equipamento\">, \n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\AVISO DE ABERTURA DE PROCESSO TEX(TAXAS DUPLICAM).html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lms.Data_Processo,\n  COALESCE(Lmm.Viagem_Navio, Vnv.Numero) as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  COALESCE(Cln.Nome_Fantasia, Cln.Nome) as Cliente,\n  COALESCE(Ept.Nome_Fantasia, Ept.Nome) as Exportador,\n  Ept.Nome_Fantasia As Shipper_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  COALESCE(Imp.Nome_Fantasia, Imp.Nome) as Importador,\n  Imp.Nome_fantasia As Consignee_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  COALESCE(Nty.Nome_Fantasia, Nty.Nome) as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Lrc.Nome as Local_Recebimento,\n  COALESCE(Ctr.Nome_Fantasia, Ctr.Nome) as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then COALESCE(Agd.Nome_Fantasia, Agd.Nome) /*Exportacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then COALESCE(Ago.Nome_Fantasia, Ago.Nome) /*Importacao - Agente no destino*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 1 Then 'Exportação Aérea'\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 2 Then 'Exportação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 1 Then 'Importação Aérea'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 2 Then 'Importação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 3 Then 'Importação Terrestre'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 1 Then 'Nacional Aérea'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 2 Then 'Nacional Marítima'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 3 Then 'Nacional Terrestre'\n  End as Tipo_Modalidade,\n  CASE\n    WHEN Lhs.Tipo_Carga = 1 THEN 'Lcl_Aereo'\n    WHEN Lhs.Tipo_Carga = 4 THEN 'Lcl_Aereo'\n    WHEN Lhs.Tipo_Carga = 3 THEN 'Fcl'\n  END AS Tipo_Carga,\n  Mer.Nome as Mercadoria,\n  Lhs.NCM_Descricao,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Vnd.Nome as Vendedor,\n  COALESCE(Aga.Nome_Fantasia, Aga.Nome) as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Lhs.Instrucoes_Operacional,\n  COALESCE(Des.Nome_Fantasia, Des.Nome) as Despachante,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Lhs.Valor_Mercadoria,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Lhs.Instrucoes_Operacional_Cliente,\n  Ofr.Numero_Oferta,\n  Pfr.Data_Aprovacao As Data_Aprovacao,\n  Mpr.Sigla As Moeda_Processo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Profits\" Sql=\"\nSelect\n  Lhs.IdLogistica_House,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Valor) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Total,  \n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST((SUM(Txs.Valor) - SUM(Txs.Agent))as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Enterprise,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Agent) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Agente\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nWHERE \n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxa\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Mpg.Sigla as Moeda_Pagamento,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n \n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Embalagem\" Sql=\"Select \n  Lge.IdLogistica_Embalagem,\n  Lge.Quantidade,\n  Lge.Altura,\n  Lge.Largura,\n  Lge.Comprimento,\n  Lge.Metros_Cubicos,\n  Lge.Peso_Liquido_Unitario,\n  Lge.Peso_Liquido,\n  Lge.Peso_Bruto_Unitario,\n  Lge.Peso_Bruto,\n  Lge.Peso_Cubado,\n  Lge.Peso_Considerado,\n  Lge.Coeficiente_Conversao_Peso,\n  Lge.Observacao,\n  Tpe.Nome,\n  Tpe.Nome_Internacional\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Embalagem Lge on Lge.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Tipo_Embalagem Tpe on Tpe.IdTipo_Embalagem = Lge.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Contato_Operacional\" Sql=\"Select\n  Rsp.Nome,\n  Rsp.EMail\nFrom \n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd  \n  Par.IdPapel_Projeto in (2)\" /*OPERACIONAL*/>\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<title>Aviso Abertura de Processo</title>\n\n<style type=\"text/css\">\n  * { box-sizing: border-box; }\n  body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n  td { padding: 2px }\n  th { padding: 1px 4px; font-size: 13px; }\n  .tamanho-linha { line-height: 3px; }\n  .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n  .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n  .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n\n  .cabecalho-esquerda { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: left; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 0px 1px 1px}\n  .cabecalho-direita { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 0px}\n\n  .espaco_interno_tabela { padding: 12px 20px; }\n  .alinhamento_esquerda { text-align: left; }\n  .alinhamento_topo { vertical-align: top; }\n  .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n  .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n  .negrito { font-weight: bold; }\n  .sem-negrito { font-weight: normal; }\n  .assinatura { padding-left: 28px; }\n  .altura-linha { line-height: 3px; }\n  .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n  .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n\n</head>\n<body>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contato_Operacional\">;matheus.fransozi@texshipping.com\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contato_Operacional\" FieldName=\"Email\">\n\n[Subject.Header]\nAVISO DE ABERTURA DE PROCESSO - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"> - CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> PROCESSO: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - EXPORTADOR: <Print Dataset=\"Processo\" FieldName=\"Exportador\"> - REF. CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\">\n[Subject.Footer]\n\n[Report.Detail]\n\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho-esquerda\" align=\"left\"><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n      <td class=\"cabecalho-direita\" align=\"right\">AVISO DE ABERTURA DE PROCESSO</td>\n    </tr>\n  </table>\n</span>\n<br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"2\">DETALHES COMERCIAIS</th>\n  </tr>\n  <tr>\n    <td width=\"22%\" class=\"negrito\">VENDEDOR:</td>\n    <td width=\"83%\"><Print Dataset=\"Processo\" FieldName=\"Vendedor\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">NÚMERO OFERTA:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">NÚMERO PROCESSO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">DATA APROVAÇÃO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Data_Aprovacao\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">MODALIDADE PROCESSO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"></td>\n  </tr>\n</table>\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"4\" class=\"text-left\">DADOS PROCESSO</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\">CLIENTE:</td>\n    <td colspan=\"3\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n    <td width=\"11%\" class=\"negrito\">IMPORTADOR:</td>\n    <td width=\"24%\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n    <td width=\"19%\" class=\"negrito\">EXPORTADOR:</td>\n    <td width=\"25%\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">DESPACHANTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Despachante\"></td>\n    <td class=\"negrito\">CIA TRANSPORTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INCOTERM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n    <td class=\"negrito\">MODALIDADE FRETE HOUSE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">ORIGEM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td class=\"negrito\">DESTINO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n</table>\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">DADOS DA CARGA</th>\n  </tr>\n  <tr>\n    <td width=\"12%\" class=\"negrito\">MERCADORIA:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n    <td width=\"12%\" class=\"negrito\">NCM:</td>\n    <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"NCM_Descricao\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">PESO LÍQUIDO:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Peso_Liquido\" DisplayFormat=\"0.000\"> Kgs</td>\n    <td class=\"negrito\">PESO BRUTO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\"0.000\"> Kgs</td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">VOLUMES:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\"></td>\n    <td class=\"negrito\">CBM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\"0.00\"> m³</td>\n  </tr>\n</table>\n<br>\n\n<Subreport NameSource=\"Processo\" NameField=\"Tipo_Carga\">\n\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th align=\"left\">Rates</th>\n    <th align=\"left\">Unit Buying</th>\n    <th align=\"left\">Unit Selling</th>\n    <th align=\"center\">Qtd Buying</th>\n    <th align=\"center\">Buying Rate</th>\n    <th align=\"center\">Qtd Selling</th>\n    <th align=\"center\">Selling Rate</th>\n  </tr>\n  <Subreport Name=\"Taxa\" Dataset=\"Taxa\">\n</table>\n\n<br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">INSTRUÇÕES OPERACIONAL</th>\n  </tr>\n  <tr>\n  <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Operacional\"></td>\n  </tr>\n  </table>\n<br>\n\n<table>\n  <tr>\n    <td class=\"assinatura\">\n      <signature>\n    </td>\n  </tr>\n</table>\n\n[Fcl.Detail]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- FCL -->\n  <tr class=\"cor-fundo-2\">\n    <th align=\"left\">QUANT.</th>\n    <th align=\"left\">TIPO DE EQUIPAMENTO</th>\n    <th align=\"left\">FREE TIME ORIGEM</th>\n    <th align=\"left\">FREE TIME DESTINO</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n    <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Origem\"> dias</td>\n    <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>\n  </tr>\n</table>\n\n[Lcl_Aereo.Detail]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- LCL/AEREO -->\n  <tr class=\"cor-fundo-2\">\n    <th align=\"center\">QUANT.</th>\n    <th align=\"center\">COMPRIMENTO</th>\n    <th align=\"center\">LARGURA</th>\n    <th align=\"center\">ALTURA</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Comprimento\" DisplayFormat=\"0.00\"> cm</td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Largura\" DisplayFormat=\"0.00\"> cm</td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Altura\" DisplayFormat=\"0.00\"> cm</td>\n  </tr>\n</table>\n\n\n[Taxa.Detail]\n<tr>\n    <td width=\"18%\" class=\"borda_direita_esquerda_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Taxa\">\n    </td>\n    <td width=\"19%\" class=\"borda_direita_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Pag_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\"0.00\"> / \n        <Print Dataset=\"Taxa\" FieldName=\"Tipo_Unico\"> \n    </td>\n    <td width=\"19%\" class=\"borda_direita_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Rec_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\"0.00\"> / \n        <Print Dataset=\"Taxa\" FieldName=\"Tipo_Unico\"> \n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Quantidade_Pagamento\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"14%\" align=\"center\" class=\"borda_direita_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Pag_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Quantidade_Recebimento\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"14%\" align=\"center\" class=\"borda_direita_baixo\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Rec_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\"0.00\">\n    </td>\n</tr>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Correção BL #45271 - SMX.html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lmm.Viagem_Navio as Numero_Viagem,\n  Case\n   When Atv.IdTarefa in (114,217) /*Agradecimento, Inf. Prontidão de carga*/ Then NULL\n  Else Lms.Data_Previsao_Embarque\n  End as Data_Previsao_Embarque,\n  Case\n    When Atv.IdTarefa in (114,217) /*Agradecimento, Inf. Prontidão de carga*/ Then NULL\n    Else Lms.Data_Previsao_Desembarque\n  End as Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Coalesce(Utr.Navio_Transbordo, Nvi.Nome) As Navio,\n  Cem.Numero_Desconsolidacao,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos as Documento_House,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Mer.Nome as Mercadoria,\n  Lam.Numero_Voo,\n  Lhs.Conhecimentos,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  case Lhs.Tipo_Carga\n    When 3 Then 'FCL'\n    else 'FCL' end as Tipo_Carga_Modelo,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Vnd.Nome as Vendedor,\n  Vnd.Email as Vendedor_Email,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Ago.Nome As Agente_Origem_Nome,\n  Ago.Fone As Agente_Origem_Fone,\n  Ago.Vat_Number As Agente_Origem_Nif,\n  coalesce(Ago.Logradouro,'') + ', ' + coalesce(Ago.Numero,'') As Agente_Origem_Logradouro,\n  Mao.Nome As Agente_Origem_Municipio,\n  Pao.Nome As Agente_Origem_Pais,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Cem.Numero_Desconsolidacao As Numero_Desconsolidacao,\n  Case \n    When Lhs.Tipo_Carga = 0 Then '(Não especificado)'\n    When Lhs.Tipo_Carga = 1 Then 'AEREO'\n    When Lhs.Tipo_Carga = 2 Then 'BREAK-BULK'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'RODOVIARIO'\n  end as Consolidacao\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  mov_Conhecimento_Embarque Cem on Cem.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Municipio Mao on Mao.IdMunicipio = Ago.IdMunicipio\nLeft Outer Join\n  cad_Pais Pao on Pao.IdPais = Ago.IdPais\nLeft Outer Join\n  (Select\n    Lmt.IdLogistica_Master,\n    Lmt.IdPorto_Transbordo,\n    Lmt.IdNavio,\n    Lmt.Data_Embarque,\n    Nvi.Nome AS Navio_Transbordo,\n    Rank() Over (Partition By Lmt.IdLogistica_Master Order By Lmt.Data_Embarque Desc, Lmt.Data_Previsao_Embarque Desc) As Ranking\n  From\n    mov_Logistica_Maritima_Transbordo Lmt\n  Left Outer Join\n    cad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\n  ) Utr On Utr.IdLogistica_Master = Lms.IdLogistica_Master And Utr.Ranking = 1\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n\n<DataSet Name=\"Campo_Livre_Solicitacao\" Sql=\"\nSelect\nLp1.Identificador,\nLp1.Valor_Data\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  LEFT OUTER JOIN\n(\n    SELECT\n    Lhs.IdLogistica_House\n\t, Ccl.Identificador\n\t, Ccl.Exibicao_Padrao\n\t, Ccl.Itens\n\t, Lpr.IdCampo_Livre\n\t, Lpr.Valor_Alfanumerico\n\t, Lpr.Valor_Texto\n\t, Lpr.Valor_Boleano\n\t, Lpr.Valor_Tipo_Fixo\n\t, Lpr.Valor_Inteiro\n\t, Lpr.Valor_Data\n\t, Lpr.Valor_Real4\n  FROM\n    mov_Logistica_House Lhs\n  CROSS JOIN\n    cad_Configuracao_Campo_Livre Ccl\n  LEFT OUTER JOIN\n    vis_Logistica_Prazo Lpr \n\t  ON Lpr.IdLogistica_House = Lhs.IdLogistica_House\n\t  AND Lpr.Identificador = Ccl.Identificador\n) Lp1 ON Lp1.IdLogistica_House = Lhs.IdLogistica_House AND Lp1.Identificador = 'BL_3_d_s_bl3'\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Campo_Livre_Conclusao\" Sql=\"Select\nLp1.Identificador,\nLp1.Exibicao_Padrao,\nLp1.Valor_Data\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  LEFT OUTER JOIN\n(\n    SELECT\n    Lhs.IdLogistica_House\n\t, Ccl.Identificador\n\t, Ccl.Exibicao_Padrao\n\t, Ccl.Itens\n\t, Lpr.IdCampo_Livre\n\t, Lpr.Valor_Alfanumerico\n\t, Lpr.Valor_Texto\n\t, Lpr.Valor_Boleano\n\t, Lpr.Valor_Tipo_Fixo\n\t, Lpr.Valor_Inteiro\n\t, Lpr.Valor_Data\n\t, Lpr.Valor_Real4\n  FROM\n    mov_Logistica_House Lhs\n  CROSS JOIN\n    cad_Configuracao_Campo_Livre Ccl\n  LEFT OUTER JOIN\n    vis_Logistica_Prazo Lpr \n\t  ON Lpr.IdLogistica_House = Lhs.IdLogistica_House\n\t  AND Lpr.Identificador = Ccl.Identificador\n) Lp1 ON Lp1.IdLogistica_House = Lhs.IdLogistica_House AND Lp1.Identificador = 'BL_3_d_c_bl3'\nWhere\n    Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\nPcn.Ativo = 1 /*Somente usuários ativos do grupo selecionado*/\nAnd\nAtv.IdAtividade = :IdAtividade\">\n\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html\"/>\n<title>Correção</title>\n</head>\n\n<style type=\"text/css\">\nbody,td,tr{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:11.0pt; padding-left:5px;}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:11.0pt; text-align:justify}\n.p_instrucoes{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:8.5pt; text-align:justify}\n.topo{ text-align:center; font-size:18px; font-weight:600; color:#FF0000}\n.negrito{ font-weight:600;}\n.vermelho{ color:#FF0000; font-weight:600;}\n\n</style>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nCORREÇÃO BL - PROCESSO: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - BOOKING: <print DataSet=\"Processo\" FieldName=\"Numero_Reserva\"> \n[Subject.Footer]\n\n[Report.Detail]\n<SubReport NameField=\"Tipo_Carga_Modelo\" NameSource=\"Processo\" Dataset=\"Processo\">\n\n[FCL.Detail]\n<body style=\"font-family: 'Segoe UI', Helvetica, Arial, sans-serif; margin: 0; padding: 0;\"></body>\n<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"background-color: #f8f9fa; padding: 20px;\">\n        <tr>\n            <td align=\"center\">\n                \n                <table width=\"600\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"background-color: #ffffff; border: 1px solid #e9ecef; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n                    \n                    <tr>\n                        <td style=\"padding: 30px 40px 20px 40px; font-size: 16px; color: #333333; line-height: 1.5;\">\n                            Gentileza seguir com a alteração conforme demonstrado no DE/PARA abaixo:\n                        </td>\n                    </tr>\n\n                    <tr>\n                        <td style=\"padding: 0 40px 30px 40px;\">\n                            \n                            <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"border: 1px solid #dee2e6; border-radius: 6px; border-collapse: separate; overflow: hidden;\">\n                                \n                                <tr>\n                                    <td width=\"50%\" style=\"background-color: #f1f3f5; padding: 12px 15px; font-size: 14px; font-weight: bold; color: #6c757d; border-bottom: 1px solid #dee2e6; border-right: 1px solid #dee2e6;\">\n                                        DE\n                                    </td>\n                                    <td width=\"50%\" style=\"background-color: #e7f1ff; padding: 12px 15px; font-size: 14px; font-weight: bold; color: #0d6efd; border-bottom: 1px solid #dee2e6;\">\n                                        PARA\n                                    </td>\n                                </tr>\n\n                                <tr>\n                                    <td style=\"padding: 20px; background-color: #ffffff; border-right: 1px solid #dee2e6; vertical-align: top;\">\n                                        <span style=\"font-size: 11px; color: #999999; text-transform: uppercase; letter-spacing: 1px; font-weight: 600;\">Data Solicitação</span><br>\n                                        <div style=\"font-size: 16px; color: #495057; font-weight: bold; margin-top: 8px;\">\n                                            <Print Dataset=\"Campo_Livre_Solicitacao\" FieldName=\"Valor_Data\">\n                                        </div>\n                                    </td>\n\n                                    <td style=\"padding: 20px; background-color: #ffffff; vertical-align: top;\">\n                                        <span style=\"font-size: 11px; color: #999999; text-transform: uppercase; letter-spacing: 1px; font-weight: 600;\">Data Conclusão</span><br>\n                                        <div style=\"font-size: 16px; color: #0d6efd; font-weight: bold; margin-top: 8px;\">\n                                            <Print Dataset=\"Campo_Livre_Conclusao\" FieldName=\"Valor_Data\">\n                                        </div>\n                                    </td>\n                                </tr>\n\n                            </table>\n                        </td>\n                    </tr>\n                    \n                </table>\n            </td>\n        </tr>\n    </table>\n\n<signature>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\COTAÇÃO PRICING - 2023 - AGL #45079.html",
        "conteudo": "[Report.Header]\n<!DOCTYPE html>\n<DataSet Name=\"Proposta\" Sql=\"Select\n  Pfr.IdProposta_Frete,\n  Pfr.Numero_Proposta,\n  Pfr.Data_Proposta,\n  Cli.Nome as Cliente,\n  Cct.Nome as Cliente_Contato,\n  Cct.Fone as Cliente_Contato_Fone,\n  Cct.EMail As Cliente_Contato_Email,\n  Vnd.Nome as Vendedor,\n  Vnd.Detalhes as Vendedor_Detalhes,\n  Vnd.EMail as Vendedor_Email\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Cli on Cli.IdPessoa = Pfr.IdCliente\nLeft Outer Join\n  cad_Pessoa_Contato Cct on Cct.IdPessoa_Contato = Pfr.IdCliente_Contato\nLeft Outer Join\nIdVendedor  cad_Pessoa Vnd on Vnd.IdPessoa = Pfr.IdVendedor\nWhere\n    Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Oferta\" Sql=\"Select\n  CASE \n    WHEN Pfc.Tipo_Carga IN (2,4) /*LCL*/ THEN CONVERT(VARCHAR, FORMAT(Pfc.Quantidade_Volumes, '0.000'))\n    WHEN Pfc.Tipo_Carga IN (1) /*LCL*/ THEN CONVERT(VARCHAR, Pfc.Quantidade_Volumes)\n    WHEN Pfc.Tipo_Carga = 3 /*FCL*/ THEN Pfn.Equipamento\n  END AS Descricao_Carga,\n  Pfc.Quantidade_Volumes,\n  Ofr.IdOferta_frete,\n  Ofr.IdProposta_Frete,\n  CASE\n  WHEN Ofr.Instrucoes_Cliente IS NOT NULL then 'Instrucoes_Cli' else '' end as Variavel_Instrucao,\n  Ofr.Instrucoes_Cliente as Instrucoes_Cliente_Final,\n  Ofr.Numero_Oferta,\n  Ofr.Remarks as Obs_Remarks,\n  Ofr.Remarks_Terrestre as Remarks_Terrestre,\n  Ofr.Remarks_Free_Time as Remarks_Free_Time,\n  CASE\n  Ofv.Tipo_Servico\n  WHEN 0 then 'NOT APPLICABLE'\n  WHEN 1 THEN 'Dedicado'\n  WHEN 2 THEN 'Rodizio'\n  end as Tipo_Servico_Coleta,\n  Nsa.Descricao as Nivel_Servico,\n  CASE\n    WHEN Ofr.Modalidade_Processo = 1 Then 'Oversized'\n  Else ''\n  End AS Over_Agl,\n  CASE \n    When Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 4 Then 'AIR-AIR'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 5 Then 'SEA-AIR'\n    When Ofr.Tipo_Operacao = 3 and Ofr.MOdalidade_Processo = 1 Then 'NACIONAL AÉREO'\n    When Ofr.Tipo_Operacao = 3 and Ofr.Modalidade_Processo = 2 Then 'NACIONAL MARÍTIMO (CABOTAGEM)'\n    When Ofr.Tipo_Operacao = 3 and Ofr.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade,\n  CASE\n  When Ofr.Modalidade_Processo = 3 THEN 'trucking@aglcargo.com' ELSE '' end as Email_Trucking,\n  Case \n    WHEN coalesce(Ofr.Tipo_Servico,0) = 0 Then 'NOT APPLICABLE'\n    WHEN Ofr.Tipo_Servico = 1 Then 'DOOR TO DOOR'\n    WHEN Ofr.Tipo_Servico = 2 Then 'DOOR TO PORT'\n    WHEN Ofr.Tipo_Servico = 3 Then 'PORT TO DOOR'\n    WHEN Ofr.Tipo_Servico = 4 Then 'PORT TO PORT'\n    WHEN Ofr.Tipo_Servico = 5 Then 'PORT TO RAMP'\n    Else CAST(Ofr.Tipo_Servico as VarChar(Max)) end As Tipo_Servico,\n  Ofr.Transit_Time,\n  CASE\n    WHEN Tps.Nome is null Then 'NOT APPLICABLE'\n    Else Tps.Nome end As Tipo_Processo,\n  Ofr.Transit_Time_Maximo,\n  CASE \n    WHEN COALESCE(Ofr.Local_Entrega, Ofv.Local_Entrega) IS NULL \n        THEN 'NOT APPLICABLE'\n    ELSE COALESCE(Ofr.Local_Entrega, Ofv.Local_Entrega) \nEND AS Local_Entrega,\n  CASE\n    WHEN Ofr.Local_Coleta is null Then 'NOT APPLICABLE'\n    Else Ofr.Local_Coleta end As Local_Coleta,\n  CASE Ofr.Modalidade_Pagamento_Master WHEN 0 THEN 'Não informado' WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_Master,\n  CASE Ofr.Modalidade_Pagamento_House WHEN 0 THEN 'Não informado' WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_House,\n  CASE\n    WHEN Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga <> 4 /*LCL*/ Then ' pricingimpo.seafreight@aglcargo.com' /*IMPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga = 4 /*LCL*/ Then ' pricinglcl.seafreight@aglcargo.com' /*IMPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga <> 4 /*LCL*/ Then ' pricingexpo.seafreight@aglcargo.com' /*EXPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga = 4 /*LCL*/ Then ' pricinglcl.seafreight@aglcargo.com' /*EXPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1 Then ' pricing.airfreight@aglcargo.com' /*IMPO AEREA*/\n    WHEN Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 1 Then ' pricing.airfreight@aglcargo.com' /*EXPO AEREA*/\n  END AS Email_Pricing,\n  Ofr.Data_Validade,\n  Ofr.Referencia_Cliente,\n  Ofr.Referencia_Externa,\n  Ofr.Validade_Dias,\n  Ofr.Observacao,\n  Ept.Nome as Exportador,\n  Imp.Nome as Importador,\n  Imp.CPF_CNPJ AS Importador_CNPJ,\n  CASE Pfc.Tipo_Carga\n    WHEN 4 /*LCL*/ THEN 'Importador_LCL'\n    ELSE ''\n  END AS Campos_Importador,\n  Vnd.Nome as Vendedor,\n  Pfr.Numero_Proposta,\n  Pfr.Data_Aprovacao,\n  Cli.Nome as Cliente,\n  CASE WHEN Ofr.Modalidade_Processo = 3 then 'Origem_Destino_Terrestre' else 'Origem_Destino_Padrao' end as Condicao_Origem_Destino,\n  Cli.Detalhes as Detalhes_Cliente,\n  Dsp.Nome as Despachante,\n  Cia.Nome as Cia_Transporte,\n  Inc.Nome as Incoterm,\n  Loc.Nome as Local_Recebimento,\n  Case\n    WHEN Org.Nome is null then 'NOT APPLICABLE'\n    Else Org.Nome end As Origem,\n  Org.Sigla as Origem_Sigla,\n  Case\n    WHEN Dst.Nome is null then 'NOT APPLICABLE'\n    Else Dst.Nome end As Destino,\n  Dst.Sigla as Destino_Sigla,\n  Dsf.Nome as Destino_Final,\n  Ofr.Transit_Time,\n  Ofr.Transit_Time_Maximo,\n  Pfc.Peso_Liquido,\n  Pfc.Peso_Bruto,\n  COALESCE(Orv.Nome,Org.Nome) as Origem_Terrestre,\n  COALESCE(Ord.Nome,Dst.Nome) as Destino_Terrestre,\n  Pfc.Peso_Cubado,\n  Pfc.NCM_Descricao,\n  Pfc.Peso_Considerado,\n  Pfc.Peso_Taxado,\n  Pfc.Metros_Cubicos,\n  Pfc.Equipamentos,\n  Pfc.Quantidade_Volumes,\n  Pfe.Equipamento,\n  CASE \n    WHEN Pfc.Tipo_Carga IN (1,2,4) /*LCL*/ Then 'Qty Volumes:'\n\tWHEN Pfc.Tipo_Carga = 3 /*FCL*/ Then 'Equipments:'\n  END AS Titulo_Carga,\n  Case \n    WHEN coalesce(Pfc.Valor_Mercadoria,0) = 0 Then 'NOT APPLICABLE'\n    Else CAST(Pfc.Valor_Mercadoria as VarChar(Max)) end As Valor_Mercadoria,\n  CASE Pfc.Tipo_Carga WHEN 1 THEN 'Áéreo' WHEN 2 THEN 'Break-Bulk' WHEN 3 THEN 'FCL' WHEN 4 THEN 'LCL' WHEN 5 THEN 'RO-RO' WHEN 6 THEN 'Rodoviário' END as Tipo_Carga,\n  CASE \n    WHEN Ofr.Modalidade_Processo = 2 AND Pfc.Tipo_Carga = 3 THEN 'Maritimo_FCL'\n    WHEN Ofr.Modalidade_Processo = 2 AND Pfc.Tipo_Carga <> 3 THEN 'Maritimo_LCL'\n    ELSE 'Outros'\n  END as Tipo_Oferta,\n  Case Pfc.Tipo_Carga\n    WHEN 1 THEN 'Aereo'\n    WHEN 3 Then 'FCL'\n    ELSE 'LCL'\n  End As Tipo_Carga_Detalhe,\n  Case Pfc.Tipo_Carga\n    WHEN 1 THEN ''\n    WHEN 3 Then ''\n    ELSE 'LCL'\n  End As Tipo_Carga_Detalhe2,\n  Mer.Nome as Mercadoria,\n  Case\n     When coalesce(Pfc.Carga_Perigosa,0) = 1 Then 'Carga_Per'\n     Else 'Não'\n  End As Carga_Perigosa,    \n  Case\n     When coalesce(Mer.Carga_Perigosa,0) = 1 Then 'Sim'\n     Else 'Não'\n  End As Mercadoria_Perigosa,      \n  Fvg.Descricao as Frequencia,\n  Ofr.Rota,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Uni.Valor_Alfanumerico as Cl_Un,\n  Cla.Valor_Alfanumerico as Cl_Class,\n  Pcg.Valor_Alfanumerico as Cl_Packing_Group,\n  CASE\n  Cmp.Valor_Tipo_Fixo\n  WHEN 2 THEN 'YES'\n  WHEN 3 THEN 'NO'\n  ELSE ''\n  END AS Carga_Empilhavel,\n  CASE\n  Tve.Valor_Tipo_Fixo\nWHEN 1 then 'Não se aplica'\nWHEN 2 then 'Utilitário'\nWHEN 3 then 'Van'\nWHEN 4 then 'VUC - Veículo Urbano de Carga'\nWHEN 5 then 'Caminhão Toco'\nWHEN 6 then 'Caminhão Truck'\nWHEN 7 then 'Cavalo e Carreta 28 Paletes'\nWHEN 8 then 'Cavalo e Carreta 30 Paletes'\nWHEN 9 then 'Outros'\n  ELSE 'Não se aplica'\n  END AS Tipo_Veiculo,\nCASE\nNes.Valor_Tipo_Fixo\nWHEN 1 THEN 'Não se aplica'\nWHEN 2 THEN 'Plataforma'\nWHEN 3 THEN 'Ajudante. Se positivo, Quantos?'\nWHEN 4 THEN 'Munck'\nWHEN 5 THEN 'Outros'\n  ELSE 'Não se aplica'\n  END AS Necessidades_Especiais,\nCASE\nIfc.Valor_Tipo_Fixo\nWHEN 1 THEN 'Não se aplica'\nWHEN 2 THEN 'Órgão Anuente'\nWHEN 3 THEN 'Certificação especial'\nELSE 'Não se aplica'\n  END AS Informacoes_Complementares\n\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Ofr.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Ofr.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Loc on Loc.IdOrigem_Destino = Ofr.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Ofr.IdDestino_Final\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Ofr.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Ofr.IdImportador\nLeft Outer Join\n  cad_Pessoa Cia on Cia.IdPessoa = Ofr.IdCompanhia_Transporte\nLEFT OUTER JOIN\n  cad_Nivel_Servico_Aereo Nsa on Nsa.IdNivel_Servico_Aereo = Ofr.IdNivel_Servico_Aereo\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Ofr.IdIncoterm\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Pfr.IdVendedor\nLeft Outer Join\n  cad_Pessoa Cli on Cli.IdPessoa = Pfr.IdCliente\nLEFT OUTER JOIN\n  cad_Tipo_Processo Tps on Tps.IdTipo_Processo = Ofr.IdTipo_Processo\nLeft Outer Join\n  cad_Pessoa Dsp on Dsp.IdPessoa = Ofr.IdDespachante_Aduaneiro\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Pfc.IdMercadoria\nLeft Outer Join\n  cad_moeda Mmr On Mmr.IdMoeda = Pfc.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Frequencia_Viagem Fvg on Fvg.IdFrequencia_Viagem = Ofr.IdFrequencia_Viagem\nLeft Outer Join\n  mov_Oferta_Frete_Viagem Ofv on Ofv.IdOferta_Frete = Ofr.IdOferta_Frete and Ofv.Tipo_Viagem = 1\nLeft Outer Join\n  cad_Origem_Destino Orv on Orv.IdOrigem_Destino = Ofv.IdOrigem and Ofv.Tipo_Viagem = 1\nLeft Outer Join\n  cad_Origem_Destino Ord on Ord.IdOrigem_Destino = Ofv.IdDestino and Ofv.Tipo_Viagem = 1\n/*Campos Livres*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Uni on Uni.IdOferta_Frete = Ofr.IdOferta_Frete and Uni.IdConfiguracao_Campo_Livre = 59 /*UN*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Cla on Cla.IdOferta_Frete = Ofr.IdOferta_Frete and Cla.IdConfiguracao_Campo_Livre = 60 /*Class*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Pcg on Pcg.IdOferta_Frete = Ofr.IdOferta_Frete and Pcg.IdConfiguracao_Campo_Livre = 61 /*Packing Group*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Cmp on Cmp.IdOferta_Frete = Ofr.IdOferta_Frete and Cmp.IdConfiguracao_Campo_Livre = 69 /*Carga Empilhavel*/  \nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Tve on Tve.IdOferta_Frete = Ofr.IdOferta_Frete and Tve.IdConfiguracao_Campo_Livre = 71 /*Tipo_Veiculo*/  \nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Nes on Nes.IdOferta_Frete = Ofr.IdOferta_Frete and Nes.IdConfiguracao_Campo_Livre = 72 /*Necessidades_Especiais*/  \nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Ifc on Ifc.IdOferta_Frete = Ofr.IdOferta_Frete and Ifc.IdConfiguracao_Campo_Livre = 73 /*Informacoes_Complementares*/  \nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(CONCAT_WS(' x ', Pfe.Quantidade, CASE\n        WHEN CHARINDEX(' ', Emr.Descricao) > 0 THEN SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1)\n        ELSE Emr.Descricao\n      END,\n      CASE\n        WHEN Emr.IdEquipamento_Maritimo = 1 THEN 'TK' /* Tank */\n        WHEN Emr.IdEquipamento_Maritimo = 2 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 3 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 4 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 5 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 6 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 7 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 8 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 9 THEN 'HC' /* High Cube */\n        WHEN Emr.IdEquipamento_Maritimo = 10 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 11 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 12 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 13 THEN ' ' /**/\n        WHEN Emr.IdEquipamento_Maritimo = 14 THEN ' ' /* Nor */\n        WHEN Emr.IdEquipamento_Maritimo = 15 THEN 'NOR' /* Nor */\n        ELSE Emr.Descricao\n      END\n    ),\n    ' / '\n  ) AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga) Pfe ON Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(ISNULL(CONVERT(VARCHAR, Pfe.Quantidade), ' ') + ' x ' + ISNULL(CAST(Emr.Descricao AS VARCHAR(MAX)), ''), ', ') AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga, Pfe.Quantidade\n) Pfn ON Pfn.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nWhere\n  Atv.IdAtividade = :IdAtividade\" MasterSource=\"Proposta\" MasterFields=\"IdProposta_Frete\" LocalFields=\"IdProposta_Frete\">\n\n\n<DataSet Name=\"Equipamentos_Agrupados\" Sql=\"Select\n  STRING_AGG(Pfn.Equipamento, ', ') as Equipamento_Agrupado\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(CONCAT_WS(' x ', Pfe.Quantidade, CASE\n        WHEN CHARINDEX(' ', Emr.Descricao) > 0 THEN SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1)\n        ELSE Emr.Descricao\n      END,\n      CASE\n        WHEN Emr.IdEquipamento_Maritimo = 1 THEN 'TK' /* Tank */\n        WHEN Emr.IdEquipamento_Maritimo = 2 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 3 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 4 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 5 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 6 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 7 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 8 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 9 THEN 'HC' /* High Cube */\n        WHEN Emr.IdEquipamento_Maritimo = 10 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 11 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 12 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 13 THEN ' ' /**/\n        WHEN Emr.IdEquipamento_Maritimo = 14 THEN ' ' /* Nor */\n        WHEN Emr.IdEquipamento_Maritimo = 15 THEN 'NOR' /* Nor */\n        ELSE Emr.Descricao\n      END\n    ),\n    ' / '\n  ) AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga) Pfe ON Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(ISNULL(CONVERT(VARCHAR, Pfe.Quantidade), ' ') + ' x ' + ISNULL(CAST(Emr.Descricao AS VARCHAR(MAX)), ''), ', ') AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga, Pfe.Quantidade\n) Pfn ON Pfn.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Equipamentos\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Ofr.IdProposta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfc.Descricao,\n  Pfe.Quantidade,\n  Emr.Descricao As Equipamento,\n  Oft.Master_Origem,\n  Oft.House_Origem,\n  Oft.Master_Destino,\n  Oft.House_Destino\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  mov_Oferta_Frete Ofr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Equipamento Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nLeft Outer Join\n  cad_Equipamento_Maritimo Emr On Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo  \nLeft Outer Join\n  mov_Oferta_Frete_Free_Time Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete And Oft.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo \nWhere\n  Atv.IdAtividade = :IdAtividade\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Carga\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfc.Descricao,\n  Pfe.Quantidade,\n  Pfe.Altura,\n  Pfe.Largura,\n  Pfe.Comprimento,\n  Pfe.Metros_Cubicos,\n  Pfe.Peso_Liquido,\n  Pfe.Peso_Bruto,\n  Pfe.Peso_Bruto_Unitario,\n  Pfe.Peso_Cubado,\n  Pfe.Peso_Considerado,\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End as oversized_cargo, \n  Emb.Nome as Embalagem\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Embalagem Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nLEFT OUTER JOIN\n  cad_Tipo_Embalagem Emb ON Emb.IdTipo_Embalagem = Pfe.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\nOrder by\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End DESC\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n\n\n<DataSet Name=\"Cargas\" sql=\"Select\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  SUM(Pfe.Quantidade) as Quantidade_Total\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Embalagem Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nWhere\n  Atv.IdAtividade = :IdAtividade\nGroup By\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta\"\n   MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\"></DataSet>\n\n <DataSet Name=\"oversized_cargo\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfe.Altura,\n  Pfe.Largura,\n  Pfe.Comprimento,\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End as oversized_cargo, \n  Emb.Nome as Embalagem\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Embalagem Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nLEFT OUTER JOIN\n  cad_Tipo_Embalagem Emb ON Emb.IdTipo_Embalagem = Pfe.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\n  AND\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End LIKE '**OVERSIZED CARGO**' \" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Oferta_Taxa_Frete\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  CASE Oft.Tipo_Recebimento \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Recebimento_Extenso,\n  CASE Oft.Tipo_Pagamento\n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Pagamento_Extenso,\n  Oft.Origem_Taxa,\n  Oft.Complemento,\n  Tle.Nome As Taxa,\n  Mrc.Sigla As Moeda_Recebimento,\n  Prc.Nome As Pessoa_Recebimento,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  mov_Proposta_Frete Pfr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nWhere\n  Atv.IdAtividade = :IdAtividade\nand\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Origem_Taxa=1  /*Frete*/\nand\n  Oft.Valor_Recebimento_Total is not Null\nOrder By\n  Case Tlg.Tipo\n    When 1 /* Frete */ Then 0\n    Else 1\n  End, \n  Oft.Origem_Taxa,  \n  Tle.Nome\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Oferta_Taxa_Origem\" Sql=\"Select\nOft.Tipo_Recebimento,\n  Ofr.IdOferta_Frete,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  CASE Oft.Tipo_Recebimento \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Recebimento_Extenso,\n  CASE Oft.Tipo_Pagamento\n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Pagamento_Extenso,\n  Oft.Origem_Taxa,\n  Oft.Complemento,\n  Tle.Nome As Taxa,\n  Mrc.Sigla As Moeda_Recebimento,\n  Prc.Nome As Pessoa_Recebimento,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  mov_Proposta_Frete Pfr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nWhere\n  Atv.IdAtividade = :IdAtividade\nand\n  Oft.Exibir_Cliente=1\nand\n  Oft.Origem_Taxa=2  /*Origem*/\nand\n  Oft.Valor_Recebimento_Total is not Null\nOrder By\n  Tle.Nome\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Oferta_Taxa_Destino\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  CASE Oft.Tipo_Recebimento \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Recebimento_Extenso,\n  CASE Oft.Tipo_Pagamento\n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Pagamento_Extenso,\n  Oft.Origem_Taxa,\n  Oft.Complemento,\n  Tle.Nome As Taxa,\n  Mrc.Sigla As Moeda_Recebimento,\n  Prc.Nome As Pessoa_Recebimento,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  mov_Proposta_Frete Pfr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nWhere\n  Atv.IdAtividade = :IdAtividade\nand\n  Oft.Exibir_Cliente=1\nand\n  Oft.Origem_Taxa=3 /*Destino*/\nand\n  Oft.Valor_Recebimento_Total is not Null\nOrder By\n  Tle.Nome\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Total_Cotacao_Moeda\" Sql=\"Select\n Ofrt.IdOferta_Frete,\n Stuff(Cast((Select ' + ' + Tmd.Moeda_Recebimento + ' ' + Format(Tmd.Valor, 'N', 'pt-br') From (Select\n    Ofr.IdOferta_Frete,\n    Mrc.Sigla as Moeda_Recebimento,\n    sum(Oft.Valor_Recebimento_Total) As Valor\n  From\n    mov_Oferta_Frete Ofr\n  Join\n    mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n      Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n        And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n        And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n        And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n        And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n        And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n          Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n          Or (Oft.Origem_Taxa = 1 /* Frete */)))\n  Join\n    cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\n  Left Outer Join\n    cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\n  Left Outer Join\n    mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n  Where\n    Oft.Exibir_Cliente = 1\n  and\n    Oft.Valor_Recebimento_Total <> 0\n  and\n    Ofr.IdOferta_Frete = Ofrt.IdOferta_Frete\n  Group By\n    Ofr.IdOferta_Frete,\n    Mrc.Sigla) As Tmd For Xml Path, Type).query('data(.)') As VarChar(Max)), 1, 2, '') As Total_Moeda\nFrom\n  mov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Proposta_Frete Pfr ON Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Oferta_Frete Ofrt ON Ofrt.IdProposta_Frete = Pfr.IdProposta_Frete\nWHERE\n  Atv.IdAtividade = :IdAtividade\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Rsp.Nome,\n  Rsp.Email as Email\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\n  And\n  Par.IdPapel_Projeto in (9)\" /*PRICING*/>\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Pfr.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<DataSet Name=\"Usuario\" Sql=\"\nSelect\n  Fcn.IdPessoa,\n  Fcn.Nome,\n  Fcn.EMail,\n  Fcn.Fone,\n  Cgo.Nome as Cargo\nFrom\n  (\n    Select Top 1\n      Cast(Valor As Integer) As IdUsuario\n    From\n      #Global_Var\n    Where\n      Variavel = 'IdUsuario'\n  ) Elg\nJOIN\n  vis_Funcionario Fcn ON Fcn.IdUsuario_Correspondente = Elg.IdUsuario\nLEFT OUTER JOIN\n  cad_Cargo Cgo ON Cgo.IdCargo = Fcn.IdCargo\">\n\n  <DataSet Name=\"Copia_Carbono\" Sql=\"Select\n  Rsp.Nome,\n  'pricing.airfreight@aglcargo.com' as Email\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\n  And\n  Par.IdPapel_Projeto in (9)\n  And\n  Rsp.IdPessoa in (72641 /*JEFFERSON PAVAN*/, 73200 /*REBBECA MOTA*/, 62154 /*GABRIEL AGUIAR*/)\" /*PRICING*/>\n\n  <DataSet Name=\"Destinario_pricing\" Sql=\"Select\n  CASE WHEN Rsp.IdPessoa = 44504/*THIAGO SOEIRO*/ Then 'thiago.soeiro@aglcargo.com; pricing.vas@aglcargo.com'\n  Else Rsp.Email End as Email\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\n  And\n  Par.IdPapel_Projeto in (13)\" /*PRICING*/>\n\n<html>\n<head>\n    <meta charset=\"utf-8\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <title>PROPOSTA COMERCIAL</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n</head>\n    <style type=\"text/css\">\n        * { box-sizing: border-box; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n        .border-table { border: 1px solid #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n        th { padding: 1px 4px; font-size: 14px; }\n        .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-cinza { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .text-center { text-align: center; vertical-align: middle; }\n        .logo-espacamento { padding: 16px 0; }\n        .text-left { text-align: left; }\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-white { color: white; }\n        .negrito { font-weight: bold; }\n        .negrito_Esquerda { font-weight: bold; text-align: left; }\n        .sem-negrito { font-weight: normal; }\n        .logo-assinatura { padding-right: 4px; border-right: 2px solid #204080; }\n        .td-contato { padding-left: 4px; }\n        .font-size-14 { font-size: 14pt; }\n        .font-size-11 { font-size: 11pt; }\n        .margin-bottom-5 { margin-bottom: 5px; }\n        .line-height-3 { line-height: 3px; }\n\n        .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n        .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda{ border-left:solid; border-color:#00<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">000; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    </style>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">; <Print Dataset=\"Destinario_pricing\" FieldName=\"Email\">; <Print Dataset=\"Oferta\" FieldName=\"Email_Pricing\">;<Print Dataset=\"Oferta\" FieldName=\"Email_Trucking\">;<Print Dataset=\"Proposta\" FieldName=\"Vendedor_Email\">\n\n[CC.Detail]\n<Print Dataset=\"Copia_Carbono\" FieldName=\"Email\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n\n[Subject.Header]\nCOTAÇÃO - <Print Dataset=\"Oferta\" FieldName=\"Tipo_Modalidade\"> - <Print Dataset=\"Proposta\" FieldName=\"Numero_Proposta\"> - <Print Dataset=\"Proposta\" FieldName=\"Cliente\"> - <Print Dataset=\"Oferta\" FieldName=\"Referencia_Cliente\">\n[Subject.Footer]\n\n[Report.Detail]\n<table class=\"cabecalho\" width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class = \"font-size-14 text-left\">COTAÇÃO PRICING</td>\n      <td rowspan=\"4\"class=\"text-right logo-espacamento\"><img src=\"https://i.imgur.com/vGq7aoI.png\"/></td>\n    </tr>\n  </table>\n    <br>\n    <br>\n\n    <SubReport NameField=\"Variavel_Instrucao\" NameSource=\"Oferta\">\n\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>REMARKS</span></td>\n      </tr>\n    </table>\n\n    <table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n        \n        <tr>\n            <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Obs_Remarks\"></td>\n        </tr>\n        <tr>\n            <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Remarks_Terrestre\"></td>\n        </tr>\n        <tr>\n            <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Remarks_Free_Time\"></td>\n        </tr>\n    </table>\n    <br>\n\n<table width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n          <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GENERAL INFORMATION</span></td>\n        </tr>\n        <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px;\">\n          <td colspan=\"5\" style=\"border-top-style:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\"></td>\n        </tr>\n</table>\n\n<table class=\"borda\" width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td width=\"15%\" class=\"negrito_Esquerda\">Customer:</td>\n        <td width=\"35%\"><Print Dataset=\"Proposta\" FieldName=\"Cliente\"></td>\n      </tr>\n      <SubReport NameField=\"Campos_Importador\" NameSource=\"Oferta\" DataSource=\"Oferta\">\n      <tr>\n        <td class=\"negrito_Esquerda\">Incoterm:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Incoterm\"></td>\n      </tr>\n      <tr>\n        <td width=\"15%\" class=\"negrito\">Pick-up address:</td>\n        <td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Local_Coleta\"></td>\n      </tr>\n\n<SubReport NameField=\"Condicao_Origem_Destino\" NameSource=\"Oferta\">\n\n       <tr>\n        <td width=\"10%\" class=\"negrito\">Final destination:</td>\n        <td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Destino_Final\"></td>\n       </tr>\n      <tr>\n        <td width=\"10%\" class=\"negrito\">Delivery address:</td>\n        <td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Local_Entrega\"></td>\n       </tr>\n       <tr>\n       <td class=\"negrito\">Tipo de Serviço da coleta:</td>\n       <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Servico_Coleta\"></td>\n      </tr>  \n      <tr>\n        <td class=\"negrito\">Cargo value:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Moeda_Mercadoria\"> <Print Dataset=\"Oferta\" FieldName=\"Valor_Mercadoria\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito_Esquerda\">Cargo description:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Mercadoria\"></td>\n      </tr>\n        <SubReport NameSource=\"Oferta\" NameField=\"Carga_Perigosa\">\n      <tr>\n          <td class=\"negrito\">Service Level:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Nivel_Servico\"></td>\n      </tr>\n      <tr>\n          <td class=\"negrito\">Stackable:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Carga_Empilhavel\"></td>\n      </tr>    \n            <tr>\n          <td class=\"negrito\">Tipo de Veículo:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Veiculo\"></td>\n      </tr>    \n            <tr>\n          <td class=\"negrito\">Necessidades Especiais:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Necessidades_Especiais\"></td>\n      </tr>    \n            <tr>\n          <td class=\"negrito\">Informações Complementares:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Informacoes_Complementares\"></td>\n      </tr>  \n                  <tr>\n          <td class=\"negrito\">Tipo de Serviço:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Servico\"></td>\n      </tr>  \n      <tr>\n          <td class=\"negrito\">NCM/HS CODE:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"NCM_Descricao\"></td>\n      </tr>      \n      <tr>\n        <td class=\"negrito\">Temperature:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Processo\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito\"><Print Dataset=\"Oferta\" FieldName=\"Titulo_Carga\"></td>\n        <!-- <td><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td> -->\n        <td><Print Dataset=\"Cargas\" FieldName=\"Quantidade_Total\"> / <Print Dataset=\"Equipamentos_Agrupados\" FieldName=\"Equipamento_Agrupado\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito\">Gross weight total:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.000\"> Kg</td>\n      </tr>\n      <tr>\n        <td class=\"negrito\">Chargeable weight total:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Peso_Taxado\" DisplayFormat=\",0.000\"> Kg</td>\n      </tr>\n      <tr>\n        <td class=\"negrito\">CBM:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.000\"> m³</td>\n      </tr>\n      \n\n    </table>\n    <br>\n    <SubReport NameField=\"Over_Agl\" NameSource=\"Oferta\">\n\n    <SubReport NameField=\"Tipo_Carga_Detalhe2\" NameSource=\"Oferta\">\n    <br>\n    <tr>\n    <td>\n        &nbsp;\n    </td>\n</tr>\n    <table width=\"735\" cellspacing=\"0\">\n    <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n      <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>NCM DESCRIPTION</span></td>\n    </tr>\n  </table>\n  <table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n  <tr>\n      <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"NCM_Descricao\"></td>\n  </tr>\n  <tr>\n      <td>\n          &nbsp;\n      </td>\n  </tr>\n</table>\n    \n    [Oversized.Header]\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>OVERSIZED CARGO</span></td>\n      </tr>\n    </table>\n\n    [Oversized.Detail]\n    <table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n        <tr>\n            <td width=\"100%\"><Print Dataset=\"oversized_cargo\" FieldName=\"oversized_cargo\"></td>\n        </tr>\n        <tr>\n            <td>\n                &nbsp;\n            </td>\n        </tr>\n    </table>\n\n\n    <SubReport DataSet=\"Oferta\" NameSource=\"Oferta\" NameField=\"Tipo_Oferta\">\n\n<!-- SubReport por oferta da proposta -->\n[Ofertas.Detail]\n    <SubReport NameSource=\"Oferta\" NameField=\"Tipo_Oferta\">\n\n[Outros.Detail]\n  <br>\n    <!--SubReport NameSource=\"Oferta\" NameField=\"Tipo_Carga_Detalhe\" SkipWhenNoDetails=\"true\"-->\n    <SubReport Name=\"Aereo\" DataSet=\"Carga\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Despesas_Frete\" DataSet=\"Oferta_Taxa_Frete\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Despesas_Origem\" DataSet=\"Oferta_Taxa_Origem\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Despesas_Destino\" DataSet=\"Oferta_Taxa_Destino\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Resumo_Obs\" SkipWhenNoDetails=\"true\">\n\n<!-- SubReport Tipo_Carga_Detalhe = Aereo -->\n[Aereo.Header]\n    <br>\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n       <td Colspan=\"9\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">CARGO DETAILS:</td>\n      </tr> \n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Package</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Qty</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Lenght</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Width</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Height</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW unit</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW Total</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>CBM</span></td>\n        <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>C. weight total</span></td>\n      </tr>\n      </table>\n[Aereo.Detail]\n        <table width=\"735\" cellspacing=\"0\">\n          <tr>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Embalagem\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\" DisplayFormat=\",0.00\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Comprimento\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Largura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Altura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto_Unitario\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00\"> m³</td>\n              <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-bottom:solid; border-right:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Considerado\" DisplayFormat=\",0.00\"> Kg</td>\n          </tr>\n        </table>\n[Aereo.Footer]\n    </table>\n\n[Carga_Per.Detail]\n      <tr>\n        <td class=\"negrito_Esquerda\">DG Cargo:</td>\n        <td>UN: <Print Dataset=\"Oferta\" FieldName=\"Cl_Un\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito_Esquerda\">&nbsp;</td>  \n        <td>CLASS: <Print Dataset=\"Oferta\" FieldName=\"Cl_Class\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito_Esquerda\">&nbsp;</td>  \n        <td>PACKING GROUP: <Print Dataset=\"Oferta\" FieldName=\"Cl_Packing_Group\"></td>\n      </tr>\n    \n[Resumo_Obs.Detail] \n\n\n[Instrucoes_Cli.Detail] \n<table width=\"735\" cellspacing=\"0\">\n  <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n    <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>CLIENT INSTRUCTIONS</span></td>\n  </tr>\n</table>\n\n<table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    \n    <tr>\n        <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Instrucoes_Cliente_Final\"></td>\n    </tr>\n</table>\n<br>\n\n\n\n[LCL.Header]\n    <br>\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n       <td Colspan=\"9\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">CARGO DETAILS:</td>\n      </tr> \n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Package</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Qty</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Lenght</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Width</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Height</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW unit</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW Total</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>CBM</span></td>\n        <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>C. weight total</span></td>\n      </tr>\n      </table>\n[LCL.Detail]\n        <table width=\"735\" cellspacing=\"0\">\n<SubReport Name=\"Info_Carga_LCL\" Dataset=\"Carga\">\n        </table>\n[LCL.Footer]\n    </table>\n\n\n[Info_Carga_LCL.Detail]\n <tr>\n               <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Embalagem\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\" DisplayFormat=\",0.00\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Comprimento\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Largura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Altura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto_Unitario\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00\"> m³</td>\n              <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-bottom:solid; border-right:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Considerado\" DisplayFormat=\",0.00\"> Kg</td>\n   </tr>\n[Info_Carga_LCL.Footer]\n\n\n[Origem_Destino_Padrao.Header]\n<tr>\n<td width=\"15%\" class=\"negrito\">Origin:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Origem\">/<Print Dataset=\"Oferta\" FieldName=\"Origem_Sigla\"></td>\n</tr>\n<tr>\n<td width=\"10%\" class=\"negrito\">Destination:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Destino\">/<Print Dataset=\"Oferta\" FieldName=\"Destino_Sigla\"></td>\n</tr>\n\n[Origem_Destino_Terrestre.Header]\n<tr>\n<td width=\"15%\" class=\"negrito\">Origin:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Origem_Terrestre\"></td>\n</tr>\n<tr>\n<td width=\"10%\" class=\"negrito\">Destination:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Destino_Terrestre\"></td>\n</tr>\n\n[Carga.Header]\n<table width=\"550\">\n  <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n    <td class=\"negrito\" width=\"12%\">Tipo Embalagem</td>\n    <td class=\"negrito\" width=\"8%\">Quantidade</td>\n    <td class=\"negrito\" width=\"10%\">Comprimento</td>\n    <td class=\"negrito\" width=\"10%\">Largura</td>\n    <td class=\"negrito\" width=\"12%\">Altura</td>\n    <td class=\"negrito\" width=\"10%\">CBM</td>\n  </tr>\n[Carga.Detail]\n  <tr>\n    <td><Print DataSet=\"Carga\" FieldName=\"Embalagem\"></td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Comprimento\"> cm</td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Largura\"> cm</td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Altura\"> cm</td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.000\"> m³</td>\n  </tr>\n[Carga.Footer]\n</table>\n\n[Importador_LCL.Detail]\n<tr>\n  <td class=\"negrito_Esquerda\">Importador:</td>\n  <td><Print Dataset=\"Oferta\" FieldName=\"Importador\"></td>\n</tr>\n<tr>\n  <td class=\"negrito_Esquerda\">Importador CNPJ:</td>\n  <td><Print Dataset=\"Oferta\" FieldName=\"Importador_CNPJ\"></td>\n</tr>\n\n[Attach]\n<DataSet Name=\"Attach\" Sql=\"Select\n  Atv.IdAtividade,\n  Arq.Nome,\n  Arq.IdDados_Arquivo,\n  Atv.IdTarefa\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Arquivo Paa on Paa.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  arq_Arquivo Arq on Arq.IdArquivo = Paa.IdArquivo And Arq.IdArquivo_Grupo = 8 /*INTERNO*/\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n[Attach.Detail]\n<SubReport Name=\"Comprovantes\" Binary=\"True\">\n\n[Comprovantes.Name]\n<Print DataSet=\"Attach\" FieldName=\"Nome\">\n\n[Comprovantes.FileData.Id]\n<Print DataSet=\"Attach\" FieldName=\"IdDados_Arquivo\" Compressed=\"True\">\n\n\n\n\n[Report.Footer]\n<table width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\DataSet Name =Processo.sql",
        "conteudo": "<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lms.Data_Processo,\n  Coalesce(Lmm.Viagem_Navio,Vnv.Numero) as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Nome_Fantasia AS Cliente_Fantasia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Nome_Fantasia As Shipper_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Nome_fantasia As Consignee_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Lrc.Nome as Local_Recebimento,\n  Ctr.Nome_Fantasia as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente no destino*/\n  End as Agente,\n  UPPER(Case\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 1 Then 'Exportação Aérea'\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 2 Then 'Exportação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 1 Then 'Importação Aérea'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 2 Then 'Importação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 3 Then 'Importação Terrestre'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 1 Then 'Nacional Aérea'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 2 Then 'Nacional Marítima'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 3 Then 'Nacional Terrestre'\n  End) as Modal,\n  Mer.Nome as Mercadoria,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Inc.Nome as Codigo_Incoterm,\n  Lhs.Observacao,\n  Vnd.Nome_Fantasia as Vendedor,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Lhs.Instrucoes_Operacional,\n  Des.Nome_Fantasia as Despachante,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Lhs.Valor_Mercadoria,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Lhs.Instrucoes_Operacional_Cliente,\n  Ofr.Numero_Oferta,\n  Pfr.Data_Aprovacao As Data_Aprovacao,\n  Mpr.Sigla As Moeda_Processo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nWhere\n  Atv.IdAtividade=:IdAtividade\">"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\ENVIO DE COMPROVANTE AO ARMADOR-CO-LOADER - AGL #44906.html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Fatura\" Sql=\"SELECT DISTINCT\n  Tx1.IdLogistica_House,\n  Tx1.Pessoa_Fatura AS Pessoa_BL,\n  Tx1.Moeda AS Moeda_BL,\n  Tx1.Taxa_Internacional AS Taxa_Internacional_BL,\n  Tx1.Fator AS Fator_BL,\n  Tx2.Moeda AS Moeda_EX,\n  Tx2.Taxa_Internacional AS Taxa_Internacional_EX,\n  Tx2.Fator AS Fator_EX,\n  Tx1.Email,\n  Tx1.Numero_Processo\nFROM\n  mov_Atividade Atv\n  Left Outer Join mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  Left outer join cad_pessoa Eml ON Eml.IdPessoa = Lhs.IdCliente\n  Left Outer Join (\n    SELECT DISTINCT\n      Ltx.IdLogistica_House,\n      Pes.Nome as Pessoa_Fatura,\n      Mrc.Sigla AS Moeda,\n      Tle.Nome_Internacional AS Taxa_Internacional,\n      Cast(\n        Case\n          When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n          Else 0\n        End As Float\n      ) As Fator,\n      Tle.IdTaxa_Logistica_Exibicao,\n      Pec.email,\n      Lhs.Numero_Processo\n\n    FROM\n      mov_Logistica_Taxa Ltx\n      Left Outer Join cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\n      Left Outer Join vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\n      Left Outer Join mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\n      Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Left Outer Join mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n      And (\n        (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n        Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem)\n      )\n      Left Outer Join cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n      left outer join cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\n      Left Outer Join cad_Pessoa_Contato Pec on Pec.IdPessoa = Pes.IdPessoa and (Pec.IdCargo = 18)\n    Where\n      Lft.IdPessoa = Lms.IdCompanhia_Transporte\n      AND Tle.IdTaxa_Logistica_Exibicao IN (6)\n  ) Tx1 on Tx1.IdLogistica_House = Lhs.IdLogistica_House\n  \n  Left Outer Join (\n    SELECT DISTINCT\n      Ltx.IdLogistica_House,\n      Pes.Nome as Pessoa_Fatura,\n      Mrc.Sigla AS Moeda,\n      Tle.Nome_Internacional AS Taxa_Internacional,\n      Cast(\n        Case\n          When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n          Else 0\n        End As Float\n      ) As Fator,\n      Tle.IdTaxa_Logistica_Exibicao\n    FROM\n      mov_Logistica_Taxa Ltx\n      Left Outer Join cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\n      Left Outer Join vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\n      Left Outer Join mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\n      Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Left Outer Join mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n      And (\n        (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n        Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem)\n      )\n      Left Outer Join cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n      left outer join cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\n    WHERE\n      Lft.IdPessoa = Lms.IdCompanhia_Transporte\n      AND Tle.IdTaxa_Logistica_Exibicao IN (85)\n  ) Tx2 on Tx2.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\nAtv.IdAtividade =:IdAtividade\">\n  </CommandText></DataSet>\n\n\n\n  \n  <html>\n    <style type=\"text/css\">\nbody { font-family: 'Roboto', Arial, sans-serif; color: #333; background-color: #f8f9fa; margin: 0; padding: 0; }\ntable { border-collapse: collapse; width: 100%; max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); }\ntd { padding: 20px; line-height: 1.6; border: none; }\nimg { max-width: 100%; height: auto; display: block; }\ntd br { line-height: 1em; }\nstrong { color: #007bff; }\na { color: #007bff; text-decoration: none; }\na:hover { text-decoration: underline; }\nh1 { font-size: 24px; color: #333; margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid #007bff; padding-bottom: 10px; }\n    </style>\n  <body>\n[Address.Detail]\n <Print Dataset=\"Fatura\" FieldName=\"Email\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n    ;  \n[Contatos.Detail]\n \n[Subject.Header]\nENVIO DE COMPROVANTE - PROCESSO <Print Dataset=\"Fatura\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n\n[Report.Detail]\n<td align=\"left\" colspan=\"3\"><br><img src=\"https://i.imgur.com/calnpEp.png\"><br><br></td>\n\n<table style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.5; width: 100%;\">\n    <tr>\n        <td>\n            Olá, prezados,\n            <br>\n            <br> \n            Segue em anexo comprovante de pagamento.\n            <br>\n            <br>\n            <strong>Ptax + 2% = </strong> \n            <Print Dataset=\"Fatura\" FieldName=\"Moeda_BL\"></Print> <Print Dataset=\"Fatura\" FieldName=\"Fator_BL\"></Print>, \n            <Print Dataset=\"Fatura\" FieldName=\"Moeda_EX\"></Print> <Print Dataset=\"Fatura\" FieldName=\"Fator_EX\"></Print>\n        </td>\n    </tr>\n</table>\n\n[Report.footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\ENVIO DE COMPROVANTE AO ARMADORCO-LOADER.sql",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Fatura\" Sql=\"SELECT DISTINCT\n  Tx1.IdLogistica_House,\n  Tx1.Pessoa_Fatura AS Pessoa_BL,\n  Tx1.Moeda AS Moeda_BL,\n  Tx1.Taxa_Internacional AS Taxa_Internacional_BL,\n  Tx1.Fator AS Fator_BL,\n  Tx2.Moeda AS Moeda_EX,\n  Tx2.Taxa_Internacional AS Taxa_Internacional_EX,\n  Tx2.Fator AS Fator_EX,\n  Tx1.Email,\n  Tx1.Numero_Processo\nFROM\n  mov_Atividade Atv\n  Left Outer Join mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  Left outer join cad_pessoa Eml ON Eml.IdPessoa = Lhs.IdCliente\n  \n  -- SUB-CONSULTA 1 (TAXA 6) COM DISTINCT\n  Left Outer Join (\n    SELECT DISTINCT\n      Ltx.IdLogistica_House,\n      Pes.Nome as Pessoa_Fatura,\n      Mrc.Sigla AS Moeda,\n      Tle.Nome_Internacional AS Taxa_Internacional,\n      Cast(\n        Case\n          When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n          Else 0\n        End As Float\n      ) As Fator,\n      Tle.IdTaxa_Logistica_Exibicao,\n      Pes.email,\n      Lhs.Numero_Processo\n    FROM\n      mov_Logistica_Taxa Ltx\n      Left Outer Join cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\n      Left Outer Join vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\n      Left Outer Join mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\n      Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Left Outer Join mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n      And (\n        (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n        Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem)\n      )\n      Left Outer Join cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n      left outer join cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\n    Where\n      Lft.IdPessoa = Lms.IdCompanhia_Transporte\n      AND Tle.IdTaxa_Logistica_Exibicao IN (6)\n  ) Tx1 on Tx1.IdLogistica_House = Lhs.IdLogistica_House\n  \n  -- SUB-CONSULTA 2 (TAXA 85) COM DISTINCT\n  Left Outer Join (\n    SELECT DISTINCT\n      Ltx.IdLogistica_House,\n      Pes.Nome as Pessoa_Fatura,\n      Mrc.Sigla AS Moeda,\n      Tle.Nome_Internacional AS Taxa_Internacional,\n      Cast(\n        Case\n          When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n          When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n          Else 0\n        End As Float\n      ) As Fator,\n      Tle.IdTaxa_Logistica_Exibicao\n    FROM\n      mov_Logistica_Taxa Ltx\n      Left Outer Join cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\n      Left Outer Join vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\n      Left Outer Join mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\n      Left Outer Join mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Left Outer Join mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n      And (\n        (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n        Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem)\n      )\n      Left Outer Join cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n      left outer join cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\n    WHERE\n      Lft.IdPessoa = Lms.IdCompanhia_Transporte\n      AND Tle.IdTaxa_Logistica_Exibicao IN (85)\n  ) Tx2 on Tx2.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\nAtv.IdAtividade =:IdAtividade\">\n  </CommandText></DataSet>\n\n\n\n  \n  <html>\n    <style type=\"text/css\">\nbody { font-family: 'Roboto', Arial, sans-serif; color: #333; background-color: #f8f9fa; margin: 0; padding: 0; }\ntable { border-collapse: collapse; width: 100%; max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); }\ntd { padding: 20px; line-height: 1.6; border: none; }\nimg { max-width: 100%; height: auto; display: block; }\ntd br { line-height: 1em; }\nstrong { color: #007bff; }\na { color: #007bff; text-decoration: none; }\na:hover { text-decoration: underline; }\nh1 { font-size: 24px; color: #333; margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid #007bff; padding-bottom: 10px; }\n    </style>\n  <body>\n[Address.Detail]\n <Print Dataset=\"Fatura\" FieldName=\"Email\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n    ;  \n[Contatos.Detail]\n \n[Subject.Header]\nENVIO DE COMPROVANTE - PROCESSO <Print Dataset=\"Fatura\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n\n[Report.Detail]\n<td align=\"left\" colspan=\"3\"><br><img src=\"https://i.imgur.com/calnpEp.png\"><br><br></td>\n\n<table style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.5; width: 100%;\">\n    <tr>\n        <td>\n            Olá, prezados,\n            <br>\n            <br> \n            Segue em anexo comprovante de pagamento.\n            <br>\n            <br>\n            <strong>Ptax + 2% = </strong> \n            <Print Dataset=\"Fatura\" FieldName=\"Moeda_BL\"></Print> <Print Dataset=\"Fatura\" FieldName=\"Fator_BL\"></Print>, \n            <Print Dataset=\"Fatura\" FieldName=\"Moeda_EX\"></Print> <Print Dataset=\"Fatura\" FieldName=\"Fator_EX\"></Print>\n        </td>\n    </tr>\n</table>\n\n[Report.footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\IA - FOLLOW UP HEAD - RAF.Header].html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Numero_Invoices,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lhs.NCM_Descricao as Numero_NCM,\n  Vnv.Numero as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Lhs.Conhecimentos as Conhecimento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AEREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO RODOVIÁRIA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇAO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇAO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇAO RODOVIÁRIA'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 1 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 2 Then 'NACIONAL MARÍTIMA'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL RODOVIÁRIO'\n  end as Tipo_modalidade,\n  Cln.Nome as Cliente,\n  Ept.Nome as Exportador,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Case \n    When Lms.Tipo_Operacao = 1 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n  End as Agente_Correspondencia,\n  Case \n    When Lms.Tipo_Operacao = 1 Then Ago.Nome /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Nome /*Exportacao - Agente no destino*/\n  End as Agente,  \n  Mer.Nome as Mercadoria,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  case \n    When Lhs.Tipo_Carga = 0 Then '(Não especificado)'\n    When Lhs.Tipo_Carga = 1 Then 'AEREO'\n    When Lhs.Tipo_Carga = 2 Then 'BREAK-BULK'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'RODOVIARIO'\n  end as Consolidacao_Extenso,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n  \n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas_Instrucao\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mrc.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  case When Ltx.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n       When Ltx.Tipo_Recebimento = 2 Then ' Processo'/*Peso Cubado*/\n       When Ltx.Tipo_Recebimento = 3 Then ' Kgs'/*Peso Cubado*/\n       When Ltx.Tipo_Recebimento = 4 Then ' kgs'/*Peso Taxado*/\n       When Ltx.Tipo_Recebimento = 5 Then ' Kgs'/*Peso Bruto*/\n       When Ltx.Tipo_Recebimento = 6 Then ' m³'/*Metro Cubico*/\n       When Ltx.Tipo_Recebimento = 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n       When Ltx.Tipo_Recebimento = 8 Then 'Invoice'\n       When Ltx.Tipo_Recebimento = 9 Then 'Volume'\n       When Ltx.Tipo_Recebimento = 10 Then 'Cntr' /*Equipamento*/\n       When Ltx.Tipo_Recebimento = 11 Then Emr.Descricao\n       When Ltx.Tipo_Recebimento = 12 Then 'TEU'\n       When Ltx.Tipo_Recebimento = 13 Then ' %'/*Percentual*/\n       When Ltx.Tipo_Recebimento = 14 Then ''/*livre*/\n       When Ltx.Tipo_Recebimento = 15 Then 'Via Master'\n       When Ltx.Tipo_Recebimento = 16 Then 'Via house'\n       When Ltx.Tipo_Recebimento = 17 Then ' Kgs'/*Peso Considerado*/\n  end as Tipo_Recebimento_escrito,\n  case When Ltx.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n       When Ltx.Tipo_Pagamento = 2 Then ' Processo'/*Peso Cubado*/\n       When Ltx.Tipo_Pagamento = 3 Then ' Kgs'/*Peso Cubado*/\n       When Ltx.Tipo_Pagamento = 4 Then ' kgs'/*Peso Taxado*/\n       When Ltx.Tipo_Pagamento = 5 Then ' Kgs'/*Peso Bruto*/\n       When Ltx.Tipo_Pagamento = 6 Then ' m³'/*Metro Cubico*/\n       When Ltx.Tipo_Pagamento = 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n       When Ltx.Tipo_Pagamento = 8 Then 'Invoice'\n       When Ltx.Tipo_Pagamento = 9 Then 'Volume'\n       When Ltx.Tipo_Pagamento = 10 Then 'Cntr' /*Equipamento*/\n       When Ltx.Tipo_Pagamento = 11 Then Emr.Descricao\n       When Ltx.Tipo_Pagamento = 12 Then 'TEU'\n       When Ltx.Tipo_Pagamento = 13 Then ' %'/*Percentual*/\n       When Ltx.Tipo_Pagamento = 14 Then ''/*livre*/\n       When Ltx.Tipo_Pagamento = 15 Then 'Via Master'\n       When Ltx.Tipo_Pagamento = 16 Then 'Via house'\n       When Ltx.Tipo_Pagamento = 17 Then ' Kgs'/*Peso Considerado*/\n  end as Tipo_Pagamento_escrito\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Exibir_Agente = 1\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n  \n<DataSet Name=\"Conhecimento_House\" Sql=\"Select\n  Cem.IdLogistica_House,\n  Cem.Numero,\n  Cem.Numero_Desconsolidacao\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Conhecimento_Embarque Cem on Cem.IdLogistica_House = Lhs.IdLogistica_House\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Escala_Aerea\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lae.Numero_Voo,\n  Lae.Detalhes,\n  Lae.Data,\n  Lae.Observacao,\n  Sea.Descricao \nfrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Aerea_Escala Lae on Lae.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Situacao_Escala_Aerea Sea on Sea.IdSituacao_Escala_Aerea = Lae.IdSituacao_Escala_Aerea\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n<title>FOLLOW-UP</title>\n</head>\n\n<style type=\"text/css\">\nbody,td,tr{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; color:#042A80}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; text-align:justify}\n.topo{ text-align:center; font-size:18px; font-weight:#042A80; color:#FF0000}\n.negrito{ color:#042A80; font-weight:600;}\n.negrito_bco{ color:#FFFFFF; font-weight:600;}\n.vermelho{ color:#FF0000; font-weight:600;}\n.fundo{ color:#FFFFFF; font-weight:600; background:#042A80; font-size:11.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda_linha {border:solid; border-color: #042A80 #CCCCCC #CCCCCC #CCCCCC; border-width: 8px 1px 0px 1px;}\n.borda_cima{ border-top-style:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_baixo{ border-bottom:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_direita{ border-right:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_direita_cima{ border-right:solid; border-top:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_esquerda{ border-left:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n.borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#042A80; border-width: 1px 1px 1px 1px}\n</style>\n\n<body>\n[Subject.Header]\nFOLLOW-UP - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n[Contatos.Detail]\n<print DataSet=\"Contatos\" FieldName=\"EMail\">\n[Contatos.AfterPrior]\n; \n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[Report.Detail]\n\n<SubReport Name=\"Processo\" Dataset=\"Processo\">\n\n[Processo.Detail]\n\n<table width=\"100%\" border=\"0\" style=\"border-style:double\" bordercolor=\"#042A80\">\n  <tr>\n   <td align=\"left\" colspan=\"5\">\n        <img src=\"http://www.rafinternational.com.br/images/logo.png\"><br><br>\n        <span class=\"negrito\">FONE +55 48 3236 4449</span><br>\n        <span class=\"negrito\">FAX    +55 48 3236 0038</span><br>\n        <span class=\"negrito\">www.rafinternational.com.br</span><br> \n    </td>\n    <td valign=\"top\" colspan=\"3\">\n        <br>\n        <h3>\n             FOLLOW UP<br>\n             <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\">\n        </h3>        \n        <span class=\"negrito\">Empresa:</span> <Print Dataset=\"Processo\" FieldName=\"Cliente\"><br>\n        <span class=\"negrito\">Referência:</span> <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"><br>\n        <span class=\"negrito\">Data:</span> <Print Dataset=\"Processo\" FieldName=\"Data_Abertura_Processo\" DisplayFormat=\"DD/MM/YYYY\"><br>                    \n    </td>\n  </tr>  \n</table>\n\n<br>\n<table width=\"100%\" cellspacing=\"0\">  \n  <tr>\n      <td width=\"16%\" class=\"borda_esquerda_cima\"><span class=\"negrito\">REFERENCIA CLIENTE</span></td>\n      <td width=\"1%\" class=\"borda_cima\">:</td>\n      <td width=\"33%\" class=\"borda_cima\"><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n      <td width=\"10%\" class=\"borda_cima\"><span class=\"negrito\">MERCADORIA</span></td>\n      <td width=\"1%\" class=\"borda_cima\">:</td>\n      <td width=\"39%\" class=\"borda_direita_cima\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n  </tr>\n  <tr>\n      <td class=\"borda_esquerda\"><span class=\"negrito\">MAWB</span></td>\n      <td>:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n      <td><span class=\"negrito\">HAWB</span></td>\n      <td>:</td>\n      <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_House\"></td>\n  </tr>\n  <tr>\n      <td class=\"borda_esquerda\"><span class=\"negrito\">EXPORTADOR</span></td>\n      <td>:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n      <td><span class=\"negrito\">IMPORTADOR</span></td>\n      <td>:</td>\n      <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">ETD</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"DD/MM/YYYY\"></td>\n    <td><span class=\"negrito\">ETA</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"DD/MM/YYYY\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">ORIGEM</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td><span class=\"negrito\">DESTINO</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n    <td colspan=\"8\" class=\"borda_direita_esquerda\"></td>\n  </tr> \n  <tr>\n    <td class=\"fundo\" colspan=\"2\"><span class=\"negrito_bco\">DATA</span></td>\n    <td class=\"fundo\" colspan=\"6\"><span class=\"negrito_bco\">DESCRIÇÃO</span></td>\n  </tr>\n<SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n<SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n  <tr>\n    <td colspan=\"8\" class=\"borda_cima\" heigth=\"3\"></td>\n  </tr>  \n  <tr>\n    <td colspan=\"8\" class=\"borda_sem_linha\"><br><br><signature></td>\n  </tr>   \n</table>\n\n[Follow_Destaque.Detail] \n  <tr valign=\"top\">\n    <td class=\"borda_esquerda\" colspan=\"2\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\"></span></td>\n    <td class=\"borda_direita\" colspan=\"6\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n[Follow_Outros.Detail] \n <tr valign=\"top\">\n   <td class=\"borda_esquerda\" colspan=\"2\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\"></td>\n   <td class=\"borda_direita\" colspan=\"6\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n\n[Conhecimentos_Processo.Detail]\n  <tr>\n      <td width=\"15%\" class=\"negrito\">CE MERCANTE</td>\n      <td width=\"5%\">:</td>\n      <td width=\"30%\"><Print Dataset=\"Conhecimentos_Processo\" FieldName=\"Numero_Desconsolidacao\"></td>\n      <td width=\"15%\" class=\"negrito\">HBL</td>\n      <td width=\"5%\">:</td>\n      <td width=\"30%\" ><Print Dataset=\"Conhecimentos_Processo\" FieldName=\"Numero\"></td>\n  </tr>\n \n[Containers.AfterPrior]\n , \n[Containers.Detail]\n   <print DataSet=\"Containers\" FieldName=\"Number\">\n\n[Escala_Aerea.Header]\n  <tr>\n    <td colspan=\"3\" class=\"borda_esquerda_cima\">FLIGHT NUMBER</td>\n    <td colspan=\"2\">DATE</td>\n    <td colspan=\"3\"class=\"borda_direita_cima\">SITUAÇÃO</td>\n  </tr>\n[Escala_Aerea.Detail]\n <tr>\n    <td class=\"borda_esquerda\" colspan=\"3\"><print DataSet=\"Escala_Aerea\" FieldName=\"Numero_Voo\"></td>\n    <td colspan=\"2\"><print DataSet=\"Escala_Aerea\" FieldName=\"Data\" DisplayFormat=\"DD/MM/YYYY HH:MM\"></td> \n    <td colspan=\"3\" class=\"borda_direita\"><print DataSet=\"Escala_Aerea\" FieldName=\"Descricao\"></td>\n </tr>\n[Escala_Aerea.Footer]\n\n \n[Carga.AfterPrior]\n / \n[Carga.Detail]\n   <print DataSet=\"Carga\" FieldName=\"Quantidade\">x<print DataSet=\"Carga\" FieldName=\"Cntr\">\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\IM - FOLLOW UP INGLES - 2025 - SYNDEX.Header].html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'AIR EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'SEA EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'LAND EXPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'AIR IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'SEA IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'LAND IMPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NATIONAL AIR'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NATIONAL SEA (COASTWISE)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NATIONAL LAND'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select Distinct\n  Pcn.Email\nFrom\n  mov_Atividade Atv\n/* Vincula a atividade ao projeto para pegar os contatos gerais do processo */\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n/* Pega os dados do contato (Pessoa_Contato) */\nJoin\n  cad_Pessoa_Contato Pcn on Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  /* Garante que o email não está vazio ou nulo */\n  Pcn.Email Is Not Null \nAnd \n  LTRIM(RTRIM(Pcn.Email)) <> ''\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <title>Page Title</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nFOLLOW-UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"> - PROCESS: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - CLIENT: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - CLIENT REF: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> / <Print Dataset=\"Processo\" FieldName=\"Destino\">\n[Subject.Footer]\n\n[Report.Detail]\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n    </tr>\n  </table>\n</span>\n  <br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td rowspan=\"6\" width=\"50%\" class=\"text-center logo-espacamento\"><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n    <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n    <td width=\"38%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n  <tr>\n      <td width=\"12%\" class=\"negrito\">REFERENCE:</td>\n      <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">CLIENT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">DATE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">CLIENT REF:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"20%\" class=\"negrito\">SHIPPER:</td>\n    <td width=\"30%\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n    <td width=\"20%\" class=\"negrito\">CONSIGNEE:</td>\n    <td width=\"30%\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n      <td class=\"negrito\">HBL:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"negrito\">VESSEL / VOYAGE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  <tr>\n      <td class=\"negrito\">ORIGIN:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"negrito\">DESTINATION:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">PLACE OF RECEIPT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Local_Recebimento\"></td>\n      <td class=\"negrito\">FINAL DESTINATION:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Destino_Final\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">EST. DATE OF LOADING:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">EST. DATE OF DISCHARGE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">DATE OF LOADING:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">DATE OF DISCHARGE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">CARRIER:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n      <td class=\"negrito\">PAYMENT TERM:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">COMMODITY:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"negrito\">GROSS WEIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td>           \n  </tr>\n  <tr>\n      <td class=\"negrito\">NO. OF PACKAGES:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n      <td class=\"negrito\">VOLUME (CBM):</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n  </tr>\n</table>\n<br>\n\n<SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Detalhe\">\n\n<tr>\n  <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n</tr>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td class=\"cor-fundo-2 borda_sem_direita\" width=\"20%\"><span class=\"negrito\">DATE</span></td>\n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"80%\"><span class=\"negrito\">DESCRIPTION</span></td>\n      </tr>\n      <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n      <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      <tr>\n        <td colspan=\"6\" heigth=\"3\"></td>\n      </tr>\n    </table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n[FCL.Detail]\n<table width=\"775\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr class=\"cor-fundo_cor-fonte-white\">   \n        <td class=\"negrito\">QUANT.</td>\n        <td class=\"negrito\">TYPE OF EQUIPMENT</td>\n        <td class=\"negrito\">FREE TIME AT DESTINATION</td>        \n    </tr>\n  <Subreport Dataset=\"Carga\" Name=\"Equipamentos\">\n</table>\n\n[Equipamentos.Detail]\n<tr>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>\n</tr>\n\n[Report.Footer]\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Im - Follow-Up Enterprise bkp.html",
        "conteudo": "[Report.Header]\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html\"/>\n<title>Follow Up</title>\n\n<DataSet Name=\"Processo\" Sql=\"Select\n  Rep.Correspondencia,\n  Rep.Nome AS Nome_Rep,\n  Rep.Cpf_Cnpj AS Contato_Rep,\n  CONCAT(Rep.Logradouro, ' ', Rep.Numero, ' ', Rep.Bairro, ' ') AS End_Rep,\n  Rep.Fax_Celular AS Fone_Rep,\n  Rep.Email AS Email_Rep,\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lme.Free_Time_House_Destino as FTH_Destino,\n  Lmm.Viagem_Navio,\n  Lms.Data_Embarque,\n  Lhs.Rota,\n  Lms.Transit_Time,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n\n  Case \n    When Atv.IdTarefa = 374 Then 'Follow up'\n    When Atv.IdTarefa = 377 Then 'Verificar informações'\n    When Atv.IdTarefa = 378 Then 'Solicitar informações'\n    When Atv.IdTarefa = 379 Then 'Instrução de embarque'\n    When Atv.IdTarefa = 380 Then 'Booking'\n    When Atv.IdTarefa = 385 Then 'Detalhes booking'\n    When Atv.IdTarefa = 387 Then 'Documentos aprovação'\n    When Atv.IdTarefa = 389 Then 'Aprovação documentos'\n    When Atv.IdTarefa = 427 Then 'Analisar documentos'\n    When Atv.IdTarefa = 429 Then 'Saída Navio'\n    When Atv.IdTarefa = 430 Then 'Solicitar originais'\n    When Atv.IdTarefa = 431 Then 'Chegada de Navio'\n    When Atv.IdTarefa = 432 Then 'Desconsolidação'\n    When Atv.IdTarefa = 433 Then 'Aviso de chegada'\n    When Atv.IdTarefa = 434 Then 'Confirmação de chegada'\n    When Atv.IdTarefa = 436 Then 'Numerário Cliente'\n    When Atv.IdTarefa = 449 Then 'Confirmar desbloqueio ao cliente'\n  End as Tarefa_Follow,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Nome_Fantasia as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome_Fantasia as Cia_Transporte,\n  Lmm.Viagem_Navio AS Viagem,\n  Nvi.Nome as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n  End as Agente,\n  Mer.Nome as Mercadoria,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Lhs.Quantidade_Volumes,\n  Rpr.Nome_Fantasia as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO - AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO - MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO - AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO - MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO - TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO - TERRESTRE'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL - TERRESTRE'\n  end as Tipo_modalidade,\n  Cnt.Nome As Contato_Principal_Cliente,\n  Cnt.Nome as Contato\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  vis_Cliente Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  (Select\n    RANK() OVER(PARTITION BY IdPessoa ORDER BY IdPessoa_Contato) Ranking,\n    Pcn.IdPessoa_Contato,\n    Pcn.IdPessoa,\n    Pcn.Nome\n  From  \n    cad_Pessoa_Contato Pcn\n  ) Cnt On Cnt.IdPessoa = Cln.IdPessoa and Cnt.Ranking = 1\nLeft Outer Join\n  cad_Pessoa Rep on Rep.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Li\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Dli.Identificador,\n  Dli.Numero_Li,\n  Dli.Anuente_Li,\n  Dli.Status_Li,\n  Dli.Data_Protocolo_Li,\n  Dli.Protocolo_Li,\n  Dli.Embarque_Li,\n  Dli.Vencimento_Li,\n  Lhs.Situacao_Agenciamento,\n  Dpx.Valor_Data As Data_Puxe\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  vis_Logistica_Prazo Dpx On (Dpx.IdLogistica_House = Lhs.IdLogistica_House) And (Dpx.Identificador Like 'DATA_PUXE')\nJoin\n  (\n    Select\n    Lhs.IdLogistica_House,\n    '01' As Identificador,\n    Nr1.Valor_Alfanumerico As Numero_Li,\n    An1.Valor_Alfanumerico As Anuente_Li,\n    St1.Valor_Alfanumerico As Status_Li,\n    Dp1.Valor_Data As Data_Protocolo_Li,\n    Np1.Valor_Alfanumerico As Protocolo_Li,\n    Em1.Valor_Data As Embarque_Li,\n    Dv1.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr1 On (Nr1.IdLogistica_House = Lhs.IdLogistica_House) And (Nr1.Identificador Like '1_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An1 On (An1.IdLogistica_House = Lhs.IdLogistica_House) And (An1.Identificador Like '1_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St1 On (St1.IdLogistica_House = Lhs.IdLogistica_House) And (St1.Identificador Like '1_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp1 On (Dp1.IdLogistica_House = Lhs.IdLogistica_House) And (Dp1.Identificador Like '1_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np1 On (Np1.IdLogistica_House = Lhs.IdLogistica_House) And (Np1.Identificador Like '1_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em1 On (Em1.IdLogistica_House = Lhs.IdLogistica_House) And (Em1.Identificador Like '1_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv1 On (Dv1.IdLogistica_House = Lhs.IdLogistica_House) And (Dv1.Identificador Like '1_Vencimento')\n  Where\n    (Nr1.Valor_Alfanumerico Is Not Null) Or\n    (An1.Valor_Alfanumerico Is Not Null) Or\n    (St1.Valor_Alfanumerico Is Not Null) Or\n    (Dp1.Valor_Data Is Not Null) Or\n    (Np1.Valor_Alfanumerico Is Not Null) Or\n    (Em1.Valor_Data Is Not Null) Or\n    (Dv1.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '02' As Identificador,\n    Nr2.Valor_Alfanumerico As Numero_Li,\n    An2.Valor_Alfanumerico As Anuente_Li,\n    St2.Valor_Alfanumerico As Status_Li,\n    Dp2.Valor_Data As Data_Protocolo_Li,\n    Np2.Valor_Alfanumerico As Protocolo_Li,\n    Em2.Valor_Data As Embarque_Li,\n    Dv2.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr2 On (Nr2.IdLogistica_House = Lhs.IdLogistica_House) And (Nr2.Identificador Like '2_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An2 On (An2.IdLogistica_House = Lhs.IdLogistica_House) And (An2.Identificador Like '2_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St2 On (St2.IdLogistica_House = Lhs.IdLogistica_House) And (St2.Identificador Like '2_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp2 On (Dp2.IdLogistica_House = Lhs.IdLogistica_House) And (Dp2.Identificador Like '2_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np2 On (Np2.IdLogistica_House = Lhs.IdLogistica_House) And (Np2.Identificador Like '2_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em2 On (Em2.IdLogistica_House = Lhs.IdLogistica_House) And (Em2.Identificador Like '2_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv2 On (Dv2.IdLogistica_House = Lhs.IdLogistica_House) And (Dv2.Identificador Like '2_Vencimento')\n  Where\n    (Nr2.Valor_Alfanumerico Is Not Null) Or\n    (An2.Valor_Alfanumerico Is Not Null) Or\n    (St2.Valor_Alfanumerico Is Not Null) Or\n    (Dp2.Valor_Data Is Not Null) Or\n    (Np2.Valor_Alfanumerico Is Not Null) Or\n    (Em2.Valor_Data Is Not Null) Or\n    (Dv2.Valor_Data Is Not Null)\n    union All\n      Select\n    Lhs.IdLogistica_House,\n    '03' As Identificador,\n    Nr3.Valor_Alfanumerico As Numero_Li,\n    An3.Valor_Alfanumerico As Anuente_Li,\n    St3.Valor_Alfanumerico As Status_Li,\n    Dp3.Valor_Data As Data_Protocolo_Li,\n    Np3.Valor_Alfanumerico As Protocolo_Li,\n    Em3.Valor_Data As Embarque_Li,\n    Dv3.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr3 On (Nr3.IdLogistica_House = Lhs.IdLogistica_House) And (Nr3.Identificador Like '3_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An3 On (An3.IdLogistica_House = Lhs.IdLogistica_House) And (An3.Identificador Like '3_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St3 On (St3.IdLogistica_House = Lhs.IdLogistica_House) And (St3.Identificador Like '3_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp3 On (Dp3.IdLogistica_House = Lhs.IdLogistica_House) And (Dp3.Identificador Like '3_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np3 On (Np3.IdLogistica_House = Lhs.IdLogistica_House) And (Np3.Identificador Like '3_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em3 On (Em3.IdLogistica_House = Lhs.IdLogistica_House) And (Em3.Identificador Like '3_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv3 On (Dv3.IdLogistica_House = Lhs.IdLogistica_House) And (Dv3.Identificador Like '3_Vencimento')\n  Where\n    (Nr3.Valor_Alfanumerico Is Not Null) Or\n    (An3.Valor_Alfanumerico Is Not Null) Or\n    (St3.Valor_Alfanumerico Is Not Null) Or\n    (Dp3.Valor_Data Is Not Null) Or\n    (Np3.Valor_Alfanumerico Is Not Null) Or\n    (Em3.Valor_Data Is Not Null) Or\n    (Dv3.Valor_Data Is Not Null)\n    union All\n      Select\n      Lhs.IdLogistica_House,\n    '04' As Identificador,\n    Nr4.Valor_Alfanumerico As Numero_Li,\n    An4.Valor_Alfanumerico As Anuente_Li,\n    St4.Valor_Alfanumerico As Status_Li,\n    Dp4.Valor_Data As Data_Protocolo_Li,\n    Np4.Valor_Alfanumerico As Protocolo_Li,\n    Em4.Valor_Data As Embarque_Li,\n    Dv4.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr4 On (Nr4.IdLogistica_House = Lhs.IdLogistica_House) And (Nr4.Identificador Like '4_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An4 On (An4.IdLogistica_House = Lhs.IdLogistica_House) And (An4.Identificador Like '4_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St4 On (St4.IdLogistica_House = Lhs.IdLogistica_House) And (St4.Identificador Like '4_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp4 On (Dp4.IdLogistica_House = Lhs.IdLogistica_House) And (Dp4.Identificador Like '4_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np4 On (Np4.IdLogistica_House = Lhs.IdLogistica_House) And (Np4.Identificador Like '4_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em4 On (Em4.IdLogistica_House = Lhs.IdLogistica_House) And (Em4.Identificador Like '4_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv4 On (Dv4.IdLogistica_House = Lhs.IdLogistica_House) And (Dv4.Identificador Like '4_Vencimento')\n  Where\n    (Nr4.Valor_Alfanumerico Is Not Null) Or\n    (An4.Valor_Alfanumerico Is Not Null) Or\n    (St4.Valor_Alfanumerico Is Not Null) Or\n    (Dp4.Valor_Data Is Not Null) Or\n    (Np4.Valor_Alfanumerico Is Not Null) Or\n    (Em4.Valor_Data Is Not Null) Or\n    (Dv4.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '05' As Identificador,\n    Nr5.Valor_Alfanumerico As Numero_Li,\n    An5.Valor_Alfanumerico As Anuente_Li,\n    St5.Valor_Alfanumerico As Status_Li,\n    Dp5.Valor_Data As Data_Protocolo_Li,\n    Np5.Valor_Alfanumerico As Protocolo_Li,\n    Em5.Valor_Data As Embarque_Li,\n    Dv5.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr5 On (Nr5.IdLogistica_House = Lhs.IdLogistica_House) And (Nr5.Identificador Like '5_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An5 On (An5.IdLogistica_House = Lhs.IdLogistica_House) And (An5.Identificador Like '5_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St5 On (St5.IdLogistica_House = Lhs.IdLogistica_House) And (St5.Identificador Like '5_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp5 On (Dp5.IdLogistica_House = Lhs.IdLogistica_House) And (Dp5.Identificador Like '5_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np5 On (Np5.IdLogistica_House = Lhs.IdLogistica_House) And (Np5.Identificador Like '5_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em5 On (Em5.IdLogistica_House = Lhs.IdLogistica_House) And (Em5.Identificador Like '5_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv5 On (Dv5.IdLogistica_House = Lhs.IdLogistica_House) And (Dv5.Identificador Like '5_Vencimento')\n  Where\n    (Nr5.Valor_Alfanumerico Is Not Null) Or\n    (An5.Valor_Alfanumerico Is Not Null) Or\n    (St5.Valor_Alfanumerico Is Not Null) Or\n    (Dp5.Valor_Data Is Not Null) Or\n    (Np5.Valor_Alfanumerico Is Not Null) Or\n    (Em5.Valor_Data Is Not Null) Or\n    (Dv5.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '06' As Identificador,\n    Nr6.Valor_Alfanumerico As Numero_Li,\n    An6.Valor_Alfanumerico As Anuente_Li,\n    St6.Valor_Alfanumerico As Status_Li,\n    Dp6.Valor_Data As Data_Protocolo_Li,\n    Np6.Valor_Alfanumerico As Protocolo_Li,\n    Em6.Valor_Data As Embarque_Li,\n    Dv6.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr6 On (Nr6.IdLogistica_House = Lhs.IdLogistica_House) And (Nr6.Identificador Like '6_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An6 On (An6.IdLogistica_House = Lhs.IdLogistica_House) And (An6.Identificador Like '6_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St6 On (St6.IdLogistica_House = Lhs.IdLogistica_House) And (St6.Identificador Like '6_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp6 On (Dp6.IdLogistica_House = Lhs.IdLogistica_House) And (Dp6.Identificador Like '6_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np6 On (Np6.IdLogistica_House = Lhs.IdLogistica_House) And (Np6.Identificador Like '6_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em6 On (Em6.IdLogistica_House = Lhs.IdLogistica_House) And (Em6.Identificador Like '6_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv6 On (Dv6.IdLogistica_House = Lhs.IdLogistica_House) And (Dv6.Identificador Like '6_Vencimento')\n  Where\n    (Nr6.Valor_Alfanumerico Is Not Null) Or\n    (An6.Valor_Alfanumerico Is Not Null) Or\n    (St6.Valor_Alfanumerico Is Not Null) Or\n    (Dp6.Valor_Data Is Not Null) Or\n    (Np6.Valor_Alfanumerico Is Not Null) Or\n    (Em6.Valor_Data Is Not Null) Or\n    (Dv6.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '07' As Identificador,\n    Nr7.Valor_Alfanumerico As Numero_Li,\n    An7.Valor_Alfanumerico As Anuente_Li,\n    St7.Valor_Alfanumerico As Status_Li,\n    Dp7.Valor_Data As Data_Protocolo_Li,\n    Np7.Valor_Alfanumerico As Protocolo_Li,\n    Em7.Valor_Data As Embarque_Li,\n    Dv7.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr7 On (Nr7.IdLogistica_House = Lhs.IdLogistica_House) And (Nr7.Identificador Like '7_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An7 On (An7.IdLogistica_House = Lhs.IdLogistica_House) And (An7.Identificador Like '7_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St7 On (St7.IdLogistica_House = Lhs.IdLogistica_House) And (St7.Identificador Like '7_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp7 On (Dp7.IdLogistica_House = Lhs.IdLogistica_House) And (Dp7.Identificador Like '7_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np7 On (Np7.IdLogistica_House = Lhs.IdLogistica_House) And (Np7.Identificador Like '7_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em7 On (Em7.IdLogistica_House = Lhs.IdLogistica_House) And (Em7.Identificador Like '7_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv7 On (Dv7.IdLogistica_House = Lhs.IdLogistica_House) And (Dv7.Identificador Like '7_Vencimento')\n  Where\n    (Nr7.Valor_Alfanumerico Is Not Null) Or\n    (An7.Valor_Alfanumerico Is Not Null) Or\n    (St7.Valor_Alfanumerico Is Not Null) Or\n    (Dp7.Valor_Data Is Not Null) Or\n    (Np7.Valor_Alfanumerico Is Not Null) Or\n    (Em7.Valor_Data Is Not Null) Or\n    (Dv7.Valor_Data Is Not Null)\n   union All\n      Select\n    Lhs.IdLogistica_House,\n    '08' As Identificador,\n    Nr8.Valor_Alfanumerico As Numero_Li,\n    An8.Valor_Alfanumerico As Anuente_Li,\n    St8.Valor_Alfanumerico As Status_Li,\n    Dp8.Valor_Data As Data_Protocolo_Li,\n    Np8.Valor_Alfanumerico As Protocolo_Li,\n    Em8.Valor_Data As Embarque_Li,\n    Dv8.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr8 On (Nr8.IdLogistica_House = Lhs.IdLogistica_House) And (Nr8.Identificador Like '8_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An8 On (An8.IdLogistica_House = Lhs.IdLogistica_House) And (An8.Identificador Like '8_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St8 On (St8.IdLogistica_House = Lhs.IdLogistica_House) And (St8.Identificador Like '8_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp8 On (Dp8.IdLogistica_House = Lhs.IdLogistica_House) And (Dp8.Identificador Like '8_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np8 On (Np8.IdLogistica_House = Lhs.IdLogistica_House) And (Np8.Identificador Like '8_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em8 On (Em8.IdLogistica_House = Lhs.IdLogistica_House) And (Em8.Identificador Like '8_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv8 On (Dv8.IdLogistica_House = Lhs.IdLogistica_House) And (Dv8.Identificador Like '8_Vencimento')\n  Where\n    (Nr8.Valor_Alfanumerico Is Not Null) Or\n    (An8.Valor_Alfanumerico Is Not Null) Or\n    (St8.Valor_Alfanumerico Is Not Null) Or\n    (Dp8.Valor_Data Is Not Null) Or\n    (Np8.Valor_Alfanumerico Is Not Null) Or\n    (Em8.Valor_Data Is Not Null) Or\n    (Dv8.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '09' As Identificador,\n    Nr9.Valor_Alfanumerico As Numero_Li,\n    An9.Valor_Alfanumerico As Anuente_Li,\n    St9.Valor_Alfanumerico As Status_Li,\n    Dp9.Valor_Data As Data_Protocolo_Li,\n    Np9.Valor_Alfanumerico As Protocolo_Li,\n    Em9.Valor_Data As Embarque_Li,\n    Dv9.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr9 On (Nr9.IdLogistica_House = Lhs.IdLogistica_House) And (Nr9.Identificador Like '9_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An9 On (An9.IdLogistica_House = Lhs.IdLogistica_House) And (An9.Identificador Like '9_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St9 On (St9.IdLogistica_House = Lhs.IdLogistica_House) And (St9.Identificador Like '9_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp9 On (Dp9.IdLogistica_House = Lhs.IdLogistica_House) And (Dp9.Identificador Like '9_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np9 On (Np9.IdLogistica_House = Lhs.IdLogistica_House) And (Np9.Identificador Like '9_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em9 On (Em9.IdLogistica_House = Lhs.IdLogistica_House) And (Em9.Identificador Like '9_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv9 On (Dv9.IdLogistica_House = Lhs.IdLogistica_House) And (Dv9.Identificador Like '9_Vencimento')\n  Where\n    (Nr9.Valor_Alfanumerico Is Not Null) Or\n    (An9.Valor_Alfanumerico Is Not Null) Or\n    (St9.Valor_Alfanumerico Is Not Null) Or\n    (Dp9.Valor_Data Is Not Null) Or\n    (Np9.Valor_Alfanumerico Is Not Null) Or\n    (Em9.Valor_Data Is Not Null) Or\n    (Dv9.Valor_Data Is Not Null)  \n  union All\n      Select\n    '10' As Identificador,\n    Lhs.IdLogistica_House,\n    Nr10.Valor_Alfanumerico As Numero_Li,\n    An10.Valor_Alfanumerico As Anuente_Li,\n    St10.Valor_Alfanumerico As Status_Li,\n    Dp10.Valor_Data As Data_Protocolo_Li,\n    Np10.Valor_Alfanumerico As Protocolo_Li,\n    Em10.Valor_Data As Embarque_Li,\n    Dv10.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr10 On (Nr10.IdLogistica_House = Lhs.IdLogistica_House) And (Nr10.Identificador Like '10_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An10 On (An10.IdLogistica_House = Lhs.IdLogistica_House) And (An10.Identificador Like '10_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St10 On (St10.IdLogistica_House = Lhs.IdLogistica_House) And (St10.Identificador Like '10_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp10 On (Dp10.IdLogistica_House = Lhs.IdLogistica_House) And (Dp10.Identificador Like '10_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np10 On (Np10.IdLogistica_House = Lhs.IdLogistica_House) And (Np10.Identificador Like '10_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em10 On (Em10.IdLogistica_House = Lhs.IdLogistica_House) And (Em10.Identificador Like '10_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv10 On (Dv10.IdLogistica_House = Lhs.IdLogistica_House) And (Dv10.Identificador Like '10_Vencimento')\n  Where\n    (Nr10.Valor_Alfanumerico Is Not Null) Or\n    (An10.Valor_Alfanumerico Is Not Null) Or\n    (St10.Valor_Alfanumerico Is Not Null) Or\n    (Dp10.Valor_Data Is Not Null) Or\n    (Np10.Valor_Alfanumerico Is Not Null) Or\n    (Em10.Valor_Data Is Not Null) Or\n    (Dv10.Valor_Data Is Not Null) \n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '11' As Identificador,\n    Nr11.Valor_Alfanumerico As Numero_Li,\n    An11.Valor_Alfanumerico As Anuente_Li,\n    St11.Valor_Alfanumerico As Status_Li,\n    Dp11.Valor_Data As Data_Protocolo_Li,\n    Np11.Valor_Alfanumerico As Protocolo_Li,\n    Em11.Valor_Data As Embarque_Li,\n    Dv11.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr11 On (Nr11.IdLogistica_House = Lhs.IdLogistica_House) And (Nr11.Identificador Like '11_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An11 On (An11.IdLogistica_House = Lhs.IdLogistica_House) And (An11.Identificador Like '11_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St11 On (St11.IdLogistica_House = Lhs.IdLogistica_House) And (St11.Identificador Like '11_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp11 On (Dp11.IdLogistica_House = Lhs.IdLogistica_House) And (Dp11.Identificador Like '11_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np11 On (Np11.IdLogistica_House = Lhs.IdLogistica_House) And (Np11.Identificador Like '11_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em11 On (Em11.IdLogistica_House = Lhs.IdLogistica_House) And (Em11.Identificador Like '11_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv11 On (Dv11.IdLogistica_House = Lhs.IdLogistica_House) And (Dv11.Identificador Like '11_Vencimento')\n  Where\n    (Nr11.Valor_Alfanumerico Is Not Null) Or\n    (An11.Valor_Alfanumerico Is Not Null) Or\n    (St11.Valor_Alfanumerico Is Not Null) Or\n    (Dp11.Valor_Data Is Not Null) Or\n    (Np11.Valor_Alfanumerico Is Not Null) Or\n    (Em11.Valor_Data Is Not Null) Or\n    (Dv11.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '12' As Identificador,\n    Nr12.Valor_Alfanumerico As Numero_Li,\n    An12.Valor_Alfanumerico As Anuente_Li,\n    St12.Valor_Alfanumerico As Status_Li,\n    Dp12.Valor_Data As Data_Protocolo_Li,\n    Np12.Valor_Alfanumerico As Protocolo_Li,\n    Em12.Valor_Data As Embarque_Li,\n    Dv12.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr12 On (Nr12.IdLogistica_House = Lhs.IdLogistica_House) And (Nr12.Identificador Like '12_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An12 On (An12.IdLogistica_House = Lhs.IdLogistica_House) And (An12.Identificador Like '12_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St12 On (St12.IdLogistica_House = Lhs.IdLogistica_House) And (St12.Identificador Like '12_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp12 On (Dp12.IdLogistica_House = Lhs.IdLogistica_House) And (Dp12.Identificador Like '12_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np12 On (Np12.IdLogistica_House = Lhs.IdLogistica_House) And (Np12.Identificador Like '12_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em12 On (Em12.IdLogistica_House = Lhs.IdLogistica_House) And (Em12.Identificador Like '12_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv12 On (Dv12.IdLogistica_House = Lhs.IdLogistica_House) And (Dv12.Identificador Like '12_Vencimento')\n  Where\n    (Nr12.Valor_Alfanumerico Is Not Null) Or\n    (An12.Valor_Alfanumerico Is Not Null) Or\n    (St12.Valor_Alfanumerico Is Not Null) Or\n    (Dp12.Valor_Data Is Not Null) Or\n    (Np12.Valor_Alfanumerico Is Not Null) Or\n    (Em12.Valor_Data Is Not Null) Or\n    (Dv12.Valor_Data Is Not Null)\n  union All\n    Select\n    Lhs.IdLogistica_House,\n    '13' As Identificador,\n    Nr13.Valor_Alfanumerico As Numero_Li,\n    An13.Valor_Alfanumerico As Anuente_Li,\n    St13.Valor_Alfanumerico As Status_Li,\n    Dp13.Valor_Data As Data_Protocolo_Li,\n    Np13.Valor_Alfanumerico As Protocolo_Li,\n    Em13.Valor_Data As Embarque_Li,\n    Dv13.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr13 On (Nr13.IdLogistica_House = Lhs.IdLogistica_House) And (Nr13.Identificador Like '13_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An13 On (An13.IdLogistica_House = Lhs.IdLogistica_House) And (An13.Identificador Like '13_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St13 On (St13.IdLogistica_House = Lhs.IdLogistica_House) And (St13.Identificador Like '13_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp13 On (Dp13.IdLogistica_House = Lhs.IdLogistica_House) And (Dp13.Identificador Like '13_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np13 On (Np13.IdLogistica_House = Lhs.IdLogistica_House) And (Np13.Identificador Like '13_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em13 On (Em13.IdLogistica_House = Lhs.IdLogistica_House) And (Em13.Identificador Like '13_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv13 On (Dv13.IdLogistica_House = Lhs.IdLogistica_House) And (Dv13.Identificador Like '13_Vencimento')\n  Where\n    (Nr13.Valor_Alfanumerico Is Not Null) Or\n    (An13.Valor_Alfanumerico Is Not Null) Or\n    (St13.Valor_Alfanumerico Is Not Null) Or\n    (Dp13.Valor_Data Is Not Null) Or\n    (Np13.Valor_Alfanumerico Is Not Null) Or\n    (Em13.Valor_Data Is Not Null) Or\n    (Dv13.Valor_Data Is Not Null)\n   union All\n      Select\n    '14' As Identificador,\n    Lhs.IdLogistica_House,\n    Nr14.Valor_Alfanumerico As Numero_Li,\n    An14.Valor_Alfanumerico As Anuente_Li,\n    St14.Valor_Alfanumerico As Status_Li,\n    Dp14.Valor_Data As Data_Protocolo_Li,\n    Np14.Valor_Alfanumerico As Protocolo_Li,\n    Em14.Valor_Data As Embarque_Li,\n    Dv14.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr14 On (Nr14.IdLogistica_House = Lhs.IdLogistica_House) And (Nr14.Identificador Like '14_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An14 On (An14.IdLogistica_House = Lhs.IdLogistica_House) And (An14.Identificador Like '14_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St14 On (St14.IdLogistica_House = Lhs.IdLogistica_House) And (St14.Identificador Like '14_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp14 On (Dp14.IdLogistica_House = Lhs.IdLogistica_House) And (Dp14.Identificador Like '14_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np14 On (Np14.IdLogistica_House = Lhs.IdLogistica_House) And (Np14.Identificador Like '14_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em14 On (Em14.IdLogistica_House = Lhs.IdLogistica_House) And (Em14.Identificador Like '14_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv14 On (Dv14.IdLogistica_House = Lhs.IdLogistica_House) And (Dv14.Identificador Like '14_Vencimento')\n  Where\n    (Nr14.Valor_Alfanumerico Is Not Null) Or\n    (An14.Valor_Alfanumerico Is Not Null) Or\n    (St14.Valor_Alfanumerico Is Not Null) Or\n    (Dp14.Valor_Data Is Not Null) Or\n    (Np14.Valor_Alfanumerico Is Not Null) Or\n    (Em14.Valor_Data Is Not Null) Or\n    (Dv14.Valor_Data Is Not Null)\n   union All\n      Select\n    Lhs.IdLogistica_House,\n    '15' As Identificador,\n    Nr15.Valor_Alfanumerico As Numero_Li,\n    An15.Valor_Alfanumerico As Anuente_Li,\n    St15.Valor_Alfanumerico As Status_Li,\n    Dp15.Valor_Data As Data_Protocolo_Li,\n    Np15.Valor_Alfanumerico As Protocolo_Li,\n    Em15.Valor_Data As Embarque_Li,\n    Dv15.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr15 On (Nr15.IdLogistica_House = Lhs.IdLogistica_House) And (Nr15.Identificador Like '15_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An15 On (An15.IdLogistica_House = Lhs.IdLogistica_House) And (An15.Identificador Like '15_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St15 On (St15.IdLogistica_House = Lhs.IdLogistica_House) And (St15.Identificador Like '15_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp15 On (Dp15.IdLogistica_House = Lhs.IdLogistica_House) And (Dp15.Identificador Like '15_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np15 On (Np15.IdLogistica_House = Lhs.IdLogistica_House) And (Np15.Identificador Like '15_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em15 On (Em15.IdLogistica_House = Lhs.IdLogistica_House) And (Em15.Identificador Like '15_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv15 On (Dv15.IdLogistica_House = Lhs.IdLogistica_House) And (Dv15.Identificador Like '15_Vencimento')\n  Where\n    (Nr15.Valor_Alfanumerico Is Not Null) Or\n    (An15.Valor_Alfanumerico Is Not Null) Or\n    (St15.Valor_Alfanumerico Is Not Null) Or\n    (Dp15.Valor_Data Is Not Null) Or\n    (Np15.Valor_Alfanumerico Is Not Null) Or\n    (Em15.Valor_Data Is Not Null) Or\n    (Dv15.Valor_Data Is Not Null)) Dli on Dli.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  (Select\n    Pac.IdProjeto_Atividade,\n    Pcn.Nome,\n    Pcn.Email,\n    Pcn.Fone,\n    Rank() Over (Partition By Pac.IdProjeto_Atividade Order By Pcn.Nome) As Ranking\n  From  \n    mov_Projeto_Atividade_Contato Pac\n  Join\nIdGrupo_Envio_Mensagem =    mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato And Pge.IdGrupo_Envio_Mensagem = 14  /*Contato_Principal*/\n  Join\n    cad_Pessoa_Contato Pcn on Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pac.IdProjeto_Atividade And Lhs.IdCliente /*Pega o contato do cliente*/ = Pcn.IdPessoa\n  ) Cnt On Cnt.IdProjeto_Atividade = Lhs.IdProjeto_Atividade And Cnt.Ranking = 1\nWhere\n  (Atv.IdAtividade = :IdAtividade)\nAnd\n  (Dpx.Valor_Data is Null)\" SkipWhenNoRecords=\"True\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mrc.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  case When Ltx.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n       When Ltx.Tipo_Recebimento = 2 Then ' Processo'/*Peso Cubado*/\n       When Ltx.Tipo_Recebimento = 3 Then ' Kgs'/*Peso Cubado*/\n       When Ltx.Tipo_Recebimento = 4 Then ' kgs'/*Peso Taxado*/\n       When Ltx.Tipo_Recebimento = 5 Then ' Kgs'/*Peso Bruto*/\n       When Ltx.Tipo_Recebimento = 6 Then ' m³'/*Metro Cubico*/\n       When Ltx.Tipo_Recebimento = 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n       When Ltx.Tipo_Recebimento = 8 Then 'Invoice'\n       When Ltx.Tipo_Recebimento = 9 Then 'Volume'\n       When Ltx.Tipo_Recebimento = 10 Then 'Cntr' /*Equipamento*/\n       When Ltx.Tipo_Recebimento = 11 Then Emr.Descricao\n       When Ltx.Tipo_Recebimento = 12 Then 'TEU'\n       When Ltx.Tipo_Recebimento = 13 Then ' %'/*Percentual*/\n       When Ltx.Tipo_Recebimento = 14 Then ''/*livre*/\n       When Ltx.Tipo_Recebimento = 15 Then 'Via Master'\n       When Ltx.Tipo_Recebimento = 16 Then 'Via house'\n       When Ltx.Tipo_Recebimento = 17 Then ' Kgs'/*Peso Considerado*/\n  end as Tipo_Recebimento_escrito\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Exibir_Cliente = 1\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Pcn.Nome,\n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7,\n  Ems.Campo_Livre8,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10,\n  Ems.Campo_Livre11,\n  Ems.Campo_Livre12,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<style type=\"text/css\">\nbody, td, tr { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 10.0pt; padding-left: 5px}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; text-align:justify}\n.p_instrucoes { font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 8.5pt; text-align: justify}\n.topo { text-align: center; font-size: 18px; font-weight: 600; color: #FF0000}\n.negrito { font-weight: 600;}\n.vermelho { color: #FF0000; font-weight: 600}\n.fundo { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; font-weight: 600; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; font-size: 11.0pt;}\n.tabela_taxa_titulo { color: #000000; font-weight: 600; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size: 11.0pt; border: solid;  border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.tabela_taxa { color: #000000; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size: 11.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda_todos{ border-top-style:solid; border-bottom:solid; border-right:solid; border-left:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda{ border-left: solid; border-right: solid; border-bottom: solid; border-top: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_linha {border: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.borda_cima { border-top-style: solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_baixo { border-bottom: solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita { border-right: solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda_baixo { border-left: solid; border-right: solid; border-bottom: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda { border-left: solid; border-right: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo { border-right: solid; border-bottom: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_cima { border-right: solid; border-top: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda { border-left: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima { border-left: solid; border-top: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo { border-left: solid; border-bottom: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo { border-top: solid; border-right: solid; border-left: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px }\n.borda_sem_cima { border-bottom: solid; border-right: solid; border-left: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px }\n.bordas_laterais { border: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 0 1px 0 1px}\n</style>\n</head>\n\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Exportador_Fantasia\"> - <Print Dataset=\"Processo\" FieldName=\"Importador_Fantasia\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> x <Print Dataset=\"Processo\" FieldName=\"Destino\"> - <Print Dataset=\"Processo\" FieldName=\"Incoterm\">\n[Subject.Footer]\n\n[Report.Detail]\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <img src=\"https://i.imgur.com/Me9BbBa.png\" width=\"775\">\n  </tr>\n</table>\n<br><br>\n\n<table width=\"775\" class=\"borda_todos\" cellspacing=\"0\">\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n   <tr>\n    <td width=\"62%\" >\n      <img class=\"img_ent\" src=\"https://static.wixstatic.com/media/ec8742_195dc4d98d6149c785c14182421a5f24~mv2.png/v1/fill/w_223,h_39,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/Enterprise%20Logo_WhiteBG.png\">\n  </td>\n    <td width=\"10%\" cellspacing=\"0\">\n      Referência:<br>\n      Cliente:<br>\n      Att:<br>\n      Data:\n    </td>\n    <td width=\"28%\" cellspacing=\"0\" >\n      <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Cliente\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Contato_Principal_Cliente\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Data_Abertura_Processo\" DisplayFormat=\"DD/MM/YYYY\">\n    </td>\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n</table>\n\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr><td>Prezado, <Print Dataset=\"Processo\" FieldName=\"Contato_Principal_Cliente\"><br> </td></tr>\n  <tr><td></td></tr>\n  <tr><td>Segue abaixo a última atualização da posição do navio:</td></tr>\n  <tr><td></td></tr>\n</table>\n\n<br>\n\n<table width=\"775\" class=\"borda\" cellspacing=\"0\" cellpadding=\"0\" style=\"text-align: center\">\n  <tr style=\"background-color: #D9D9D9\">\n    <td align = \"center\"><strong>Navio</strong></td>\n    <td align = \"center\"><strong>Viagem</strong></td>\n    <td align = \"center\"><strong>Origem</strong></td>\n    <td align = \"center\"><strong>Destino</strong></td>\n    <td align = \"center\"><strong>ETD</strong></td>\n    <td align = \"center\"><strong>ETA</strong></td>\n    <td align = \"center\"><strong>Transit Time</strong></td>\n  </tr>\n  <tr>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Navio\"></td>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Viagem\"></td>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\"></td>\n    <td align = \"center\"><Print Dataset=\"Processo\" FieldName=\"Transit_Time\"> dias</td>\n  </tr>\n</table>\n<div width=\"775\">\n<p>Abaixo segue a atualização do follow up </p>\n</div>\n<table width=\"775\" cellspacing=\"0\">\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n  <tr>\n    <td colspan=\"4\">\n    <table class=\"borda_todos\" width=\"775\" cellspacing=\"0\">\n    <td width=\"15%\" class=\"borda_esquerda\"><span class=\"negrito\">MBL</span></td>\n    <td width=\"1%\">:</td>\n    <td width=\"34%\"><Print Dataset=\"Processo\" FieldName=\"Documento_Master\"></td>\n    <td width=\"15%\"><span class=\"negrito\">HBL</span></td>\n    <td width=\"1%\">:</td>\n    <td width=\"34%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Exportador</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Exportador_Fantasia\"></td>\n    <td><span class=\"negrito\">Importador</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Importador_Fantasia\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Commodity</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n    <td><span class=\"negrito\">Navio/Viagem</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Origem</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td><span class=\"negrito\">Destino</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <!--tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Local Coleta</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Local_Coleta\"></td>\n    <td><span class=\"negrito\">Local Entrega</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Local_Entrega\"></td>\n  </tr-->\n    <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Prev. de embarque</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\"></td>\n    <td class=\"negrito\">Prev. de chegada</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\"></td>\n  </tr> \n <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Booking Number</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n    <td class=\"negrito\">Free Time Demurrage</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"FTH_Destino\"></td>\n  </tr>\n <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Armador</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n    <td class=\"negrito\">Tipo Rota</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Rota\"></td>\n  </tr>\n <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Equipamento</span></td>\n    <td>:</td>\n    <td><SubReport Name=\"Carga\" Dataset=\"Carga\"></td>\n    <td class=\"negrito\">Incoterm</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n  </tr>\n  </table><br>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"fundo\" colspan=\"2\"><span class=\"negrito\">Data</span></td>\n    <td class=\"fundo\" colspan=\"4\"><span class=\"negrito\">Descrição</span></td>\n  </tr>\n  <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n  <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n  <tr>\n    <td colspan=\"6\" class=\"borda_cima\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\"  cellspacing=\"0\" cellpadding=\"0\">\n   <tr><p>Aproveitamos para informar nosso contato no destino para a devida aplicação dos procedimentos de liberação da carga e documentos originais.</p></tr>\n</table>\n\n  <table width=\"775\" class=\"borda\" cellspacing=\"0\" cellpadding=\"0\" >\n    <tr style=\"background-color: #D9D9D9\">\n      <td colspan=\"2\" align = \"left\"><strong>Dados do representante local: </strong></td>\n    </tr>\n    <tr>\n      <td class=\"center borda_direita\" width=\"30%\"><strong>Nome: </strong> </td>\n      <td width=\"70%\"><Print Dataset=\"Processo\" FieldName=\"Nome_Rep\"></td>\n    </tr>\n     <tr>\n      <td class=\"center borda_direita\"><strong>Contato: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Contato_rep\"></td>\n    </tr>\n     <tr>\n      <td class=\"center borda_direita\"><strong>Endereço: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"End_Rep\"></td>\n    </tr>\n     <tr>\n      <td class=\"center borda_direita\"><strong>Telefone: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Fone_Rep\"></td>\n    </tr>\n    <tr>\n      <td class=\"center borda_direita\"><strong>Email: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Email_Rep\"></td>\n    </tr>\n</table>\n <br><br><br>\n\n\n\n\n<table width=\"775\"  cellspacing=\"0\" cellpadding=\"0\">\n<tr><p>Manteremos informada em caso de eventuais alterações e estamos disponíveis para esclarecer quaisquer dúvidas.</p></tr>\n<tr><p>Agradecemos por confiar na equipe ENTERPRISE.</p></tr>\n</table>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Im - Follow-Up Enterprise.html",
        "conteudo": "[Report.Header]\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html\"/>\n<title>Follow Up</title>\n\n<DataSet Name=\"Processo\" Sql=\"Select\n  Rep.Correspondencia,\n  Rep.Nome AS Nome_Rep,\n  Rep.Cpf_Cnpj AS Contato_Rep,\n  CONCAT(Rep.Logradouro, ' ', Rep.Numero, ' ', Rep.Bairro, ' ') AS End_Rep,\n  Rep.Fax_Celular AS Fone_Rep,\n  Rep.Email AS Email_Rep,\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lme.Free_Time_House_Destino as FTH_Destino,\n  Lmm.Viagem_Navio,\n  Lms.Data_Embarque,\n  Lhs.Rota,\n  Lms.Transit_Time,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n\n  Case \n    When Atv.IdTarefa = 374 Then 'Follow up'\n    When Atv.IdTarefa = 377 Then 'Verificar informações'\n    When Atv.IdTarefa = 378 Then 'Solicitar informações'\n    When Atv.IdTarefa = 379 Then 'Instrução de embarque'\n    When Atv.IdTarefa = 380 Then 'Booking'\n    When Atv.IdTarefa = 385 Then 'Detalhes booking'\n    When Atv.IdTarefa = 387 Then 'Documentos aprovação'\n    When Atv.IdTarefa = 389 Then 'Aprovação documentos'\n    When Atv.IdTarefa = 427 Then 'Analisar documentos'\n    When Atv.IdTarefa = 429 Then 'Saída Navio'\n    When Atv.IdTarefa = 430 Then 'Solicitar originais'\n    When Atv.IdTarefa = 431 Then 'Chegada de Navio'\n    When Atv.IdTarefa = 432 Then 'Desconsolidação'\n    When Atv.IdTarefa = 433 Then 'Aviso de chegada'\n    When Atv.IdTarefa = 434 Then 'Confirmação de chegada'\n    When Atv.IdTarefa = 436 Then 'Numerário Cliente'\n    When Atv.IdTarefa = 449 Then 'Confirmar desbloqueio ao cliente'\n  End as Tarefa_Follow,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Nome_Fantasia as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome_Fantasia as Cia_Transporte,\n  Lmm.Viagem_Navio AS Viagem,\n  Nvi.Nome as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n  End as Agente,\n  Mer.Nome as Mercadoria,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Lhs.Quantidade_Volumes,\n  Rpr.Nome_Fantasia as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO - AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO - MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO - AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO - MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO - TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO - TERRESTRE'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL - TERRESTRE'\n  end as Tipo_modalidade,\n  Cnt.Nome As Contato_Principal_Cliente,\n  Cnt.Nome as Contato\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  vis_Cliente Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  (Select\n    RANK() OVER(PARTITION BY IdPessoa ORDER BY IdPessoa_Contato) Ranking,\n    Pcn.IdPessoa_Contato,\n    Pcn.IdPessoa,\n    Pcn.Nome\n  From  \n    cad_Pessoa_Contato Pcn\n  ) Cnt On Cnt.IdPessoa = Cln.IdPessoa and Cnt.Ranking = 1\nLeft Outer Join\n  cad_Pessoa Rep on Rep.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n  <DataSet Name=\"Transbordo_Logistica\" Sql=\"SELECT \n\tLhs.IdLogistica_House,\n\tLvg.IdLogistica_Viagem,\n\tNvi.Nome AS Navio,\n\tLvg.Numero_Controle AS Reserva,\n\tLvg.Viagem_Voo,\n\tOrg.Nome AS Origem,\n\tDst.Nome AS Destino,\n\tCoalesce(Lvg.Data_Previsao_DesEmbarque,Lvg.Data_Desembarque) as ETA,\n        Case When Lvg.Data_Embarque is null then Coalesce(Lvg.Data_Previsao_Embarque,Lvg.Data_Embarque) else Lvg.Data_Embarque End as ETD,\n\tDATEDIFF(dd,Lvg.Data_Previsao_Embarque, Lvg.Data_Previsao_Desembarque) AS Transit_Time\nFROM\n\tmov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tmov_Logistica_Viagem Lvg ON Lvg.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lvg.IdOrigem\nLEFT OUTER JOIN\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lvg.IdDestino\nJOIN\n  cad_Navio Nvi on Nvi.IdNavio = Lvg.IdNavio\nWhere\n  Atv.IdAtividade =:IdAtividade\">\n\n<DataSet Name=\"Li\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Dli.Identificador,\n  Dli.Numero_Li,\n  Dli.Anuente_Li,\n  Dli.Status_Li,\n  Dli.Data_Protocolo_Li,\n  Dli.Protocolo_Li,\n  Dli.Embarque_Li,\n  Dli.Vencimento_Li,\n  Lhs.Situacao_Agenciamento,\n  Dpx.Valor_Data As Data_Puxe\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  vis_Logistica_Prazo Dpx On (Dpx.IdLogistica_House = Lhs.IdLogistica_House) And (Dpx.Identificador Like 'DATA_PUXE')\nJoin\n  (\n    Select\n    Lhs.IdLogistica_House,\n    '01' As Identificador,\n    Nr1.Valor_Alfanumerico As Numero_Li,\n    An1.Valor_Alfanumerico As Anuente_Li,\n    St1.Valor_Alfanumerico As Status_Li,\n    Dp1.Valor_Data As Data_Protocolo_Li,\n    Np1.Valor_Alfanumerico As Protocolo_Li,\n    Em1.Valor_Data As Embarque_Li,\n    Dv1.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr1 On (Nr1.IdLogistica_House = Lhs.IdLogistica_House) And (Nr1.Identificador Like '1_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An1 On (An1.IdLogistica_House = Lhs.IdLogistica_House) And (An1.Identificador Like '1_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St1 On (St1.IdLogistica_House = Lhs.IdLogistica_House) And (St1.Identificador Like '1_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp1 On (Dp1.IdLogistica_House = Lhs.IdLogistica_House) And (Dp1.Identificador Like '1_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np1 On (Np1.IdLogistica_House = Lhs.IdLogistica_House) And (Np1.Identificador Like '1_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em1 On (Em1.IdLogistica_House = Lhs.IdLogistica_House) And (Em1.Identificador Like '1_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv1 On (Dv1.IdLogistica_House = Lhs.IdLogistica_House) And (Dv1.Identificador Like '1_Vencimento')\n  Where\n    (Nr1.Valor_Alfanumerico Is Not Null) Or\n    (An1.Valor_Alfanumerico Is Not Null) Or\n    (St1.Valor_Alfanumerico Is Not Null) Or\n    (Dp1.Valor_Data Is Not Null) Or\n    (Np1.Valor_Alfanumerico Is Not Null) Or\n    (Em1.Valor_Data Is Not Null) Or\n    (Dv1.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '02' As Identificador,\n    Nr2.Valor_Alfanumerico As Numero_Li,\n    An2.Valor_Alfanumerico As Anuente_Li,\n    St2.Valor_Alfanumerico As Status_Li,\n    Dp2.Valor_Data As Data_Protocolo_Li,\n    Np2.Valor_Alfanumerico As Protocolo_Li,\n    Em2.Valor_Data As Embarque_Li,\n    Dv2.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr2 On (Nr2.IdLogistica_House = Lhs.IdLogistica_House) And (Nr2.Identificador Like '2_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An2 On (An2.IdLogistica_House = Lhs.IdLogistica_House) And (An2.Identificador Like '2_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St2 On (St2.IdLogistica_House = Lhs.IdLogistica_House) And (St2.Identificador Like '2_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp2 On (Dp2.IdLogistica_House = Lhs.IdLogistica_House) And (Dp2.Identificador Like '2_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np2 On (Np2.IdLogistica_House = Lhs.IdLogistica_House) And (Np2.Identificador Like '2_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em2 On (Em2.IdLogistica_House = Lhs.IdLogistica_House) And (Em2.Identificador Like '2_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv2 On (Dv2.IdLogistica_House = Lhs.IdLogistica_House) And (Dv2.Identificador Like '2_Vencimento')\n  Where\n    (Nr2.Valor_Alfanumerico Is Not Null) Or\n    (An2.Valor_Alfanumerico Is Not Null) Or\n    (St2.Valor_Alfanumerico Is Not Null) Or\n    (Dp2.Valor_Data Is Not Null) Or\n    (Np2.Valor_Alfanumerico Is Not Null) Or\n    (Em2.Valor_Data Is Not Null) Or\n    (Dv2.Valor_Data Is Not Null)\n    union All\n      Select\n    Lhs.IdLogistica_House,\n    '03' As Identificador,\n    Nr3.Valor_Alfanumerico As Numero_Li,\n    An3.Valor_Alfanumerico As Anuente_Li,\n    St3.Valor_Alfanumerico As Status_Li,\n    Dp3.Valor_Data As Data_Protocolo_Li,\n    Np3.Valor_Alfanumerico As Protocolo_Li,\n    Em3.Valor_Data As Embarque_Li,\n    Dv3.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr3 On (Nr3.IdLogistica_House = Lhs.IdLogistica_House) And (Nr3.Identificador Like '3_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An3 On (An3.IdLogistica_House = Lhs.IdLogistica_House) And (An3.Identificador Like '3_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St3 On (St3.IdLogistica_House = Lhs.IdLogistica_House) And (St3.Identificador Like '3_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp3 On (Dp3.IdLogistica_House = Lhs.IdLogistica_House) And (Dp3.Identificador Like '3_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np3 On (Np3.IdLogistica_House = Lhs.IdLogistica_House) And (Np3.Identificador Like '3_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em3 On (Em3.IdLogistica_House = Lhs.IdLogistica_House) And (Em3.Identificador Like '3_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv3 On (Dv3.IdLogistica_House = Lhs.IdLogistica_House) And (Dv3.Identificador Like '3_Vencimento')\n  Where\n    (Nr3.Valor_Alfanumerico Is Not Null) Or\n    (An3.Valor_Alfanumerico Is Not Null) Or\n    (St3.Valor_Alfanumerico Is Not Null) Or\n    (Dp3.Valor_Data Is Not Null) Or\n    (Np3.Valor_Alfanumerico Is Not Null) Or\n    (Em3.Valor_Data Is Not Null) Or\n    (Dv3.Valor_Data Is Not Null)\n    union All\n      Select\n      Lhs.IdLogistica_House,\n    '04' As Identificador,\n    Nr4.Valor_Alfanumerico As Numero_Li,\n    An4.Valor_Alfanumerico As Anuente_Li,\n    St4.Valor_Alfanumerico As Status_Li,\n    Dp4.Valor_Data As Data_Protocolo_Li,\n    Np4.Valor_Alfanumerico As Protocolo_Li,\n    Em4.Valor_Data As Embarque_Li,\n    Dv4.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr4 On (Nr4.IdLogistica_House = Lhs.IdLogistica_House) And (Nr4.Identificador Like '4_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An4 On (An4.IdLogistica_House = Lhs.IdLogistica_House) And (An4.Identificador Like '4_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St4 On (St4.IdLogistica_House = Lhs.IdLogistica_House) And (St4.Identificador Like '4_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp4 On (Dp4.IdLogistica_House = Lhs.IdLogistica_House) And (Dp4.Identificador Like '4_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np4 On (Np4.IdLogistica_House = Lhs.IdLogistica_House) And (Np4.Identificador Like '4_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em4 On (Em4.IdLogistica_House = Lhs.IdLogistica_House) And (Em4.Identificador Like '4_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv4 On (Dv4.IdLogistica_House = Lhs.IdLogistica_House) And (Dv4.Identificador Like '4_Vencimento')\n  Where\n    (Nr4.Valor_Alfanumerico Is Not Null) Or\n    (An4.Valor_Alfanumerico Is Not Null) Or\n    (St4.Valor_Alfanumerico Is Not Null) Or\n    (Dp4.Valor_Data Is Not Null) Or\n    (Np4.Valor_Alfanumerico Is Not Null) Or\n    (Em4.Valor_Data Is Not Null) Or\n    (Dv4.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '05' As Identificador,\n    Nr5.Valor_Alfanumerico As Numero_Li,\n    An5.Valor_Alfanumerico As Anuente_Li,\n    St5.Valor_Alfanumerico As Status_Li,\n    Dp5.Valor_Data As Data_Protocolo_Li,\n    Np5.Valor_Alfanumerico As Protocolo_Li,\n    Em5.Valor_Data As Embarque_Li,\n    Dv5.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr5 On (Nr5.IdLogistica_House = Lhs.IdLogistica_House) And (Nr5.Identificador Like '5_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An5 On (An5.IdLogistica_House = Lhs.IdLogistica_House) And (An5.Identificador Like '5_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St5 On (St5.IdLogistica_House = Lhs.IdLogistica_House) And (St5.Identificador Like '5_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp5 On (Dp5.IdLogistica_House = Lhs.IdLogistica_House) And (Dp5.Identificador Like '5_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np5 On (Np5.IdLogistica_House = Lhs.IdLogistica_House) And (Np5.Identificador Like '5_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em5 On (Em5.IdLogistica_House = Lhs.IdLogistica_House) And (Em5.Identificador Like '5_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv5 On (Dv5.IdLogistica_House = Lhs.IdLogistica_House) And (Dv5.Identificador Like '5_Vencimento')\n  Where\n    (Nr5.Valor_Alfanumerico Is Not Null) Or\n    (An5.Valor_Alfanumerico Is Not Null) Or\n    (St5.Valor_Alfanumerico Is Not Null) Or\n    (Dp5.Valor_Data Is Not Null) Or\n    (Np5.Valor_Alfanumerico Is Not Null) Or\n    (Em5.Valor_Data Is Not Null) Or\n    (Dv5.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '06' As Identificador,\n    Nr6.Valor_Alfanumerico As Numero_Li,\n    An6.Valor_Alfanumerico As Anuente_Li,\n    St6.Valor_Alfanumerico As Status_Li,\n    Dp6.Valor_Data As Data_Protocolo_Li,\n    Np6.Valor_Alfanumerico As Protocolo_Li,\n    Em6.Valor_Data As Embarque_Li,\n    Dv6.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr6 On (Nr6.IdLogistica_House = Lhs.IdLogistica_House) And (Nr6.Identificador Like '6_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An6 On (An6.IdLogistica_House = Lhs.IdLogistica_House) And (An6.Identificador Like '6_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St6 On (St6.IdLogistica_House = Lhs.IdLogistica_House) And (St6.Identificador Like '6_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp6 On (Dp6.IdLogistica_House = Lhs.IdLogistica_House) And (Dp6.Identificador Like '6_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np6 On (Np6.IdLogistica_House = Lhs.IdLogistica_House) And (Np6.Identificador Like '6_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em6 On (Em6.IdLogistica_House = Lhs.IdLogistica_House) And (Em6.Identificador Like '6_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv6 On (Dv6.IdLogistica_House = Lhs.IdLogistica_House) And (Dv6.Identificador Like '6_Vencimento')\n  Where\n    (Nr6.Valor_Alfanumerico Is Not Null) Or\n    (An6.Valor_Alfanumerico Is Not Null) Or\n    (St6.Valor_Alfanumerico Is Not Null) Or\n    (Dp6.Valor_Data Is Not Null) Or\n    (Np6.Valor_Alfanumerico Is Not Null) Or\n    (Em6.Valor_Data Is Not Null) Or\n    (Dv6.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '07' As Identificador,\n    Nr7.Valor_Alfanumerico As Numero_Li,\n    An7.Valor_Alfanumerico As Anuente_Li,\n    St7.Valor_Alfanumerico As Status_Li,\n    Dp7.Valor_Data As Data_Protocolo_Li,\n    Np7.Valor_Alfanumerico As Protocolo_Li,\n    Em7.Valor_Data As Embarque_Li,\n    Dv7.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr7 On (Nr7.IdLogistica_House = Lhs.IdLogistica_House) And (Nr7.Identificador Like '7_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An7 On (An7.IdLogistica_House = Lhs.IdLogistica_House) And (An7.Identificador Like '7_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St7 On (St7.IdLogistica_House = Lhs.IdLogistica_House) And (St7.Identificador Like '7_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp7 On (Dp7.IdLogistica_House = Lhs.IdLogistica_House) And (Dp7.Identificador Like '7_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np7 On (Np7.IdLogistica_House = Lhs.IdLogistica_House) And (Np7.Identificador Like '7_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em7 On (Em7.IdLogistica_House = Lhs.IdLogistica_House) And (Em7.Identificador Like '7_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv7 On (Dv7.IdLogistica_House = Lhs.IdLogistica_House) And (Dv7.Identificador Like '7_Vencimento')\n  Where\n    (Nr7.Valor_Alfanumerico Is Not Null) Or\n    (An7.Valor_Alfanumerico Is Not Null) Or\n    (St7.Valor_Alfanumerico Is Not Null) Or\n    (Dp7.Valor_Data Is Not Null) Or\n    (Np7.Valor_Alfanumerico Is Not Null) Or\n    (Em7.Valor_Data Is Not Null) Or\n    (Dv7.Valor_Data Is Not Null)\n   union All\n      Select\n    Lhs.IdLogistica_House,\n    '08' As Identificador,\n    Nr8.Valor_Alfanumerico As Numero_Li,\n    An8.Valor_Alfanumerico As Anuente_Li,\n    St8.Valor_Alfanumerico As Status_Li,\n    Dp8.Valor_Data As Data_Protocolo_Li,\n    Np8.Valor_Alfanumerico As Protocolo_Li,\n    Em8.Valor_Data As Embarque_Li,\n    Dv8.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr8 On (Nr8.IdLogistica_House = Lhs.IdLogistica_House) And (Nr8.Identificador Like '8_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An8 On (An8.IdLogistica_House = Lhs.IdLogistica_House) And (An8.Identificador Like '8_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St8 On (St8.IdLogistica_House = Lhs.IdLogistica_House) And (St8.Identificador Like '8_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp8 On (Dp8.IdLogistica_House = Lhs.IdLogistica_House) And (Dp8.Identificador Like '8_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np8 On (Np8.IdLogistica_House = Lhs.IdLogistica_House) And (Np8.Identificador Like '8_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em8 On (Em8.IdLogistica_House = Lhs.IdLogistica_House) And (Em8.Identificador Like '8_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv8 On (Dv8.IdLogistica_House = Lhs.IdLogistica_House) And (Dv8.Identificador Like '8_Vencimento')\n  Where\n    (Nr8.Valor_Alfanumerico Is Not Null) Or\n    (An8.Valor_Alfanumerico Is Not Null) Or\n    (St8.Valor_Alfanumerico Is Not Null) Or\n    (Dp8.Valor_Data Is Not Null) Or\n    (Np8.Valor_Alfanumerico Is Not Null) Or\n    (Em8.Valor_Data Is Not Null) Or\n    (Dv8.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '09' As Identificador,\n    Nr9.Valor_Alfanumerico As Numero_Li,\n    An9.Valor_Alfanumerico As Anuente_Li,\n    St9.Valor_Alfanumerico As Status_Li,\n    Dp9.Valor_Data As Data_Protocolo_Li,\n    Np9.Valor_Alfanumerico As Protocolo_Li,\n    Em9.Valor_Data As Embarque_Li,\n    Dv9.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr9 On (Nr9.IdLogistica_House = Lhs.IdLogistica_House) And (Nr9.Identificador Like '9_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An9 On (An9.IdLogistica_House = Lhs.IdLogistica_House) And (An9.Identificador Like '9_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St9 On (St9.IdLogistica_House = Lhs.IdLogistica_House) And (St9.Identificador Like '9_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp9 On (Dp9.IdLogistica_House = Lhs.IdLogistica_House) And (Dp9.Identificador Like '9_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np9 On (Np9.IdLogistica_House = Lhs.IdLogistica_House) And (Np9.Identificador Like '9_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em9 On (Em9.IdLogistica_House = Lhs.IdLogistica_House) And (Em9.Identificador Like '9_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv9 On (Dv9.IdLogistica_House = Lhs.IdLogistica_House) And (Dv9.Identificador Like '9_Vencimento')\n  Where\n    (Nr9.Valor_Alfanumerico Is Not Null) Or\n    (An9.Valor_Alfanumerico Is Not Null) Or\n    (St9.Valor_Alfanumerico Is Not Null) Or\n    (Dp9.Valor_Data Is Not Null) Or\n    (Np9.Valor_Alfanumerico Is Not Null) Or\n    (Em9.Valor_Data Is Not Null) Or\n    (Dv9.Valor_Data Is Not Null)  \n  union All\n      Select\n    '10' As Identificador,\n    Lhs.IdLogistica_House,\n    Nr10.Valor_Alfanumerico As Numero_Li,\n    An10.Valor_Alfanumerico As Anuente_Li,\n    St10.Valor_Alfanumerico As Status_Li,\n    Dp10.Valor_Data As Data_Protocolo_Li,\n    Np10.Valor_Alfanumerico As Protocolo_Li,\n    Em10.Valor_Data As Embarque_Li,\n    Dv10.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr10 On (Nr10.IdLogistica_House = Lhs.IdLogistica_House) And (Nr10.Identificador Like '10_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An10 On (An10.IdLogistica_House = Lhs.IdLogistica_House) And (An10.Identificador Like '10_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St10 On (St10.IdLogistica_House = Lhs.IdLogistica_House) And (St10.Identificador Like '10_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp10 On (Dp10.IdLogistica_House = Lhs.IdLogistica_House) And (Dp10.Identificador Like '10_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np10 On (Np10.IdLogistica_House = Lhs.IdLogistica_House) And (Np10.Identificador Like '10_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em10 On (Em10.IdLogistica_House = Lhs.IdLogistica_House) And (Em10.Identificador Like '10_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv10 On (Dv10.IdLogistica_House = Lhs.IdLogistica_House) And (Dv10.Identificador Like '10_Vencimento')\n  Where\n    (Nr10.Valor_Alfanumerico Is Not Null) Or\n    (An10.Valor_Alfanumerico Is Not Null) Or\n    (St10.Valor_Alfanumerico Is Not Null) Or\n    (Dp10.Valor_Data Is Not Null) Or\n    (Np10.Valor_Alfanumerico Is Not Null) Or\n    (Em10.Valor_Data Is Not Null) Or\n    (Dv10.Valor_Data Is Not Null) \n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '11' As Identificador,\n    Nr11.Valor_Alfanumerico As Numero_Li,\n    An11.Valor_Alfanumerico As Anuente_Li,\n    St11.Valor_Alfanumerico As Status_Li,\n    Dp11.Valor_Data As Data_Protocolo_Li,\n    Np11.Valor_Alfanumerico As Protocolo_Li,\n    Em11.Valor_Data As Embarque_Li,\n    Dv11.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr11 On (Nr11.IdLogistica_House = Lhs.IdLogistica_House) And (Nr11.Identificador Like '11_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An11 On (An11.IdLogistica_House = Lhs.IdLogistica_House) And (An11.Identificador Like '11_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St11 On (St11.IdLogistica_House = Lhs.IdLogistica_House) And (St11.Identificador Like '11_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp11 On (Dp11.IdLogistica_House = Lhs.IdLogistica_House) And (Dp11.Identificador Like '11_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np11 On (Np11.IdLogistica_House = Lhs.IdLogistica_House) And (Np11.Identificador Like '11_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em11 On (Em11.IdLogistica_House = Lhs.IdLogistica_House) And (Em11.Identificador Like '11_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv11 On (Dv11.IdLogistica_House = Lhs.IdLogistica_House) And (Dv11.Identificador Like '11_Vencimento')\n  Where\n    (Nr11.Valor_Alfanumerico Is Not Null) Or\n    (An11.Valor_Alfanumerico Is Not Null) Or\n    (St11.Valor_Alfanumerico Is Not Null) Or\n    (Dp11.Valor_Data Is Not Null) Or\n    (Np11.Valor_Alfanumerico Is Not Null) Or\n    (Em11.Valor_Data Is Not Null) Or\n    (Dv11.Valor_Data Is Not Null)\n  union All\n      Select\n    Lhs.IdLogistica_House,\n    '12' As Identificador,\n    Nr12.Valor_Alfanumerico As Numero_Li,\n    An12.Valor_Alfanumerico As Anuente_Li,\n    St12.Valor_Alfanumerico As Status_Li,\n    Dp12.Valor_Data As Data_Protocolo_Li,\n    Np12.Valor_Alfanumerico As Protocolo_Li,\n    Em12.Valor_Data As Embarque_Li,\n    Dv12.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr12 On (Nr12.IdLogistica_House = Lhs.IdLogistica_House) And (Nr12.Identificador Like '12_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An12 On (An12.IdLogistica_House = Lhs.IdLogistica_House) And (An12.Identificador Like '12_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St12 On (St12.IdLogistica_House = Lhs.IdLogistica_House) And (St12.Identificador Like '12_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp12 On (Dp12.IdLogistica_House = Lhs.IdLogistica_House) And (Dp12.Identificador Like '12_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np12 On (Np12.IdLogistica_House = Lhs.IdLogistica_House) And (Np12.Identificador Like '12_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em12 On (Em12.IdLogistica_House = Lhs.IdLogistica_House) And (Em12.Identificador Like '12_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv12 On (Dv12.IdLogistica_House = Lhs.IdLogistica_House) And (Dv12.Identificador Like '12_Vencimento')\n  Where\n    (Nr12.Valor_Alfanumerico Is Not Null) Or\n    (An12.Valor_Alfanumerico Is Not Null) Or\n    (St12.Valor_Alfanumerico Is Not Null) Or\n    (Dp12.Valor_Data Is Not Null) Or\n    (Np12.Valor_Alfanumerico Is Not Null) Or\n    (Em12.Valor_Data Is Not Null) Or\n    (Dv12.Valor_Data Is Not Null)\n  union All\n    Select\n    Lhs.IdLogistica_House,\n    '13' As Identificador,\n    Nr13.Valor_Alfanumerico As Numero_Li,\n    An13.Valor_Alfanumerico As Anuente_Li,\n    St13.Valor_Alfanumerico As Status_Li,\n    Dp13.Valor_Data As Data_Protocolo_Li,\n    Np13.Valor_Alfanumerico As Protocolo_Li,\n    Em13.Valor_Data As Embarque_Li,\n    Dv13.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr13 On (Nr13.IdLogistica_House = Lhs.IdLogistica_House) And (Nr13.Identificador Like '13_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An13 On (An13.IdLogistica_House = Lhs.IdLogistica_House) And (An13.Identificador Like '13_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St13 On (St13.IdLogistica_House = Lhs.IdLogistica_House) And (St13.Identificador Like '13_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp13 On (Dp13.IdLogistica_House = Lhs.IdLogistica_House) And (Dp13.Identificador Like '13_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np13 On (Np13.IdLogistica_House = Lhs.IdLogistica_House) And (Np13.Identificador Like '13_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em13 On (Em13.IdLogistica_House = Lhs.IdLogistica_House) And (Em13.Identificador Like '13_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv13 On (Dv13.IdLogistica_House = Lhs.IdLogistica_House) And (Dv13.Identificador Like '13_Vencimento')\n  Where\n    (Nr13.Valor_Alfanumerico Is Not Null) Or\n    (An13.Valor_Alfanumerico Is Not Null) Or\n    (St13.Valor_Alfanumerico Is Not Null) Or\n    (Dp13.Valor_Data Is Not Null) Or\n    (Np13.Valor_Alfanumerico Is Not Null) Or\n    (Em13.Valor_Data Is Not Null) Or\n    (Dv13.Valor_Data Is Not Null)\n   union All\n      Select\n    '14' As Identificador,\n    Lhs.IdLogistica_House,\n    Nr14.Valor_Alfanumerico As Numero_Li,\n    An14.Valor_Alfanumerico As Anuente_Li,\n    St14.Valor_Alfanumerico As Status_Li,\n    Dp14.Valor_Data As Data_Protocolo_Li,\n    Np14.Valor_Alfanumerico As Protocolo_Li,\n    Em14.Valor_Data As Embarque_Li,\n    Dv14.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr14 On (Nr14.IdLogistica_House = Lhs.IdLogistica_House) And (Nr14.Identificador Like '14_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An14 On (An14.IdLogistica_House = Lhs.IdLogistica_House) And (An14.Identificador Like '14_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St14 On (St14.IdLogistica_House = Lhs.IdLogistica_House) And (St14.Identificador Like '14_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp14 On (Dp14.IdLogistica_House = Lhs.IdLogistica_House) And (Dp14.Identificador Like '14_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np14 On (Np14.IdLogistica_House = Lhs.IdLogistica_House) And (Np14.Identificador Like '14_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em14 On (Em14.IdLogistica_House = Lhs.IdLogistica_House) And (Em14.Identificador Like '14_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv14 On (Dv14.IdLogistica_House = Lhs.IdLogistica_House) And (Dv14.Identificador Like '14_Vencimento')\n  Where\n    (Nr14.Valor_Alfanumerico Is Not Null) Or\n    (An14.Valor_Alfanumerico Is Not Null) Or\n    (St14.Valor_Alfanumerico Is Not Null) Or\n    (Dp14.Valor_Data Is Not Null) Or\n    (Np14.Valor_Alfanumerico Is Not Null) Or\n    (Em14.Valor_Data Is Not Null) Or\n    (Dv14.Valor_Data Is Not Null)\n   union All\n      Select\n    Lhs.IdLogistica_House,\n    '15' As Identificador,\n    Nr15.Valor_Alfanumerico As Numero_Li,\n    An15.Valor_Alfanumerico As Anuente_Li,\n    St15.Valor_Alfanumerico As Status_Li,\n    Dp15.Valor_Data As Data_Protocolo_Li,\n    Np15.Valor_Alfanumerico As Protocolo_Li,\n    Em15.Valor_Data As Embarque_Li,\n    Dv15.Valor_Data As Vencimento_Li\n  From\n    mov_Logistica_House Lhs\n  Left Outer Join\n    vis_Logistica_Campo_Livre Nr15 On (Nr15.IdLogistica_House = Lhs.IdLogistica_House) And (Nr15.Identificador Like '15_Numero')\n  Left Outer Join\n    vis_Logistica_Campo_Livre An15 On (An15.IdLogistica_House = Lhs.IdLogistica_House) And (An15.Identificador Like '15_Anuente')\n  Left Outer Join\n    vis_Logistica_Campo_Livre St15 On (St15.IdLogistica_House = Lhs.IdLogistica_House) And (St15.Identificador Like '15_Status')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dp15 On (Dp15.IdLogistica_House = Lhs.IdLogistica_House) And (Dp15.Identificador Like '15_Data_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Np15 On (Np15.IdLogistica_House = Lhs.IdLogistica_House) And (Np15.Identificador Like '15_Protocolo')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Em15 On (Em15.IdLogistica_House = Lhs.IdLogistica_House) And (Em15.Identificador Like '15_Embarque')\n  Left Outer Join\n    vis_Logistica_Campo_Livre Dv15 On (Dv15.IdLogistica_House = Lhs.IdLogistica_House) And (Dv15.Identificador Like '15_Vencimento')\n  Where\n    (Nr15.Valor_Alfanumerico Is Not Null) Or\n    (An15.Valor_Alfanumerico Is Not Null) Or\n    (St15.Valor_Alfanumerico Is Not Null) Or\n    (Dp15.Valor_Data Is Not Null) Or\n    (Np15.Valor_Alfanumerico Is Not Null) Or\n    (Em15.Valor_Data Is Not Null) Or\n    (Dv15.Valor_Data Is Not Null)) Dli on Dli.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  (Select\n    Pac.IdProjeto_Atividade,\n    Pcn.Nome,\n    Pcn.Email,\n    Pcn.Fone,\n    Rank() Over (Partition By Pac.IdProjeto_Atividade Order By Pcn.Nome) As Ranking\n  From  \n    mov_Projeto_Atividade_Contato Pac\n  Join\n    mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato And Pge.IdGrupo_Envio_Mensagem = 14  /*Contato_Principal*/\n  Join\n    cad_Pessoa_Contato Pcn on Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pac.IdProjeto_Atividade And Lhs.IdCliente /*Pega o contato do cliente*/ = Pcn.IdPessoa\n  ) Cnt On Cnt.IdProjeto_Atividade = Lhs.IdProjeto_Atividade And Cnt.Ranking = 1\nWhere\n  (Atv.IdAtividade = :IdAtividade)\nAnd\n  (Dpx.Valor_Data is Null)\" SkipWhenNoRecords=\"True\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mrc.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  case When Ltx.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n       When Ltx.Tipo_Recebimento = 2 Then ' Processo'/*Peso Cubado*/\n       When Ltx.Tipo_Recebimento = 3 Then ' Kgs'/*Peso Cubado*/\n       When Ltx.Tipo_Recebimento = 4 Then ' kgs'/*Peso Taxado*/\n       When Ltx.Tipo_Recebimento = 5 Then ' Kgs'/*Peso Bruto*/\n       When Ltx.Tipo_Recebimento = 6 Then ' m³'/*Metro Cubico*/\n       When Ltx.Tipo_Recebimento = 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n       When Ltx.Tipo_Recebimento = 8 Then 'Invoice'\n       When Ltx.Tipo_Recebimento = 9 Then 'Volume'\n       When Ltx.Tipo_Recebimento = 10 Then 'Cntr' /*Equipamento*/\n       When Ltx.Tipo_Recebimento = 11 Then Emr.Descricao\n       When Ltx.Tipo_Recebimento = 12 Then 'TEU'\n       When Ltx.Tipo_Recebimento = 13 Then ' %'/*Percentual*/\n       When Ltx.Tipo_Recebimento = 14 Then ''/*livre*/\n       When Ltx.Tipo_Recebimento = 15 Then 'Via Master'\n       When Ltx.Tipo_Recebimento = 16 Then 'Via house'\n       When Ltx.Tipo_Recebimento = 17 Then ' Kgs'/*Peso Considerado*/\n  end as Tipo_Recebimento_escrito\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Exibir_Cliente = 1\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Pcn.Nome,\n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7,\n  Ems.Campo_Livre8,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10,\n  Ems.Campo_Livre11,\n  Ems.Campo_Livre12,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<style type=\"text/css\">\nbody, td, tr { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 10.0pt; padding-left: 5px}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; text-align:justify}\n.p_instrucoes { font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 8.5pt; text-align: justify}\n.topo { text-align: center; font-size: 18px; font-weight: 600; color: #FF0000}\n.negrito { font-weight: 600;}\n.vermelho { color: #FF0000; font-weight: 600}\n.fundo { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; font-weight: 600; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; font-size: 11.0pt;}\n.tabela_taxa_titulo { color: #000000; font-weight: 600; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size: 11.0pt; border: solid;  border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.tabela_taxa { color: #000000; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size: 11.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda_todos{ border-top-style:solid; border-bottom:solid; border-right:solid; border-left:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda{ border-left: solid; border-right: solid; border-bottom: solid; border-top: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_linha {border: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.borda_cima { border-top-style: solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_baixo { border-bottom: solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita { border-right: solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda_baixo { border-left: solid; border-right: solid; border-bottom: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda { border-left: solid; border-right: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo { border-right: solid; border-bottom: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_cima { border-right: solid; border-top: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda { border-left: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima { border-left: solid; border-top: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo { border-left: solid; border-bottom: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo { border-top: solid; border-right: solid; border-left: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px }\n.borda_sem_cima { border-bottom: solid; border-right: solid; border-left: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px }\n.bordas_laterais { border: solid; border-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 0 1px 0 1px}\n</style>\n</head>\n\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Exportador_Fantasia\"> - <Print Dataset=\"Processo\" FieldName=\"Importador_Fantasia\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> x <Print Dataset=\"Processo\" FieldName=\"Destino\"> - <Print Dataset=\"Processo\" FieldName=\"Incoterm\">\n[Subject.Footer]\n\n[Report.Detail]\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <img src=\"https://i.imgur.com/Me9BbBa.png\" width=\"775\">\n  </tr>\n</table>\n<br><br>\n\n<table width=\"775\" class=\"borda_todos\" cellspacing=\"0\">\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n   <tr>\n    <td width=\"62%\" >\n      <img class=\"img_ent\" src=\"https://static.wixstatic.com/media/ec8742_195dc4d98d6149c785c14182421a5f24~mv2.png/v1/fill/w_223,h_39,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/Enterprise%20Logo_WhiteBG.png\">\n  </td>\n    <td width=\"10%\" cellspacing=\"0\">\n      Referência:<br>\n      Cliente:<br>\n      Att:<br>\n      Data:\n    </td>\n    <td width=\"28%\" cellspacing=\"0\" >\n      <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Cliente\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Contato_Principal_Cliente\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Data_Abertura_Processo\" DisplayFormat=\"DD/MM/YYYY\">\n    </td>\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n</table>\n\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr><td>Prezado, <Print Dataset=\"Processo\" FieldName=\"Contato_Principal_Cliente\"><br> </td></tr>\n  <tr><td></td></tr>\n  <tr><td>Segue abaixo a última atualização da posição do navio:</td></tr>\n  <tr><td></td></tr>\n</table>\n\n<br>\n\n<!-- CORREÇÃO AQUI: Loop adicionado para buscar todos os navios -->\n<SubReport Name=\"Carga_Processo\" Dataset=\"Transbordo_Logistica\">\n<!-- FIM DA CORREÇÃO -->\n\n<div width=\"775\">\n<p>Abaixo segue a atualização do follow up </p>\n</div>\n<table width=\"775\" cellspacing=\"0\">\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n  <tr>\n    <td colspan=\"4\">\n    <table class=\"borda_todos\" width=\"775\" cellspacing=\"0\">\n    <td width=\"15%\" class=\"borda_esquerda\"><span class=\"negrito\">MBL</span></td>\n    <td width=\"1%\">:</td>\n    <td width=\"34%\"><Print Dataset=\"Processo\" FieldName=\"Documento_Master\"></td>\n    <td width=\"15%\"><span class=\"negrito\">HBL</span></td>\n    <td width=\"1%\">:</td>\n    <td width=\"34%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Exportador</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Exportador_Fantasia\"></td>\n    <td><span class=\"negrito\">Importador</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Importador_Fantasia\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Commodity</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n    <td><span class=\"negrito\">Navio/Viagem</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Origem</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td><span class=\"negrito\">Destino</span></td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n    <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Prev. de embarque</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\"></td>\n    <td class=\"negrito\">Prev. de chegada</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\"></td>\n  </tr> \n <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Booking Number</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n    <td class=\"negrito\">Free Time Demurrage</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"FTH_Destino\"></td>\n  </tr>\n <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Armador</span></td>\n    <td>:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n    <td class=\"negrito\">Tipo Rota</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Rota\"></td>\n  </tr>\n <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Equipamento</span></td>\n    <td>:</td>\n    <td><SubReport Name=\"Carga\" Dataset=\"Carga\"></td>\n    <td class=\"negrito\">Incoterm</td>\n    <td>:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n  </tr>\n  </table><br>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"fundo\" colspan=\"2\"><span class=\"negrito\">Data</span></td>\n    <td class=\"fundo\" colspan=\"4\"><span class=\"negrito\">Descrição</span></td>\n  </tr>\n  <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n  <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n  <tr>\n    <td colspan=\"6\" class=\"borda_cima\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\"  cellspacing=\"0\" cellpadding=\"0\">\n   <tr><p>Aproveitamos para informar nosso contato no destino para a devida aplicação dos procedimentos de liberação da carga e documentos originais.</p></tr>\n</table>\n\n  <table width=\"775\" class=\"borda\" cellspacing=\"0\" cellpadding=\"0\" >\n    <tr style=\"background-color: #D9D9D9\">\n      <td colspan=\"2\" align = \"left\"><strong>Dados do representante local: </strong></td>\n    </tr>\n    <tr>\n      <td class=\"center borda_direita\" width=\"30%\"><strong>Nome: </strong> </td>\n      <td width=\"70%\"><Print Dataset=\"Processo\" FieldName=\"Nome_Rep\"></td>\n    </tr>\n     <tr>\n      <td class=\"center borda_direita\"><strong>Contato: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Contato_rep\"></td>\n    </tr>\n     <tr>\n      <td class=\"center borda_direita\"><strong>Endereço: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"End_Rep\"></td>\n    </tr>\n     <tr>\n      <td class=\"center borda_direita\"><strong>Telefone: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Fone_Rep\"></td>\n    </tr>\n    <tr>\n      <td class=\"center borda_direita\"><strong>Email: </strong></td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Email_Rep\"></td>\n    </tr>\n</table>\n <br><br><br>\n\n\n\n\n<table width=\"775\"  cellspacing=\"0\" cellpadding=\"0\">\n<tr><p>Manteremos informada em caso de eventuais alterações e estamos disponíveis para esclarecer quaisquer dúvidas.</p></tr>\n<tr><p>Agradecemos por confiar na equipe ENTERPRISE.</p></tr>\n</table>\n\n<!-- DEFINIÇÃO DO LOOP DA TABELA MOVIDA PARA O FINAL -->\n[Carga_Processo.Header]\n<table width=\"775\" class=\"borda_todos\" cellspacing=\"0\">\n  <tr class=\"fundo borda_baixo\">\n    <th width=\"22%\" colspan=\"2\"  align=\"left\"><span class=\"negrito\">Navio</span></th>\n    <th width=\"13%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Viagem</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">Origem</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">Destino</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">ETD</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">ETA</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">Transit Time</span></th>\n  </tr>\n[Carga_Processo.Detail]\n  <tr>\n    <td width=\"22%\" colspan=\"2\" align=\"left\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Navio\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Viagem_Voo\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Origem\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Destino\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"ETD\" DisplayFormat=\"DD/MM/YYYY\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"ETA\" DisplayFormat=\"DD/MM/YYYY\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Transit_Time\"> dias</td>\n      \n  </tr>\n[Carga_Processo.Footer]\n</table>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Im_06 - Confirmacao De Embarque Enterprise.html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Interna,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lhs.Data_Validade_Taxas,\n  GETDATE() as Data_Atual,\n  Vnv.Numero as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Lhs.Conhecimentos as Documento_House,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Nome_Fantasia As Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome_Fantasia as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n  End as Agente,\n  Mer.Nome as Mercadoria,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Rpr.Nome_Fantasia as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case \n    When Lhs.Tipo_Carga = 3 /*FCL*/ Then 'Fcl'\n    Else 'Outros'\n  End As Tipo_Carga,\n  CASE\n    WHEN Lhs.Modalidade_Pagamento = 1 THEN 'HBL CC/PP'\n    WHEN Lhs.Modalidade_Pagamento = 2 THEN 'HBL CC'\n    WHEN Lhs.Modalidade_Pagamento = 3 THEN 'HBL PP'\n    WHEN Lhs.Modalidade_Pagamento = 4 THEN 'HBL PPA'\n    ELSE ''\n  END Modalidade_Pagamento_HBL,\n  CASE\n    WHEN Lms.Modalidade_Pagamento = 1 THEN 'MBL CC/PP'\n    WHEN Lms.Modalidade_Pagamento = 2 THEN 'MBL CC'\n    WHEN Lms.Modalidade_Pagamento = 3 THEN 'MBL PP'\n    WHEN Lms.Modalidade_Pagamento = 4 THEN 'MBL PPA'  \n    ELSE ''\n  END Modalidade_Pagamento_MBL,\n  Lms.Transit_Time,\n  Lms.Transit_Time_Maximo,\n  Cnt.Nome As Contato_Principal_Cliente,\n  case\n    When Lhs.Tipo_carga = 3 Then 'FCL_Texto'\n    Else 'Outros_Texto'\n  End As Tipo_Carga_Escrito_Texto,\n  case\n    When Lhs.Tipo_carga = 3 Then 'Fcl'\n    Else 'Outros'\n  End As Tipo_Carga_Escrito,\n  Cto.Nome as Contato\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  (Select\n    RANK() OVER(PARTITION BY IdPessoa ORDER BY IdPessoa_Contato) Ranking,\n    Pcn.IdPessoa_Contato,\n    Pcn.IdPessoa,\n    Pcn.Nome\n  From  \n    cad_Pessoa_Contato Pcn\n  ) Cto On Cto.IdPessoa = Cln.IdPessoa and Cto.Ranking = 1\nLeft Outer Join\n  (Select\n    Pac.IdProjeto_Atividade,\n    Pcn.Nome,\n    Pcn.Email,\n    Pcn.Fone,\n    Rank() Over (Partition By Pac.IdProjeto_Atividade Order By Pcn.Nome) As Ranking\n  From  \n    mov_Projeto_Atividade_Contato Pac\n  Join\n    mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato And Pge.IdGrupo_Envio_Mensagem = 14 /*Contato_Principal*/\n  Join\n    cad_Pessoa_Contato Pcn on Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Pac.IdProjeto_Atividade And Lhs.IdCliente/*Pega o contato do cliente*/ = Pcn.IdPessoa\n  ) Cnt On Cnt.IdProjeto_Atividade = Lhs.IdProjeto_Atividade And Cnt.Ranking = 1\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  case\n    When Lhs.Tipo_Carga = 3 Then Eqm.Descricao\n    Else 'LCL'\n  End as Ue,\n  Lmc.Type_Packages\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Transbordo_Logistica\" Sql=\"SELECT \n\tLhs.IdLogistica_House,\n\tLvg.IdLogistica_Viagem,\n\tNvi.Nome AS Navio,\n\tLvg.Numero_Controle AS Reserva,\n\tLvg.Viagem_Voo,\n\tOrg.Nome AS Origem,\n\tDst.Nome AS Destino,\n\tCoalesce(Lvg.Data_Previsao_DesEmbarque,Lvg.Data_Desembarque) as ETA,\n        Case When Lvg.Data_Embarque is null then Coalesce(Lvg.Data_Previsao_Embarque,Lvg.Data_Embarque) else Lvg.Data_Embarque End as ETD,\n\tDATEDIFF(dd,Lvg.Data_Previsao_Embarque, Lvg.Data_Previsao_Desembarque) AS Transit_Time\nFROM\n\tmov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tmov_Logistica_Viagem Lvg ON Lvg.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lvg.IdOrigem\nLEFT OUTER JOIN\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lvg.IdDestino\nJOIN\n  cad_Navio Nvi on Nvi.IdNavio = Lvg.IdNavio\nWhere\n  Atv.IdAtividade =:IdAtividade\">\n\n\n<DataSet Name=\"Total_TT\" Sql=\"SELECT\n\tLhs.IdLogistica_House,\n\tSUM(DATEDIFF(dd,Lvg.Data_Previsao_Embarque, Lvg.Data_Previsao_Desembarque)) AS Total_Transit_Time\nFROM\n\tmov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tmov_Logistica_Viagem Lvg ON Lvg.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lvg.IdOrigem\nLEFT OUTER JOIN\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lvg.IdDestino\nLEFT OUTER JOIN\n  cad_Navio Nvi on Nvi.IdNavio = Lvg.IdNavio\nWhere\n  Atv.IdAtividade =:IdAtividade\nGROUP BY\n\tLhs.IdLogistica_House\">\n\n\n<DataSet Name=\"Transbordo_Logistica_OLD\" Sql=\"DECLARE @IdAtividade as INT\nSET @IdAtividade = :IdAtividade\nSelect \n  Lhs.IdLogistica_House,\n  Lmm.Viagem_Navio as Viagem,\n  Org.Nome as Origem,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Maritima_Transbordo FROM mov_Logistica_Maritima_Transbordo WHERE IdLogistica_Master = Lms.IdLogistica_Master) THEN Lmt.Origem_Transbordo\n  ELSE Dest.Nome\n  END as Destino,\n  Nvi.Nome as Navio,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Maritima_Transbordo FROM mov_Logistica_Maritima_Transbordo WHERE IdLogistica_Master = Lms.IdLogistica_Master) THEN Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Chegada)\n  ELSE Lms.Data_Previsao_Desembarque\n  END as ETA,   \n  Lms.Data_Embarque as ETD,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Maritima_Transbordo FROM mov_Logistica_Maritima_Transbordo WHERE IdLogistica_Master = Lms.IdLogistica_Master) THEN DATEDIFF(dd,Lms.Data_Previsao_Embarque,Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Chegada))\n  ELSE Lms.Transit_Time\n  END as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  (SELECT\n  IdLogistica_Maritima_Transbordo,\n  IdLogistica_Master,\n  Data_Previsao_Chegada,\n  Data_Chegada,\n  Ptr.Nome as Origem_Transbordo,\n  Rank() Over (Partition By IdLogistica_Master Order By IdLogistica_Maritima_Transbordo Asc) As Ranking\n  FROM \n  mov_Logistica_Maritima_Transbordo Lmtb\n  Left Outer Join\n  cad_Origem_Destino Ptr ON Ptr.IdOrigem_Destino = Lmtb.IdPorto_Transbordo) Lmt on Lmt.IdLogistica_Master = Lms.IdLogistica_Master AND Lmt.Ranking = 1\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dest on Dest.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmm.IdNavio IS NOT NULL\nUNION ALL\nSelect \n  Lhs.IdLogistica_House,\n  Lmt.Viagem,\n  Ptr.Nome as Origem,\n  Pds.Nome as Destino,\n  'TRANSBORDO - '+Nvi.Nome as Navio,\n  Coalesce(Lmt.Data_Previsao_Desembarque,Lmt.Data_Desembarque) as ETA,\n  Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Previsao_Embarque) as ETD,\n  DATEDIFF(dd,Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Previsao_Embarque),Coalesce(Lmt.Data_Previsao_Desembarque,Lmt.Data_Desembarque)) as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt on Lmt.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\n  cad_Origem_Destino Pds on Pds.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmt.IdLogistica_Maritima_Transbordo IS NOT NULL\">\n\n<DataSet Name=\"Transbordo_Logistica_1\" Sql=\"DECLARE @IdAtividade as INT\nSET @IdAtividade = :IdAtividade\nSelect \n  Lhs.IdLogistica_House,\n  Lmm.Viagem_Navio as Viagem,\n  Org.Nome as Origem,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Viagem FROM mov_Logistica_Viagem WHERE Tipo_Viagem = 5 /*Transbordo*/ and IdLogistica_Viagem = Lhs.IdLogistica_House) THEN Lmt.Origem_Transbordo\n  ELSE Dest.Nome\n  END as Destino,\n  Nvi.Nome as Navio,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Viagem FROM mov_Logistica_Viagem WHERE Tipo_Viagem = 5 /*Transbordo*/ and IdLogistica_Viagem = Lhs.IdLogistica_House) THEN Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Chegada)\n  ELSE Lms.Data_Previsao_Desembarque\n  END as ETA,   \n  Lms.Data_Previsao_Embarque as ETD,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Viagem FROM mov_Logistica_Viagem WHERE Tipo_Viagem = 5 /*Transbordo*/ and IdLogistica_Viagem = Lhs.IdLogistica_House) THEN DATEDIFF(dd,Lms.Data_Previsao_Embarque,Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Chegada))\n  ELSE Lms.Transit_Time\n  END as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  (SELECT\n  Lmtb.IdLogistica_Viagem,\n  Lmtb.IdLogistica_House,\n  Van.Data_Previsao_Desembarque AS Data_Previsao_Chegada,\n    Van.Data_Desembarque AS Data_Chegada,\n  Ptr.Nome as Origem_Transbordo,\n  Rank() Over (Partition By Lmtb.IdLogistica_House Order By Lmtb.Data_Desembarque Desc)As Ranking\n  FROM \n  mov_Logistica_Viagem Lmtb\n  LEFT OUTER JOIN \n  mov_Logistica_Viagem Van on Van.IdLogistica_House = Lmtb.IdLogistica_House AND Van.Sequencia = Lmtb.Sequencia - 1\n  Left Outer Join\n  cad_Origem_Destino Ptr ON Ptr.IdOrigem_Destino = Lmtb.IdOrigem) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House AND Lmt.Ranking = 1\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dest on Dest.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmm.IdNavio IS NOT NULL\nUNION ALL\nSelect \n  Lhs.IdLogistica_House,\n  Lmt.Viagem_Voo as Viagem,\n  Ptr.Nome as Origem,\n  Pds.Nome as Destino,\n  'TRANSBORDO - '+Nvi.Nome as Navio,\n  Coalesce(Lmt.Data_Previsao_Desembarque,Lmt.Data_Desembarque) as ETA,\n  Coalesce(Van.Data_Previsao_Desembarque,Lmt.Data_Previsao_Embarque) as ETD,\n  DATEDIFF(dd,Coalesce(Van.Data_Previsao_Desembarque,Lmt.Data_Previsao_Embarque),Coalesce(Lmt.Data_Previsao_Desembarque,Lmt.Data_Desembarque)) as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Viagem Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House and Lmt.Tipo_Viagem = 5\nLEFT OUTER JOIN \n  mov_Logistica_Viagem Van on Van.IdLogistica_House = Lmt.IdLogistica_House AND Van.Sequencia = Lmt.Sequencia - 1\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Pds on Pds.IdOrigem_Destino = Lmt.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmt.IdLogistica_Viagem IS NOT NULL\">\n\n<DataSet Name=\"Total_TT_OLD\" Sql=\"DECLARE @IdAtividade as INT\nSET @IdAtividade = :IdAtividade\n\nSELECT SUM(Transit_Time) as Total_Transit_Time FROM(\nSelect \n  Lhs.IdLogistica_House,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Maritima_Transbordo FROM mov_Logistica_Maritima_Transbordo WHERE IdLogistica_Master = Lms.IdLogistica_Master) THEN DATEDIFF(dd,Lms.Data_Previsao_Embarque,Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Chegada))\n  ELSE Lms.Transit_Time\n  END as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  (SELECT\n  IdLogistica_Master,\n  Data_Previsao_Chegada,\n  Data_Chegada,\n  Rank() Over (Partition By IdLogistica_Master Order By IdLogistica_Maritima_Transbordo Asc) As Ranking\n  FROM \n  mov_Logistica_Maritima_Transbordo) Lmt on Lmt.IdLogistica_Master = Lms.IdLogistica_Master AND Lmt.Ranking = 1\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmm.IdNavio IS NOT NULL\nUNION ALL\nSelect \n  Lhs.IdLogistica_House,\n  SUM(DATEDIFF(dd,Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Previsao_Embarque),Coalesce(Lmt.Data_Previsao_Desembarque,Lmt.Data_Desembarque))) as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt on Lmt.IdLogistica_Master = Lms.IdLogistica_Master\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmt.IdLogistica_Maritima_Transbordo IS NOT NULL\nGROUP BY Lhs.IdLogistica_House\n) as Total_Transit\">\n\n<DataSet Name=\"Total_TT_1\" Sql=\"DECLARE @IdAtividade as INT\nSET @IdAtividade = :IdAtividade\n\nSELECT SUM(Transit_Time) as Total_Transit_Time FROM(\nSelect \n  Lhs.IdLogistica_House,\n  CASE\n  WHEN EXISTS(SELECT IdLogistica_Viagem FROM mov_Logistica_Viagem WHERE Tipo_Viagem = 5 /*Transbordo*/ and IdLogistica_Viagem = Lhs.IdLogistica_House) THEN DATEDIFF(dd,Lms.Data_Previsao_Embarque,Coalesce(Lmt.Data_Previsao_Chegada,Lmt.Data_Chegada))\n  ELSE Lms.Transit_Time\n  END as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  (SELECT\n  Lmt.IdLogistica_House,\n  Van.Data_Previsao_Desembarque AS Data_Previsao_Chegada,\n  Van.Data_Desembarque AS Data_Chegada,\n  Rank() Over (Partition By Lmt.IdLogistica_House Order By Lmt.Data_Desembarque Desc)As Ranking\n  FROM \n  mov_Logistica_Viagem Lmt\n  LEFT OUTER JOIN \n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lmt.IdLogistica_House AND Van.Sequencia = Lmt.Sequencia - 1) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House AND Lmt.Ranking = 1\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmm.IdNavio IS NOT NULL\nUNION ALL\nSelect \n  Lhs.IdLogistica_House,\n  SUM(DATEDIFF(dd,Coalesce(Van.Data_Previsao_Desembarque,Lmt.Data_Previsao_Embarque),Coalesce(Lmt.Data_Previsao_Desembarque,Lmt.Data_Desembarque))) as Transit_Time\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Viagem Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House and Lmt.Tipo_Viagem = 5 /*Transbordo*/\nLeft Outer Join\n  mov_Logistica_Viagem Van on Van.IdLogistica_House = Lmt.IdLogistica_House AND Van.Sequencia = Lmt.Sequencia - 1\nWhere\n  Atv.IdAtividade = @IdAtividade AND Lmt.IdLogistica_Viagem IS NOT NULL\nGROUP BY Lhs.IdLogistica_House\n) as Total_Transit\">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr,\n  Eqp.Qtd_Ctnr,\n  Ltx.Valor_Recebimento_Unitario,\n  Moe.Sigla as Moeda_Recebimento_Carga\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nLEFT OUTER JOIN\n  (SELECT IdLogistica_House,SUM(Quantidade) AS Qtd_Ctnr  \n    FROM mov_Logistica_Maritima_Equipamento Eqp GROUP BY IdLogistica_House) AS Eqp ON Eqp.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  mov_Logistica_Taxa Ltx ON Ltx.IdLogistica_House = Lme.IdLogistica_House AND Ltx.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nLEFT OUTER JOIN\n  cad_Taxa_Logistica_Exibicao Tle ON Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLEFT OUTER JOIN\n  cad_Taxa_Logistica Tlo ON Tlo.IdTaxa_Logistica = Tle.IdTaxa_Logistica AND Tlo.Tipo = 1\nLEFT OUTER JOIN\n  cad_Moeda Moe ON Moe.IdMoeda = Ltx.IdMoeda_Recebimento\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n  <DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email,\n  Atv.IdProjeto_Atividade\nFrom\n  mov_Atividade Atv\nLEFT OUTER JOIN\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLEFT OUTER JOIN\n  mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  cad_Pessoa Psa ON Psa.IdPessoa = Lhs.IdCliente\nLEFT OUTER JOIN\n  cad_Pessoa_Contato Pcn on Pcn.IdPessoa = Psa.IdPessoa\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nLEFT OUTER JOIN\n  cad_Contato_Grupo_Envio Cge ON Cge.IdPessoa_Contato = Pcn.IdPessoa_Contato\nWhere\n  Mmn.IdGrupo_Envio_Mensagem = Cge.IdGrupo_Envio_Mensagem\nAND\n  Atv.IdAtividade = :IdAtividade\">\n\n  <DataSet Name=\"Contato_Responsavel\" Sql=\"Select \n    Pss.Email,\n    Atv.IdProjeto_Atividade,\n    Pss.IdPessoa\nFrom\n    mov_Atividade Atv\nJoin\n    cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n    mov_Projeto_Atividade_Responsavel Par on Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n    cad_Pessoa Pss on Pss.IdPessoa = Par.IdResponsavel\nAnd\n    (NullIf(LTrim(Pss.Email), '') Is Not Null)\nWhere\n    Atv.IdAtividade = :IdAtividade AND Par.IdPapel_Projeto = 2\">\n\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<title>Confirmacao de Embarque</title>\n</head>\n\n<style type=\"text/css\">\nbody,td,tr{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:11.0pt; text-align:justify}\n.font_10{font-size:10.0pt;}\n.topo{ text-align:center; font-size:18px; font-weight:600; color:#FF0000}\n.negrito{ font-weight:600;}\n.vermelho{ color:#FF0000; font-weight:600;}\n.fundo{ color:#000000; font-weight:600; background:#D9D9D9; font-size:11.0pt;}\n.fundo_campos{ color:#000000; font-weight:600; background:#D9D9D9; font-size:10.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda_linha {border:solid; border-color: #BFBFBF #BFBFBF #BFBFBF #BFBFBF; border-width: 8px 1px 0px 1px;}\n.borda_cima{ border-top-style:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_baixo{ border-bottom:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_direita{ border-right:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_todos{ border-top-style:solid; border-bottom:solid; border-right:solid; border-left:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_direita_cima{ border-right:solid; border-top:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_esquerda{ border-left:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#BFBFBF; border-width: 1px 1px 1px 1px}\n.sem_borda{border-width: 0px;}\nimg {vertical-align: middle; }\n</style>\n\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n[CC.Detail]\n<Print Dataset=\"Contato_Responsavel\" FieldName=\"Email\">\n\n[Subject.Header]\n<Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Exportador\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> x <Print Dataset=\"Processo\" FieldName=\"Destino\"> - <Print Dataset=\"Processo\" FieldName=\"Incoterm\">\n[Subject.Footer]\n[Report.Detail]\n<table width=\"775\" cellspacing=\"0\">\n  <tr>\n      <img src=\"https://i.imgur.com/nzElexr.png\">\n  </tr>\n</table><br>\n\n<table class=\"borda_todos\" width=\"775\" cellspacing=\"0\">\n<tr><td colspan=\"4\">&nbsp;</td></tr>\n  <tr>\n    <td width=\"62%\" >\n      <img class=\"img_ent\" src=\"https://static.wixstatic.com/media/ec8742_195dc4d98d6149c785c14182421a5f24~mv2.png/v1/fill/w_223,h_39,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/Enterprise%20Logo_WhiteBG.png\">\n  </td>\n    <td width=\"10%\" cellspacing=\"0\" >\n      Referência:<br>\n      Cliente:<br>\n      Att:<br>\n      Data:\n    </td>\n    <td width=\"28%\" cellspacing=\"0\" >\n      <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Cliente_Fantasia\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Contato_Principal_Cliente\"><br>\n      <Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"DD/MM/YYYY\">\n    </td></tr>\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\">\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n  <tr>\n    <td colspan=\"4\">\n      <p>Prezado (a) <Print Dataset=\"Processo\" FieldName=\"Contato\">, <br><br>\n      Gentileza notar confirmação para esse embarque. Cópia do BL original será enviada assim que emitido pelo Armador.</p>\n    </td>\n  </tr>\n</table><br>\n\n\n\n\n<table class=\"borda_todos\" width=\"775\" cellspacing=\"0\">\n  <tr>\n    <td width=\"12%\" colspan=\"1\" valign=\"top\">\n      <b>S/Referência:</b>&nbsp;<br>\n      <span class=\"fundo_campos\"><b>Master BL:</b></span>&nbsp;<br>\n      <b>Shipper:</b>&nbsp;\n    </td>\n    <td width=\"38%\" colspan=\"1\" valign=\"top\">\n      <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"><br>\n      <span class=\"fundo_campos\"><Print Dataset=\"Processo\" FieldName=\"Documento_Master\"></span><br>\n      &nbsp;\n    </td>  \n    <td width=\"18%\" colspan=\"1\" valign=\"top\">\n      <b>Modalidade de Frete:</b>&nbsp;<br>\n      <span class=\"fundo_campos\"><b>House BL:</b></span>&nbsp;<br>\n      <b>Consignee:</b>&nbsp;      \n    </td>\n    <td width=\"32%\" colspan=\"1\" valign=\"top\">\n      <Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_HBL\"><br>\n      <span class=\"fundo_campos\"><Print Dataset=\"Processo\" FieldName=\"Documento_House\"></span><br>\n         \n    </td>\n  </tr>\n  <tr>\n    <td colspan=\"2\" valign=\"top\">\n      <Print Dataset=\"Processo\" FieldName=\"Exportador_Correspondencia\">\n    </td>\n    <td colspan=\"2\" valign=\"top\">\n      <Print Dataset=\"Processo\" FieldName=\"Importador_Correspondencia\">\n</td>\n</tr>\n<tr>\n    <td colspan=\"2\" valign=\"top\">\n      <b>Commodity:</b>&nbsp; <Print Dataset=\"Processo\" FieldName=\"Mercadoria\">\n    </td> \n    <td colspan=\"2\" valign=\"top\">\n      <b>Equipment:</b>&nbsp;<SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga\">\n    </td>\n  </tr>  \n</table><br>\n\n\n\n\n\n<SubReport Name=\"Carga_Processo\" Dataset=\"Transbordo_Logistica\">\n<SubReport Name=\"Total_TT\" Dataset=\"Total_TT\">\n&nbsp;\n<SubReport Name=\"Equipamentos_Processo\" Dataset=\"Container\">\n&nbsp;\n<table width=\"775\" class=\"borda_todos\" cellspacing=\"0\">\n  <tr>\n      <th colspan=\"4\" class=\"fundo borda_baixo\" align=\"left\"><span class=\"negrito\">Informações Relevantes:</span></th>\n  </tr>\n  <tr>\n      <td colspan=\"4\">\n        <p class=\"font_10\">Os dados sobre navios e previsões de chegada podem sofrer alterações sem aviso prévio. Para garantir maior precisão e segurança no planejamento de suas operações, solicitamos que confirme essas informações junto ao nossos operadores e escritório nos respectivos portos de descarga.<br><br>\n        <subReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Escrito_Texto\" DataSet=\"Processo\"></p>\n      </td>\n  </tr>\n  <tr><td colspan=\"4\">&nbsp;</td></tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\">\n  <tr>\n    <td colspan=\"4\">\n      <signature>\n    </td>\n  </tr>\n</table>\n\n[FCL_Texto.Detail]\n<b>Redestinação de Container:</b> A solicitação deverá ser feita por escrito e 72 horas antes da atracação do navio.<br><br>\n<b>Estadia de Container:</b> Expirado o prazo estipulado para livre utilização do container, será aplicado taxa diária (demurrage/detention) em vigor de acordo com a proposta comercial aprovada.\n\n[Outros_Texto.Detail]\n\n\n[Carga_Processo.Header]\n<table width=\"775\" class=\"borda_todos\" cellspacing=\"0\">\n  <tr class=\"fundo borda_baixo\">\n    <th width=\"22%\" colspan=\"2\"  align=\"left\"><span class=\"negrito\">Navio</span></th>\n    <th width=\"13%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Viagem</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">Origem</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">Destino</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">ETD</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">ETA</span></th>\n    <th colspan=\"1\"  align=\"center\"><span class=\"negrito\">Transit Time</span></th>\n  </tr>\n[Carga_Processo.Detail]\n  <tr>\n    <td width=\"22%\" colspan=\"2\" align=\"left\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Navio\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Viagem_Voo\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Origem\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Destino\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"ETD\" DisplayFormat=\"DD/MM/YYYY\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"ETA\" DisplayFormat=\"DD/MM/YYYY\"></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Transbordo_Logistica\" FieldName=\"Transit_Time\"> dias</td>\n  </tr>\n[Carga_Processo.Footer]\n</table>\n\n[Equipamentos_Processo.Header]\n<table width=\"775\" class=\"borda_todos\" cellspacing=\"0\">\n  <tr class=\"fundo borda_baixo\">\n    <th width=\"25%\" colspan=\"2\"  align=\"left\"><span class=\"negrito\">Equipamento</span></th>\n    <th width=\"15%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Nº Container</span></th>\n    <th width=\"15%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Conteúdo</span></th>\n    <th width=\"15%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Peso Bruto</span></th>\n    <th width=\"15%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Peso Líquido</span></th>\n    <th width=\"15%\" colspan=\"1\"  align=\"center\"><span class=\"negrito\">Cubagem</span></th>\n  </tr>\n[Equipamentos_Processo.Detail]\n  <tr>\n    <td width=\"25%\" colspan=\"2\" align=\"left\"><Print Dataset=\"Container\" FieldName=\"Ue\"></td>\n    <td width=\"15%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Container\" FieldName=\"Cntr\"></td>\n    <td width=\"15%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Container\" FieldName=\"Type_Packages\"></td>\n    <td width=\"15%\" colspan=\"1\" align=\"right\"><Print Dataset=\"Container\" FieldName=\"Gross_Weight\" DisplayFormat=\",0.00\"></td>\n    <td width=\"15%\" colspan=\"1\" align=\"right\"><Print Dataset=\"Container\" FieldName=\"Net_Weight\" DisplayFormat=\",0.00\"></td>\n    <td width=\"15%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Container\" FieldName=\"Measurement\" DisplayFormat=\",0.000\"></td>\n  </tr>\n[Equipamentos_Processo.Footer]\n</table>\n\n[Total_TT.Header]\n<table width=\"775\" cellspacing=\"0\">\n[Total_TT.Detail]\n  <tr class=\"sem_borda\">\n    <td width=\"13%\" colspan=\"1\" align=\"left\">&nbsp;</td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\">&nbsp;</td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\">&nbsp;</td>\n    <td width=\"11%\" colspan=\"1\" align=\"center\">&nbsp;</td>\n    <td width=\"11%\" colspan=\"1\" align=\"center\">&nbsp;</td>\n    <td width=\"26%\" colspan=\"2\" align=\"center\"><b>Previsão de Transit Time Total:</b></td>\n    <td width=\"13%\" colspan=\"1\" align=\"center\"><Print Dataset=\"Total_TT\" FieldName=\"Total_Transit_Time\"> dias</td>\n  </tr>\n[Total_TT.Footer]\n</table>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\MENSAGEM - Aviso de abertura de processo - #45130 bkp.sql",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lms.Data_Processo,\n  Coalesce(Lmm.Viagem_Navio,Vnv.Numero) as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Nome_Fantasia AS Cliente_Fantasia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Nome_Fantasia As Shipper_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Nome_fantasia As Consignee_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Lrc.Nome as Local_Recebimento,\n  Ctr.Nome_Fantasia as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente no destino*/\n  End as Agente,\n  UPPER(Case\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 1 Then 'Exportação Aérea'\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 2 Then 'Exportação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 1 Then 'Importação Aérea'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 2 Then 'Importação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 3 Then 'Importação Terrestre'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 1 Then 'Nacional Aérea'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 2 Then 'Nacional Marítima'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 3 Then 'Nacional Terrestre'\n  End) as Modal,\n  Mer.Nome as Mercadoria,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Inc.Nome as Codigo_Incoterm,\n  Lhs.Observacao,\n  Vnd.Nome_Fantasia as Vendedor,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Lhs.Instrucoes_Operacional,\n  Des.Nome_Fantasia as Despachante,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Lhs.Valor_Mercadoria,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Lhs.Instrucoes_Operacional_Cliente,\n  Ofr.Numero_Oferta,\n  Pfr.Data_Aprovacao As Data_Aprovacao,\n  Mpr.Sigla As Moeda_Processo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Profits\" Sql=\"\nSelect\n  Lhs.IdLogistica_House,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Valor) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Total,  \n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST((SUM(Txs.Valor) - SUM(Txs.Agent))as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Enterprise,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Agent) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Agente\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nWHERE \n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas_Frete\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico \nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 1 /*Frete*/\nAnd\n  Ltx.Exibir_Cliente = 1\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas_Origem\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico \nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 2 /*Origem*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas_Destino\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico \nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 3 /*Destino*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n \n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Rsp.EMail\nFrom \n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd  \n  Par.IdPapel_Projeto in (2)\">\n\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<title>Aviso Abertura de Processo</title>\n</head>\n<style type=\"text/css\">\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7,\n  Ems.Campo_Livre8,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10,\n  Ems.Campo_Livre11,\n  Ems.Campo_Livre12,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\nbody,td,tr{ color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; text-align:justify}\n.p_instrucoes{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:8.5pt; text-align:justify}\n.destaque{font-size:18px; font-weight:600;}\n.topo{ text-align:center; font-size:18px; font-weight:600; color:#FF0000}\n.negrito{ font-weight:600;}\n.vermelho{ color:#FF0000; font-weight:600;}\n.fundo{ color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; font-weight:600; background:#D9D9D9; font-size:11.0pt;}\n.tabela_taxa_titulo{ color:#000000; font-weight:600; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size:11.0pt; border:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.tabela_taxa{ color:#000000; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size:11.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda{ border-left:solid; border-right:solid; border-bottom:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_linha {border:solid; border-color:#D9D9D9 #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo{max-height: 1px; border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_cima_serrilhado{ border-top:dotted; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n</head>\n<align=\"left\" table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n   <tr>\n     <td><img src=\"https://i.imgur.com/p6bRXuN.png\" width=\"775\"></td>\n   </tr>\n</table>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> | <Print Dataset=\"Processo\" FieldName=\"Shipper_Fantasia\"> x <Print Dataset=\"Processo\" FieldName=\"Consignee_Fantasia\"> | <Print Dataset=\"Processo\" FieldName=\"Origem\"> X <Print Dataset=\"Processo\" FieldName=\"Destino\"> | <Print Dataset=\"Processo\" FieldName=\"Codigo_Incoterm\"> / <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\">\n[Subject.Footer]\n[Report.Detail]\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n   <td align=\"left\" colspan=\"3\" valign=\"middle\"><br><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"><br>\n        <br></td> \n   <td valign=\"top\" colspan=\"3\"><br><span class=\"destaque\">INSTRUÇÃO DE ABERTURA DE PROCESSO</span>\n          <br>\n          <span class=\"negrito\">Agente:</span> <Print Dataset=\"Processo\" FieldName=\"Agente\">\n   </td>\n  </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr><td class=\"fundo borda\" colspan=\"2\" align=\"center\">COMMERCIAL DETAILS</td><tr>\n  <tr>\n    <td class=\"borda_direita_esquerda\" width=\"18%\"><span class=\"negrito\">Vendedor</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Vendedor\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_direita_esquerda\"><span class=\"negrito\">Proposta</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_direita_esquerda\"><span class=\"negrito\">Data de Aprovação</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Data_Aprovacao\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_direita_esquerda\"><span class=\"negrito\">Modalidade</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modal\"></td>\n  </tr>  \n  <tr>\n    <td class=\"borda_direita_esquerda\"><span class=\"negrito\">Cliente</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Cliente_Fantasia\"></td>\n  </tr>  \n  <tr>\n    <td class=\"borda_direita_esquerda\"><span class=\"negrito\">Exportador</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Shipper_Fantasia\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_direita_esquerda\"><span class=\"negrito\">Despachante</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Despachante\"></td>\n  </tr>\n  <tr><td class=\"borda_cima\" colspan=\"2\"></td></tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr><td class=\"fundo borda\" colspan=\"4\" align=\"center\">SHIPMENT DETAILS</td><tr>\n  <tr>\n    <td class=\"borda_esquerda\" width=\"18%\"><span class=\"negrito\">Incoterm</span></td>\n    <td width=\"32%\"><Print Dataset=\"Processo\" FieldName=\"codigo_Incoterm\"></td>\n    <td width=\"18%\"><span class=\"negrito\">Freight Type</span></td>\n    <td class=\"borda_direita\" width=\"32%\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_Master\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Origin</span></td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td><span class=\"negrito\">Destination</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>  \n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">PO #</span></td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n    <td><span class=\"negrito\">Currency</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Moeda_Processo\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Pick Up Adress</span></td>\n    <td class=\"borda_direita\" colspan=\"3\"><Print Dataset=\"Processo\" FieldName=\"Local_Coleta\"></td>\n  </tr>\n  <tr><td class=\"borda_cima\" colspan=\"4\"></td></tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"borda_esquerda_cima\" width=\"18%\"><span class=\"negrito\">Shipping Line</span></td>\n    <td width=\"32%\" class=\"borda_cima\"><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n    <td width=\"18%\" class=\"borda_cima\"><span class=\"negrito\">Commodity</span></td>\n    <td class=\"borda_direita_cima\" width=\"32%\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Equipamento</span></td>\n    <td><SubReport Name=\"Carga\" DataSet=\"Carga\"></td>\n    <td><span class=\"negrito\">Package</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>  \n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Gross Weight</span></td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.000 kg\"></td>\n    <td><span class=\"negrito\">CBM</span></td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.000\"></td>\n  </tr>\n  <tr>\n    <td class=\"borda_esquerda\"><span class=\"negrito\">Remarks</span></td>\n    <td class=\"borda_direita\" colspan=\"3\"><Print Dataset=\"Processo\" FieldName=\"Observacao\"></td>\n  </tr>\n  <tr><td class=\"borda_cima\" colspan=\"4\"></td></tr>\n</table>\n\n<SubReport Name=\"Frete_Internacional\" Dataset=\"Taxas_Frete\">\n<SubReport Name=\"Taxas_Origem\" Dataset=\"Taxas_Origem\">\n<SubReport Name=\"Taxas_Destino\" Dataset=\"Taxas_Destino\">\n\n<table width=\"775\" cellspacing=\"0\">\n  <tr>\n    <td colspan=\"6\" class=\"fundo borda\" align=\"center\">Handling and Special Instructions</td>\n  </tr>\n  <tr>\n    <td colspan=\"6\" class=\"borda_direita_esquerda\"><print DataSet=\"Processo\" FieldName=\"Instrucoes_Cliente\"></td>\n  </tr>\n  <tr>\n    <td colspan=\"6\" class=\"borda_cima\"></td>\n  </tr>\n  <tr>\n    <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Frete_Internacional.Header]\n<table width=\"775\" cellspacing=\"0\" cellpading=\"0\">\n  <tr class=\"fundo\">\n    <td class=\"borda_esquerda_cima\"></td>\n    <td class=\"borda_cima\"></td>\n    <td class=\"borda_cima\"></td>\n    <td class=\"borda_cima\" ></td>\n    <td class=\"borda_esquerda_cima\" colspan=\"3\" align=\"center\">Buying Rate</td>\n    <td class=\"borda_sem_baixo\" colspan=\"3\" align=\"center\">Selling Rate</td>\n  </tr>\n  <tr class=\"fundo\">\n    <td width=\"18%\" align=\"left\" class=\"borda_esquerda\">Taxas</td>\n    <td width=\"8%\" align=\"center\">Tipo</td>\n    <td width=\"8%\" align=\"center\">Qtd</td>\n    <td width=\"8%\" align=\"center\">Unit</td>\n    <td width=\"10%\" align=\"center\" class=\"borda_esquerda\">Unit</td>\n    <td width=\"11%\" align=\"center\">Total</td>\n    <td width=\"8%\" align=\"center\"></td>\n    <td width=\"10%\" align=\"center\" class=\"borda_esquerda\">Unit</td>\n    <td width=\"11%\" align=\"center\">Total</td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita\"></td>\n  </tr>\n[Frete_Internacional.Detail]\n  <tr>\n    <td align=\"left\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Taxa_Internacional\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Origem_Taxa\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Quantidade_Recebimento\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Tipo_Unico\"></td>\n    <td align=\"right\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"right\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Moeda_Pagamento\"></td>\n    <td align=\"right\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"right\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"center\" class=\"borda_direita\"><Print Dataset=\"Taxas_Frete\" FieldName=\"Moeda_Recebimento\"></td>  \n  </tr>\n[Frete_Internacional.Footer]\n\n[Taxas_Origem.Header]\n  <tr>\n    <td colspan=\"10\" class=\"borda_cima_serrilhado\"><img src=\"https://imgur.com/IOvoKmT.png\"></td>\n  </tr>\n[Taxas_Origem.Detail]\n  <tr>\n    <td align=\"left\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Taxa_Internacional\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Origem_Taxa\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Quantidade_Recebimento\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Tipo_Unico\"></td>\n    <td align=\"right\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"right\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Moeda_Pagamento\"></td>\n    <td align=\"right\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"right\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"center\" class=\"borda_direita\"><Print Dataset=\"Taxas_Origem\" FieldName=\"Moeda_Recebimento\"></td>  \n  </tr>\n[Taxas_Origem.Footer]\n\n[Taxas_Destino.Header]\n  <tr>\n    <td colspan=\"10\" class=\"borda_cima_serrilhado\"><img src=\"https://imgur.com/IOvoKmT.png\"></td>\n  </tr>\n[Taxas_Destino.Detail]\n  <tr>\n    <td align=\"left\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Taxa_Internacional\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Origem_Taxa\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Quantidade_Recebimento\"></td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Tipo_Unico\"></td>\n    <td align=\"right\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"right\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"center\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Moeda_Pagamento\"></td>\n    <td align=\"right\" class=\"borda_esquerda\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"right\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">&nbsp;&nbsp;</td>\n    <td align=\"center\" class=\"borda_direita\"><Print Dataset=\"Taxas_Destino\" FieldName=\"Moeda_Recebimento\"></td>\n  </tr>\n[Taxas_Destino.Footer]\n  <tr>\n    <td colspan=\"10\" class=\"borda_cima\"></td>\n  </tr>\n</table>\n\n[Carga.AfterPrior]\n / \n[Carga.Detail]\n       <Print Dataset=\"Carga\" FieldName=\"Quantidade\" DisplayFormat=\",0\"> x <Print Dataset=\"Carga\" FieldName=\"Cntr\">\n[Carga.Footer]\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\MODELO BRABO.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Case\n    When Atv.IdTarefa = 317 Then 'CONFIRMAÇÃO DE CHEGADA'\n    When Atv.IdTarefa = 293 Then 'CONFIRMAÇÃO DE EMBARQUE'\n    When Atv.IdTarefa = 306 Then 'CE MERCANTE'\n    When Atv.IdTarefa = 377 Then 'TERMO DE CONTAINER'\n    When Atv.IdTarefa = 297 Then 'HBL - FOLLOW UP'\n    When Atv.IdTarefa = 289 Then 'BOOKING DETAILS'\n    Else 'FOLLOW UP'\n  End as AssuntoFollow,\n  Case\n  WHEN Lhs.IdCliente IN (1647 /*Manulola*/, 1643 /*SR7*/, 1646 /*RSC7*/, 1761 /*FIT*/) THEN 'Refcli_Inicio'\n  ELSE 'Refcli_Meio'\n  END AS Refcli,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Coalesce(Nvt.Navio, Nvi.Nome) as Navio,\n  Coalesce(Nvt.Viagem_Voo, Lmm.Viagem_Navio) as Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  Case\n    When Lhs.Tipo_Carga = 3 Then 'Processo_FCL'\n    When Lhs.Tipo_Carga = 4 Then 'Processo_LCL'\n  End As Tipo_Carga_Processo,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join (\nSelect\n  ROW_NUMBER() OVER(PARTITION BY Lvg.IdLogistica_House ORDER BY Lvg.Data_Previsao_Desembarque desc) as Indice,\n  Lhs.IdLogistica_House,\n  Nav.Nome as Navio,\n  Lvg.Viagem_Voo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Viagem Lvg on Lvg.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Navio Nav on Nav.IdNavio = Lvg.IdNavio\nWhere\n  Lvg.Data_Desembarque is null\nand\n  Lvg.Modalidade_Transporte = 2) Nvt on Nvt.IdLogistica_House = Lhs.IdLogistica_House and Nvt.Indice = 1\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n  <DataSet Name=\"Equipamento_LCL\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lbm.Quantidade,\n  Tmb.Nome as Embalagem,\n  Lbm.Peso_Bruto,\n  Lbm.Metros_Cubicos,\n  Lbm.Comprimento,\n  Lbm.Largura,\n  Lbm.Altura\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Embalagem Lbm on Lbm.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Tipo_Embalagem Tmb on Tmb.IdTipo_Embalagem = Lbm.IdTipo_Embalagem\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n    <head>\n      <meta charset=\"utf-8\" />\n      <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n      <title>Page Title</title>\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    \n      <style>\n        * { box-sizing: border-box; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n        .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n        .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n        th { font-size: 14px; }\n        .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .text-center { text-align: center; }\n        .text-left { text-align: left; }\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-white { color: white; }\n        .negrito { font-weight: bold; }\n        .sem-negrito { font-weight: normal; }\n        .font-size-14 { font-size: 14px; }\n        .font-size-11 { font-size: 11pt; }\n        .margin-bottom-5 { margin-bottom: 5px; }\n        .line-height-3 { line-height: 3px; }\n      </style>\n    </head>\n    <body>\n    [Address.Detail]\n    <SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n    \n    [CC.Detail]\n    \n    [Contatos.AfterPrior]\n    ;  \n    [Contatos.Detail]\n    <Print Dataset=\"Contatos\" FieldName=\"Email\">\n    \n    [Subject.Header]\n<SubReport NameField=\"Refcli\" NameSource=\"Processo\">\n    [Subject.Footer]\n    \n    [Refcli_Inicio.Detail]\n REF. CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> | <Print Dataset=\"Processo\" FieldName=\"AssuntoFollow\"> | <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> | CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> | <Print Dataset=\"Processo\" FieldName=\"Origem\"> X <Print Dataset=\"Processo\" FieldName=\"Destino\"> | <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\">\n\n    [Refcli_Meio.Detail]\n <Print Dataset=\"Processo\" FieldName=\"AssuntoFollow\"> | <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> | REF. CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> | CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> | <Print Dataset=\"Processo\" FieldName=\"Origem\"> X <Print Dataset=\"Processo\" FieldName=\"Destino\"> | <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\">\n\n    [Report.Detail]\n<table border=\"0\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: collapse; font-family: Verdana; font-size: 10pt;\">\n    <tr>\n        <td colspan=\"2\" style=\"text-align: center; padding: 12px;\">\n            <img border=\"0\" src=\"https://i.imgur.com/aHkZL9Y.png\" width=\"250\" alt=\"Logo\">\n        </td>\n    </tr>\n    <tr>\n        <td colspan=\"11\" style=\"background-color: #384c7c; color: #ffffff; text-align: center; padding: 12px; border-radius: 12px;\">\n            <b><Print Dataset=\"Processo\" FieldName=\"AssuntoFollow\"> - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></b>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=\"2\" style=\"height: 12px;\"></td>\n    </tr>\n    <tr style=\"background-color: #f2f2f2; border-radius: 12px;\">\n        <td colspan=\"2\" style=\"padding: 8px; border-radius: 12px;\">\n            <table width=\"100%\" style=\"border: 0;\">\n                <tr>\n                    <td style=\"width: 50%;\"><b>REF. CLIENTE:</b> <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n                    <td style=\"width: 50%;\"><b>CLIENTE:</b> <Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n    <tr style=\"background-color: #ffffff;\">\n        <td colspan=\"2\" style=\"padding: 8px;\">\n            <table width=\"100%\" style=\"border: 0;\">\n                <tr>\n                    <td style=\"width: 50%;\"><b>REFERÊNCIA:</b> <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n                    <td style=\"width: 50%;\"><b>DATA:</b> <Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n       \n<table border=\"0\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: collapse; font-family: Verdana; font-size: 9pt;\">\n  <tr style=\"background-color: #384c7c;\">\n    <th colspan=\"4\" style=\"color: #ffffff; text-align: center; padding: 8px; font-weight: bold; border-radius: 6px;\">DADOS DO PROCESSO</th>\n  </tr>\n  <tr>\n    <td colspan=\"4\" style=\"height: 6px;\"></td>\n  </tr>\n  <tr>\n    <td style=\"padding: 8px; width: 20%;\"><b>NAVIO:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Navio\"></td>\n    <td style=\"padding: 8px; width: 20%;\"><b>VIAGEM:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>\n  </tr>\n  <tr>\n    <td colspan=\"4\" style=\"background-color: #f2f2f2; border-radius: 6px;\">\n      <table border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: collapse;\">\n        <tr>\n          <td style=\"padding: 8px; width: 20%;\"><b>POL:</b></td>\n          <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n          <td style=\"padding: 8px; width: 20%;\"><b>POD:</b></td>\n          <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n  <tr>\n    <td style=\"padding: 8px; width: 20%;\"><b>HBL:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n    <td style=\"padding: 8px; width: 20%;\"><b>MBL:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n  </tr>\n  <tr>\n    <td colspan=\"4\" style=\"background-color: #f2f2f2; border-radius: 6px;\">\n      <table border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: collapse;\">\n        <tr>\n          <td style=\"padding: 8px; width: 20%;\"><b>ETD:</b></td>\n          <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n          <td style=\"padding: 8px; width: 20%;\"><b>ETA:</b></td>\n          <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n  <tr>\n    <td style=\"padding: 8px; width: 20%;\"><b>ATD:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n    <td style=\"padding: 8px; width: 20%;\"><b>ATA:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n    <td colspan=\"4\" style=\"background-color: #f2f2f2; border-radius: 6px;\">\n      <table border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: collapse;\">\n        <tr>\n          <td style=\"padding: 8px; width: 20%;\"><b>CONSIGNEE:</b></td>\n          <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n          <td style=\"padding: 8px; width: 20%;\"><b>NOTIFY:</b></td>\n          <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Notify\"></td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n<SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Processo\">\n</table>\n\n\n    <br>\n    \n    <SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Detalhe\">\n\n      <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: collapse; font-family: Verdana; font-size: 9pt;\">\n        <tr style=\"background-color: #384c7c; color: white;\">\n          <td style=\"padding: 8px; width: 20%; border-radius: 8px 0 0 8px;\"><b>DATA</b></td>\n          <td style=\"padding: 8px; width: 80%; border-radius: 0 8px 8px 0;\"><b>DESCRIÇÃO</b></td>\n        </tr>\n        <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n        <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n        <tr>\n          <td colspan=\"6\" style=\"height: 6px;\"></td>\n        </tr>\n      </table>\n\n[Processo_FCL.Detail]\n<tr>\n    <td style=\"padding: 8px; width: 20%;\"><b>ARMADOR:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n    <td style=\"padding: 8px; width: 20%;\"><b></b></td>\n    <td style=\"padding: 8px; width: 30%;\"></td>\n  </tr>\n\n[Processo_LCL.Detail]\n  <tr>\n    <td style=\"padding: 8px; width: 20%;\"><b>TERMINAL REDESTINAÇÃO:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Terminal_Redestinacao\"></td>\n    <td style=\"padding: 8px; width: 20%;\"><b>ARMADOR/COLOADER:</b></td>\n    <td style=\"padding: 8px; width: 30%;\"><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n  </tr>\n      \n      [Follow_Destaque.Detail]\n      <tr>\n        <td style=\"padding: 8px; width: 20%; border-bottom: 1px solid #e0e0e0; vertical-align: top;\"><b><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></b></td>\n        <td style=\"padding: 8px; width: 80%; border-bottom: 1px solid #e0e0e0; vertical-align: top;\"><b><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></b></td>\n      </tr>\n      \n      [Follow_Outros.Detail] \n      <tr>\n        <td style=\"padding: 8px; width: 20%; border-bottom: 1px solid #e0e0e0; vertical-align: top;\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n        <td style=\"padding: 8px; width: 80%; border-bottom: 1px solid #e0e0e0; vertical-align: top;\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n      </tr>\n\n    [FCL.Detail]\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: separate; border-spacing: 0 2px; font-family: Verdana; font-size: 9pt;\">\n      <tr style=\"background-color: #384c7c; color: white;\">\n        <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 25%; border-radius: 6px 0 0 6px;\">QUANT.</td>\n        <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 25%;\">TIPO DE EQUIPAMENTO</td>\n        <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 25%;border-radius: 0 6px 6px 0;\">FREE TIME DESTINO</td>\n      </tr>\n        <SubReport Name=\"Carga\" Dataset=\"Carga\">\n    </table>\n\n    [Carga.Detail]\n    <tr>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 25%; border-radius: 6px 0 0 6px;\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\">x</td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 25%;\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 25%;\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>\n    </tr>\n\n    [LCL.Detail]\n      <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse: separate; border-spacing: 0 2px; font-family: Verdana; font-size: 9pt;\">\n        <tr style=\"background-color: #384c7c; color: white;\">\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%; border-radius: 6px 0 0 6px;\">QUANT.</td>\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\">EMBALAGEM</td>\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\">COMPRIMENTO</td>\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\">LARGURA</td>\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\">ALTURA</td>\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\">METROS CÚBICOS</td>\n          <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%; border-radius: 0 6px 6px 0;\">PESO BRUTO</td>\n        </tr>\n          <SubReport Name=\"Equipamento_LCL\" Dataset=\"Equipamento_LCL\">\n      </table>\n\n    [Equipamento_LCL.Detail]\n    <tr>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%; border-radius: 6px 6px;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Quantidade\">x</td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Embalagem\"></td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Comprimento\">cm</td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Largura\">cm</td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Altura\">cm</td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Metros_Cubicos\">m³</td>\n      <td style=\"padding: 8px; font-weight: bold; text-align: center; width: 14.25%; border-radius: 6px 6px;\"><Print Dataset=\"Equipamento_LCL\" FieldName=\"Peso_Bruto\">kg</td>\n    </tr>\n[Report.Footer]\n<table width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n</body>\n</html>\n\n[Attach]\n<DataSet Name=\"Attach\" Sql=\"\nSelect\n  Arq.Nome,\n  Arq.IdDados_Arquivo\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Arquivo Paa on Paa.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  arq_Arquivo Arq on (Arq.IdArquivo = Paa.IdArquivo)\n    And (\n      (Atv.IdTarefa = 306 and Arq.IdArquivo_Grupo = 30) or\n      (Atv.IdTarefa = 317 and Arq.IdArquivo_Grupo = 32) or\n      (Atv.IdTarefa = 297 and Arq.IdArquivo_Grupo = 9)\n    )\nWhere\n  Atv.IdAtividade = :IdAtividade\n  AND Atv.IdTarefa in (306, 317, 297)\nOrder By\n  Arq.Data_Criacao Desc\">\n\n[Attach.Detail]\n<SubReport Name=\"Comprovantes\" Binary=\"True\">\n\n[Comprovantes.Name]\n<Print DataSet=\"Attach\" FieldName=\"Nome\">\n\n[Comprovantes.FileData.Id]\n<Print DataSet=\"Attach\" FieldName=\"IdDados_Arquivo\" Compressed=\"True\">"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Modelo de E-mail.sql",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'Variavel_Armador'\n  else 'Variavel_Modalidade'\n  end as Variavel,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'ARMADOR:'\n  else 'MODALIDADE:'\n  end as Titulo_Variavel,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 59162 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 48952 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n   CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971)  THEN 'Titulo_Referencia'\n  else 'Referencia_Titulo'\n  end as Referencia_Variavel,\n  COALESCE(Agm.Nome,Ctr.Nome) as Armador_Nome,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Nvi.Nome as Navio,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Agm on Agm.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n<DataSet Name=\"Proposta\" Sql=\"Select\n  Pfr.IdProposta_Frete,\n  Pfr.Numero_Proposta,\n  Pfr.Data_Proposta,\n  Cli.Nome as Cliente,\n  Cct.Nome as Cliente_Contato,\n  Cct.Fone as Cliente_Contato_Fone,\n  Cct.EMail As Cliente_Contato_Email,\n  Vnd.Nome as Vendedor,\n  Vnd.Detalhes as Vendedor_Detalhes,\n  Vnd.EMail as Vendedor_Email\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Cli on Cli.IdPessoa = Pfr.IdCliente\nLeft Outer Join\n  cad_Pessoa_Contato Cct on Cct.IdPessoa_Contato = Pfr.IdCliente_Contato\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Pfr.IdVendedor\nWhere\n    Atv.IdAtividade = :IdAtividade\">\n\n\n\n<DataSet Name=\"Fatura\" Sql=\"SELECT\n  Tx1.IdLogistica_House,\n  Tx1.Pessoa_Fatura AS Pessoa_BL,\n  Tx1.Moeda AS Moeda_BL,\n  Tx1.Taxa_Internacional AS Taxa_Internacional_BL,\n  Tx1.Fator AS Fator_BL,\n  Tx2.Moeda AS Moeda_EX,\n  Tx2.Taxa_Internacional AS Taxa_Internacional_EX,\n  Tx2.Fator AS Fator_EX,\n  Tx1.Email,\n  Tx1.Numero_Processo\nFROM\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master \n  Left outer join\n  cad_pessoa Eml ON Eml.IdPessoa = Lhs.IdCliente\nLeft Outer Join (\nSELECT\n  Ltx.IdLogistica_House,\n  Pes.Nome as Pessoa_Fatura,\n  Mrc.Sigla AS Moeda,\n  Tle.Nome_Internacional AS Taxa_Internacional,\n  Cast(Case\n    When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n    Else 0\n  End As Float) As Fator,\n  Tle.IdTaxa_Logistica_Exibicao,\n  Pes.email,\n  Lhs.Numero_Processo\nFROM\n  mov_Logistica_Taxa Ltx\n  Left Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\nLeft Outer Join \n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n    And ((Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n    Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem))\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n  left outer join\n  cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\nWhere\n  Lft.IdPessoa = Lms.IdCompanhia_Transporte \nAND\n  Tle.IdTaxa_Logistica_Exibicao IN (6)\n)Tx1 on Tx1.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join (\nSELECT\n  Ltx.IdLogistica_House,\n  Pes.Nome as Pessoa_Fatura,\n  Mrc.Sigla AS Moeda,\n  Tle.Nome_Internacional AS Taxa_Internacional,\n  Cast(Case\n    When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n    Else 0\n  End As Float) As Fator,\n  Tle.IdTaxa_Logistica_Exibicao\nFROM\n  mov_Logistica_Taxa Ltx\n  Left Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\nLeft Outer Join \n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n    And ((Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n    Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem))\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n  left outer join\n  cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\nWHERE\n  Lft.IdPessoa = Lms.IdCompanhia_Transporte \nAND\n  Tle.IdTaxa_Logistica_Exibicao IN (85)\n)Tx2 on Tx2.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\n    Atv.IdAtividade =:IdAtividade\">\n  </CommandText></DataSet>\n  <html>\n    <style type=\"text/css\">\nbody { font-family: 'Roboto', Arial, sans-serif; color: #333; background-color: #f8f9fa; margin: 0; padding: 0; }\ntable { border-collapse: collapse; width: 100%; max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); }\ntd { padding: 20px; line-height: 1.6; border: none; }\nimg { max-width: 100%; height: auto; display: block; }\ntd br { line-height: 1em; }\nstrong { color: #007bff; }\na { color: #007bff; text-decoration: none; }\na:hover { text-decoration: underline; }\nh1 { font-size: 24px; color: #333; margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid #007bff; padding-bottom: 10px; }\n    </style>\n  <body>\n[Address.Detail]\n <Print Dataset=\"Fatura\" FieldName=\"Email\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n    ;  \n[Contatos.Detail]\n \n[Subject.Header]\nSTATUS PROCESSO - PROCESSO <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n\n[Report.Detail]\n\n\n[Report.footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Modelo de mensagem COTAÇÃO AO PRICING - AGL.html",
        "conteudo": "[Report.Header]\n<!DOCTYPE html>\n<DataSet Name=\"Proposta\" Sql=\"Select\n  Pfr.IdProposta_Frete,\n  Pfr.Numero_Proposta,\n  Pfr.Data_Proposta,\n  Cli.Nome as Cliente,\n  Cct.Nome as Cliente_Contato,\n  Cct.Fone as Cliente_Contato_Fone,\n  Cct.EMail As Cliente_Contato_Email,\n  Vnd.Nome as Vendedor,\n  Vnd.Detalhes as Vendedor_Detalhes,\n  Vnd.EMail as Vendedor_Email\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Cli on Cli.IdPessoa = Pfr.IdCliente\nLeft Outer Join\n  cad_Pessoa_Contato Cct on Cct.IdPessoa_Contato = Pfr.IdCliente_Contato\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Pfr.IdVendedor\nWhere\n    Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Oferta\" Sql=\"Select\n  CASE \n    WHEN Pfc.Tipo_Carga IN (2,4) /*LCL*/ THEN CONVERT(VARCHAR, FORMAT(Pfc.Quantidade_Volumes, '0.000'))\n    WHEN Pfc.Tipo_Carga IN (1) /*LCL*/ THEN CONVERT(VARCHAR, Pfc.Quantidade_Volumes)\n    WHEN Pfc.Tipo_Carga = 3 /*FCL*/ THEN Pfn.Equipamento\n  END AS Descricao_Carga,\n  Pfc.Quantidade_Volumes,\n  Ofr.IdOferta_frete,\n  Ofr.IdProposta_Frete,\n  CASE\n  WHEN Ofr.Instrucoes_Cliente IS NOT NULL then 'Instrucoes_Cli' else '' end as Variavel_Instrucao,\n  Ofr.Instrucoes_Cliente as Instrucoes_Cliente_Final,\n  Ofr.Numero_Oferta,\n  Ofr.Remarks as Obs_Remarks,\n  Ofr.Remarks_Terrestre as Remarks_Terrestre,\n  Ofr.Remarks_Free_Time as Remarks_Free_Time,\n  CASE\n  Ofv.Tipo_Servico\n  WHEN 0 then 'NOT APPLICABLE'\n  WHEN 1 THEN 'Dedicado'\n  WHEN 2 THEN 'Rodizio'\n  end as Tipo_Servico_Coleta,\n  Nsa.Descricao as Nivel_Servico,\n  CASE\n    WHEN Ofr.Modalidade_Processo = 1 Then 'Oversized'\n  Else ''\n  End AS Over_Agl,\n  CASE \n    When Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 4 Then 'AIR-AIR'\n    When Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 5 Then 'SEA-AIR'\n    When Ofr.Tipo_Operacao = 3 and Ofr.MOdalidade_Processo = 1 Then 'NACIONAL AÉREO'\n    When Ofr.Tipo_Operacao = 3 and Ofr.Modalidade_Processo = 2 Then 'NACIONAL MARÍTIMO (CABOTAGEM)'\n    When Ofr.Tipo_Operacao = 3 and Ofr.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade,\n  CASE\n  When Ofr.Modalidade_Processo = 3 THEN 'trucking@aglcargo.com' ELSE '' end as Email_Trucking,\n  Case \n    WHEN coalesce(Ofr.Tipo_Servico,0) = 0 Then 'NOT APPLICABLE'\n    WHEN Ofr.Tipo_Servico = 1 Then 'DOOR TO DOOR'\n    WHEN Ofr.Tipo_Servico = 2 Then 'DOOR TO PORT'\n    WHEN Ofr.Tipo_Servico = 3 Then 'PORT TO DOOR'\n    WHEN Ofr.Tipo_Servico = 4 Then 'PORT TO PORT'\n    WHEN Ofr.Tipo_Servico = 5 Then 'PORT TO RAMP'\n    Else CAST(Ofr.Tipo_Servico as VarChar(Max)) end As Tipo_Servico,\n  Ofr.Transit_Time,\n  CASE\n    WHEN Tps.Nome is null Then 'NOT APPLICABLE'\n    Else Tps.Nome end As Tipo_Processo,\n  Ofr.Transit_Time_Maximo,\n  CASE \n    WHEN COALESCE(Ofr.Local_Entrega, Ofv.Local_Entrega) IS NULL \n        THEN 'NOT APPLICABLE'\n    ELSE COALESCE(Ofr.Local_Entrega, Ofv.Local_Entrega) \nEND AS Local_Entrega,\n  CASE\n    WHEN Ofr.Local_Coleta is null Then 'NOT APPLICABLE'\n    Else Ofr.Local_Coleta end As Local_Coleta,\n  CASE Ofr.Modalidade_Pagamento_Master WHEN 0 THEN 'Não informado' WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_Master,\n  CASE Ofr.Modalidade_Pagamento_House WHEN 0 THEN 'Não informado' WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_House,\n  CASE\n    WHEN Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga <> 4 /*LCL*/ Then ' pricingimpo.seafreight@aglcargo.com' /*IMPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga = 4 /*LCL*/ Then ' pricinglcl.seafreight@aglcargo.com' /*IMPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga <> 4 /*LCL*/ Then ' pricingexpo.seafreight@aglcargo.com' /*EXPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 2 and Pfc.Tipo_Carga = 4 /*LCL*/ Then ' pricinglcl.seafreight@aglcargo.com' /*EXPO MARITIMA*/\n    WHEN Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1 Then ' pricing.airfreight@aglcargo.com' /*IMPO AEREA*/\n    WHEN Ofr.Tipo_Operacao = 1 and Ofr.Modalidade_Processo = 1 Then ' pricing.airfreight@aglcargo.com' /*EXPO AEREA*/\n  END AS Email_Pricing,\n  Ofr.Data_Validade,\n  Ofr.Referencia_Cliente,\n  Ofr.Referencia_Externa,\n  Ofr.Validade_Dias,\n  Ofr.Observacao,\n  Ept.Nome as Exportador,\n  Imp.Nome as Importador,\n  Imp.CPF_CNPJ AS Importador_CNPJ,\n  CASE Pfc.Tipo_Carga\n    WHEN 4 /*LCL*/ THEN 'Importador_LCL'\n    ELSE ''\n  END AS Campos_Importador,\n  Vnd.Nome as Vendedor,\n  Pfr.Numero_Proposta,\n  Pfr.Data_Aprovacao,\n  Cli.Nome as Cliente,\n  CASE WHEN Ofr.Modalidade_Processo = 3 then 'Origem_Destino_Terrestre' else 'Origem_Destino_Padrao' end as Condicao_Origem_Destino,\n  Cli.Detalhes as Detalhes_Cliente,\n  Dsp.Nome as Despachante,\n  Cia.Nome as Cia_Transporte,\n  Inc.Nome as Incoterm,\n  Loc.Nome as Local_Recebimento,\n  Case\n    WHEN Org.Nome is null then 'NOT APPLICABLE'\n    Else Org.Nome end As Origem,\n  Org.Sigla as Origem_Sigla,\n  Case\n    WHEN Dst.Nome is null then 'NOT APPLICABLE'\n    Else Dst.Nome end As Destino,\n  Dst.Sigla as Destino_Sigla,\n  Dsf.Nome as Destino_Final,\n  Ofr.Transit_Time,\n  Ofr.Transit_Time_Maximo,\n  Pfc.Peso_Liquido,\n  Pfc.Peso_Bruto,\n  COALESCE(Orv.Nome,Org.Nome) as Origem_Terrestre,\n  COALESCE(Ord.Nome,Dst.Nome) as Destino_Terrestre,\n  Pfc.Peso_Cubado,\n  Pfc.NCM_Descricao,\n  Pfc.Peso_Considerado,\n  Pfc.Peso_Taxado,\n  Pfc.Metros_Cubicos,\n  Pfc.Equipamentos,\n  Pfc.Quantidade_Volumes,\n  Pfe.Equipamento,\n  CASE \n    WHEN Pfc.Tipo_Carga IN (1,2,4) /*LCL*/ Then 'Qty Volumes:'\n\tWHEN Pfc.Tipo_Carga = 3 /*FCL*/ Then ''\n  END AS Titulo_Carga,\n  Case \n    WHEN coalesce(Pfc.Valor_Mercadoria,0) = 0 Then 'NOT APPLICABLE'\n    Else CAST(Pfc.Valor_Mercadoria as VarChar(Max)) end As Valor_Mercadoria,\n  CASE Pfc.Tipo_Carga WHEN 1 THEN 'Áéreo' WHEN 2 THEN 'Break-Bulk' WHEN 3 THEN 'FCL' WHEN 4 THEN 'LCL' WHEN 5 THEN 'RO-RO' WHEN 6 THEN 'Rodoviário' END as Tipo_Carga,\n  CASE \n    WHEN Ofr.Modalidade_Processo = 2 AND Pfc.Tipo_Carga = 3 THEN 'Maritimo_FCL'\n    WHEN Ofr.Modalidade_Processo = 2 AND Pfc.Tipo_Carga <> 3 THEN 'Maritimo_LCL'\n    ELSE 'Outros'\n  END as Tipo_Oferta,\n  Case Pfc.Tipo_Carga\n    WHEN 1 THEN 'Aereo'\n    WHEN 3 Then 'FCL'\n    ELSE 'LCL'\n  End As Tipo_Carga_Detalhe,\n  Case Pfc.Tipo_Carga\n    WHEN 1 THEN ''\n    WHEN 3 Then ''\n    ELSE 'LCL'\n  End As Tipo_Carga_Detalhe2,\n  Mer.Nome as Mercadoria,\n  Case\n     When coalesce(Pfc.Carga_Perigosa,0) = 1 Then 'Carga_Per'\n     Else 'Não'\n  End As Carga_Perigosa,    \n  Case\n     When coalesce(Mer.Carga_Perigosa,0) = 1 Then 'Sim'\n     Else 'Não'\n  End As Mercadoria_Perigosa,      \n  Fvg.Descricao as Frequencia,\n  Ofr.Rota,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Uni.Valor_Alfanumerico as Cl_Un,\n  Cla.Valor_Alfanumerico as Cl_Class,\n  Pcg.Valor_Alfanumerico as Cl_Packing_Group,\n  CASE\n  Cmp.Valor_Tipo_Fixo\n  WHEN 2 THEN 'YES'\n  WHEN 3 THEN 'NO'\n  ELSE ''\n  END AS Carga_Empilhavel,\n  CASE\n  Tve.Valor_Tipo_Fixo\nWHEN 1 then 'Não se aplica'\nWHEN 2 then 'Utilitário'\nWHEN 3 then 'Van'\nWHEN 4 then 'VUC - Veículo Urbano de Carga'\nWHEN 5 then 'Caminhão Toco'\nWHEN 6 then 'Caminhão Truck'\nWHEN 7 then 'Cavalo e Carreta 28 Paletes'\nWHEN 8 then 'Cavalo e Carreta 30 Paletes'\nWHEN 9 then 'Outros'\n  ELSE 'Não se aplica'\n  END AS Tipo_Veiculo,\nCASE\nNes.Valor_Tipo_Fixo\nWHEN 1 THEN 'Não se aplica'\nWHEN 2 THEN 'Plataforma'\nWHEN 3 THEN 'Ajudante. Se positivo, Quantos?'\nWHEN 4 THEN 'Munck'\nWHEN 5 THEN 'Outros'\n  ELSE 'Não se aplica'\n  END AS Necessidades_Especiais,\nCASE\nIfc.Valor_Tipo_Fixo\nWHEN 1 THEN 'Não se aplica'\nWHEN 2 THEN 'Órgão Anuente'\nWHEN 3 THEN 'Certificação especial'\nELSE 'Não se aplica'\n  END AS Informacoes_Complementares\n\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Ofr.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Ofr.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Loc on Loc.IdOrigem_Destino = Ofr.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Ofr.IdDestino_Final\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Ofr.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Ofr.IdImportador\nLeft Outer Join\n  cad_Pessoa Cia on Cia.IdPessoa = Ofr.IdCompanhia_Transporte\nLEFT OUTER JOIN\n  cad_Nivel_Servico_Aereo Nsa on Nsa.IdNivel_Servico_Aereo = Ofr.IdNivel_Servico_Aereo\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Ofr.IdIncoterm\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Pfr.IdVendedor\nLeft Outer Join\n  cad_Pessoa Cli on Cli.IdPessoa = Pfr.IdCliente\nLEFT OUTER JOIN\n  cad_Tipo_Processo Tps on Tps.IdTipo_Processo = Ofr.IdTipo_Processo\nLeft Outer Join\n  cad_Pessoa Dsp on Dsp.IdPessoa = Ofr.IdDespachante_Aduaneiro\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Pfc.IdMercadoria\nLeft Outer Join\n  cad_moeda Mmr On Mmr.IdMoeda = Pfc.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Frequencia_Viagem Fvg on Fvg.IdFrequencia_Viagem = Ofr.IdFrequencia_Viagem\nLeft Outer Join\n  mov_Oferta_Frete_Viagem Ofv on Ofv.IdOferta_Frete = Ofr.IdOferta_Frete and Ofv.Tipo_Viagem = 1\nLeft Outer Join\n  cad_Origem_Destino Orv on Orv.IdOrigem_Destino = Ofv.IdOrigem and Ofv.Tipo_Viagem = 1\nLeft Outer Join\n  cad_Origem_Destino Ord on Ord.IdOrigem_Destino = Ofv.IdDestino and Ofv.Tipo_Viagem = 1\n/*Campos Livres*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Uni on Uni.IdOferta_Frete = Ofr.IdOferta_Frete and Uni.IdConfiguracao_Campo_Livre = 59 /*UN*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Cla on Cla.IdOferta_Frete = Ofr.IdOferta_Frete and Cla.IdConfiguracao_Campo_Livre = 60 /*Class*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Pcg on Pcg.IdOferta_Frete = Ofr.IdOferta_Frete and Pcg.IdConfiguracao_Campo_Livre = 61 /*Packing Group*/\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Cmp on Cmp.IdOferta_Frete = Ofr.IdOferta_Frete and Cmp.IdConfiguracao_Campo_Livre = 69 /*Carga Empilhavel*/  \nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Tve on Tve.IdOferta_Frete = Ofr.IdOferta_Frete and Tve.IdConfiguracao_Campo_Livre = 71 /*Tipo_Veiculo*/  \nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Nes on Nes.IdOferta_Frete = Ofr.IdOferta_Frete and Nes.IdConfiguracao_Campo_Livre = 72 /*Necessidades_Especiais*/  \nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Ifc on Ifc.IdOferta_Frete = Ofr.IdOferta_Frete and Ifc.IdConfiguracao_Campo_Livre = 73 /*Informacoes_Complementares*/  \nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(CONCAT_WS(' x ', Pfe.Quantidade, CASE\n        WHEN CHARINDEX(' ', Emr.Descricao) > 0 THEN SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1)\n        ELSE Emr.Descricao\n      END,\n      CASE\n        WHEN Emr.IdEquipamento_Maritimo = 1 THEN 'TK' /* Tank */\n        WHEN Emr.IdEquipamento_Maritimo = 2 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 3 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 4 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 5 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 6 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 7 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 8 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 9 THEN 'HC' /* High Cube */\n        WHEN Emr.IdEquipamento_Maritimo = 10 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 11 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 12 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 13 THEN ' ' /**/\n        WHEN Emr.IdEquipamento_Maritimo = 14 THEN ' ' /* Nor */\n        WHEN Emr.IdEquipamento_Maritimo = 15 THEN 'NOR' /* Nor */\n        ELSE Emr.Descricao\n      END\n    ),\n    ' / '\n  ) AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga) Pfe ON Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(ISNULL(CONVERT(VARCHAR, Pfe.Quantidade), ' ') + ' x ' + ISNULL(CAST(Emr.Descricao AS VARCHAR(MAX)), ''), ', ') AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga, Pfe.Quantidade\n) Pfn ON Pfn.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nWhere\n  Atv.IdAtividade = :IdAtividade\" MasterSource=\"Proposta\" MasterFields=\"IdProposta_Frete\" LocalFields=\"IdProposta_Frete\">\n\n\n<DataSet Name=\"Equipamentos_Agrupados\" Sql=\"Select\n  STRING_AGG(Pfn.Equipamento, ', ') as Equipamento_Agrupado\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(CONCAT_WS(' x ', Pfe.Quantidade, CASE\n        WHEN CHARINDEX(' ', Emr.Descricao) > 0 THEN SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1)\n        ELSE Emr.Descricao\n      END,\n      CASE\n        WHEN Emr.IdEquipamento_Maritimo = 1 THEN 'TK' /* Tank */\n        WHEN Emr.IdEquipamento_Maritimo = 2 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 3 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 4 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 5 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 6 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 7 THEN 'PM' /* Platform */\n        WHEN Emr.IdEquipamento_Maritimo = 8 THEN 'FR' /* Flat Rack */\n        WHEN Emr.IdEquipamento_Maritimo = 9 THEN 'HC' /* High Cube */\n        WHEN Emr.IdEquipamento_Maritimo = 10 THEN 'DRY' /* Dry Box */\n        WHEN Emr.IdEquipamento_Maritimo = 11 THEN 'OT' /* Open Top */\n        WHEN Emr.IdEquipamento_Maritimo = 12 THEN 'RH' /* Reefer */\n        WHEN Emr.IdEquipamento_Maritimo = 13 THEN ' ' /**/\n        WHEN Emr.IdEquipamento_Maritimo = 14 THEN ' ' /* Nor */\n        WHEN Emr.IdEquipamento_Maritimo = 15 THEN 'NOR' /* Nor */\n        ELSE Emr.Descricao\n      END\n    ),\n    ' / '\n  ) AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga) Pfe ON Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nLeft Outer Join (SELECT\n  Pfe.IdProposta_Frete_Carga,\n  STRING_AGG(ISNULL(CONVERT(VARCHAR, Pfe.Quantidade), ' ') + ' x ' + ISNULL(CAST(Emr.Descricao AS VARCHAR(MAX)), ''), ', ') AS Equipamento\nFROM\n  mov_Proposta_Frete_Equipamento Pfe\nLEFT OUTER JOIN\n  cad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo\nGROUP BY\n  Pfe.IdProposta_Frete_Carga, Pfe.Quantidade\n) Pfn ON Pfn.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Equipamentos\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Ofr.IdProposta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfc.Descricao,\n  Pfe.Quantidade,\n  Emr.Descricao As Equipamento,\n  Oft.Master_Origem,\n  Oft.House_Origem,\n  Oft.Master_Destino,\n  Oft.House_Destino\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  mov_Oferta_Frete Ofr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Equipamento Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nLeft Outer Join\n  cad_Equipamento_Maritimo Emr On Emr.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo  \nLeft Outer Join\n  mov_Oferta_Frete_Free_Time Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete And Oft.IdEquipamento_Maritimo = Pfe.IdEquipamento_Maritimo \nWhere\n  Atv.IdAtividade = :IdAtividade\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Carga\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfc.Descricao,\n  Pfe.Quantidade,\n  Pfe.Altura,\n  Pfe.Largura,\n  Pfe.Comprimento,\n  Pfe.Metros_Cubicos,\n  Pfe.Peso_Liquido,\n  Pfe.Peso_Bruto,\n  Pfe.Peso_Bruto_Unitario,\n  Pfe.Peso_Cubado,\n  Pfe.Peso_Considerado,\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End as oversized_cargo, \n  Emb.Nome as Embalagem\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Embalagem Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nLEFT OUTER JOIN\n  cad_Tipo_Embalagem Emb ON Emb.IdTipo_Embalagem = Pfe.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\nOrder by\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End DESC\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n\n\n<DataSet Name=\"Cargas\" sql=\"SELECT\n  Ofr.IdOferta_Frete,\n  Pfc.Tipo_Carga,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  CASE \n      WHEN Pfc.Tipo_Carga = 3 THEN NULL \n      ELSE SUM(Pfe.Quantidade) \n  END AS Quantidade_Total,\n  CASE \n      WHEN Pfc.Tipo_Carga = 3 THEN 'display: none;'\n      ELSE '' \n  END AS Estilo_Linha\nFROM\n  mov_Atividade Atv\n  LEFT OUTER JOIN mov_Proposta_Frete Pfr ON Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  LEFT OUTER JOIN mov_Oferta_Frete Ofr ON Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\n  LEFT OUTER JOIN mov_Proposta_Frete_Carga Pfc ON Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\n  LEFT OUTER JOIN mov_Proposta_Frete_Embalagem Pfe ON Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nWHERE\n  Atv.IdAtividade = :IdAtividade\nGROUP BY\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfc.Tipo_Carga\"\n   MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\"></DataSet>\n\n <DataSet Name=\"oversized_cargo\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Pfr.Numero_Proposta,\n  Ofr.Numero_Oferta,\n  Pfe.Altura,\n  Pfe.Largura,\n  Pfe.Comprimento,\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End as oversized_cargo, \n  Emb.Nome as Embalagem\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  mov_Proposta_Frete_Embalagem Pfe On Pfe.IdProposta_Frete_Carga = Pfc.IdProposta_Frete_Carga \nLEFT OUTER JOIN\n  cad_Tipo_Embalagem Emb ON Emb.IdTipo_Embalagem = Pfe.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\n  AND\n  Case \n    When pfe.Largura >= 200.00 or pfe.Comprimento >= 300.00 or pfe.Altura >= 160.00 Then '**OVERSIZED CARGO**' \n  Else ''\n  End LIKE '**OVERSIZED CARGO**' \" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Oferta_Taxa_Frete\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  CASE Oft.Tipo_Recebimento \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Recebimento_Extenso,\n  CASE Oft.Tipo_Pagamento\n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Pagamento_Extenso,\n  Oft.Origem_Taxa,\n  Oft.Complemento,\n  Tle.Nome As Taxa,\n  Mrc.Sigla As Moeda_Recebimento,\n  Prc.Nome As Pessoa_Recebimento,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  mov_Proposta_Frete Pfr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nWhere\n  Atv.IdAtividade = :IdAtividade\nand\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Origem_Taxa=1  /*Frete*/\nand\n  Oft.Valor_Recebimento_Total is not Null\nOrder By\n  Case Tlg.Tipo\n    When 1 /* Frete */ Then 0\n    Else 1\n  End, \n  Oft.Origem_Taxa,  \n  Tle.Nome\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Oferta_Taxa_Origem\" Sql=\"Select\nOft.Tipo_Recebimento,\n  Ofr.IdOferta_Frete,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  CASE Oft.Tipo_Recebimento \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Recebimento_Extenso,\n  CASE Oft.Tipo_Pagamento\n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Pagamento_Extenso,\n  Oft.Origem_Taxa,\n  Oft.Complemento,\n  Tle.Nome As Taxa,\n  Mrc.Sigla As Moeda_Recebimento,\n  Prc.Nome As Pessoa_Recebimento,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  mov_Proposta_Frete Pfr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nWhere\n  Atv.IdAtividade = :IdAtividade\nand\n  Oft.Exibir_Cliente=1\nand\n  Oft.Origem_Taxa=2  /*Origem*/\nand\n  Oft.Valor_Recebimento_Total is not Null\nOrder By\n  Tle.Nome\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Oferta_Taxa_Destino\" Sql=\"Select\n  Ofr.IdOferta_Frete,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  CASE Oft.Tipo_Recebimento \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Recebimento_Extenso,\n  CASE Oft.Tipo_Pagamento\n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Shipment'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Ofr.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Package'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  END as Tipo_Pagamento_Extenso,\n  Oft.Origem_Taxa,\n  Oft.Complemento,\n  Tle.Nome As Taxa,\n  Mrc.Sigla As Moeda_Recebimento,\n  Prc.Nome As Pessoa_Recebimento,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  mov_Proposta_Frete Pfr On Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nWhere\n  Atv.IdAtividade = :IdAtividade\nand\n  Oft.Exibir_Cliente=1\nand\n  Oft.Origem_Taxa=3 /*Destino*/\nand\n  Oft.Valor_Recebimento_Total is not Null\nOrder By\n  Tle.Nome\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Total_Cotacao_Moeda\" Sql=\"Select\n Ofrt.IdOferta_Frete,\n Stuff(Cast((Select ' + ' + Tmd.Moeda_Recebimento + ' ' + Format(Tmd.Valor, 'N', 'pt-br') From (Select\n    Ofr.IdOferta_Frete,\n    Mrc.Sigla as Moeda_Recebimento,\n    sum(Oft.Valor_Recebimento_Total) As Valor\n  From\n    mov_Oferta_Frete Ofr\n  Join\n    mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n      Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n        And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n        And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n        And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n        And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n        And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n          Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n          Or (Oft.Origem_Taxa = 1 /* Frete */)))\n  Join\n    cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\n  Left Outer Join\n    cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\n  Left Outer Join\n    mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n  Where\n    Oft.Exibir_Cliente = 1\n  and\n    Oft.Valor_Recebimento_Total <> 0\n  and\n    Ofr.IdOferta_Frete = Ofrt.IdOferta_Frete\n  Group By\n    Ofr.IdOferta_Frete,\n    Mrc.Sigla) As Tmd For Xml Path, Type).query('data(.)') As VarChar(Max)), 1, 2, '') As Total_Moeda\nFrom\n  mov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Proposta_Frete Pfr ON Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Oferta_Frete Ofrt ON Ofrt.IdProposta_Frete = Pfr.IdProposta_Frete\nWHERE\n  Atv.IdAtividade = :IdAtividade\" MasterSource=\"Oferta\" MasterFields=\"IdOferta_Frete\" LocalFields=\"IdOferta_Frete\">\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Rsp.Nome,\n  Rsp.Email as Email\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\n  And\n  Par.IdPapel_Projeto in (9)\" /*PRICING*/>\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Pfr.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<DataSet Name=\"Usuario\" Sql=\"\nSelect\n  Fcn.IdPessoa,\n  Fcn.Nome,\n  Fcn.EMail,\n  Fcn.Fone,\n  Cgo.Nome as Cargo\nFrom\n  (\n    Select Top 1\n      Cast(Valor As Integer) As IdUsuario\n    From\n      #Global_Var\n    Where\n      Variavel = 'IdUsuario'\n  ) Elg\nJOIN\n  vis_Funcionario Fcn ON Fcn.IdUsuario_Correspondente = Elg.IdUsuario\nLEFT OUTER JOIN\n  cad_Cargo Cgo ON Cgo.IdCargo = Fcn.IdCargo\">\n\n  <DataSet Name=\"Copia_Carbono\" Sql=\"Select\n  Rsp.Nome,\n  'pricing.airfreight@aglcargo.com' as Email\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\n  And\n  Par.IdPapel_Projeto in (9)\n  And\n  Rsp.IdPessoa in (72641 /*JEFFERSON PAVAN*/, 73200 /*REBBECA MOTA*/, 62154 /*GABRIEL AGUIAR*/)\" /*PRICING*/>\n\n  <DataSet Name=\"Destinario_pricing\" Sql=\"Select\n  CASE WHEN Rsp.IdPessoa = 44504/*THIAGO SOEIRO*/ Then 'thiago.soeiro@aglcargo.com; pricing.vas@aglcargo.com'\n  Else Rsp.Email End as Email\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\n  And\n  Par.IdPapel_Projeto in (13)\" /*PRICING*/>\n\n<html>\n<head>\n    <meta charset=\"utf-8\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <title>PROPOSTA COMERCIAL</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n</head>\n    <style type=\"text/css\">\n        * { box-sizing: border-box; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n        .border-table { border: 1px solid #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n        th { padding: 1px 4px; font-size: 14px; }\n        .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-cinza { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .text-center { text-align: center; vertical-align: middle; }\n        .logo-espacamento { padding: 16px 0; }\n        .text-left { text-align: left; }\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-white { color: white; }\n        .negrito { font-weight: bold; }\n        .negrito_Esquerda { font-weight: bold; text-align: left; }\n        .sem-negrito { font-weight: normal; }\n        .logo-assinatura { padding-right: 4px; border-right: 2px solid #204080; }\n        .td-contato { padding-left: 4px; }\n        .font-size-14 { font-size: 14pt; }\n        .font-size-11 { font-size: 11pt; }\n        .margin-bottom-5 { margin-bottom: 5px; }\n        .line-height-3 { line-height: 3px; }\n\n        .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n        .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda{ border-left:solid; border-color:#00<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">000; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    </style>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">; <Print Dataset=\"Destinario_pricing\" FieldName=\"Email\">; <Print Dataset=\"Oferta\" FieldName=\"Email_Pricing\">;<Print Dataset=\"Oferta\" FieldName=\"Email_Trucking\">;<Print Dataset=\"Proposta\" FieldName=\"Vendedor_Email\">\n\n[CC.Detail]\n<Print Dataset=\"Copia_Carbono\" FieldName=\"Email\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n\n[Subject.Header]\nCOTAÇÃO - <Print Dataset=\"Oferta\" FieldName=\"Tipo_Modalidade\"> - <Print Dataset=\"Proposta\" FieldName=\"Numero_Proposta\"> - <Print Dataset=\"Proposta\" FieldName=\"Cliente\"> - <Print Dataset=\"Oferta\" FieldName=\"Referencia_Cliente\">\n[Subject.Footer]\n\n[Report.Detail]\n<table class=\"cabecalho\" width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class = \"font-size-14 text-left\">COTAÇÃO PRICING</td>\n      <td rowspan=\"4\"class=\"text-right logo-espacamento\"><img src=\"https://i.imgur.com/vGq7aoI.png\"/></td>\n    </tr>\n  </table>\n    <br>\n    <br>\n\n    <SubReport NameField=\"Variavel_Instrucao\" NameSource=\"Oferta\">\n\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>REMARKS</span></td>\n      </tr>\n    </table>\n\n    <table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n        \n        <tr>\n            <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Obs_Remarks\"></td>\n        </tr>\n        <tr>\n            <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Remarks_Terrestre\"></td>\n        </tr>\n        <tr>\n            <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Remarks_Free_Time\"></td>\n        </tr>\n    </table>\n    <br>\n\n<table width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n          <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GENERAL INFORMATION</span></td>\n        </tr>\n        <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px;\">\n          <td colspan=\"5\" style=\"border-top-style:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\"></td>\n        </tr>\n</table>\n\n<table class=\"borda\" width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td width=\"15%\" class=\"negrito_Esquerda\">Customer:</td>\n        <td width=\"35%\"><Print Dataset=\"Proposta\" FieldName=\"Cliente\"></td>\n      </tr>\n      <SubReport NameField=\"Campos_Importador\" NameSource=\"Oferta\" DataSource=\"Oferta\">\n      <tr>\n        <td class=\"negrito_Esquerda\">Incoterm:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Incoterm\"></td>\n      </tr>\n      <tr>\n        <td width=\"15%\" class=\"negrito\">Pick-up address:</td>\n        <td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Local_Coleta\"></td>\n      </tr>\n\n<SubReport NameField=\"Condicao_Origem_Destino\" NameSource=\"Oferta\">\n\n       <tr>\n        <td width=\"10%\" class=\"negrito\">Final destination:</td>\n        <td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Destino_Final\"></td>\n       </tr>\n      <tr>\n        <td width=\"10%\" class=\"negrito\">Delivery address:</td>\n        <td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Local_Entrega\"></td>\n       </tr>\n       <tr>\n       <td class=\"negrito\">Tipo de Serviço da coleta:</td>\n       <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Servico_Coleta\"></td>\n      </tr>  \n      <tr>\n        <td class=\"negrito\">Cargo value:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Moeda_Mercadoria\"> <Print Dataset=\"Oferta\" FieldName=\"Valor_Mercadoria\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito_Esquerda\">Cargo description:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Mercadoria\"></td>\n      </tr>\n        <SubReport NameSource=\"Oferta\" NameField=\"Carga_Perigosa\">\n      <tr>\n          <td class=\"negrito\">Service Level:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Nivel_Servico\"></td>\n      </tr>\n      <tr>\n          <td class=\"negrito\">Stackable:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Carga_Empilhavel\"></td>\n      </tr>    \n            <tr>\n          <td class=\"negrito\">Tipo de Veículo:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Veiculo\"></td>\n      </tr>    \n            <tr>\n          <td class=\"negrito\">Necessidades Especiais:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Necessidades_Especiais\"></td>\n      </tr>    \n            <tr>\n          <td class=\"negrito\">Informações Complementares:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Informacoes_Complementares\"></td>\n      </tr>  \n                  <tr>\n          <td class=\"negrito\">Tipo de Serviço:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Servico\"></td>\n      </tr>  \n      <tr>\n          <td class=\"negrito\">NCM/HS CODE:</td>\n          <td><Print Dataset=\"Oferta\" FieldName=\"NCM_Descricao\"></td>\n      </tr>      \n      <tr>\n        <td class=\"negrito\">Temperature:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Tipo_Processo\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito\"><Print Dataset=\"Oferta\" FieldName=\"Titulo_Carga\"></td>\n        <!-- <td><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td> -->\n        <td style='<Print Dataset=\"Cargas\" FieldName=\"Estilo_Linha\">'>  <!--Alterado aqui para não buscar a linha quando tipo_carga=3-->\n    <Print Dataset=\"Cargas\" FieldName=\"Quantidade_Total\">\n      </td>\n      </tr>\n      <tr>\n        <td class=\"negrito\">Equipments:</td>\n        <td>\n            <Print Dataset=\"Equipamentos_Agrupados\" FieldName=\"Equipamento_Agrupado\"></Print>\n        </td>\n      </tr> \n      <tr>\n        <td class=\"negrito\">Gross weight total:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.000\"> Kg</td>\n      </tr>\n      <tr>\n        <td class=\"negrito\">Chargeable weight total:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Peso_Taxado\" DisplayFormat=\",0.000\"> Kg</td>\n      </tr>\n      <tr>\n        <td class=\"negrito\">CBM:</td>\n        <td><Print Dataset=\"Oferta\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.000\"> m³</td>\n      </tr>\n      \n\n    </table>\n    <br>\n    <SubReport NameField=\"Over_Agl\" NameSource=\"Oferta\">\n\n    <SubReport NameField=\"Tipo_Carga_Detalhe2\" NameSource=\"Oferta\">\n    <br>\n    <tr>\n    <td>\n        &nbsp;\n    </td>\n    </tr>\n    <table width=\"735\" cellspacing=\"0\">\n    <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n      <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>NCM DESCRIPTION</span></td>\n    </tr>\n  </table>\n  <table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n  <tr>\n      <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"NCM_Descricao\"></td>\n  </tr>\n  <tr>\n      <td>\n          &nbsp;\n      </td>\n  </tr>\n</table>\n    \n    [Oversized.Header]\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>OVERSIZED CARGO</span></td>\n      </tr>\n    </table>\n\n    [Oversized.Detail]\n    <table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n        <tr>\n            <td width=\"100%\"><Print Dataset=\"oversized_cargo\" FieldName=\"oversized_cargo\"></td>\n        </tr>\n        <tr>\n            <td>\n                &nbsp;\n            </td>\n        </tr>\n    </table>\n\n\n    <SubReport DataSet=\"Oferta\" NameSource=\"Oferta\" NameField=\"Tipo_Oferta\">\n\n<!-- SubReport por oferta da proposta -->\n[Ofertas.Detail]\n    <SubReport NameSource=\"Oferta\" NameField=\"Tipo_Oferta\">\n\n[Outros.Detail]\n  <br>\n    <!--SubReport NameSource=\"Oferta\" NameField=\"Tipo_Carga_Detalhe\" SkipWhenNoDetails=\"true\"-->\n    <SubReport Name=\"Aereo\" DataSet=\"Carga\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Despesas_Frete\" DataSet=\"Oferta_Taxa_Frete\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Despesas_Origem\" DataSet=\"Oferta_Taxa_Origem\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Despesas_Destino\" DataSet=\"Oferta_Taxa_Destino\" SkipWhenNoDetails=\"true\">\n    <SubReport Name=\"Resumo_Obs\" SkipWhenNoDetails=\"true\">\n\n<!-- SubReport Tipo_Carga_Detalhe = Aereo -->\n[Aereo.Header]\n    <br>\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n       <td Colspan=\"9\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">CARGO DETAILS:</td>\n      </tr> \n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Package</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Qty</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Lenght</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Width</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Height</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW unit</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW Total</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>CBM</span></td>\n        <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>C. weight total</span></td>\n      </tr>\n      </table>\n[Aereo.Detail]\n        <table width=\"735\" cellspacing=\"0\">\n          <tr>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Embalagem\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\" DisplayFormat=\",0.00\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Comprimento\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Largura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Altura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto_Unitario\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00\"> m³</td>\n              <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-bottom:solid; border-right:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Considerado\" DisplayFormat=\",0.00\"> Kg</td>\n          </tr>\n        </table>\n[Aereo.Footer]\n    </table>\n\n[Carga_Per.Detail]\n      <tr>\n        <td class=\"negrito_Esquerda\">DG Cargo:</td>\n        <td>UN: <Print Dataset=\"Oferta\" FieldName=\"Cl_Un\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito_Esquerda\">&nbsp;</td>  \n        <td>CLASS: <Print Dataset=\"Oferta\" FieldName=\"Cl_Class\"></td>\n      </tr>\n      <tr>\n        <td class=\"negrito_Esquerda\">&nbsp;</td>  \n        <td>PACKING GROUP: <Print Dataset=\"Oferta\" FieldName=\"Cl_Packing_Group\"></td>\n      </tr>\n    \n[Resumo_Obs.Detail] \n\n\n[Instrucoes_Cli.Detail] \n<table width=\"735\" cellspacing=\"0\">\n  <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n    <td colspan=\"1\" width=\"25%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>CLIENT INSTRUCTIONS</span></td>\n  </tr>\n</table>\n\n<table width=\"735\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    \n    <tr>\n        <td width=\"100%\"><Print Dataset=\"Oferta\" FieldName=\"Instrucoes_Cliente_Final\"></td>\n    </tr>\n</table>\n<br>\n\n\n\n[LCL.Header]\n    <br>\n    <table width=\"735\" cellspacing=\"0\">\n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n       <td Colspan=\"9\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">CARGO DETAILS:</td>\n      </tr> \n      <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Package</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\">Qty</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Lenght</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Width</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>Height</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW unit</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>GW Total</span></td>\n        <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>CBM</span></td>\n        <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center negrito\"><span>C. weight total</span></td>\n      </tr>\n      </table>\n[LCL.Detail]\n        <table width=\"735\" cellspacing=\"0\">\n<SubReport Name=\"Info_Carga_LCL\" Dataset=\"Carga\">\n        </table>\n[LCL.Footer]\n    </table>\n\n\n[Info_Carga_LCL.Detail]\n <tr>\n               <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Embalagem\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\" DisplayFormat=\",0.00\"></td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Comprimento\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Largura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Altura\" DisplayFormat=\",0.00\"> cm</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto_Unitario\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00\"> kg</td>\n              <td colspan=\"1\" width=\"8%\" style=\"border-left:solid; border-bottom:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00\"> m³</td>\n              <td colspan=\"1\" width=\"12%\" style=\"border-left:solid; border-bottom:solid; border-right:solid; border-top:solid; border-color:#CCCCCC; border-width: 1px 1px 1px 1px;\" class=\"text-center\"><Print Dataset=\"Carga\" FieldName=\"Peso_Considerado\" DisplayFormat=\",0.00\"> Kg</td>\n   </tr>\n[Info_Carga_LCL.Footer]\n\n\n[Origem_Destino_Padrao.Header]\n<tr>\n<td width=\"15%\" class=\"negrito\">Origin:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Origem\">/<Print Dataset=\"Oferta\" FieldName=\"Origem_Sigla\"></td>\n</tr>\n<tr>\n<td width=\"10%\" class=\"negrito\">Destination:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Destino\">/<Print Dataset=\"Oferta\" FieldName=\"Destino_Sigla\"></td>\n</tr>\n\n[Origem_Destino_Terrestre.Header]\n<tr>\n<td width=\"15%\" class=\"negrito\">Origin:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Origem_Terrestre\"></td>\n</tr>\n<tr>\n<td width=\"10%\" class=\"negrito\">Destination:</td>\n<td width=\"20%\"><Print Dataset=\"Oferta\" FieldName=\"Destino_Terrestre\"></td>\n</tr>\n\n[Carga.Header]\n<table width=\"550\">\n  <tr style=\"font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px; background: #315497; color: white;\">\n    <td class=\"negrito\" width=\"12%\">Tipo Embalagem</td>\n    <td class=\"negrito\" width=\"8%\">Quantidade</td>\n    <td class=\"negrito\" width=\"10%\">Comprimento</td>\n    <td class=\"negrito\" width=\"10%\">Largura</td>\n    <td class=\"negrito\" width=\"12%\">Altura</td>\n    <td class=\"negrito\" width=\"10%\">CBM</td>\n  </tr>\n[Carga.Detail]\n  <tr>\n    <td><Print DataSet=\"Carga\" FieldName=\"Embalagem\"></td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Comprimento\"> cm</td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Largura\"> cm</td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Altura\"> cm</td>\n    <td><Print DataSet=\"Carga\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.000\"> m³</td>\n  </tr>\n[Carga.Footer]\n</table>\n\n[Importador_LCL.Detail]\n<tr>\n  <td class=\"negrito_Esquerda\">Importador:</td>\n  <td><Print Dataset=\"Oferta\" FieldName=\"Importador\"></td>\n</tr>\n<tr>\n  <td class=\"negrito_Esquerda\">Importador CNPJ:</td>\n  <td><Print Dataset=\"Oferta\" FieldName=\"Importador_CNPJ\"></td>\n</tr>\n\n[Attach]\n<DataSet Name=\"Attach\" Sql=\"Select\n  Atv.IdAtividade,\n  Arq.Nome,\n  Arq.IdDados_Arquivo,\n  Atv.IdTarefa\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Arquivo Paa on Paa.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  arq_Arquivo Arq on Arq.IdArquivo = Paa.IdArquivo And Arq.IdArquivo_Grupo = 8 /*INTERNO*/\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n[Attach.Detail]\n<SubReport Name=\"Comprovantes\" Binary=\"True\">\n\n[Comprovantes.Name]\n<Print DataSet=\"Attach\" FieldName=\"Nome\">\n\n[Comprovantes.FileData.Id]\n<Print DataSet=\"Attach\" FieldName=\"IdDados_Arquivo\" Compressed=\"True\">\n\n\n\n\n[Report.Footer]\n<table width=\"735\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Modelo E-mail Processo.html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\ngetDate() as Data_Atual,\nLhs.IdLogistica_House,\nLhs.Numero_Processo,\nLhs.Referencia_Externa,\nLhs.Referencia_Cliente,\nLhs.Local_Entrega,\nLhs.Consignee,\nLhs.Local_Coleta,\nLhs.Data_Entrega,\nLhs.Conhecimentos,\nLhs.Quantidade_UN_Nacoes_Unidas as UN,\nLmm.Viagem_Navio As Numero_Viagem,\nLms.Data_Previsao_Desembarque,\nLms.Data_Previsao_Embarque,\nLms.Data_Desembarque,\nLms.Transit_Time,\nLms.Transit_Time_Maximo,\nCoalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\nCoalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\nLms.Numero_Reserva,\nLms.Numero_Conhecimento as Documento_Master,\nCln.Nome as Cliente1,\nCln.Cpf_Cnpj as Cliente_CNPJ,\nOfr.Numero_Oferta,\nEpt.Nome as Exportador,\nEpt.Correspondencia as Exportador_Correspondencia,\nImp.Nome as Importador,\nImp.Correspondencia as Importador_Correspondencia,\nNty.Nome as Notify,\nNty.Cpf_Cnpj as Notify_CNPJ,\nNty.Correspondencia as Notify_Correspondencia,\nOrg.Nome as Origem,\nOrg.Sigla as Origem_Sigla,\nDst.Nome as Destino,\nDst.Sigla as Destino_Sigla,\nDfn.Nome as Destino_Final,\nDfn.Sigla as Destino_Final_Sigla,\nCtr.Nome as Cia_Transporte,\nCtr.Correspondencia as Cia_Transporte_Corresp,\nCase\nWhen Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\nWhen Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\nWhen Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\nWhen Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\nend as Modalidade_Pagamento_House,\nNvi.Nome as Navio,\nCase\nWhen Lms.Tipo_Operacao = 1 Then Ago.Nome /*Importacao - Agente na origem*/\nWhen Lms.Tipo_Operacao = 2 Then Agd.Nome /*Exportacao - Agente no destino*/\nEnd as Agente,\nCase\nWhen Lhs.Carga_Perigosa = 1 Then 'CargaPerigosa'\nWhen Lhs.Carga_Perigosa != 1 Then 'CargaPerigosa2'\nEnd as Perigosa,\nMer.Nome as Mercadoria,\nLam.Numero_Voo,\nLhs.Metros_Cubicos,\nLhs.Peso_Liquido,\nLhs.Peso_Bruto,\nLhs.Peso_Cubado,\nLhs.Quantidade_Volumes,\nInc.Nome as Incoterm,\nLhs.Observacao,\nAga.Nome as Agencia_Maritima_Aerea,\nAga.Correspondencia as Agencia_MA_Correspondencia,\nTat.Nome as Terminal_Atracacao,\nTrt.Nome as Terminal_Redestinacao,\ncoalesce(Lhs.Data_Coleta,Lhs.Data_Previsao_Coleta) as Data_Coleta,\ncoalesce(Lhs.Data_Entrega,Lhs.Data_Previsao_Entrega) as Data_Entrega,\nDdd.Valor_Data as Deadline_Draft_Cliente,\nDdg.Valor_Data as Deadline_Goods_Cliente,\nDls.Valor_Data as Deadline_SD\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\nmov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\nmov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\nmov_Logistica_Aerea_House Lah on Lah.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\ncad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\ncad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\ncad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\ncad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\ncad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\ncad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\ncad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\ncad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\ncad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\ncad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\ncad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\ncad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\nmov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\nvis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\nmov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\nLeft Outer Join\ncad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\ncad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\nvis_Logistica_Prazo Ddd on Ddd.IdLogistica_House = Lhs.IdLogistica_House And Ddd.IdConfiguracao_Campo_Livre = 1\nLeft Outer Join\nvis_Logistica_Prazo Ddg on Ddg.IdLogistica_House = Lhs.IdLogistica_House AND Ddg.IdConfiguracao_Campo_Livre = 11\nLeft Outer Join\nvis_Logistica_Prazo Dls on Dls.IdLogistica_House = Lhs.IdLogistica_House And Dls.IdConfiguracao_Campo_Livre = 13\nWhere\nAtv.IdAtividade=:IdAtividade\">\n<DataSet Name=\"Item_Carga\" Sql=\"Select\nLhs.IdLogistica_House,\nLmc.Number As Numero_Cntr,\nLmc.Quantity,\nEmr.Descricao as Tipo_Cntr,\ncoalesce(Lmc.Type_Packages, Emb.Nome) As Tipo_Embalagem\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nLeft Outer Join\ncad_Tipo_Embalagem_Container Tec on Tec.IdTipo_Embalagem_Container = Lmc.IdTipo_Embalagem_Container\nLeft Outer Join\ncad_Serpro_Tipo_Embalagem Emb on Emb.IdSerpro_Tipo_Embalagem = Tec.IdSerpro_Tipo_Embalagem\nWhere\nAtv.IdAtividade = :IdAtividade\">\n<DataSet Name=\"Carga\" Sql=\"Select\nLhs.IdLogistica_House,\nLme.Quantidade,\nLme.Free_Time_Master_Origem,\nLme.Free_Time_House_Origem,\nLme.Free_Time_Master_Destino,\nLme.Free_Time_House_Destino,\nEmr.Descricao as Cntr\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Escala\" Sql=\"Select\nLhs.IdLogistica_House,\nLae.viagem_voo,\nLae.Observacao\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Viagem Lae on Lae.IdLogistica_House = Lhs.IdLogistica_House\nWhere\nAtv.IdAtividade = :IdAtividade\">\n<DataSet Name=\"Contato_Comercial\" Sql=\"Select\nRsp.Nome,\nRsp.EMail\nFrom\nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\ncad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd\nPar.IdPapel_Projeto in (3)\" /*Comercial*/>\n<DataSet Name=\"Inside_Sales\" Sql=\"Select\nPss.Email,\nAtv.IdProjeto_Atividade,\nPss.IdPessoa\nFrom\nmov_Atividade Atv\nJoin\ncad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\nmov_Projeto_Atividade_Responsavel Par on Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\ncad_Pessoa Pss on Pss.IdPessoa = Par.IdResponsavel\nAnd\n(NullIf(LTrim(Pss.Email), '') Is Not Null)\nWhere\nAtv.IdAtividade = :IdAtividade AND Par.IdPapel_Projeto = 4\">\n<DataSet Name=\"Transbordo_OLD\" Sql=\"Select\nLhs.IdLogistica_House,\nLmt.Viagem,\nLmt.Data_Desembarque,\nLmt.Data_Embarque,\nPtr.Nome as Porto_Transbordo,\nPds.Nome as Porto_Desembarque,\nNvi.Nome as Navio_Transbordo\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\nmov_Logistica_Maritima_Transbordo Lmt on Lmt.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\ncad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\ncad_Origem_Destino Pds on Pds.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\ncad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\nWhere\nAtv.IdAtividade = :IdAtividade\nOrder by\nLmt.Data_Chegada Desc\">\n<DataSet Name=\"Transbordo\" Sql=\"Select\nLhs.IdLogistica_House,\nTrb.Viagem,\nTrb.Data_Chegada,\nTrb.Data_Desembarque,\nTrb.Data_Embarque,\nTrb.Porto_Transbordo,\nTrb.Navio_Transbordo,\nTrb.Porto_Desembarque,\ncoalesce(Trb.Navio_Transbordo,Nvi.Nome) As Navio_Chegada,\ncoalesce(Trb.Viagem,Lmm.Viagem_Navio) As Viagem_Chegada\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\nmov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\ncad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join(\nSELECT\nLgv.IdLogistica_Viagem,\nLgv.IdLogistica_House,\nNvi.Nome as Navio_Transbordo,\nLgv.Data_Embarque,\nVan.Data_Previsao_Desembarque AS Data_Previsao_Chegada,\nVan.Data_Desembarque AS Data_Chegada,\nLgv.Viagem_Voo as Viagem,\nLgv.Data_Desembarque,\nOrg.Nome as Porto_Transbordo,\nDst.Nome as Porto_Desembarque\nFROM\nmov_Logistica_Viagem Lgv\nJOIN\nmov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Sequencia - 1\nLeft Outer Join\ncad_Navio Nvi on Nvi.IdNavio = Lgv.IdNavio\nLeft Outer Join\ncad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\nLeft Outer Join\ncad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\nWhere\nLgv.Tipo_Viagem = 5 /*Transbordo Escala*/) Trb on Trb.IdLogistica_House = Lhs.IdLogistica_House\nWhere\nAtv.IdAtividade = :IdAtividade\nOrder by\nTrb.IdLogistica_Viagem Desc\">\n<DataSet Name=\"Contatos\" Sql=\"SELECT\nPcn.Email\nFROM\nmov_Atividade Atv\nJOIN\ncad_Modelo_Mensagem Mmn ON Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJOIN\nmov_Projeto_Atividade_Contato Pac ON Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nJOIN\ncad_Pessoa_Contato Pcn ON Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato\nAND (NULLIF(LTRIM(Pcn.Email), '') IS NOT NULL)\nJOIN\nmov_Projeto_Atividade_Grupo_Envio Pge ON Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAND Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWHERE\nAtv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"email\" Sql=\"SELECT \ncase\nwhen Lms.Modalidade_Processo = 1 /*AEREO*/ and Lms.Tipo_Operacao = 1 /*EXPORTAÇÃO*/ then 'cs.air@aglcargo.com'\nwhen Lms.Modalidade_Processo = 1 /*AEREO */ and Lms.Tipo_Operacao = 2 /*IMPORTAÇÃO*/ then 'cs.air@aglcargo.com'\nwhen Lms.Modalidade_Processo = 2 /*MARITIMO*/ and Lms.Tipo_Operacao = 1 /*EXPORTAÇÃO*/ then 'ocean.export@aglcargo.com'\nwhen Lms.Modalidade_Processo = 2 /*MARITIMO*/ and Lms.Tipo_Operacao = 2 /*IMPORTAÇÃO*/ then 'ocean.import@aglcargo.com'\nend as Email_Operacao,\nLhs.IdLogistica_House,\nLms.Modalidade_Processo,\nLms.Tipo_Operacao\nFROM\n\tmov_Atividade Atv\n\tLeft Outer Join\n\tmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n\tLeft Outer Join\t\n\tMov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n\tWHERE\nAtv.IdAtividade = :IdAtividade\">\n\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<title>Booking</title>\n</head>\n<style type=\"text/css\">\nbody,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt;}\n.topo{ text-align:center; font-size:16.0pt; font-weight:800}\n.negrito{ font-weight:600;}\n.negrito_16{ font-weight:600; font-size:16.0pt;}\n.negrito_13{ font-weight:600; font-size:13.0pt;}\n.negrito_vermelho{ font-weight:600; color:#FF0000;}\n.negrito_vermelho_sublinhado{ font-weight:600; color:#FF0000; text-decoration: underline;}\n.negrito_vermelho_16{ font-weight:600; color:#FF0000; font-size:16.0pt;}\n.vermelho{ color:#FF0000}\n.fundo{ color:#FFFFFF; font-weight:600; background:#000000; font-size:11.0pt;}\n.sublinhado { text-decoration:underline; font-weight:600;}\n.justifica_Texto {text-align:justify; font-style:italic; font-size:11.0pt;}\n.justifica_Texto_8 {text-align:justify; font-style:italic; font-size:8.0pt;}\n.borda_linha {border:solid; border-color:#000000 #000000 #000000 #000000; border-width: 8px 2px 0px 2px;}\n.borda{ border-style:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_cima{ border-top-style:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_baixo{ border-bottom:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_direita{ border-right:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_direita_cima{ border-right:solid; border-top:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_esquerda{ border-left:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#000000; border-width: 2px 2px 2px 2px}\n.borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#000000; border-width: 2px 2px 2px 2px}\n</style>\n<body>\n[Address.Detail]\n\n<Print Dataset=\"email\" FieldName=\"Email_Operacao\">\n\n[Contatos.AfterPrior]\n;\n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n[CC.Detail]\ncs.air@aglcargo.com\n\n[Subject.Header] <!--Assunto do E-mail -->\nCONFIRMAÇÃO DE CHEGADA -  Ref. Externa <Print Dataset=\"Processo\" FieldName=\"Referencia_Externa\"> PROCESSO: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - PROPOSTA: <Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\">\n\n[Subject.Footer]\n\n[Report.Detail] <!--Corpo de mensagem-->\n<table width=\"775\">\n<tr>\n<td align=\"left\" colspan=\"3\"><br><img src=\"https://i.imgur.com/calnpEp.png\"><br><br></td>\n</tr>\n<tr>\n  <td colspan=\"3\">\n    <span class=\"sublinhado\"> CONFIRMAÇÃO DE CHEGADA EXPORTAÇÃO </span><br>\n  </td>\n</tr>\n\n<tr>\n  <td colspan=\"3\">\n    Olá,\n    Segue a confirmação de desembarque da carga do <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\">\n  </td>\n</tr>\n\n</table>\n</body>\n</html>\n<table>\n<tr>\n</table>\n</tr>\n</table>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\OPE - EA - CONFIRMAÇÃO DE CHEGADA # 46049.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Transit_Time,\n  Lms.Transit_Time_Maximo,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n  End as Agente,\n  Lhs.NCM_Descricao,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue,\n  CASE\n  WHEN Eqm.Tipo = 1 THEN 'Container 20'''\n  WHEN Eqm.Tipo = 2 THEN 'Container 40'''\n  WHEN Eqm.Tipo = 3 THEN 'Carreta'\n  END AS Tipo_Equipamento\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Frete_Conhecimento\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Mpg.Sigla as Moeda_Pagamento,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 1 /*Frete*/\nAnd\n  Ltx.Exibir_Conhecimento = 1\nAnd\n  Ltx.Receber_De not in (0) /*Sem cobrança*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Origem_Conhecimento\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 2 /*Origem*/\nAnd\n  Ltx.Exibir_Conhecimento = 1\nAnd\n  Ltx.Receber_De not in (0) /*Sem cobrança*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Destino_Conhecimento\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 3 /*Destino*/\nAnd\n  Ltx.Exibir_Conhecimento = 1\nAnd\n  Ltx.Receber_De not in (0) /*Sem cobrança*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Fatura_Agente\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then '/ Processo'/*Peso Cubado*/\n    When 3 Then '/ Kg'/*Peso Cubado*/\n    When 4 Then '/ Kg'/*Peso Taxado*/\n    When 5 Then '/ Kg'/*Peso Bruto*/\n    When 6 Then '/ CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then '/ AWB' When 2 then '/ BL'  else NULL end\n    When 8 Then '/ Invoice'\n    When 9 Then '/ Volume'\n    When 10 Then '/ Cntr' /*Equipamento*/\n    When 11 Then '/ ' + Emr.Descricao\n    When 12 Then '/ TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then '/ Via Master'\n    When 16 Then '/ Via house'\n    When 17 Then '/ Kg'/*Peso Considerado*/\n    When 18 Then '/ Kg' /*Peso taxado master*/\n    When 19 Then '/ Carreta'\n    When 20 Then '/ U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Exibir_Agente = 1\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n<html>\n<head>\n<style>\n        * { box-sizing: border-box; }\n    body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n    td { padding: 2px }\n    th { padding: 1px 4px; font-size: 13px; }\n    .tamanho-linha { line-height: 3px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .espaco_interno_tabela { padding: 12px 20px; }\n    .alinhamento_esquerda { text-align: left; }\n    .alinhamento_topo { vertical-align: top; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .assinatura { padding-left: 28px; }\n    .altura-linha { line-height: 3px; }\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#00<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">000; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n\n</head>\n<body>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\ngabriel.lopez@navcomlogistics.com.br\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nCONFIRMAÇÃO DE CHEGADA - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"> - PROCESSO: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> / <Print Dataset=\"Processo\" FieldName=\"Destino\">\n[Subject.Footer]\n\n[Report.Detail]\n\n<span>\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  \n      <tr>\n    \n        <td class=\"cabecalho\">CONFIRMAÇÃO DE CHEGADA - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"></td>\n  \n      </tr>\n    \n     </table>\n</span>\n<br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n        <td colspan=\"3\" class=\"altura-linha\">&nbsp;</td>\n    </tr>\n    <tr>\n        <td rowspan=\"6\" width=\"50%\" class=\"espaco_interno_tabela\">\n            <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\">\n        </td>\n    </tr>\n    <tr>\n        <td width=\"12%\" class=\"negrito\">REFERÊNCIA:</td>\n        <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">CLIENTE:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">DATA:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">REF. CLIENTE:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n    </tr>\n    <tr>\n        <td colspan=\"3\" class=\"altura-linha\">&nbsp;</td>\n    </tr>\n</table>\n<br>\nPrezado(a) <Print Dataset=\"Processo\" FieldName=\"Cliente\">,\n<br><br>\nPor gentileza notar confirmação de chegada:\n<br><br>\n\n\n<table class=\"borda\" width=\"775\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr>\n        <td width=\"50%\" colspan=\"2\" class=\"negrito alinhamento_topo\">EXPORTADOR:</td>\n        <td width=\"50%\" colspan=\"2\" class=\"negrito alinhamento_topo\">IMPORTADOR:</td>\n    </tr>\n    <tr>\n        <td width=\"45%\" class=\"alinhamento_topo\" colspan=\"2\">\n            <Print Dataset=\"Processo\" FieldName=\"Exportador_Correspondencia\">\n        </td>\n        <td width=\"45%\" class=\"alinhamento_topo\" colspan=\"2\">\n            <Print Dataset=\"Processo\" FieldName=\"Importador_Correspondencia\">\n        </td>\n    </tr>\n    <tr>\n      <td width=\"20%\" class=\"negrito\">LOCAL DE RECEBIMENTO:</td>\n      <td width=\"30%\"><Print Dataset=\"Processo\" FieldName=\"Local_Recebimento\"></td>\n      <td width=\"15%\" class=\"negrito\">ORIGEM</td>\n      <td width=\"35%\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">DESTINO</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n        <td class=\"negrito\">DESTINO FINAL:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Destino_Final\"></td>\n        \n    </tr>\n    <tr>\n        <td class=\"negrito\">MODALIDADE DE FRETE:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n        <td class=\"negrito\">INCOTERM:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">MAWB:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n        <td class=\"negrito\">HAWB:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n    </tr>\n</table>\n\n<br>\n\n<img src=\"https://i.imgur.com/VhqCQBQ.png\" width=\"775\">\n\n<br>\n<table width=\"775\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr>\n        <td width=\"17%\" class=\"negrito\">Aeroporto de Origem:</td>\n        <td width=\"43%\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n        <td width=\"20%\" class=\"negrito\">Aeroporto de Destino:</td>\n        <td width=\"20%\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">Data de embarque:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n        <td class=\"negrito\">Confirmação de chegada:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\"></td>\n    </tr>\n    <tr>\n        <td class=\"negrito\">Cia Aérea</td>\n        <td>\n          <Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\">\n        </td>\n        <td class=\"negrito\">Transit Time:</td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Transit_Time\"> dias</td>\n    </tr>\n</table>\n<br>\n\n<table width=\"775\">\n  <tr>\n    <td>\n      Agradecemos a confiança em nossos serviços e ficamos à disposição para eventuais oportunidades.\n    </td>\n  </tr>\n</table>\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td colspan=\"2\" style=\"background-color: rgb(0, 39, 51); text-align:center; padding:2px 0;\">\n      <span style=\"font-weight:bold; font-size:15px; color: rgb(219, 242, 38)\">HISTÓRICO</span>\n    </td>\n  </tr>\n\n  <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"1\">\n  <tr>\n    <td colspan=\"6\" height=\"3\"></td>\n  </tr>\n</table>\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Follow_Outros.Detail]\n<tr>\n  <td valign=\"top\" width=\"20%\" style=\"padding-bottom:10px; border-bottom:2px solid rgb(0, 39, 51);\">\n    <Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\">\n  </td>\n\n  <td valign=\"top\" width=\"80%\"\n      style=\"padding-bottom:10px; border-bottom:2px solid rgb(0, 39, 51);\">\n    <Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\">\n  </td>\n</tr>\n\n<tr><td colspan=\"2\" style=\"height:10px;\"></td></tr>\n\n\n[Report.Footer]\n\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\OPE - IM - FOLLOW UP (WAREHOUSE)#45240 bkp.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'MARITIME EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'MARITIME IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\nAcm.IdAcompanhamento,\nAcm.Data,\nAcm.Descricao,\nAcm.Tipo,\nRsp.Nome as Responsavel\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\ncad_Modelo_Mensagem Mmn ON Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLeft Outer Join\ncad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd\nAcm.Tipo = 1\nAnd\nMmn.IdGrupo_Envio_Mensagem = Acm.IdGrupo_Envio_Mensagem\nORDER BY\nAcm.Data DESC,\nAcm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n    Pcn.Email,\n    Atv.IdProjeto_Atividade\nFrom\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLEFT OUTER JOIN\n    mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    cad_Pessoa Psa ON Psa.IdPessoa = Lhs.IdTransportadora_Destino\nLEFT OUTER JOIN\n  cad_Pessoa_Contato Pcn on Pcn.IdPessoa = Psa.IdPessoa\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nLEFT OUTER JOIN\n  cad_Contato_Grupo_Envio Cge ON Cge.IdPessoa_Contato = Pcn.IdPessoa_Contato\nWhere\n  Mmn.IdGrupo_Envio_Mensagem = Cge.IdGrupo_Envio_Mensagem\nAND\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <title>Page Title</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\nshipping@bosswoodproducts.com\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nBOSS WOOD PRODUCTS - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - FOLLOW-UP\n[Subject.Footer]\n\n[Report.Detail]\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n    </tr>\n  </table>\n</span>\n  <br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td rowspan=\"6\" width=\"50%\" class=\"text-center logo-espacamento\"><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n    <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n    <td width=\"38%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n  <tr>\n      <td width=\"12%\" class=\"negrito\">REFERENCE:</td>\n      <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">DATE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td class=\"negrito\">HBL:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"negrito\">VESSEL/VOY:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  <tr>\n      <td class=\"negrito\">ORIGIN:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"negrito\">DESTINATION:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">ETD:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">ETA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">ATD:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">ATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">CARRIER:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n      <td class=\"negrito\">FREIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">GOODS:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"negrito\">GROSS WEIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td>           \n  </tr>\n  <tr>\n      <td class=\"negrito\">PACKAGES:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n      <td class=\"negrito\">M3:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">COINTAINERS:</td>\n    <td><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\">BOOKING:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n  </tr>\n</table>\n\n<SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Detalhe\">\n\n<tr>\n  <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n</tr>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td class=\"cor-fundo-2 borda_sem_direita\" width=\"20%\"><span class=\"negrito\">DATE</span></td>\n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"80%\"><span class=\"negrito\">DESCRIPTION</span></td>\n      </tr>\n      <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n      <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      <tr>\n        <td colspan=\"6\" heigth=\"3\"></td>\n      </tr>\n    </table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n[FCL.Detail]\n<table width=\"775\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr class=\"cor-fundo_cor-fonte-white\">   \n        <td class=\"negrito\">QUANT.</td>\n        <td class=\"negrito\">EQUIPMENT</td>\n        <td class=\"negrito\">FREE TIME</td>        \n    </tr>\n    <br>\n  <Subreport Dataset=\"Carga\" Name=\"Equipamentos\">\n</table>\n\n[Equipamentos.Detail]\n<tr>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> Days</td>\n</tr>\n\n[Report.Footer]\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\OPE - IM - FOLLOW UP (WAREHOUSE)#45240.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'MARITIME EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'MARITIME IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\nAcm.IdAcompanhamento,\nAcm.Data,\nAcm.Descricao,\nAcm.Tipo,\nRsp.Nome as Responsavel\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\ncad_Modelo_Mensagem Mmn ON Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLeft Outer Join\ncad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd\nAcm.Tipo = 1\nAnd\nMmn.IdGrupo_Envio_Mensagem = Acm.IdGrupo_Envio_Mensagem\nORDER BY\nAcm.Data DESC,\nAcm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n    Pcn.Email,\n    Atv.IdProjeto_Atividade\nFrom\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLEFT OUTER JOIN\n    mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    cad_Pessoa Psa ON Psa.IdPessoa = Lhs.IdTransportadora_Destino\nLEFT OUTER JOIN\n  cad_Pessoa_Contato Pcn on Pcn.IdPessoa = Psa.IdPessoa\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nLEFT OUTER JOIN\n  cad_Contato_Grupo_Envio Cge ON Cge.IdPessoa_Contato = Pcn.IdPessoa_Contato\nWhere\n  Mmn.IdGrupo_Envio_Mensagem = Cge.IdGrupo_Envio_Mensagem\nAND\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <title>Page Title</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\nshipping@bosswoodproducts.com\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nINVOICE FATURAMENTO - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> -<Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\">\n[Subject.Footer]\n\n[Report.Detail]\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n    </tr>\n  </table>\n</span>\n  <br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td rowspan=\"6\" width=\"50%\" class=\"text-center logo-espacamento\"><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n    <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n    <td width=\"38%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n  <tr>\n      <td width=\"12%\" class=\"negrito\">REFERENCE:</td>\n      <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> / <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n        \n  </tr>\n  <tr>\n      <td class=\"negrito\">DATE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td class=\"negrito\">HBL:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"negrito\">VESSEL/VOY:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  <tr>\n      <td class=\"negrito\">ORIGIN:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"negrito\">DESTINATION:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">ETD:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">ETA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">ATD:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">ATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">CARRIER:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n      <td class=\"negrito\">FREIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">GOODS:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"negrito\">GROSS WEIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td>           \n  </tr>\n  <tr>\n      <td class=\"negrito\">PACKAGES:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n      <td class=\"negrito\">M3:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">COINTAINERS:</td>\n    <td><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\">BOOKING:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n  </tr>\n</table>\n\n\n<table width=\"775\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr class=\"cor-fundo_cor-fonte-white\">   \n        <td class=\"negrito\">PRAZO INVOICE</td>      \n    </tr>\n     <td> &nbsp </td>\n    <tr>\n        <td style=\"font-size: 18px;\"><span style=\"background-color: #ffd900; padding: 2px 5px; color: #000000;\">\n        MAX 48HRS APÓS ATD </span></td>       \n    </tr>\n     <td> &nbsp </td>\n</table>\n\n<SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Detalhe\">\n<tr>\n  <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n</tr>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n        <td class=\"cor-fundo-2 borda_sem_direita\" width=\"33%\">\n            <span class=\"negrito\">DIMENSÕES</span>\n        </td>\n        \n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"33%\" style=\"border-right: none !important;\">\n            <span class=\"negrito\">QUANTIDADE</span>\n        </td>\n        \n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"34%\" style=\"border-left: none !important;\">\n            <span class=\"negrito\">NET WEIGHT</span>\n        </td>\n    </tr>\n\n    <tr>\n        <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n        <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td> \n    </tr>\n\n    <tr>\n        <td colspan=\"6\" height=\"3\"></td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n<!-- [FCL.Detail]\n<table width=\"775\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr class=\"cor-fundo_cor-fonte-white\">   \n        <td class=\"negrito\">QUANT.</td>\n        <td class=\"negrito\">EQUIPMENT</td>\n        <td class=\"negrito\">FREE TIME</td>        \n    </tr>\n    <br>\n  <Subreport Dataset=\"Carga\" Name=\"Equipamentos\">\n</table> -->\n\n[Equipamentos.Detail]\n<tr>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> Days</td>\n</tr>\n\n[Report.Footer]\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Processo cancelado aviso.html",
        "conteudo": "[Report.Header]\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n<title>Proposta</title>\n\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Mmr.Sigla as Moeda_Mercadoria,\n  Lhs.Valor_Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao as Observacao_Processo,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Moeda Mmr ON Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\nRsp.Nome,\nRsp.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\ncad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd  \nPar.IdPapel_Projeto = 5\">\n\n<DataSet Name=\"Vendedor\" Sql=\"\nSELECT top 1\nVen.Nome,\nVen.Email\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\ncad_Pessoa Ven on Ven.IdPessoa = Lhs.IdVendedor\nWhere\nAtv.IdAtividade = :IdAtividade\"></DataSet>\n\n\n<DataSet Name=\"Contato_Vend_Resp\" Sql=\"Select top 1\nRsp.Nome,\nRsp.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nleft outer join\nmov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Par.IdProjeto_Atividade\nleft outer join\ncad_Pessoa Rsp on Rsp.IdPessoa = Pfr.IdResponsavel\nWhere\nAtv.IdAtividade =:IdAtividade\">\n\n\n<DataSet Name=\"Contato_Pricing\" Sql=\"SELECT \n\tFnc.EMail as Responsavel_EMail,\n  CASE\n  WHEN Org.IdOrigem_Destino_Grupo IN (1,2,8,11,14,15,16) THEN 'vitor.buchele@texshipping.com'\n  WHEN Org.IdOrigem_Destino_Grupo IN (10,12) THEN 'jessica.delgado@texshipping.com'\n  else Fnc.EMail\n  END as Contato_Grupo_Origem\nFROM \n  mov_Atividade Atv\nLEFT OUTER JOIN \n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLEFT OUTER JOIN\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Ofr.IdOrigem\nLEFT OUTER JOIN\n\tmov_Projeto_Atividade_Responsavel Par ON Par.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tvis_Funcionario Fnc ON Fnc.IdPessoa = Par.IdResponsavel\nLEFT OUTER JOIN\n\tcad_Papel_Projeto Ppr ON Ppr.IdPapel_Projeto = Par.IdPapel_Projeto\nWHERE\nPpr.IdPapel_Projeto = 5 /*PRICING*/\nAND\nAtv.IdAtividade =:IdAtividade\">\n\n\n<DataSet Name=\"Contato_INSIDE_SALES\" Sql=\"Select\nRsp.Nome,\nRsp.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\ncad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd  \nPar.IdPapel_Projeto = 11\">\n\n\n<DataSet Name=\"Contato_Vendedor\" Sql=\"Select top 1\nVen.Nome,\nVen.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nleft outer join\nmov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Par.IdProjeto_Atividade\nleft outer join\ncad_Pessoa Ven on Ven.IdPessoa = Pfr.IdVendedor\nWhere\nAtv.IdAtividade =:IdAtividade\">\n\n\n<DataSet Name=\"Contatos_Coord_Analista\" Sql=\"SELECT \nCASE \nWHEN Oft.Tipo_Operacao = 2 /*Importação*/ AND Oft.Modalidade_Processo = 2 /*maritimo*/ THEN 'joao.becker@texshipping.com;'\nELSE ''\nEND AS Coordenador_Procurement,\nCASE \nWHEN Oft.Modalidade_Processo = 1 /*Aéreo*/ AND (Oft.Tipo_Operacao = 2 /*Importação*/ OR Oft.Tipo_Operacao = 1) /*Exportação*/ THEN 'gabriela.sandri@texshipping.com; marina.tomasoni@texshipping.com;'\nELSE ''\nEND AS Coordenador_Pricing,\nCASE \nWHEN Oft.Tipo_Operacao = 1 /*Exportação*/ AND Oft.Modalidade_Processo = 2 /*Marítimo*/ THEN 'elaine.costa@texshipping.com;'\nELSE ''\nEND AS Coordenador_Pricing_Expo\nFrom \nmov_Atividade Atv\nLEFT OUTER JOIN\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN \nmov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Par.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Oferta_Frete Oft ON Oft.IdProposta_Frete = Pfr.IdProposta_Frete\nWHERE \nAtv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7,\n  Ems.Campo_Livre8,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10,\n  Ems.Campo_Livre11,\n  Ems.Campo_Livre12,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Pfr.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<style type=\"text/css\">\nbody,td,tr{ color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; text-align:justify}\n.p_instrucoes{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:8.5pt; text-align:justify}\n.topo{ text-align:center; font-size:18px; font-weight:600; color:#FF0000}\n.negrito{ font-weight:600;}\n.vermelho{ color:#FF0000; font-weight:600;}\n.fundo{ color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; font-weight:600; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; font-size:11.0pt;}\n.tabela_taxa_titulo{ color:#000000; font-weight:600; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size:11.0pt; border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.tabela_taxa{ color:#000000; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size:11.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda{ border-left:solid; border-right:solid; border-bottom:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n</head>\n<align=\"left\" table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n   \n</table>\n<body>\n[Address.Detail]\n<Print Dataset=\"Contato_INSIDE_SALES\" FieldName=\"EMail\">; <Print Dataset=\"Vendedor\" FieldName=\"Email\">\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"EMail\">\n\n[Subject.Header]\nCANCELAMENTO DO PROCESSO – REF: '<Print Dataset=\"Processo\" FieldName=\"Numero_Processo\">' - Refe. Cliente: '<Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\">'\n[Subject.Footer]\n[Report.Detail]\n<table width=\"600\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n        <td>\n            <br>\n            <p class=\"negrito\" style=\"font-size: 14pt;\">Olá,</p>\n            <p>Informamos que houve uma atualização no status do seu processo.</p>\n            <br>\n            \n            <!-- Tabela com a classe borda_linha para dar destaque no topo com a cor do sistema -->\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"10\">\n                <tr>\n                    <td class=\"borda_linha\" bgcolor=\"#f9f9f9\">\n                        <span class=\"p_instrucoes\">NÚMERO DO PROCESSO</span><br>\n                        <span class=\"negrito\" style=\"font-size: 16pt;\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></span>\n                    </td>\n                </tr>\n                <tr>\n                    <!-- Usa borda_direita_esquerda_baixo para fechar a caixa iniciada acima -->\n                    <td class=\"borda_direita_esquerda_baixo\">\n                         <p class=\"negrito\">Status: Cancelado</p>\n                         <br>\n                         <p class=\"negrito\">Motivo:</p>\n                         <p><Print Dataset=\"Processo\" FieldName=\"Observacao_Processo\"></p>\n                    </td>\n                </tr>\n            </table>\n            \n    </td>\n    </tr>\n</table>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROJETO 2019 - AVISO ABERTURA DE PROCESSO EM - EXALOG  #45130.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lms.Data_Processo,\n  Coalesce(Lmm.Viagem_Navio,Vnv.Numero) as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Nome_Fantasia AS Cliente_Fantasia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Nome_Fantasia As Shipper_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Nome_fantasia As Consignee_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Lrc.Nome as Local_Recebimento,\n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Lmd.Lucro_Estimado As Lucro_Estimado,\n  Mlc.Sigla as Sigla_Lucro,\n  Com.Nome As Tabela_Recebimento,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente no destino*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 1 Then 'Exportação Aérea'\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 2 Then 'Exportação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 1 Then 'Importação Aérea'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 2 Then 'Importação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 3 Then 'Importação Terrestre'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 1 Then 'Nacional Aérea'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 2 Then 'Nacional Marítima'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 3 Then 'Nacional Terrestre'\n  End as Tipo_Modalidade,\n  CASE\n    WHEN Lhs.Tipo_Carga = 0 THEN '(Não especificado)'\n    WHEN Lhs.Tipo_Carga = 1 THEN 'Aéreo'\n    WHEN Lhs.Tipo_Carga = 2 THEN 'Break-Bulk'\n    WHEN Lhs.Tipo_Carga = 3 THEN 'FCL'\n    WHEN Lhs.Tipo_Carga = 4 THEN 'LCL'\n    WHEN Lhs.Tipo_Carga = 5 THEN 'RO-RO'\n    WHEN Lhs.Tipo_Carga = 6 THEN 'Rodoviário'\n  END AS Tipo_Carga,\n  Mer.Nome as Mercadoria,\n  Lhs.NCM_Descricao,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lhs.Instrucoes_Cliente,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Vnd.Nome as Vendedor,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Lhs.Instrucoes_Operacional,\n  Lhs.Instrucoes_Financeiro,\n  Lhs.Instrucoes_Agente,\n  Ofr.Margem_Cambio_Recebimento as Margem_Recebimento,\n  Ofr.Observacao As Observacao_Comercial,\n  Des.Nome_Fantasia as Despachante,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Lhs.Valor_Mercadoria,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Lhs.Instrucoes_Operacional_Cliente,\n  Ofr.Numero_Oferta,\n  Pfr.Data_Aprovacao As Data_Aprovacao,\n  Mpr.Sigla As Moeda_Processo,\n  Sgd.Nome As Seguradora,\n  Ofr.Data_Validade As Data_Validade,\n  Case\n    When Rfn.IdConversao_Moeda = 1 Then 'PTAX'\n    When Rfn.IdConversao_Moeda = 2 Then 'Abertura'\n  END As Tabela_Recebimento,\n  Ctf.Numero_Contrato,\n  CASE \n  WHEN Ofr.Master_Direto = 0 THEN 'Não'\n  WHEN Ofr.Master_Direto = 1 THEN 'Sim'\n  END AS Master_Direto,\n  CASE\n  WHEN Ofr.Master_Direto = 0 THEN Ads.Nome\n  END AS Agente_Destino,\n  CASE\n  WHEN Ofr.Master_Direto = 0 THEN Dad.Nome \n  END AS Despachante_Aduaneiro\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join \n  mov_Logistica_Fatura Lft on Lft.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join \n  cad_Pessoa Sgd on Sgd.IdPessoa = Lhs.IdSeguradora\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nLeft Outer Join \n  cad_Conversao_Moeda Com on Com.IdConversao_Moeda = Ofr.IdFator_Conversao_Recebimento\nLeft Outer Join \n  mov_Logistica_Moeda Lmd on Lmd.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Moeda Mlc on Mlc.IdMoeda = Lmd.IdMoeda \nLEFT JOIN\n  mov_Contrato_Frete Ctf\n  ON Ctf.IdContrato_Frete = Ofr.IdContrato_Frete\nLEFT JOIN\n  cad_Pessoa Ads\n  ON Ads.IdPessoa = Ofr.IdAgente_Destino\nLEFT JOIN\n  cad_Pessoa Dad\n  ON Dad.IdPessoa = Ofr.IdDespachante_Aduaneiro\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Processo_Entrega\" Sql=\"Select \n  Dse.Nome AS Entrega\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join \n  mov_Logistica_Fatura Lft on Lft.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join \n  cad_Pessoa Sgd on Sgd.IdPessoa = Lhs.IdSeguradora\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nLeft Outer Join \n  cad_Conversao_Moeda Com on Com.IdConversao_Moeda = Ofr.IdFator_Conversao_Recebimento\nLeft Outer Join \n  mov_Logistica_Moeda Lmd on Lmd.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Moeda Mlc on Mlc.IdMoeda = Lmd.IdMoeda \nLEFT JOIN\n  mov_Contrato_Frete Ctf\n  ON Ctf.IdContrato_Frete = Ofr.IdContrato_Frete\nLEFT JOIN\n  cad_Pessoa Ads\n  ON Ads.IdPessoa = Ofr.IdAgente_Destino\nLEFT JOIN\n  cad_Pessoa Dad\n  ON Dad.IdPessoa = Ofr.IdDespachante_Aduaneiro\nLEFT JOIN\n  mov_Logistica_Viagem Lgv\n  ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT JOIN\n   cad_Origem_Destino Dse\n   ON Dse.IdOrigem_Destino = Lgv.IdDestino \nWhere\n  Atv.IdAtividade=:IdAtividade AND Lgv.Tipo_Viagem = 8 AND Lgv.Ultima_Viagem = 1\">\n\n\n<DataSet Name=\"Coletas\" Sql=\"Select TOP 1\n  Lhs.IdLogistica_House,\n  Ocl.Nome AS Origem_Coleta,\n  Dcl.Nome AS Destino_Coleta\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join \n  mov_Logistica_Fatura Lft on Lft.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join \n  cad_Pessoa Sgd on Sgd.IdPessoa = Lhs.IdSeguradora\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nLeft Outer Join \n  cad_Conversao_Moeda Com on Com.IdConversao_Moeda = Ofr.IdFator_Conversao_Recebimento\nLeft Outer Join \n  mov_Logistica_Moeda Lmd on Lmd.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Moeda Mlc on Mlc.IdMoeda = Lmd.IdMoeda \nLEFT JOIN\n  mov_Contrato_Frete Ctf\n  ON Ctf.IdContrato_Frete = Ofr.IdContrato_Frete\nLEFT JOIN\n  cad_Pessoa Ads\n  ON Ads.IdPessoa = Ofr.IdAgente_Destino\nLEFT JOIN\n  cad_Pessoa Dad\n  ON Dad.IdPessoa = Ofr.IdDespachante_Aduaneiro\nLEFT JOIN\n  mov_Logistica_Viagem Lgv\n  ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT JOIN \n     cad_Origem_Destino Ocl\n     ON Ocl.IdOrigem_Destino = Lgv.IdOrigem\nLEFT JOIN \n     cad_Origem_Destino Dcl\n     ON Dcl.IdOrigem_Destino = Lgv.IdDestino\nWhere\n  Atv.IdAtividade=:IdAtividade AND Lgv.Tipo_Viagem = 1\">\n\n<DataSet Name=\"Profits\" Sql=\"\nSelect\n  Lhs.IdLogistica_House,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Valor) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Total,  \n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST((SUM(Txs.Valor) - SUM(Txs.Agent))as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Enterprise,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Agent) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Agente\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nWHERE \n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxa\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Mpg.Sigla as Moeda_Pagamento,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico,\n  Pgm.Nome as Pessoa_Pagamento,\n  Rcb.Nome as Pessoa_Recebimento,\n  CASE Ltx.Receber_De\n\tWhen 0 Then '(Sem pagamento)'\n\tWhen 1 Then 'Agente na origem'\n\tWhen 2 Then 'Agente de destino'\n\tWhen 3 Then 'Cliente'\n\tWhen 4 Then 'Comissionadao'\n\tWhen 5 Then 'Exportador'\n\tWhen 6 Then 'Importador'\n\tWhen 7 Then 'Outro'\n\tWhen 8 Then 'Cia Transporte'\n\tWhen 9 Then 'Notify'\n\tWhen 10 Then 'Associação internacional'\n\tWhen 11 Then 'Desp. aduaneiro'\n  end as Receber_De,\n  CASE Ltx.Pagar_Para\n  When 0 Then '(Sem pagamento)'\n\tWhen 1 Then 'Agência marítima/aérea'\n\tWhen 2 Then 'Agente na origem'\n\tWhen 3 Then 'Agente no destino'\n\tWhen 4 Then 'Comissionado'\n\tWhen 5 Then 'Cia de transporte'\n\tWhen 6 Then 'Despachante aduaneiro'\n\tWhen 7 Then 'Vendedor'\n\tWhen 8 Then 'Outro'\n\tWhen 9 Then 'Cliente'\n\tWhen 10 Then 'Exportador'\n\tWhen 11 Then 'Importador'\n\tWhen 12 Then 'Representante'\n\tWhen 13 Then 'Associação internacional'\n\tWhen 14 Then 'Seguradora'\n\tWhen 15 Then 'Representante destino final'\n  end as Pagar_Para,\n  CASE\n  When Ltx.Modalidade_Pagamento = 0 Then ''\n  When Ltx.Modalidade_Pagamento = 1 Then 'Prepaid'\n  When Ltx.Modalidade_Pagamento = 2 Then 'Collect'\n  When Ltx.Modalidade_Pagamento = 3 Then 'Abroad'\n  end as Modalidade_Pagamento,\n  CASE\n  When Ltx.Modalidade_Recebimento = 0 Then ''\n  When Ltx.Modalidade_Recebimento = 1 Then 'Prepaid'\n  When Ltx.Modalidade_Recebimento = 2 Then 'Collect'\n  When Ltx.Modalidade_Recebimento = 3 Then 'Abroad'\n  end as Modalidade_Recebimento\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House \nLeft Outer Join\t\n  cad_Pessoa Pgm on Pgm.IdPessoa = Ltx.IdPessoa_Pagamento\nLeft Outer Join\t\n  cad_Pessoa Rcb on Rcb.IdPessoa = Ltx.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n \n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr,\n  Mda.Nome AS Moeda,\n  Lhs.Valor_Mercadoria AS Valor_Carga,\n  Lms.Peso_Considerado,\n  CASE\n  WHEN Ofl.Valor_Tipo_Fixo = 1 THEN 'Empilhável'\n  WHEN Ofl.Valor_Tipo_Fixo = 2 THEN 'Não Empilhável'\n  END AS Carga_Lcl\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nLEFT JOIN\n  cad_Moeda Mda \n  ON Mda.IdMoeda= Lhs.IdMoeda_Mercadoria\nLEFT JOIN\n  mov_Logistica_Master Lms\n  ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT JOIN\n  vis_Oferta_Frete_Campo_Livre Ofl\n  ON Ofl.IdOferta_Frete = Lhs.IdOferta_Frete AND Ofl.IdConfiguracao_Campo_Livre = 194\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Embalagem\" Sql=\"Select \n  Lge.IdLogistica_Embalagem,\n  Lge.Quantidade,\n  Lge.Altura,\n  Lge.Largura,\n  Lge.Comprimento,\n  Lge.Metros_Cubicos,\n  Lge.Peso_Liquido_Unitario,\n  Lge.Peso_Liquido,\n  Lge.Peso_Bruto_Unitario,\n  Lge.Peso_Bruto,\n  Lge.Peso_Cubado,\n  Lge.Peso_Considerado,\n  Lge.Coeficiente_Conversao_Peso,\n  Lge.Observacao,\n  Tpe.Nome,\n  Tpe.Nome_Internacional\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Embalagem Lge on Lge.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Tipo_Embalagem Tpe on Tpe.IdTipo_Embalagem = Lge.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Contato_Operacional\" Sql=\"Select\n  Rsp.Nome,\n  Rsp.EMail\nFrom \n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd  \n  Par.IdPapel_Projeto in (2)\" /*OPERACIONAL*/>\n\n\n<DataSet Name=\"Oferta_Frete_Campo_Livre\" Sql=\"SELECT\n  Atv.IdAtividade,\n  Lhs.IdLogistica_House,\n  CASE\n    WHEN COALESCE(Ofc1.Valor_Tipo_Fixo, 0) = 0 and Lhs.Tipo_Carga = 3 THEN ''\n\t  WHEN COALESCE(Ofc1.Valor_Tipo_Fixo, 0) = 1 and Lhs.Tipo_Carga = 3 THEN 'Carga geral'\n\t  WHEN COALESCE(Ofc1.Valor_Tipo_Fixo, 0) = 2 and Lhs.Tipo_Carga = 3 THEN 'Padrão alimento'\n\t  WHEN COALESCE(Ofc1.Valor_Tipo_Fixo, 0) = 3 and Lhs.Tipo_Carga = 3 THEN 'Supertestado'\n    WHEN COALESCE(Ofc2.Valor_Tipo_Fixo, 0) = 0 and Lhs.Tipo_Carga = 4 THEN ''\n\t  WHEN COALESCE(Ofc2.Valor_Tipo_Fixo, 0) = 1 and Lhs.Tipo_Carga = 4 THEN 'Empilhável'\n\t  WHEN COALESCE(Ofc2.Valor_Tipo_Fixo, 0) = 2 and Lhs.Tipo_Carga = 4 THEN 'Não Empilhável'\n  END as Campo_Livre_Oferta\nFROM\n  mov_Atividade Atv\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  vis_Oferta_Frete_Campo_Livre Ofc1 on Ofc1.IdOferta_Frete = Lhs.IdOferta_Frete and Ofc1.IdConfiguracao_Campo_Livre = 193 /*CARACTERISTICA_CONTAINER*/\nLEFT OUTER JOIN\n  vis_Oferta_Frete_Campo_Livre Ofc2 on Ofc2.IdOferta_Frete = Lhs.IdOferta_Frete and Ofc2.IdConfiguracao_Campo_Livre = 194 /*CARGA_LCL*/\nWHERE\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<title>Aviso Abertura de Processo</title>\n\n<style type=\"text/css\">\n  * { box-sizing: border-box; }\n  body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n  td { padding: 2px }\n  th { padding: 1px 4px; font-size: 13px; }\n  .tamanho-linha { line-height: 3px; }\n  .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n  .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n  .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n\n  .cabecalho-esquerda { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: left; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 0px 1px 1px}\n  .cabecalho-direita { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 0px}\n\n  .espaco_interno_tabela { padding: 12px 20px; }\n  .alinhamento_esquerda { text-align: left; }\n  .alinhamento_topo { vertical-align: top; }\n  .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n  .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n  .negrito { font-weight: bold; }\n  .sem-negrito { font-weight: normal; }\n  .assinatura { padding-left: 28px; }\n  .altura-linha { line-height: 3px; }\n  .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n  .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n\n</head>\n<body>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contato_Operacional\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contato_Operacional\" FieldName=\"Email\">\n\n[Subject.Header]\nABERTURA NOVO PROCESSO || Oferta <Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\"> || Processo <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> || <Print Dataset=\"Processo\" FieldName=\"Cliente\"> ||  <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> || <Print Dataset=\"Processo\" FieldName=\"Exportador\"> || <Print Dataset=\"Processo\" FieldName=\"Importador\"> || <Print Dataset=\"Processo\" FieldName=\"Origem\"> x <Print Dataset=\"Processo\" FieldName=\"Destino\"> | Booking: <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></Print>\n[Subject.Footer]\n\n[Report.Detail]\n\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho-esquerda\" align=\"left\"></td>\n      <td class=\"cabecalho-direita\" align=\"right\">HANDOVER - AVISO DE ABERTURA DE PROCESSO</td>\n    </tr>\n  </table>\n</span>\n<br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"2\">DETALHES COMERCIAIS</th>\n  </tr>\n    <tr>\n    <td width=\"22%\" class=\"negrito\">VENDEDOR:</td>\n    <td width=\"83%\"><Print Dataset=\"Processo\" FieldName=\"Vendedor\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">NÚMERO OFERTA:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">NÚMERO PROCESSO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n    <tr>\n    <td class=\"negrito\">CONTRATO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Contrato\"></td>\n  </tr>\n    <tr>\n    <td class=\"negrito\">MASTER DIRETO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Master_Direto\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">DATA DE VALIDADE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Data_Validade\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">MODALIDADE PROCESSO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"></td>\n  </tr>\n</table>\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"4\" class=\"text-left\">DADOS PROCESSO</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\">CLIENTE:</td>\n    <td colspan=\"3\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n    <td width=\"19%\" class=\"negrito\">EXPORTADOR:</td>\n    <td width=\"25%\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td width=\"19%\" class=\"negrito\">AGENTE DESTINO:</td>\n    <td width=\"25%\"><Print Dataset=\"Processo\" FieldName=\"Agente_Destino\"></td>\n    <td class=\"negrito\">INCOTERM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n  </tr>\n  <tr>\n    <td width=\"19%\" class=\"negrito\">DESPACHANTE ADUANEIRO:</td>\n    <td width=\"25%\"><Print Dataset=\"Processo\" FieldName=\"Despachante_Aduaneiro\"></td>\n    <td class=\"negrito\">DESTINO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">CIA TRANSPORTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n    <td class=\"negrito\">ENTREGA:</td>\n    <td><Print Dataset=\"Processo_Entrega\" FieldName=\"Entrega\"></td>\n\n  </tr>\n  <tr>\n    <td class=\"negrito\">ORIGEM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td class=\"negrito\">COLETA:</td>\n    <td><Print Dataset=\"Coletas\" FieldName=\"Origem_Coleta\"></td>  \n  </tr>\n</table>\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">DADOS DA CARGA</th>\n  </tr>\n  <tr>\n    <td width=\"12%\" class=\"negrito\">SEGURADORA:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Seguradora\"></td>\n  </tr>\n  <tr>\n    <td width=\"12%\" class=\"negrito\">MARCADORIA:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n    <td width=\"12%\" class=\"negrito\">NCM:</td>\n    <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"NCM_Descricao\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">TIPO DE CARGA:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Tipo_Carga\"> <Print Dataset=\"Oferta_Frete_Campo_Livre\" FieldName=\"Campo_Livre_Oferta\"></td>\n    <td class=\"negrito\">PESO BRUTO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\"0.000\"> Kgs</td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">VOLUMES:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\"></td>\n    <td class=\"negrito\">CBM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\"0.00\"> m³</td>\n  </tr>\n</table>\n<br>\n\n<SubReport Name=\"Instrucoes\" Dataset=\"Processo\" SkipWhenNoDetails=\"true\">\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">INSTRUÇÕES</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. OPERACIONAL:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Operacional\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. FINANCEIRO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Financeiro\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. CLIENTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Cliente\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. AGENTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Agente\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">OPERACIONAL CLIENTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Operacional_Cliente\"></td>\n  </tr>\n</table>\n<br>\n<br>\n\n<Subreport NameSource=\"Processo\" NameField=\"Tipo_Carga\">\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th align=\"left\" style=\"background-color: #0077b6;\">Taxas</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Receber De</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Unid. de Venda</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Qntd. de Venda</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Taxa de Venda</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Modalidade</th>\n    <th align=\"center\" style=\"background-color: #008000;\">Pagar Para</th>\n    <th align=\"left\" style=\"background-color: #008000;\">Unid. de Compra</th>\n    <th align=\"left\" style=\"background-color: #008000;\">Qntd. de Compra</th>\n    <th align=\"center\" style=\"background-color:#008000;\">Taxa de Compra</th>\n    <th align=\"center\" style=\"background-color:#008000;\">Modalidade</th>\n  </tr>\n  <Subreport Name=\"Taxa\" Dataset=\"Taxa\">\n</table>\n\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo-3\">\n    <th align=\"center\">OBSERVAÇÕES</th>\n  </tr>\n  <tr>\n    <td> </td>\n  </tr>\n  <tr>\n    <td> </td>\n  </tr>\n  <tr>\n    <td> </td>\n  </tr>\n  <tr>\n    <td> </td>\n  </tr>\n</table>\n<br><br>\n\n<table>\n  <tr>\n    <td class=\"assinatura\">\n      <signature>\n    </td>\n  </tr>\n</table>\n\n[Fcl.Detail]\n<SubReport Name=\"Tipo_FCL\" DataSet=\"Carga\" SkipWhenNoDetails=\"true\">\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">OBSERVAÇÃO E PRAZO DE PAGAMENTO</th>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Lucro Estimado:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Sigla_Lucro\"> <Print Dataset=\"Processo\" FieldName=\"Lucro_Estimado\" DisplayFormat=\"0.00\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade De Pagamento Master:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_Master\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade de Pagamento House:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Margem Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Margem_Recebimento\"> %</td>\n  </tr>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Tabela_Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Tabela_Recebimento\"> %</td>\n  </tr>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Observação:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Observacao_Comercial\"> %</td>\n  </tr>\n\n</table>\n\n[Lcl.Detail]\n<SubReport Name=\"Tipo_LCL\" DataSet=\"Carga\" SkipWhenNoDetails=\"true\">\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">OBSERVAÇÃO E PRAZO DE PAGAMENTO</th>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Lucro Estimado:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Sigla_Lucro\"> <Print Dataset=\"Processo\" FieldName=\"Lucro_Estimado\" DisplayFormat=\"0.00\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade De Pagamento Master:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_Master\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade de Pagamento House:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Margem Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Margem_Recebimento\"> %</td>\n  </tr>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Tabela_Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Tabela_Recebimento\"> %</td>\n  </tr>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Observação:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Observacao_Comercial\"> %</td>\n  </tr>\n\n</table>\n\n[Lcl_Aereo.Detail]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- LCL/AEREO -->\n  <tr class=\"cor-fundo-2\">\n    <th align=\"center\">QUANT.</th>\n    <th align=\"center\">COMPRIMENTO</th>\n    <th align=\"center\">LARGURA</th>\n    <th align=\"center\">ALTURA</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Comprimento\" DisplayFormat=\"0.00\"> cm</td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Largura\" DisplayFormat=\"0.00\"> cm</td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Altura\" DisplayFormat=\"0.00\"> cm</td>\n  </tr>\n</table>\n\n\n[Taxa.Detail]\n<tr>\n    <td width=\"20%\" class=\"borda_direita_esquerda_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Taxa\">\n    </td>\n    <td width=\"14%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Receber_De\">\n    </td >\n    <td width=\"8%\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Rec_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\"0.00\"> \n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Quantidade_Recebimento\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"10%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Rec_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\"0.00\">\n    </td>\n        <td width=\"10%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Modalidade_Recebimento\"> \n    </td>\n    <td width=\"12%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Pagar_Para\">\n    </td>\n        <td width=\"10%\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Pag_Dinamica\" > \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\"0.00\"> \n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Quantidade_Pagamento\" DisplayFormat=\"0.00\"> \n    </td>\n    <td width=\"10%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Pag_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\"0.00\">\n    </td>     \n    <td width=\"10%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Modalidade_Pagamento\"> \n    </td>\n</tr>\n\n[Tipo_FCL.Header]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- FCL -->\n  <tr class=\"cor-fundo-2\">\n    <td width=\"10%\">QUANT.</td>\n    <td width=\"30%\">TIPO DE EQUIPAMENTO</td>\n    <td width=\"15%\">FREE TIME ORIGEM COMPRA</td>\n    <td width=\"15%\">FREE TIME DESTINO COMPRA</td>\n    <td width=\"15%\">FREE TIME ORIGEM VENDA</td>\n    <td width=\"15%\">FREE TIME DESTINO VENDA</td>\n  </tr>\n</table>\n[Tipo_FCL.Detail]\n<table class=\"borda_sem_cima\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"10%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td width=\"30%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_Master_Origem\"> dias</td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_Master_Destino\"> dias</td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Origem\"> dias</td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>\n  </tr>\n</table>\n\n[Tipo_LCL.Header]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- LCL -->\n  <tr class=\"cor-fundo-2\">\n    <!--<td width=\"10%\">QUANT.</td>-->\n    <td width=\"25%\">MOEDA</td>\n    <td width=\"25%\">VALOR CARGA</td>\n    <td width=\"25%\">PESO CONSIDERADO</td>\n    <td width=\"25%\">CARGA LCL</td>\n    <!--<td width=\"15%\">FREE TIME ORIGEM VENDA</td>-->\n    <!--<td width=\"15%\">FREE TIME DESTINO VENDA</td>-->\n  </tr>\n</table>\n[Tipo_LCL.Detail]\n<table class=\"borda_sem_cima\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <!--<td width=\"10%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>-->\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Moeda\"></td>\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Valor_Carga\"></td>\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Peso_Considerado\" DisplayFormat=\"0.000\"> kg</td>\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Carga_Lcl\"></td>\n    <!--<td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Origem\"> dias</td>-->\n    <!--<td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>-->\n  </tr>\n</table>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROJETO 2019 - AVISO ABERTURA DE PROCESSO IM #45130 EXALOG.sql",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lms.Data_Processo,\n  Coalesce(Lmm.Viagem_Navio,Vnv.Numero) as Numero_Viagem,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome_Fantasia as Cliente,\n  Cln.Nome_Fantasia AS Cliente_Fantasia,\n  Ept.Nome_Fantasia as Exportador,\n  Ept.Email as Exportador_Email,\n  Ept.Fone as Exportador_Fone,\n  Ept.Logradouro as Exportador_Endereco,\n  Ept.Nome_Fantasia As Shipper_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome_Fantasia as Importador,\n  Imp.Nome_fantasia As Consignee_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome_Fantasia as Notify,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Lrc.Nome as Local_Recebimento,\n  Ctr.Nome as Cia_Transporte,\n  Ago.Nome as Agente_Origem,\n  Agd.Nome as Agente_Destino,\n  Nvi.Nome as Navio,\n  Lmd.Lucro_Estimado As Lucro_Estimado,\n  Mlc.Sigla as Sigla_Lucro,\n  Com.Nome As Tabela_Recebimento,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente no destino*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 1 Then 'Exportação Aérea'\n    When Lms.Tipo_Operacao = 1 AND Lms.Modalidade_Processo = 2 Then 'Exportação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 1 Then 'Importação Aérea'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 2 Then 'Importação Marítima'\n    When Lms.Tipo_Operacao = 2 AND Lms.Modalidade_Processo = 3 Then 'Importação Terrestre'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 1 Then 'Nacional Aérea'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 2 Then 'Nacional Marítima'\n    When Lms.Tipo_Operacao = 3 AND Lms.Modalidade_Processo = 3 Then 'Nacional Terrestre'\n  End as Tipo_Modalidade,\n  CASE\n    WHEN Lhs.Tipo_Carga = 0 THEN '(Não especificado)'\n    WHEN Lhs.Tipo_Carga = 1 THEN 'Aéreo'\n    WHEN Lhs.Tipo_Carga = 2 THEN 'Break-Bulk'\n    WHEN Lhs.Tipo_Carga = 3 THEN 'FCL'\n    WHEN Lhs.Tipo_Carga = 4 THEN 'LCL'\n    WHEN Lhs.Tipo_Carga = 5 THEN 'RO-RO'\n    WHEN Lhs.Tipo_Carga = 6 THEN 'Rodoviário'\n  END AS Tipo_Carga,\n  Mer.Nome as Mercadoria,\n  Lhs.NCM_Descricao,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Imp.Nome as Nome_Importador,\n  Lhs.Instrucoes_Cliente,\n  Lam.Peso_Taxado,\n  Lhs.Quantidade_Volumes,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Vnd.Nome as Vendedor,\n  Aga.Nome_Fantasia as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Lhs.Instrucoes_Operacional,\n  Ofr.Margem_Cambio_Recebimento as Margem_Recebimento,\n  Ofr.Margem_Cambio_Pagamento as Margem_Pagamento,\n  Ofr.Observacao As Observacao_Comercial,\n  Des.Nome_Fantasia as Despachante,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Lhs.Valor_Mercadoria,\n  Mmr.Sigla As Moeda_Mercadoria,\n  Lhs.Instrucoes_Operacional_Cliente,\n  Lhs.Instrucoes_Financeiro,\n  Lhs.Instrucoes_Agente,\n  Ofr.Numero_Oferta,\n  Pfr.Data_Aprovacao As Data_Aprovacao,\n  Mpr.Sigla As Moeda_Processo,\n  Sgd.Nome As Seguradora,\n  Ofr.Data_Validade As Data_Validade,\n  Case\n    When Rfn.IdConversao_Moeda = 1 Then 'PTAX'\n    When Rfn.IdConversao_Moeda = 2 Then 'Abertura'\n  END As Tabela_Recebimento\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join \n  mov_Logistica_Fatura Lft on Lft.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join \n  cad_Pessoa Sgd on Sgd.IdPessoa = Lhs.IdSeguradora\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Des on Des.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  cad_Moeda Mmr on Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Moeda Mpr on Mpr.IdMoeda = Lms.IdMoeda_Processo\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete_Original\nLeft Outer Join\n  mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\nLeft Outer Join \n  cad_Conversao_Moeda Com on Com.IdConversao_Moeda = Ofr.IdFator_Conversao_Recebimento\nLeft Outer Join \n  mov_Logistica_Moeda Lmd on Lmd.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Moeda Mlc on Mlc.IdMoeda = Lmd.IdMoeda \nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Profits\" Sql=\"\nSelect\n  Lhs.IdLogistica_House,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Valor) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Total,  \n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST((SUM(Txs.Valor) - SUM(Txs.Agent))as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Enterprise,\n  STUFF(CAST((SELECT + ' + ' + Mda.Sigla + ' ' + REPLACE(CAST(SUM(Txs.Agent) as VARCHAR(MAX)),'.',',') as Profit_Total FROM (SELECT Ltx.IdLogistica_House,Ltx.IdMoeda_Recebimento as IdMoeda,Ltx.Valor_Recebimento_Total as Valor,NULL as Agent FROM mov_Logistica_Taxa Ltx WHERE Ltx.IdMoeda_Recebimento IS NOT NULL\tUNION ALL SELECT  Ltx.IdLogistica_House,Ltx.IdMoeda_Pagamento as IdMoeda,- CASE WHEN Ltx.IdTaxa_Logistica_Exibicao <> 11 THEN Ltx.Valor_Pagamento_Total END as Valor,+ CASE WHEN Ltx.IdTaxa_Logistica_Exibicao = 11 THEN Ltx.Valor_Pagamento_Total END as Agent\tFROM mov_Logistica_Taxa Ltx\tWHERE Ltx.IdMoeda_Pagamento IS NOT NULL) Txs Left Outer Join cad_Moeda Mda On Mda.IdMoeda = Txs.IdMoeda WHERE Txs.IdLogistica_House = Lhs.IdLogistica_House GROUP BY Mda.Sigla FOR XML PATH, TYPE).query('data(.)') As VARCHAR(MAX)), 1, 2, '') as Profit_Agente\nFrom\n  mov_Atividade Atv\nJoin\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nWHERE \n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxa\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Mpg.Sigla as Moeda_Pagamento,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico,\n  Pgm.Nome as Pessoa_Pagamento,\n  Rcb.Nome as Pessoa_Recebimento,\n    CASE Ltx.Receber_De\n\tWhen 0 Then '(Sem pagamento)'\n\tWhen 1 Then 'Agente na origem'\n\tWhen 2 Then 'Agente de destino'\n\tWhen 3 Then 'Cliente'\n\tWhen 4 Then 'Comissionadao'\n\tWhen 5 Then 'Exportador'\n\tWhen 6 Then 'Importador'\n\tWhen 7 Then 'Outro'\n\tWhen 8 Then 'Cia Transporte'\n\tWhen 9 Then 'Notify'\n\tWhen 10 Then 'Associação internacional'\n\tWhen 11 Then 'Desp. aduaneiro'\n  end as Receber_De,\n  CASE Ltx.Pagar_Para\n  When 0 Then '(Sem pagamento)'\n\tWhen 1 Then 'Agência marítima/aérea'\n\tWhen 2 Then 'Agente na origem'\n\tWhen 3 Then 'Agente no destino'\n\tWhen 4 Then 'Comissionado'\n\tWhen 5 Then 'Cia de transporte'\n\tWhen 6 Then 'Despachante aduaneiro'\n\tWhen 7 Then 'Vendedor'\n\tWhen 8 Then 'Outro'\n\tWhen 9 Then 'Cliente'\n\tWhen 10 Then 'Exportador'\n\tWhen 11 Then 'Importador'\n\tWhen 12 Then 'Representante'\n\tWhen 13 Then 'Associação internacional'\n\tWhen 14 Then 'Seguradora'\n\tWhen 15 Then 'Representante destino final'\n  end as Pagar_Para,\n    CASE\n  When Ltx.Modalidade_Pagamento = 0 Then ''\n  When Ltx.Modalidade_Pagamento = 1 Then 'Prepaid'\n  When Ltx.Modalidade_Pagamento = 2 Then 'Collect'\n  When Ltx.Modalidade_Pagamento = 3 Then 'Abroad'\n  end as Modalidade_Pagamento,\n  CASE\n  When Ltx.Modalidade_Recebimento = 0 Then ''\n  When Ltx.Modalidade_Recebimento = 1 Then 'Prepaid'\n  When Ltx.Modalidade_Recebimento = 2 Then 'Collect'\n  When Ltx.Modalidade_Recebimento = 3 Then 'Abroad'\n  end as Modalidade_Recebimento\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\t\n  cad_Pessoa Pgm on Pgm.IdPessoa = Ltx.IdPessoa_Pagamento\nLeft Outer Join\t\n  cad_Pessoa Rcb on Rcb.IdPessoa = Ltx.IdPessoa_Recebimento\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n \n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr,\n  Mda.Nome AS Moeda,\n  Lhs.Valor_Mercadoria AS Valor_Carga,\n  Lms.Peso_Considerado,\n  CASE\n  WHEN Ofl.Valor_Tipo_Fixo = 1 THEN 'Empilhável'\n  WHEN Ofl.Valor_Tipo_Fixo = 2 THEN 'Não Empilhável'\n  END AS Carga_Lcl\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nLEFT JOIN\n  cad_Moeda Mda \n  ON Mda.IdMoeda= Lhs.IdMoeda_Mercadoria\nLEFT JOIN\n  mov_Logistica_Master Lms\n  ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT JOIN\n  vis_Oferta_Frete_Campo_Livre Ofl\n  ON Ofl.IdOferta_Frete = Lhs.IdOferta_Frete AND Ofl.IdConfiguracao_Campo_Livre = 194\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Embalagem\" Sql=\"Select \n  Lge.IdLogistica_Embalagem,\n  Lge.Quantidade,\n  Lge.Altura,\n  Lge.Largura,\n  Lge.Comprimento,\n  Lge.Metros_Cubicos,\n  Lge.Peso_Liquido_Unitario,\n  Lge.Peso_Liquido,\n  Lge.Peso_Bruto_Unitario,\n  Lge.Peso_Bruto,\n  Lge.Peso_Cubado,\n  Lge.Peso_Considerado,\n  Lge.Coeficiente_Conversao_Peso,\n  Lge.Observacao,\n  Tpe.Nome,\n  Tpe.Nome_Internacional\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Embalagem Lge on Lge.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Tipo_Embalagem Tpe on Tpe.IdTipo_Embalagem = Lge.IdTipo_Embalagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n  <DataSet Name=\"Contato_Exportador_Notify\" Sql=\"Select\n  Pctn.Nome as Notify,\n  CASE WHEN Lhs.Tipo_Carga in (3,4) /*FCL OU LCL*/ THEN Pctn.EMail ELSE '' end as Email_Notify,\n  Pcte.Nome as Exportador,\n  CASE WHEN Lhs.Tipo_Carga in (3,4) /*FCL OU LCL*/ THEN Pcte.EMail ELSE '' end as Email_Exportador\nFrom \n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Pctn on Pctn.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Pcte on Pcte.IdPessoa = Lhs.IdExportador\nWhere\n  Atv.IdAtividade =:IdAtividade\">\n\n<DataSet Name=\"Contato_Operacional\" Sql=\"Select\n  Rsp.Nome,\n  Rsp.EMail\nFrom \n  mov_Atividade Atv\nJoin\n  mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd  \n  Par.IdPapel_Projeto in (2)\" /*OPERACIONAL*/>\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<title>Aviso Abertura de Processo</title>\n\n<style type=\"text/css\">\n  * { box-sizing: border-box; }\n  body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n  td { padding: 2px }\n  th { padding: 1px 4px; font-size: 13px; }\n  .tamanho-linha { line-height: 3px; }\n  .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n  .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n  .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n\n  .cabecalho-esquerda { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: left; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 0px 1px 1px}\n  .cabecalho-direita { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 0px}\n\n  .espaco_interno_tabela { padding: 12px 20px; }\n  .alinhamento_esquerda { text-align: left; }\n  .alinhamento_topo { vertical-align: top; }\n  .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n  .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n  .negrito { font-weight: bold; }\n  .sem-negrito { font-weight: normal; }\n  .assinatura { padding-left: 28px; }\n  .altura-linha { line-height: 3px; }\n  .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n  .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n  .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n\n</head>\n<body>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contato_Operacional\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contato_Operacional\" FieldName=\"Email\">\n\n[Subject.Header]\nABERTURA NOVO PROCESSO || Oferta <Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\"> || Processo <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> || <Print Dataset=\"Processo\" FieldName=\"Cliente\"> ||  <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> || <Print Dataset=\"Processo\" FieldName=\"Exportador\"> || <Print Dataset=\"Processo\" FieldName=\"Importador\"> || <Print Dataset=\"Processo\" FieldName=\"Origem\"> x <Print Dataset=\"Processo\" FieldName=\"Destino\"> | Booking: <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\">\n[Subject.Footer]\n\n[Report.Detail]\n\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho-esquerda\" align=\"left\"><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n      <td class=\"cabecalho-direita\" align=\"right\">HANDOVER - AVISO DE ABERTURA DE PROCESSO</td>\n    </tr>\n  </table>\n</span>\n<br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"2\">DETALHES COMERCIAIS</th>\n  </tr>\n    <tr>\n    <td width=\"22%\" class=\"negrito\">VENDEDOR:</td>\n    <td width=\"83%\"><Print Dataset=\"Processo\" FieldName=\"Vendedor\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">NÚMERO OFERTA:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Oferta\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">NÚMERO PROCESSO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">MODALIDADE PROCESSO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"></td>\n  </tr>\n</table>\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"4\" class=\"text-left\">DADOS PROCESSO</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\">CLIENTE:</td>\n    <td colspan=\"1\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n    <td class=\"negrito\">NOTIFY:</td>\n    <td colspan=\"2\"><Print Dataset=\"Processo\" FieldName=\"Notify\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">IMPORTADOR:</td>\n    <td colspan=\"1\"><Print Dataset=\"Processo\" FieldName=\"Nome_Importador\"></td>\n    <td class=\"negrito\">EXPORTADOR:</td>\n    <td colspan=\"2\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">CIA TRANSPORTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n    <td class=\"negrito\">INCOTERM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">ORIGEM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n    <td class=\"negrito\">DESTINO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n    <tr>\n    <td class=\"negrito\">AGENTE ORIGEM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Agente_Origem\"></td>\n    <td class=\"negrito\">AGENTE DESTINO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Agente_Destino\"></td>\n  </tr>\n</table>\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">DADOS DA CARGA</th>\n  </tr>\n  <tr>\n    <td width=\"12%\" class=\"negrito\">SEGURADORA:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Seguradora\"></td>\n  </tr>\n  <tr>\n    <td width=\"12%\" class=\"negrito\">MARCADORIA:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n    <td width=\"12%\" class=\"negrito\">NCM:</td>\n    <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"NCM_Descricao\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">TIPO DE CARGA:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Tipo_Carga\"></td>\n    <td class=\"negrito\">PESO BRUTO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\"0.000\"> Kgs</td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">VOLUMES:</td>\n    <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\"></td>\n    <td class=\"negrito\">CBM:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\"0.00\"> m³</td>\n  </tr>\n</table>\n<br>\n\n<SubReport Name=\"Instrucoes\" Dataset=\"Processo\" SkipWhenNoDetails=\"true\">\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">INSTRUÇÕES</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. OPERACIONAL:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Operacional\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. FINANCEIRO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Financeiro\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. CLIENTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Cliente\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">INSTR. AGENTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Agente\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">OPERACIONAL CLIENTE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Operacional_Cliente\"></td>\n  </tr>\n</table>\n<br>\n\n<SubReport Name=\"Exportador\" Dataset=\"Processo\" SkipWhenNoDetails=\"true\">\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">EXPORTADOR</th>\n  </tr>\n  <tr>\n    <td width=\"22%\" class=\"negrito\">NOME:</td>\n    <td width=\"83%\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">FONE:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Exportador_Fone\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">E-MAIL:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Exportador_Email\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">ENDEREÇO:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Exportador_Endereco\"></td>\n  </tr>\n</table>\n<br>\n<br>\n</SubReport>\n\n<Subreport NameSource=\"Processo\" NameField=\"Tipo_Carga\">\n\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo cor-fonte-destaque\">\n    <th align=\"left\" style=\"background-color: #0077b6;\">Taxas</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Receber De</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Unid. de Venda</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Qntd. de Venda</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Taxa de Venda</th>\n    <th align=\"center\" style=\"background-color: #0077b6;\">Modalidade</th>\n    <th align=\"center\" style=\"background-color: #008000;\">Pagar Para</th>\n    <th align=\"left\" style=\"background-color: #008000;\">Unid. de Compra</th>\n    <th align=\"left\" style=\"background-color: #008000;\">Qntd. de Compra</th>\n    <th align=\"center\" style=\"background-color:#008000;\">Taxa de Compra</th>\n    <th align=\"center\" style=\"background-color:#008000;\">Modalidade</th>\n  </tr>\n  <Subreport Name=\"Taxa\" Dataset=\"Taxa\">\n</table>\n\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr class=\"cor-fundo-3\">\n    <th align=\"center\">OBSERVAÇÕES</th>\n  </tr>\n  <tr>\n    <td></td>\n  </tr>\n  <tr>\n       <td></td>\n  </tr>\n  <tr>\n        <td></td>\n  </tr>\n  <tr>\n        <td></td>\n  </tr>\n</table>\n<br><br>\n\n<table>\n  <tr>\n    <td class=\"assinatura\">\n      <signature>\n    </td>\n  </tr>\n</table>\n\n[Fcl.Detail]\n<SubReport Name=\"Tipo_FCL\" DataSet=\"Carga\" SkipWhenNoDetails=\"true\">\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">OBSERVAÇÃO E PRAZO DE PAGAMENTO</th>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Lucro Estimado:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Sigla_Lucro\"> <Print Dataset=\"Processo\" FieldName=\"Lucro_Estimado\" DisplayFormat=\"0.00\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade De Pagamento Master:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_Master\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade de Pagamento House:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Margem Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Margem_Recebimento\"> %</td>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Tabela Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Tabela_Recebimento\"> %</td>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Observação:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Observacao_Comercial\"> %</td>\n  </tr>\n\n</table>\n\n[Lcl.Detail]\n<SubReport Name=\"Tipo_LCL\" DataSet=\"Carga\" SkipWhenNoDetails=\"true\">\n<br>\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <th colspan=\"4\" class=\"cor-fundo cor-fonte-destaque\">OBSERVAÇÃO E PRAZO DE PAGAMENTO</th>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Lucro Estimado:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Sigla_Lucro\"> <Print Dataset=\"Processo\" FieldName=\"Lucro_Estimado\" DisplayFormat=\"0.00\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade De Pagamento Master:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_Master\"></td>\n  </tr>\n  <tr>\n    <td width=\"20%\" class=\"negrito\">Modalidade de Pagamento House:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Margem Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Margem_Recebimento\"> %</td>\n  </tr>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Tabela_Recebimento:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Tabela_Recebimento\"> %</td>\n  </tr>\n  </tr>\n    <tr>\n    <td width=\"20%\" class=\"negrito\">Observação:</td>\n    <td width=\"38%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Observacao_Comercial\"> %</td>\n  </tr>\n\n</table>\n\n[Lcl_Aereo.Detail]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- LCL/AEREO -->\n  <tr class=\"cor-fundo-2\">\n    <th align=\"center\">QUANT.</th>\n    <th align=\"center\">COMPRIMENTO</th>\n    <th align=\"center\">LARGURA</th>\n    <th align=\"center\">ALTURA</th>\n  </tr>\n  <tr>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Comprimento\" DisplayFormat=\"0.00\"> cm</td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Largura\" DisplayFormat=\"0.00\"> cm</td>\n    <td class=\"negrito\" align=\"center\"><Print Dataset=\"Embalagem\" FieldName=\"Altura\" DisplayFormat=\"0.00\"> cm</td>\n  </tr>\n</table>\n\n\n[Taxa.Detail]\n<tr>\n    <td width=\"18%\" class=\"borda_direita_esquerda_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Taxa\">\n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Receber_De\">\n    </td>\n    <td width=\"19%\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Rec_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Quantidade_Recebimento\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"14%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Rec_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"10%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: rgb(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Modalidade_Recebimento\"> \n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Pagar_Para\">\n    </td> \n    <td width=\"19%\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Pag_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"14%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Moeda_Pag_Dinamica\"> \n        <Print Dataset=\"Taxa\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"8%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Quantidade_Pagamento\" DisplayFormat=\"0.00\">\n    </td>\n    <td width=\"10%\" align=\"center\" class=\"borda_direita_baixo\" style=\"background-color: #006400(92, 183, 243)\">\n        <Print Dataset=\"Taxa\" FieldName=\"Modalidade_Pagamento\"> \n    </td>\n</tr>\n\n[Tipo_FCL.Header]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- FCL -->\n  <tr class=\"cor-fundo-2\">\n    <td width=\"10%\">QUANT.</td>\n    <td width=\"30%\">TIPO DE EQUIPAMENTO</td>\n    <td width=\"15%\">FREE TIME ORIGEM COMPRA</td>\n    <td width=\"15%\">FREE TIME DESTINO COMPRA</td>\n    <td width=\"15%\">FREE TIME ORIGEM VENDA</td>\n    <td width=\"15%\">FREE TIME DESTINO VENDA</td>\n  </tr>\n</table>\n[Tipo_FCL.Detail]\n<table class=\"borda_sem_cima\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"10%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td width=\"30%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_Master_Origem\"> dias</td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_Master_Destino\"> dias</td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Origem\"> dias</td>\n    <td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>\n  </tr>\n</table>\n\n[Tipo_LCL.Header]\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> <!-- LCL -->\n  <tr class=\"cor-fundo-2\">\n    <!--<td width=\"10%\">QUANT.</td>-->\n    <td width=\"25%\">MOEDA</td>\n    <td width=\"25%\">VALOR CARGA</td>\n    <td width=\"25%\">PESO CONSIDERADO</td>\n    <td width=\"25%\">CARGA LCL</td>\n    <!--<td width=\"15%\">FREE TIME ORIGEM VENDA</td>-->\n    <!--<td width=\"15%\">FREE TIME DESTINO VENDA</td>-->\n  </tr>\n</table>\n[Tipo_LCL.Detail]\n<table class=\"borda_sem_cima\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <!--<td width=\"10%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>-->\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Moeda\"></td>\n    <td width=\"25\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Valor_Carga\"></td>\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Peso_Considerado\" DisplayFormat=\"0.000\"> kg</td>\n    <td width=\"25%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Carga_Lcl\"></td>\n    <!--<td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Origem\"> dias</td>-->\n    <!--<td width=\"15%\" class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> dias</td>-->\n  </tr>\n</table>\n\n\n\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROJETO 2019 - EM CONFIRMAÇÃO DE EMBARQUE #45562 TIRRENA.HTML",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Transit_Time,\n  Lms.Transit_Time_Maximo,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Cpf_Cnpj,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  ' / ' + Lmm.Viagem_Navio AS Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Lhs.NCM_Descricao,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  CASE \n    WHEN Lhs.Tipo_Frete = 1 THEN 'FAK'\n    WHEN Lhs.Tipo_Frete = 2 THEN 'NAC'\n    WHEN Lhs.Tipo_Frete = 3 THEN 'BID'\n    WHEN Lhs.Tipo_Frete = 4 THEN 'Long Term'\n    WHEN Lhs.Tipo_Frete = 5 THEN 'SPOT'\n  END AS Tipo_Frete,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Case\n    When Lhs.Local_Emissao = 1 Then 'DESTINO' \n    When Lhs.Local_Emissao = 2 Then 'EXPRESS RELEASE' \n    When Lhs.Local_Emissao = 3 Then 'ORIGEM' \n    When Lhs.Local_Emissao = 4 Then 'SEA WAYBILL' \n  End as Emissao_House,\n  Case\n    When Lms.Local_Emissao = 1 Then 'DESTINO' \n    When Lms.Local_Emissao = 2 Then 'EXPRESS RELEASE' \n    When Lms.Local_Emissao = 3 Then 'ORIGEM' \n    When Lms.Local_Emissao = 4 Then 'SEA WAYBILL' \n  End as Emissao_Master,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade,\n  Ven.Nome AS Vendedor,\n  Pct.Valor_Alfanumerico as Po_Contract,\n  Pft.Valor_Texto as Profit,\n  Case \n    When Lhs.Local_Emissao = 2 Then '*WILL BE EXPRESS REALEASE – DON’T RELEASE THE CARGO WITHOUT OUR AUTHORIZATION*' \n    Else Null \n  End as Frase_Realease,\n  Cl1.Valor_Texto as Info_Buying,\n  Cl2.Valor_Texto as Info_Selling,\n  CASE\n  WHEN Lmt.IdPorto_Transbordo IS NULL THEN Lhs.Rota\n  ELSE Ptb.Nome\n  END as Porto_Transbordo,\n  CASE DATEPART(MONTH,Lhs.Data_Previsao_Entrega)\n    WHEN 1 THEN 'JANUARY'\n    WHEN 2 THEN 'FEBRUARY'\n    WHEN 3 THEN 'MARCH'\n    WHEN 4 THEN 'APRIL'\n    WHEN 5 THEN 'MAY'\n    WHEN 6 THEN 'JUNE'\n    WHEN 7 THEN 'JULY'\n    WHEN 8 THEN 'AUGUST'\n    WHEN 9 THEN 'SEPTEMBER'\n    WHEN 10 THEN 'OCTOBER'\n    WHEN 11 THEN 'NOVEMBER'\n    WHEN 12 THEN 'DECEMBER'\n  END as Mes_Previsao_Entrega_Ing,\n  CASE DATEPART(DAY,Lhs.Data_Previsao_Entrega)\n   WHEN 1 THEN '01st'\n   WHEN 2 THEN '02nd'\n   WHEN 3 THEN '03rd'\n   WHEN 4 THEN '04th'\n   WHEN 5 THEN '05th'\n   WHEN 6 THEN '06th'\n   WHEN 7 THEN '07th'\n   WHEN 8 THEN '08th'\n   WHEN 9 THEN '09th'\n   WHEN 10 THEN '10th'\n   WHEN 11 THEN '11th'\n   WHEN 12 THEN '12th'\n   WHEN 13 THEN '13th'\n   WHEN 14 THEN '14th'\n   WHEN 15 THEN '15th'\n   WHEN 16 THEN '16th'\n   WHEN 17 THEN '17th'\n   WHEN 18 THEN '18th'\n   WHEN 19 THEN '19th'\n   WHEN 20 THEN '20th'\n   WHEN 21 THEN '21st'\n   WHEN 22 THEN '22nd'\n   WHEN 23 THEN '23rd'\n   WHEN 24 THEN '24th'\n   WHEN 25 THEN '25th'\n   WHEN 26 THEN '26th'\n   WHEN 27 THEN '27th'\n   WHEN 28 THEN '28th'\n   WHEN 29 THEN '29th'\n   WHEN 30 THEN '30th'\n   WHEN 31 THEN '31st'\n  END as Dia_Previsao_Entrega_Ing,\n  CASE\n     WHEN Lms.Master_Direto = 0 THEN 'após pagamentos das taxas locais e autorização do shipper.'\n     ELSE 'após pagamentos das taxas locais, autorização do shipper e frete pago pelo importador.'\n  END AS Master_Direto,\n  Case\n  when Lms.Master_Direto = 1 THEN 'Modelo_Direto'\n  Else 'Modelo_Padrao'\n  End as Mensagem\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ven ON Ven.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  vis_Logistica_Campo_Livre Pct On (Pct.IdLogistica_House = Lhs.IdLogistica_House) And (Pct.IdConfiguracao_Campo_Livre = 155)\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Pft on Pft.IdOferta_Frete = COALESCE(Lhs.IdOferta_Frete,Lhs.IdOferta_Frete_Original) And Pft.IdConfiguracao_Campo_Livre = 151\nLeft Outer Join\n  vis_Logistica_Campo_Livre Cl1 On (Cl1.IdLogistica_House = Lhs.IdLogistica_House) And (Cl1.IdConfiguracao_Campo_Livre = 156 /*Info Buying*/)\nLeft Outer Join\n  vis_Logistica_Campo_Livre Cl2 On (Cl2.IdLogistica_House = Lhs.IdLogistica_House) And (Cl2.IdConfiguracao_Campo_Livre = 157 /*Info Selling*/)\nLeft Outer Join\n(SELECT\n  Lmt.IdLogistica_House,\n  Lmt.IdOrigem as IdPorto_Transbordo,\n  RANK() OVER(PARTITION BY Lmt.IdLogistica_House ORDER BY Lmt.Data_Embarque DESC,Lmt.IdLogistica_Viagem DESC) as Ranking\nFROM\n  mov_Logistica_Viagem Lmt\nWHERE\n  Lmt.Tipo_Viagem = 5 and Lmt.Data_Embarque IS NOT NULL\n) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_Master AND Lmt.Ranking = 1\nLeft Outer Join\n  cad_Origem_Destino Ptb on Ptb.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nWhere\n  Atv.IdAtividade= :IdAtividade\">\n \n\n\n  <DataSet Name=\"Novo_Destino_Final\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Trb.Viagem,\n  Trb.Data_Chegada,\n  Trb.Numero_Controle as Numero_BL,\n  Trb.Data_Desembarque,\n  Trb.Data_Previsao_Embarque,\n  Trb.Data_Previsao_Desembarque,\n  Trb.Data_Embarque,\n  Trb.Data_Previsao_Chegada,\n  Trb.Data_Chegada,\n  Trb.Porto_Transbordo,\n  Trb.Navio_Transbordo,\n  CASE\n  WHEN Trb.Porto_Desembarque IS NOT NULL THEN 'Com_Delivery' else 'Sem_Delivey' end as Variavel_Delivery,\n  Trb.Navio_Transbordo as Navio,\n  Trb.Porto_Desembarque as Destino_Final,\n  coalesce(Trb.Navio_Transbordo,Nvi.Nome) As Navio_Chegada,\n  coalesce(Trb.Viagem,Lmm.Viagem_Navio) As Viagem_Chegada,\n  Trb.Observacao,\n  Case\n  When Trb.Situacao_Embarque = 0 Then 'Não informado'\n  When Trb.Situacao_Embarque = 1 Then 'Aguardando embarque'\n  When Trb.Situacao_Embarque = 2 Then 'Embarcado'\n  When Trb.Situacao_Embarque = 3 Then 'Desembarcado'\n  When Trb.Situacao_Embarque = 4 Then 'Cancelado'\n  End as Situacao_Embarque\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join(\n  SELECT\n    Lgv.IdLogistica_Viagem,\n    Lgv.IdLogistica_House,\n    Lgv.Numero_Controle,\n    Lgv.Numero_Conhecimento,\n    Lgv.Situacao_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque,\n    Nvi.Nome as Navio_Transbordo,\n    Lgv.Data_Embarque,\n    Van.Data_Previsao_Desembarque AS Data_Previsao_Chegada,\n    Van.Data_Desembarque AS Data_Chegada,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.IdLogistica_House, Van.Data_Previsao_Desembarque Desc, Lgv.IdLogistica_Viagem)As Ranking\n  FROM\n    mov_Logistica_Viagem Lgv\n  JOIN\n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Sequencia - 1\n  Left Outer Join\n    cad_Navio Nvi on Nvi.IdNavio = Lgv.IdNavio\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  Where\n  Lgv.Tipo_Viagem = 6 /*Destino Final*/) Trb on Trb.IdLogistica_House = Lhs.IdLogistica_House And Trb.Ranking = 1\nWhere\n  Atv.IdAtividade = :IdAtividade\nOrder by\n  Trb.IdLogistica_Viagem Desc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxa_Frete\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Ltx.IdLogistica_Taxa,\n  Lhs.Numero_Processo,\n  Lte.Nome as Taxa,\n  Lte.Nome_Internacional as Taxa_International,\n  Ltx.Tipo_Pagamento,\n  Ltx.Tipo_Recebimento,\n  Emr.Descricao As Equipamento_Maritimo,\n  Mdp.Sigla as Moeda_Pagamento,\n  Mdr.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Pagamento_Minimo,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Origem_Taxa\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Taxa Ltx On Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr On Ltx.IdEquipamento_Maritimo = Emr.IdEquipamento_Maritimo\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Lte On Lte.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Moeda Mdp On Mdp.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mdr On Mdr.IdMoeda = Ltx.IdMoeda_Recebimento\nWhere \n  Lte.IdTaxa_Logistica_Exibicao = 2\nAnd \n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,\n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<head>\n<style type=\"text/css\">\n    body,td,tr,p{ font-family: Calibri, sans-serif; font-size:10.0pt; }\n    td { padding: 2px }\n    th { padding: 1px 4px; font-size: 14.0pt; }\n\n    .cor-fundo_fonte-branca_negrito_borda { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; font-weight: bold; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    .destaque_negrito {background: yellow; font-weight: bold}\n\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .espaco_interno_tabela { padding: 12px 20px; }\n    .alinhamento_esquerda { text-align: left; }\n    .alinhamento_topo { vertical-align: top; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .altura-linha { line-height: 3px; }\n    .sublinhado { text-decoration: underline; }\n    .destaque { background: yellow; }\n    .cabecalho { padding: 5px }\n    .espaco-direita { padding-right: 38px; }\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#00<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">000; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nCONFIRMAÇÃO DE EMBARQUE - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"> - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n[Report.Detail]\n<SubReport NameSource=\"Processo\" NameField=\"Mensagem\">\n[Report.Footer]\n\n\n\n\n\n[Modelo_Padrao.Detail]\n<table width=\"775\">\n  <tr>\n    <td><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n  </tr>\n</table>\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td><span class=\"negrito\">PARA:</span> <Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Curitiba,</span> <Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\">\n  <tr>\n    <th class=\"cor-fundo_fonte-branca_negrito_borda\">CONFIRMAÇÃO DE EMBARQUE</th>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td>Prezados,</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td>Confirmamos o embarque de sua carga no referido navio, segue cópia do BL.</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td><span class=\"negrito\">Booking</span> <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Navio:</span> <Print Dataset=\"Processo\" FieldName=\"Navio\"><Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Saída:</span> <Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Porto de Embarque:</span> <Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Porto de Descarga:</span> <Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <SubReport NameField=\"Variavel_Delivery\" NameSource=\"Novo_Destino_Final\">\n  <tr>\n    <td valign=\"top\"><span class=\"negrito\">Local de emissão do BL:</span> <span class=\"espaco-direita\"><Print Dataset=\"Processo\" FieldName=\"Emissao_House\"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"destaque_negrito\"><Print Dataset=\"Processo\" FieldName=\"Frase_Realease\"></span></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Exportador:</span> <Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">CNEE:</span> <Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">HBL:</span> <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Modalidade Pagamento House:</span> <Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n</table>\n<br>\n\n<table width=\"575\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td>Gentileza conferir o BL de acordo com o draft enviado, qualquer inserção de dados ou alteração haverá custo de reemissão, o BL EXPRESS RELEASE / ORIGINAL será liberado <span class=\"sublinhado\"><Print Dataset=\"Processo\" FieldName=\"Master_Direto\"></span></td>\n  </tr>\n  <tr><td>\n</td></tr>\n  <tr>\n    <td>Valores para pagamento serão enviados pelo departamento financeiro assim que as taxas estiverem disponíveis para verificação.</td>\n  </tr>\n  <tr><td>\n</td></tr>\n  <tr>\n    <td>Qualquer dúvida, entrar em contato conosco.</td>\n  </tr>\n  <tr><td>\n</td></tr>\n  <tr>\n    <td>Permanecemos à sua inteira disposição para qualquer informação adicional.</td>\n  </tr>\n  <tr><td>\n</td></tr> \n  <tr>\n    <td>Sds,</td>\n  </tr>\n</table>\n<br>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><br><signature></td>\n  </tr>\n</table>\n[Modelo_Padrao.Footer]\n\n\n\n\n\n\n[Modelo_Direto.Detail]\n<table width=\"775\">\n  <tr>\n    <td><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n  </tr>\n</table>\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td><span class=\"negrito\">PARA:</span> <Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Curitiba,</span> <Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\">\n  <tr>\n    <th class=\"cor-fundo_fonte-branca_negrito_borda\">CONFIRMAÇÃO DE EMBARQUE</th>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td>Prezados,</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td>Confirmamos o embarque de sua carga no referido navio, segue cópia do BL.</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td><span class=\"negrito\">Booking</span> <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Navio:</span> <Print Dataset=\"Processo\" FieldName=\"Navio\"><Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Saída:</span> <Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Porto de Embarque:</span> <Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Porto de Descarga:</span> <Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <SubReport NameField=\"Variavel_Delivery\" NameSource=\"Novo_Destino_Final\">\n  <tr>\n    <td valign=\"top\"><span class=\"negrito\">Local de emissão do BL:</span> <span class=\"espaco-direita\"><Print Dataset=\"Processo\" FieldName=\"Emissao_House\"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"destaque_negrito\"><Print Dataset=\"Processo\" FieldName=\"Frase_Realease\"></span></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Exportador:</span> <Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">CNEE:</span> <Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">MBL:</span> <Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Modalidade Pagamento House:</span> <Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n</table>\n<br>\n\n<table width=\"575\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td>Gentileza conferir o BL de acordo com o draft enviado, qualquer inserção de dados ou alteração haverá custo de reemissão, o BL WAYBILL será liberado <span class=\"sublinhado\"><Print Dataset=\"Processo\" FieldName=\"Master_Direto\"></span></td>\n  </tr>\n  <tr><td>\n</td></tr>\n  <tr>\n    <td>Valores para pagamento serão enviados pelo departamento financeiro assim que as taxas estiverem disponíveis para verificação.</td>\n  </tr>\n  <tr><td>\n</td></tr>\n  <tr>\n    <td>Qualquer dúvida, entrar em contato conosco.</td>\n  </tr>\n  <tr><td>\n</td></tr>\n  <tr>\n    <td>Permanecemos à sua inteira disposição para qualquer informação adicional.</td>\n  </tr>\n  <tr><td>\n</td></tr> \n  <tr>\n    <td>Sds,</td>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><br><signature></td>\n  </tr>\n</table>\n[Modelo_Direto.Footer]\n\n\n\n\n\n[Com_Delivery]\n  <tr>\n    <td colspan=\"2\" valign=\"top\"><span class=\"negrito\">Destino Final:</span> <Print Dataset=\"Novo_Destino_Final\" FieldName=\"Destino_Final\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>\n  </tr>\n\n[Sem_Delivery]\n  <tr>\n    <td colspan=\"2\" valign=\"top\"><span class=\"negrito\"></td>\n  </tr>\n</table>\n\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROJETO 2019 - EM CONFIRMAÇÃO DE EMBARQUE_TIRRENA_#45562 .html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  case when Lms.Master_Direto = 0 then 'não' when Lms.Master_Direto = 1 then 'sim' end as Master_Direto,\n  CASE WHEN Lms.Master_Direto = 1 THEN Lms.Numero_Conhecimento ELSE Lhs.Conhecimentos END AS Conhecimentos,\n  CASE WHEN Lms.Master_Direto = 1 THEN 'MBL' ELSE 'HBL' END AS Label_Doc,\n    CASE WHEN Lms.Master_Direto = 1 THEN Lms.Numero_Conhecimento ELSE Lhs.Conhecimentos END AS Conhecimentos,\n  CASE WHEN Lms.Master_Direto = 1 THEN 'MBL' ELSE 'HBL' END AS Label_Doc,\n  CASE WHEN Lms.Master_Direto = 1 THEN 'Gentileza conferir o BL de acordo com o draft enviado, qualquer inserção de dados ou alteração haverá custo de reemissão, o BL WAYBILL será liberado após pagamentos das taxas locais, autorização do shipper e frete pelo importador.' ELSE 'Gentileza conferir o BL de acordo com o draft enviado, qualquer inserção de dados ou alteração haverá custo de reemissão, o BL ORIGINAL será liberado após pagamentos das taxas locais.' END AS Texto_Rodape,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Transit_Time,\n  Lms.Transit_Time_Maximo,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Cpf_Cnpj,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  ' / ' + Lmm.Viagem_Navio AS Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Lhs.NCM_Descricao,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  CASE \n    WHEN Lhs.Tipo_Frete = 1 THEN 'FAK'\n    WHEN Lhs.Tipo_Frete = 2 THEN 'NAC'\n    WHEN Lhs.Tipo_Frete = 3 THEN 'BID'\n    WHEN Lhs.Tipo_Frete = 4 THEN 'Long Term'\n    WHEN Lhs.Tipo_Frete = 5 THEN 'SPOT'\n  END AS Tipo_Frete,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Case\n    When Lhs.Local_Emissao = 1 Then 'DESTINO' \n    When Lhs.Local_Emissao = 2 Then 'EXPRESS RELEASE' \n    When Lhs.Local_Emissao = 3 Then 'ORIGEM' \n    When Lhs.Local_Emissao = 4 Then 'SEA WAYBILL' \n  End as Emissao_House,\n  Case\n    When Lms.Local_Emissao = 1 Then 'DESTINO' \n    When Lms.Local_Emissao = 2 Then 'EXPRESS RELEASE' \n    When Lms.Local_Emissao = 3 Then 'ORIGEM' \n    When Lms.Local_Emissao = 4 Then 'SEA WAYBILL' \n  End as Emissao_Master,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade,\n  Ven.Nome AS Vendedor,\n  Pct.Valor_Alfanumerico as Po_Contract,\n  Pft.Valor_Texto as Profit,\n  Case \n    When Lhs.Local_Emissao = 2 Then '*WILL BE EXPRESS REALEASE – DON’T RELEASE THE CARGO WITHOUT OUR AUTHORIZATION*' \n    Else Null \n  End as Frase_Realease,\n  Cl1.Valor_Texto as Info_Buying,\n  Cl2.Valor_Texto as Info_Selling,\n  CASE\n  WHEN Lmt.IdPorto_Transbordo IS NULL THEN Lhs.Rota\n  ELSE Ptb.Nome\n  END as Porto_Transbordo,\n  CASE DATEPART(MONTH,Lhs.Data_Previsao_Entrega)\n    WHEN 1 THEN 'JANUARY'\n    WHEN 2 THEN 'FEBRUARY'\n    WHEN 3 THEN 'MARCH'\n    WHEN 4 THEN 'APRIL'\n    WHEN 5 THEN 'MAY'\n    WHEN 6 THEN 'JUNE'\n    WHEN 7 THEN 'JULY'\n    WHEN 8 THEN 'AUGUST'\n    WHEN 9 THEN 'SEPTEMBER'\n    WHEN 10 THEN 'OCTOBER'\n    WHEN 11 THEN 'NOVEMBER'\n    WHEN 12 THEN 'DECEMBER'\n  END as Mes_Previsao_Entrega_Ing,\n  CASE DATEPART(DAY,Lhs.Data_Previsao_Entrega)\n   WHEN 1 THEN '01st'\n   WHEN 2 THEN '02nd'\n   WHEN 3 THEN '03rd'\n   WHEN 4 THEN '04th'\n   WHEN 5 THEN '05th'\n   WHEN 6 THEN '06th'\n   WHEN 7 THEN '07th'\n   WHEN 8 THEN '08th'\n   WHEN 9 THEN '09th'\n   WHEN 10 THEN '10th'\n   WHEN 11 THEN '11th'\n   WHEN 12 THEN '12th'\n   WHEN 13 THEN '13th'\n   WHEN 14 THEN '14th'\n   WHEN 15 THEN '15th'\n   WHEN 16 THEN '16th'\n   WHEN 17 THEN '17th'\n   WHEN 18 THEN '18th'\n   WHEN 19 THEN '19th'\n   WHEN 20 THEN '20th'\n   WHEN 21 THEN '21st'\n   WHEN 22 THEN '22nd'\n   WHEN 23 THEN '23rd'\n   WHEN 24 THEN '24th'\n   WHEN 25 THEN '25th'\n   WHEN 26 THEN '26th'\n   WHEN 27 THEN '27th'\n   WHEN 28 THEN '28th'\n   WHEN 29 THEN '29th'\n   WHEN 30 THEN '30th'\n   WHEN 31 THEN '31st'\n  END as Dia_Previsao_Entrega_Ing,\n  CASE\n     WHEN Lms.Master_Direto = 0 THEN 'após pagamentos das taxas locais e autorização do shipper.'\n     ELSE 'após pagamentos das taxas e frete pelo importador.'\n  END AS Master_Direto\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ven ON Ven.IdPessoa = Lhs.IdVendedor\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  vis_Logistica_Campo_Livre Pct On (Pct.IdLogistica_House = Lhs.IdLogistica_House) And (Pct.IdConfiguracao_Campo_Livre = 155)\nLeft Outer Join\n  vis_Oferta_Frete_Campo_Livre Pft on Pft.IdOferta_Frete = COALESCE(Lhs.IdOferta_Frete,Lhs.IdOferta_Frete_Original) And Pft.IdConfiguracao_Campo_Livre = 151\nLeft Outer Join\n  vis_Logistica_Campo_Livre Cl1 On (Cl1.IdLogistica_House = Lhs.IdLogistica_House) And (Cl1.IdConfiguracao_Campo_Livre = 156 /*Info Buying*/)\nLeft Outer Join\n  vis_Logistica_Campo_Livre Cl2 On (Cl2.IdLogistica_House = Lhs.IdLogistica_House) And (Cl2.IdConfiguracao_Campo_Livre = 157 /*Info Selling*/)\nLeft Outer Join\n(SELECT\n  Lmt.IdLogistica_House,\n  Lmt.IdOrigem as IdPorto_Transbordo,\n  RANK() OVER(PARTITION BY Lmt.IdLogistica_House ORDER BY Lmt.Data_Embarque DESC,Lmt.IdLogistica_Viagem DESC) as Ranking\nFROM\n  mov_Logistica_Viagem Lmt\nWHERE\n  Lmt.Tipo_Viagem = 5 and Lmt.Data_Embarque IS NOT NULL\n) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_Master AND Lmt.Ranking = 1\nLeft Outer Join\n  cad_Origem_Destino Ptb on Ptb.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nWhere\n  Atv.IdAtividade= :IdAtividade\">\n\n\n  <DataSet Name=\"Novo_Destino_Final\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Trb.Viagem,\n  Trb.Data_Chegada,\n  Trb.Numero_Controle as Numero_BL,\n  Trb.Data_Desembarque,\n  Trb.Data_Previsao_Embarque,\n  Trb.Data_Previsao_Desembarque,\n  Trb.Data_Embarque,\n  Trb.Data_Previsao_Chegada,\n  Trb.Data_Chegada,\n  Trb.Porto_Transbordo,\n  Trb.Navio_Transbordo,\n  CASE\n  WHEN Trb.Porto_Desembarque IS NOT NULL THEN 'Com_Delivery' else 'Sem_Delivey' end as Variavel_Delivery,\n  Trb.Navio_Transbordo as Navio,\n  Trb.Porto_Desembarque as Destino_Final,\n  coalesce(Trb.Navio_Transbordo,Nvi.Nome) As Navio_Chegada,\n  coalesce(Trb.Viagem,Lmm.Viagem_Navio) As Viagem_Chegada,\n  Trb.Observacao,\n  Case\n  When Trb.Situacao_Embarque = 0 Then 'Não informado'\n  When Trb.Situacao_Embarque = 1 Then 'Aguardando embarque'\n  When Trb.Situacao_Embarque = 2 Then 'Embarcado'\n  When Trb.Situacao_Embarque = 3 Then 'Desembarcado'\n  When Trb.Situacao_Embarque = 4 Then 'Cancelado'\n  End as Situacao_Embarque\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join(\n  SELECT\n    Lgv.IdLogistica_Viagem,\n    Lgv.IdLogistica_House,\n    Lgv.Numero_Controle,\n    Lgv.Numero_Conhecimento,\n    Lgv.Situacao_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque,\n    Nvi.Nome as Navio_Transbordo,\n    Lgv.Data_Embarque,\n    Van.Data_Previsao_Desembarque AS Data_Previsao_Chegada,\n    Van.Data_Desembarque AS Data_Chegada,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.IdLogistica_House, Van.Data_Previsao_Desembarque Desc, Lgv.IdLogistica_Viagem)As Ranking\n  FROM\n    mov_Logistica_Viagem Lgv\n  JOIN\n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Sequencia - 1\n  Left Outer Join\n    cad_Navio Nvi on Nvi.IdNavio = Lgv.IdNavio\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  Where\n  Lgv.Tipo_Viagem = 6 /*Destino Final*/) Trb on Trb.IdLogistica_House = Lhs.IdLogistica_House And Trb.Ranking = 1\nWhere\n  Atv.IdAtividade = :IdAtividade\nOrder by\n  Trb.IdLogistica_Viagem Desc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxa_Frete\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Ltx.IdLogistica_Taxa,\n  Lhs.Numero_Processo,\n  Lte.Nome as Taxa,\n  Lte.Nome_Internacional as Taxa_International,\n  Ltx.Tipo_Pagamento,\n  Ltx.Tipo_Recebimento,\n  Emr.Descricao As Equipamento_Maritimo,\n  Mdp.Sigla as Moeda_Pagamento,\n  Mdr.Sigla as Moeda_Recebimento,\n  Ltx.Valor_Pagamento_Minimo,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Origem_Taxa\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Taxa Ltx On Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr On Ltx.IdEquipamento_Maritimo = Emr.IdEquipamento_Maritimo\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Lte On Lte.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Moeda Mdp On Mdp.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mdr On Mdr.IdMoeda = Ltx.IdMoeda_Recebimento\nWhere \n  Lte.IdTaxa_Logistica_Exibicao = 2\nAnd \n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,\n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<head>\n<style type=\"text/css\">\n    body,td,tr,p{ font-family: Calibri, sans-serif; font-size:10.0pt; }\n    td { padding: 2px }\n    th { padding: 1px 4px; font-size: 14.0pt; }\n\n    .cor-fundo_fonte-branca_negrito_borda { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; font-weight: bold; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    .destaque_negrito {background: yellow; font-weight: bold}\n\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .espaco_interno_tabela { padding: 12px 20px; }\n    .alinhamento_esquerda { text-align: left; }\n    .alinhamento_topo { vertical-align: top; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .altura-linha { line-height: 3px; }\n    .sublinhado { text-decoration: underline; }\n    .destaque { background: yellow; }\n    .cabecalho { padding: 5px }\n    .espaco-direita { padding-right: 38px; }\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#00<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">000; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nCONFIRMAÇÃO DE EMBARQUE - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade\"> - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n[Report.Detail]\n<table width=\"775\">\n  <tr>\n    <td><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n  </tr>\n</table>\n<br>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td><span class=\"negrito\">PARA:</span> <Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Curitiba,</span> <Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\">\n  <tr>\n    <th class=\"cor-fundo_fonte-branca_negrito_borda\">CONFIRMAÇÃO DE EMBARQUE</th>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td>Prezados,</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td>Confirmamos o embarque de sua carga no referido navio, segue cópia do BL.</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td><span class=\"negrito\">Booking</span> <Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Navio:</span> <Print Dataset=\"Processo\" FieldName=\"Navio\"><Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Saída:</span> <Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Porto de Embarque:</span> <Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Porto de Descarga:</span> <Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <SubReport NameField=\"Variavel_Delivery\" NameSource=\"Novo_Destino_Final\">\n  <tr>\n    <td valign=\"top\"><span class=\"negrito\">Local de emissão do BL:</span> <span class=\"espaco-direita\"><Print Dataset=\"Processo\" FieldName=\"Emissao_House\"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"destaque_negrito\"><Print Dataset=\"Processo\" FieldName=\"Frase_Realease\"></span></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Exportador:</span> <Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">CNEE:</span> <Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Label_Doc\">:</span> <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n  </tr>\n  <tr>\n    <td><span class=\"negrito\">Modalidade Pagamento House:</span> <Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n</table>\n<br>\n\n<table width=\"575\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td style=\"text-align: justify;\">\n      <Print Dataset=\"Processo\" FieldName=\"Texto_Rodape\">\n        <br>\n    </td>\n  </tr>\n  <tr>\n    <td style=\"text-align: justify;\">Valores para pagamento serão enviados pelo departamento financeiro assim que as taxas estiverem disponíveis para verificação.</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td>Qualquer dúvida, entrar em contato conosco.</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td>Permanecemos à sua inteira disposição para qualquer informação adicional.</td>\n  </tr>\n  <tr><td>&nbsp;</td></tr>\n  <tr>\n    <td>Sds,</td>\n  </tr>\n</table>\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><br><signature></td>\n  </tr>\n</table>\n\n[Com_Delivery]\n  <tr>\n    <td colspan=\"2\" valign=\"top\"><span class=\"negrito\">Destino Final:</span> <Print Dataset=\"Novo_Destino_Final\" FieldName=\"Destino_Final\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>\n  </tr>\n\n[Sem_Delivery]\n  <tr>\n    <td colspan=\"2\" valign=\"top\"><span class=\"negrito\"></td>\n  </tr>\n\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROJETO 2019 - IM - SHIPPING INSTRUCTIONS #45138.html",
        "conteudo": "[Report.Header]\n<!DOCTYPE html>\n<DataSet Name=\"Processo\" Sql=\"Select TOP 1\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Instrucoes_Agente,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Transit_Time,\n  Lms.Transit_Time_Maximo,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Lhs.NCM_Descricao,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  Case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'AIR EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'SEA EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'LAND EXPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'AIR IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'SEA IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'LAND IMPORT'\n  End as Tipo_Modalidade_Inter,\n  Case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLEFT OUTER JOIN\n  mov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lgv.IdDestino\nWhere\n  Atv.IdAtividade=:IdAtividade\n  ORDER BY\n  Lgv.Sequencia DESC\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Frete_Conhecimento\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Mpg.Sigla as Moeda_Pagamento,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 1 /*Frete*/\nAnd\n  Ltx.Exibir_Conhecimento = 1\nAnd\n  Ltx.Receber_De not in (0) /*Sem cobrança*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Origem_Conhecimento\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 2 /*Origem*/\nAnd\n  Ltx.Exibir_Conhecimento = 1\nAnd\n  Ltx.Receber_De not in (0) /*Sem cobrança*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Destino_Conhecimento\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then ' Processo'/*Peso Cubado*/\n    When 3 Then ' Kg'/*Peso Cubado*/\n    When 4 Then ' Kg'/*Peso Taxado*/\n    When 5 Then ' Kg'/*Peso Bruto*/\n    When 6 Then ' CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then 'Awb' When 2 then 'BL'  else NULL end\n    When 8 Then 'Invoice'\n    When 9 Then 'Volume'\n    When 10 Then 'Cntr' /*Equipamento*/\n    When 11 Then Emr.Descricao\n    When 12 Then 'TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then 'Via Master'\n    When 16 Then 'Via house'\n    When 17 Then ' Kg'/*Peso Considerado*/\n    When 18 Then ' Kg' /*Peso taxado master*/\n    When 19 Then ' Carreta'\n    When 20 Then ' U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Origem_Taxa = 3 /*Destino*/\nAnd\n  Ltx.Exibir_Conhecimento = 1\nAnd\n  Ltx.Receber_De not in (0) /*Sem cobrança*/\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Taxas_Fatura_Agente\" Sql=\"Select\n  Ltx.IdLogistica_House,\n  Mrc.Sigla as Moeda_Recebimento,\n  Case Ltx.Tipo_Recebimento\n   When 13 Then ''\n   Else Mrc.Sigla\n  End As Moeda_Rec_Dinamica,\n  Case Ltx.Tipo_Pagamento\n   When 13 Then ''\n   Else Mpg.Sigla\n  End As Moeda_Pag_Dinamica,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Tipo_Recebimento,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Minimo,\n  Ltx.Valor_Recebimento_Total,\n  Ltx.Tipo_Pagamento,\n  Mpg.Sigla as Moeda_Pagamento,\n  Ltx.Quantidade_Pagamento,\n  Ltx.Valor_Pagamento_Unitario,\n  Ltx.Valor_Pagamento_Total,\n  Ltx.Valor_Pagamento_Minimo,\n  CASE Ltx.Origem_Taxa\n    When 1 Then 'Frete'\n    When 2 Then 'Origem'\n    When 3 Then 'Destino'\n  end as Origem_Taxa,\n  Ltx.Complemento,\n  Ltx.Exibir_Conhecimento,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  CASE COALESCE(Ltx.Tipo_Recebimento,Ltx.Tipo_Pagamento) \n    When 1 Then ''/*(Sem cobrança)*/\n    When 2 Then '/ Processo'/*Peso Cubado*/\n    When 3 Then '/ Kg'/*Peso Cubado*/\n    When 4 Then '/ Kg'/*Peso Taxado*/\n    When 5 Then '/ Kg'/*Peso Bruto*/\n    When 6 Then '/ CBM'/*Metro Cubico*/\n    When 7 Then case Lms.Modalidade_Processo When 1 then '/ AWB' When 2 then '/ BL'  else NULL end\n    When 8 Then '/ Invoice'\n    When 9 Then '/ Volume'\n    When 10 Then '/ Cntr' /*Equipamento*/\n    When 11 Then '/ ' + Emr.Descricao\n    When 12 Then '/ TEU'\n    When 13 Then ' %'/*Percentual*/\n    When 14 Then ''/*livre*/\n    When 15 Then '/ Via Master'\n    When 16 Then '/ Via house'\n    When 17 Then '/ Kg'/*Peso Considerado*/\n    When 18 Then '/ Kg' /*Peso taxado master*/\n    When 19 Then '/ Carreta'\n    When 20 Then '/ U.N.' /*(Nações Unidas)*/\n    When 21 Then ' % sobre importância segurada'\n    When 22 Then ' % sobre valor mercadoria'       \n  end as Tipo_Unico\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House  \nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.Exibir_Agente = 1\nAnd\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n\n  <DataSet Name=\"Correspondencia\" Sql=\"Select \nExp.correspondencia as Exportador,\nCpd.correspondencia as Exalog,\nExp.Email\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_logistica_master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n\tcad_pessoa Exp ON Exp.idpessoa = Lhs.IdExportador\nLeft Outer Join\t\n\tcad_pessoa Cpd ON Cpd.idpessoa = 44488\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n  \n<DataSet Name=\"Taxas\" Sql=\"\nSELECT\n    (\n        SELECT TOP 1 \n            Ltx.Valor_pagamento_total\n        FROM \n            mov_Logistica_Taxa Ltx\n        LEFT OUTER JOIN \n            mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\n        WHERE\n            Ltx.IdTaxa_logistica_exibicao = 1026\n    ) AS Valor_Frete,\n\n    (\n        SELECT TOP 1 \n            Mpg.Sigla\n        FROM\n            mov_Logistica_Taxa Ltx\n        LEFT OUTER JOIN \n            mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\n        LEFT OUTER JOIN \n            cad_Moeda Mpg ON Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\n        WHERE    \n            Ltx.IdTaxa_logistica_exibicao = 1026\n    ) AS Moeda_Frete,\n\n    (\n        SELECT TOP 1\n            Ltx.Valor_pagamento_total\n        FROM\n            mov_Logistica_Taxa Ltx\n        LEFT OUTER JOIN \n            mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\n        WHERE\n            Ltx.IdTaxa_logistica_exibicao = 782\n    ) AS Valor_EXW,\n\n    (\n        SELECT TOP 1\n            Mpg.Sigla\n        FROM \n            mov_Logistica_Taxa Ltx\n        LEFT OUTER JOIN \n            mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Ltx.IdLogistica_House\n        LEFT OUTER JOIN \n            cad_Moeda Mpg ON Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\n        WHERE\n            Ltx.IdTaxa_logistica_exibicao = 782\n    ) AS Moeda_EXW\n FROM\n    mov_Atividade Atv\nWHERE\n    Atv.IdAtividade = :IdAtividade\">\n\n\n    <DataSet Name=\"PROFIT\" Sql=\"\nSELECT TOP 1\nMoe.Sigla AS Moeda,\nFORMAT(Ltx.Valor_Pagamento_Unitario, '#,##0.00') AS VALOR_PROFIT\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House \n LEFT OUTER JOIN\n cad_moeda Moe ON Moe.IdMoeda = Ltx.IdMoeda_Pagamento\nWhere\n     Atv.IdAtividade = :IdAtividade\n     AND\n     Ltx.IdTaxa_logistica_exibicao = 165\">\n\n<DataSet Name=\"EXW\" Sql=\"\nSELECT\nCASE WHEN Ltx.Valor_Pagamento_Unitario > 0 THEN 'HBL EXW:' ELSE '' END AS Titulo,\nMoe.Sigla AS Moeda,\nFORMAT(Ltx.Valor_Pagamento_Unitario, '#,##0.00') AS Valor\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join \n mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House \n LEFT OUTER JOIN\n cad_moeda Moe ON Moe.IdMoeda = Ltx.IdMoeda_Pagamento\nWhere\n     Atv.IdAtividade = :IdAtividade\n     AND\n     Ltx.IdTaxa_logistica_exibicao = 782\n     AND\n     COALESCE(Ltx.Valor_Pagamento_Unitario, 0) > 0\">\n\n     <DataSet Name=\"Frete\" Sql=\"\n     SELECT\n       CASE WHEN Ltx.Valor_Pagamento_Unitario > 0 THEN 'HBL Freight:' ELSE '' END AS Titulo,\n       Moe.Sigla AS Moeda,\n       FORMAT(Ltx.Valor_Pagamento_Unitario, '#,##0.00') AS Valor\n     From\n       mov_Atividade Atv\n     Left Outer Join\n       mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n     Left Outer Join\n       mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n     Left Outer Join \n       mov_Logistica_Taxa Ltx on Ltx.IdLogistica_House = Lhs.IdLogistica_House \n     LEFT OUTER JOIN\n       cad_moeda Moe ON Moe.IdMoeda = Ltx.IdMoeda_Pagamento\n     Where\n       Atv.IdAtividade = :IdAtividade\n       AND\n       Ltx.IdTaxa_logistica_exibicao = 1026 \n       AND\n       COALESCE(Ltx.Valor_Pagamento_Unitario, 0) > 0\n     \">\n\n<html>\n<head>\n    <meta charset=\"utf-8\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <title>SHIPPING INSTRUCTIONS - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - Cliente: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\">/<Print Dataset=\"Processo\" FieldName=\"Destino\"></title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <style type=\"text/css\">\n        * { box-sizing: border-box; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n        .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n        th { font-size: 14px; }\n        .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .text-center { text-align: center; vertical-align: middle; }\n        .logo-espacamento { padding: 16px 0; }\n        .text-left { text-align: left; }\n        .text-right { text-align: right; }\n        .vertical-align-top { vertical-align: top; }\n        .vertical-align-bottom { vertical-align: bottom; }\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-white { color: white; }\n        .cor-fonte-vermelho { color: #f44336; }\n        .negrito { font-weight: bold; }\n        .sem-negrito { font-weight: normal; }\n        .logo-assinatura { padding-right: 4px; border-right: 2px solid #204080; }\n        .td-contato { padding-left: 4px; }\n        .font-size-14 { font-size: 14px; }\n        .font-size-13 { font-size: 13px; }\n        .font-size-16 { font-size: 16px; }\n        .margin-bottom-5 { margin-bottom: 5px; }\n        .line-height-3 { line-height: 3px; }\n\n        .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n        .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    </style>\n</head>\n<body>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nSHIPPING INSTRUCTIONS <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade_Inter\"> - PROCESS: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - CLIENT: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> / <Print Dataset=\"Processo\" FieldName=\"Destino\">\n[Subject.Footer]\n\n[Report.Detail]\n\n\n\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">SHIPPING INSTRUCTIONS - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade_Inter\"></td>\n    </tr>\n  </table>\n</span>\n<br>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td width=\"70%\" class=\"font-size-16 negrito vertical-align-bottom\">SHIPPING INSTRUCTION: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n            <td rowspan=\"2\" width=\"30%\" class=\"text-center logo-espacamento\"><br><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"><br></td>\n        </tr>\n        <tr>\n            <td class=\"vertical-align-top\">Agent Name: <span><Print Dataset=\"Processo\" FieldName=\"Agente\"></span></td>\n        </tr>\n        <tr><td>Dear Partner, </td></tr>\n        <tr>\n            <td>\n                <br>\n                Bellow you can find our Shipping Instruction about a new cargo. <br>\n                Kindly contact shipper and advise goods readiness by overnight. \n                <br><br>\n            </td>\n        </tr>\n        <br>\n        <tr>\n            <td>\n                Please note mandatory instructions: <br>\n                - Please inform cargo receipt/pick up date. <br>\n                - When cargo arrive at your warehouse, please send us your WR receipt with complete information about the cargo. <br>\n                - Please send us pictures of cargo. <br>\n                - Original invoice + packink list must be attached on hawb (if shipper will send directly to consignee, please inform us and attach a copy on hawb). <br>\n                - If the weight/volume/cbm informed in your WR are different from the invoice, you must contact shipper and request a new set of document and send to us. <br>\n                <span class=\"cor-fonte-vermelho negrito\">- WE NEED ALL DOCUMENTS (DRAFT HBL, WR, COMMERCIAL INVOICE AND PACKING LIST) for cnee's approval before shipment.</span>\n            </td>\n        </tr>\n    </table>\n    <br>\n    <table width=\"775\" class=\"borda\" cellspacing=\"0\">\n        <tr>\n            <th colspan=\"4\" class=\"cor-fundo cor-fonte-white\">SHIPMENT DETAILS</th>\n        </tr>\n        <tr>\n            <td width=\"17%\" class=\"negrito\">PLACE OF RECEIPT:</td>\n            <td width=\"33%\" class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Local_Recebimento\"></td>\n            <td width=\"17%\" class=\"negrito\">ORIGIN:</td>\n            <td width=\"33%\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">DESTINATION:</td>\n            <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n            <td class=\"negrito\">FINAL DESTINATION:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Destino_Final\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CARRIER:</td>\n            <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n            <td class=\"negrito\">INCOTERM:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Incoterm\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">FREIGHT HBL:</td>\n            <td class=\"borda_direita\"><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n            <td class=\"negrito\">FREIGHT MBL:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_Master\"></td>\n        </tr>\n        <tr>\n</tr>\n\n    </table>\n\n    <br>\n\n    <table class=\"borda_sem_baixo\" width=\"775\" cellspacing=\"0\" style=\"height: 300px;\">\n\n    <tr class=\"cor-fundo-2\" style=\"height: 25px;\">\n\n        <th colspan=\"8\" class=\"text-center\" style=\"vertical-align: middle;\">RATES TO ISSUE IN HBL</th>\n    </tr>\n\n<SubReport Name=\"Freight\" Dataset=\"Frete\">\n   <tr style=\"height: 20px;\">\n       <td width=\"15%\" style=\"font-weight: bold; white-space: nowrap; vertical-align: top;\">\n           <Print Dataset=\"Frete\" FieldName=\"Titulo\">\n       </td>\n       <td width=\"85%\" style=\"vertical-align: top;\">\n           <Print Dataset=\"Frete\" FieldName=\"Moeda\"> <Print Dataset=\"Frete\" FieldName=\"Valor\">\n       </td>\n   </tr>\n</SubReport>\n\n<SubReport Name=\"EXW\" Dataset=\"EXW\">\n    <tr style=\"height: 20px;\">\n        <td style=\"font-weight: bold; white-space: nowrap; vertical-align: top;\">\n            <Print Dataset=\"EXW\" FieldName=\"Titulo\">\n        </td>\n        <td style=\"vertical-align: top;\">\n            <Print Dataset=\"EXW\" FieldName=\"Moeda\"> <Print Dataset=\"EXW\" FieldName=\"Valor\">\n        </td>\n    </tr>\n</SubReport>\n\n    <tr>\n        <td colspan=\"2\" style=\"padding: 0;\">\n            <SubReport Name=\"Taxas_Origem\" Dataset=\"Taxas_Origem_Conhecimento\">\n            <SubReport Name=\"Taxas_Frete\" Dataset=\"Taxas_Frete_Conhecimento\">\n        </td>\n    </tr>\n\n</table>\n\n    \n\n    <table width=\"775\" class=\"borda\" cellspacing=\"0\">\n        <tr class=\"cor-fundo-2\">\n            <th class=\"text-center borda_baixo\">HANDLING AND SPECIAL INSTRUCTIONS</th>\n        </tr>\n        <tr>\n            <td><Print Dataset=\"Processo\" FieldName=\"Instrucoes_Agente\"></td>\n        </tr>\n        <SubReport Name=\"PROFIT\" Dataset=\"PROFIT\"> \n        <tr>\n         <td>PROFIT: &nbsp;<Print Dataset=\"PROFIT\" FieldName=\"Moeda\" Format=\"#,##0.00\">&nbsp;<Print Dataset=\"PROFIT\" FieldName=\"VALOR_PROFIT\"></td>\n        </tr>\n        </SubReport>\n        <tr><td>&nbsp;</td></tr>\n        <tr><td>&nbsp;</td></tr>\n    </table>\n    <br><br>\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n    </table>\n\n<br>\n<table width=\"775\" class=\"borda_sem_baixo\" cellspacing=\"0\">\n    \n    <tr class=\"cor-fundo-2\">\n        <th colspan=\"2\">CORRESPONDENCE</th>\n    </tr>\n\n    <tr class=\"cor-fundo\">\n        <th width=\"50%\" class=\"text-center\">Shipper</th>\n        <th width=\"50%\" class=\"text-center borda_direita\">Exalog</th>\n    </tr>\n\n    <SubReport Name=\"Correspondencia\" Dataset=\"Correspondencia\"> \n        \n        [Correspondencia.Detail]\n        <tr>       \n\n            <td class=\"borda_baixo borda_direita font-size-13\">\n                <Print Dataset=\"Correspondencia\" FieldName=\"Exportador\"> <br>\n                E-mail:<Print Dataset=\"Correspondencia\" FieldName=\"Email\"></Print>\n            </td>\n\n            <td class=\"borda_direita_baixo font-size-13\">\n                <Print Dataset=\"Correspondencia\" FieldName=\"Exalog\">\n            </td>\n        </tr>\n    </SubReport>\n</table>\n<br>\n\n\n<table width=\"775\" class=\"borda_sem_baixo\" cellspacing=\"0\">\n    \n    <tr class=\"cor-fundo-2\">\n        <th colspan=\"2\">SHIPPER CONTACT - CONSIGNEE /NOTIFY MBL</th>\n    </tr>\n\n    <tr class=\"cor-fundo\">\n        <th width=\"50%\" class=\"text-center\">CNEE/HBL</th>\n        <th width=\"50%\" class=\"text-center borda_direita\">NOTIFY HBL</th>\n    </tr>\n\n    <SubReport Name=\"Importador\" Dataset=\"Processo\"> \n  <tr>\n   <td>Importador: &nbsp;<Print Dataset=\"Processo\" FieldName=\"Importador\">&nbsp;<Print Dataset=\"Processo\" FieldName=\"Importador_Correspondencia\"></td>\n </tr>\n    </SubReport>\n</table>\n\n\n[Taxas_Origem.Header]\n        <tr class=\"cor-fundo cor-fonte-white\">\n            <th class=\"text-left\">Costs at Origin</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-center font-size-13\">Unit Buying</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-left font-size-13\">Unit Selling</th>\n            <th class=\"text-center font-size-13\">Buying Rate</th>\n            <th class=\"text-center font-size-13\">Selling Rate</th>\n        </tr>\n[Taxas_Origem.Detail]\n        <tr>\n            <td width=\"18%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Taxa_Internacional\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Quantidade_Pagamento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\"> / <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Quantidade_Recebimento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\"> / <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Origem_Conhecimento\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">\n            </td>\n        </tr>\n[Taxas_Origem.Footer]\n\n[Taxas_Frete.Header]\n        <tr class=\"cor-fundo cor-fonte-white\">\n            <th class=\"text-left\">International Freight</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-center font-size-13\">Unit Buying</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-left font-size-13\">Unit Selling</th>\n            <th class=\"text-center font-size-13\">Buying Rate</th>\n            <th class=\"text-center font-size-13\">Selling Rate</th>\n        </tr>\n[Taxas_Frete.Detail]\n        <tr>\n            <td width=\"18%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Taxa_Internacional\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Quantidade_Pagamento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\"> / <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Quantidade_Recebimento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\"> / <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Frete_Conhecimento\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">\n            </td>\n        </tr>\n[Taxas_Frete.Footer]\n\n[Taxas_Destino.Header]\n        <tr class=\"cor-fundo cor-fonte-white\">\n            <th class=\"text-left\">Costs at Destination</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-center font-size-13\">Unit Buying</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-left font-size-13\">Unit Selling</th>\n            <th class=\"text-center font-size-13\">Buying Rate</th>\n            <th class=\"text-center font-size-13\">Selling Rate</th>\n        </tr>\n[Taxas_Destino.Detail]\n        <tr>\n            <td width=\"18%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Taxa_Internacional\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Quantidade_Pagamento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\"> / \n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Quantidade_Recebimento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\"> / <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Destino_Conhecimento\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">\n            </td>\n        </tr>\n[Taxas_Destino.Footer]\n\n[Taxas_Fatura_Agente.Header]\n        <tr class=\"cor-fundo cor-fonte-white\">\n            <th class=\"text-left\">Rates</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-center font-size-13\">Unit Buying</th>\n            <th class=\"text-center font-size-13\">Quant</th>\n            <th class=\"text-left font-size-13\">Unit Selling</th>\n            <th class=\"text-center font-size-13\">Buying Rate</th>\n            <th class=\"text-center font-size-13\">Selling Rate</th>\n        </tr>\n[Taxas_Fatura_Agente.Detail]\n        <tr>\n            <td width=\"18%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Taxa_Internacional\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Quantidade_Pagamento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Valor_Pagamento_Unitario\" DisplayFormat=\",0.00\"> \n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"5%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Quantidade_Recebimento\">\n            </td>\n            <td width=\"21%\" class=\"borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Valor_Recebimento_Unitario\" DisplayFormat=\",0.00\"> \n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Tipo_Unico\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_direita_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Moeda_Pag_Dinamica\"> \n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Valor_Pagamento_Total\" DisplayFormat=\",0.00\">\n            </td>\n            <td width=\"15%\" class=\"text-center borda_baixo font-size-13\">\n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Moeda_Rec_Dinamica\"> \n              <Print Dataset=\"Taxas_Fatura_Agente\" FieldName=\"Valor_Recebimento_Total\" DisplayFormat=\",0.00\">\n            </td>\n        </tr>\n[Taxas_Fatura_Agente.Footer]\n\n[Report.Footer]\n</body>\n</html>\n\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROJETO 2019 - IM SOLICITAÇÃO DE DRAFT A #45353.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Transit_Time,\n  Lms.Transit_Time_Maximo,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Lhs.NCM_Descricao,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  Case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  End as Modalidade_Pagamento_Master,\n  Case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  End as Modalidade_Pagamento_House,\n  Case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  End as Tipo_Modalidade,\n  Case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'AIR EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'SEA EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'LAND EXPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'AIR IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'SEA IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'LAND IMPORT'\n  End as Tipo_Modalidade_Inter\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 As Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n  Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<html>\n<head>\n    <title>SOLICITAÇÃO DE DRAFT - EXPORTAÇÃO MARÍTIMA</title>\n\n    <style>\n        * { box-sizing: border-box; }\n        .container { position: relative; }\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        td { padding: 2px }\n        th { padding: 1px 4px; font-size: 13px; }\n        .tamanho-linha { line-height: 3px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .espaco_interno_tabela { padding: 12px 20px; }\n        .alinhamento_esquerda { text-align: left; }\n        .alinhamento_topo { vertical-align: top; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-destaque { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; }\n        .negrito { font-weight: bold; }\n        .sem-negrito { font-weight: normal; }\n        .assinatura { padding-left: 28px; }\n        .altura-linha { line-height: 3px; }\n        .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n        .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda{ border-left:solid; border-color:#00<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">000; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    </style>\n</head>\n<body>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nDRAFT FOR APPROVAL - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade_Inter\"> - PROCESS: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - CLIENT: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> / <Print Dataset=\"Processo\" FieldName=\"Destino\">\n[Subject.Footer]\n\n[Report.Detail]\n\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">DRAFT FOR APPROVAL - <Print Dataset=\"Processo\" FieldName=\"Tipo_Modalidade_Inter\"></td>\n    </tr>\n  </table>\n</span>\n<br>\n\n    <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n          <td colspan=\"2\" class=\"altura-linha\">&nbsp;</td>\n        </tr>\n        <tr>\n            <td rowspan=\"6\" width=\"50%\" class=\"espaco_interno_tabela\">\n                <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\">\n            </td>\n        </tr>\n        <tr>\n            <td width=\"14%\" class=\"negrito\">REFERENCE:</td>\n            <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CUSTOMER:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">DATE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CUSTOMER REF.:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n        </tr>\n        <tr>\n          <td class=\"negrito\">BOOKING:</td>\n          <td><Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n      </tr>\n        <tr>\n            <td colspan=\"2\" class=\"altura-linha\">&nbsp;</td>\n        </tr>\n    </table>\n    <br>\n    <table width=\"775\" cellspacing=\"0\" cellspacing=\"0\">\n        <tr>\n          <td>\n            Dear <Print Dataset=\"Processo\" FieldName=\"Agente\">\n          </td>\n        </tr>\n        <tr>\n          <td>\n            Please send us the documents for check and approval the DRAFT for this shipment, below the list of the documents that we need:\n          </td>\n        </tr>\n        <tr><td>&nbsp;</td></tr>\n        <tr>\n          <td>- MBL</td>\n        </tr>\n        <tr>\n          <td>- HBL</td>\n        </tr>\n        <tr>\n          <td>- Invoice</td>\n        </tr>\n        <tr>\n          <td> - Packing list</td>\n        </tr>\n    </table>\n    <br>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"5\" style=\"font-family: Arial, sans-serif; font-size: 12px; color: #333;\">\n    \n    <tr>\n        <td style=\"font-weight: bold; font-size: 13px; border-bottom: 2px solid #000; padding-top: 15px;\">\n            ** HBL MANDATORY INFORMATION AND IMPORTANT INSTRUCTIONS **\n        </td>\n    </tr>\n\n    <tr>\n        <td style=\"padding-top: 10px;\">\n            <ul style=\"margin: 0; padding-left: 20px; line-height: 1.6;\">\n                <li><strong>NCM Number:</strong></li>\n                <li><strong>Goods description:</strong> as per commercial invoice (if commercial invoice is not available, confirm with shipper);</li>\n                <li><strong>Consignee complete name, address and CNPJ:</strong> must be mentioned on HBL as per commercial invoice;</li>\n                <li><strong>Gross Weight and CBM:</strong> should be mentioned on HB/L (per kind of package);</li>\n                <li><strong>Seal and Container Number:</strong> should be mentioned on the HB/L.</li>\n                <li><strong>Wooden Packing</strong> should be mentioned as below:\n                    <ul style=\"margin-top: 5px; list-style-type: circle;\">\n                        <li>Treated and Certified</li>\n                        <li>Processed Wood</li>\n                        <li>Not Treated and not Certified</li>\n                        <li>Not Applicable</li>\n                    </ul>\n                </li>\n            </ul>\n        </td>\n    </tr>\n\n    <tr>\n        <td style=\"padding-top: 10px;\">\n            <ol style=\"margin: 0; padding-left: 20px; line-height: 1.6;\">\n                <li>To make sure that all data (DATE OF ISSUE, GW, CBM and NCM number) will be same in hbl and mbl.</li>\n                <li>Brazilian Customs <strong>DOES NOT ALLOW</strong>: BL with no freight, “Freight 0,00”, \"Freight as per agreement\" or \"Freight As Agreed\". The freight amount must be stated on the HB/L;</li>\n                <li>Note the data for the MBL below:</li>\n            </ol>\n            \n            <div style=\"margin-top: 10px; margin-left: 20px; background-color: #f8f9fa; border: 1px solid #ddd; padding: 15px; border-radius: 4px;\">\n                <strong style=\"display: block; margin-bottom: 5px; color: #000;\">CONSIGNEE/NOTIFY:</strong>\n                EXALOG ASSESSORIA E LOGISTICA LTDA<br>\n                <strong>CNPJ:</strong> 23.659.517/0001-92<br>\n                Av. Ana Costa 228, sala 71<br>\n                Bairro: Gonzaga Cep: 11060-000 - Phone: 55 13 3234 8531 / +55 13 3233 5991<br>\n                <strong>Email:</strong> bruno.schomer@exalog.com.br\n            </div>\n        </td>\n    </tr>\n\n    <tr>\n        <td style=\"height: 20px;\"></td>\n    </tr>\n\n    <tr>\n        <td class=\"font-size-14\" style=\"font-weight: bold;\">\n            Thank you very much in advanced,\n        </td>\n    </tr>\n\n</table>\n    <br>\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n         <td colspan=\"6\"><signature></td>\n      </tr>\n    </table>\n\n[Report.Footer]\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\PROPOSTA NAO APROVADA POR TARIFA.html",
        "conteudo": "[Report.Header]\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n<title>Proposta</title>\n\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Mmr.Sigla as Moeda_Mercadoria,\n  Lhs.Valor_Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao as Observacao_Processo,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Moeda Mmr ON Mmr.IdMoeda = Lhs.IdMoeda_Mercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\nRsp.Nome,\nRsp.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\ncad_Pessoa Rsp On (Rsp.IdPessoa = Par.IdResponsavel) And (NullIf(LTrim(Rsp.Email), '') Is Not Null)\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd  \nPar.IdPapel_Projeto = 5\">\n\n\n\n<DataSet Name=\"Contato_Vend_Resp\" Sql=\"Select top 1\nRsp.Nome,\nRsp.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nleft outer join\nmov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Par.IdProjeto_Atividade\nleft outer join\ncad_Pessoa Rsp on Rsp.IdPessoa = Pfr.IdResponsavel\nWhere\nAtv.IdAtividade =:IdAtividade\">\n\n\n<DataSet Name=\"Contato_Pricing\" Sql=\"SELECT \n\tFnc.EMail as Responsavel_EMail,\n  CASE\n  WHEN Org.IdOrigem_Destino_Grupo IN (1,2,8,11,14,15,16) THEN 'vitor.buchele@texshipping.com'\n  WHEN Org.IdOrigem_Destino_Grupo IN (10,12) THEN 'jessica.delgado@texshipping.com'\n  else Fnc.EMail\n  END as Contato_Grupo_Origem\nFROM \n  mov_Atividade Atv\nLEFT OUTER JOIN \n  mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\nLEFT OUTER JOIN\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Ofr.IdOrigem\nLEFT OUTER JOIN\n\tmov_Projeto_Atividade_Responsavel Par ON Par.IdProjeto_Atividade = Pfr.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tvis_Funcionario Fnc ON Fnc.IdPessoa = Par.IdResponsavel\nLEFT OUTER JOIN\n\tcad_Papel_Projeto Ppr ON Ppr.IdPapel_Projeto = Par.IdPapel_Projeto\nWHERE\nPpr.IdPapel_Projeto = 5 /*PRICING*/\nAND\nAtv.IdAtividade =:IdAtividade\">\n\n\n<DataSet Name=\"Contato_Vendedor\" Sql=\"Select top 1\nVen.Nome,\nVen.EMail\nFrom \nmov_Atividade Atv\nJoin\nmov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nleft outer join\nmov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Par.IdProjeto_Atividade\nleft outer join\ncad_Pessoa Ven on Ven.IdPessoa = Pfr.IdVendedor\nWhere\nAtv.IdAtividade =:IdAtividade\">\n\n    <DataSet Name=\"Contatos_Coord_Analista\" Sql=\"SELECT \n    CASE \n        WHEN Oft.Tipo_Operacao = 2 /*Importação*/ AND Oft.Modalidade_Processo = 2 /*maritimo*/ THEN 'joao.becker@texshipping.com;'\n        ELSE ''\n    END AS Coordenador_Procurement,\n    CASE \n        WHEN Oft.Modalidade_Processo = 1 /*Aéreo*/ AND (Oft.Tipo_Operacao = 2 /*Importação*/ OR Oft.Tipo_Operacao = 1) /*Exportação*/ THEN 'gabriela.sandri@texshipping.com; marina.tomasoni@texshipping.com;'\n        ELSE ''\n    END AS Coordenador_Pricing,\n    CASE \n        WHEN Oft.Tipo_Operacao = 1 /*Exportação*/ AND Oft.Modalidade_Processo = 2 /*Marítimo*/ THEN 'elaine.costa@texshipping.com;'\n        ELSE ''\n    END AS Coordenador_Pricing_Expo\n    From \n        mov_Atividade Atv\n    LEFT OUTER JOIN\n        mov_Projeto_Atividade_Responsavel Par On Par.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n    LEFT OUTER JOIN \n        mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Par.IdProjeto_Atividade\n    LEFT OUTER JOIN\n        mov_Oferta_Frete Oft ON Oft.IdProposta_Frete = Pfr.IdProposta_Frete\n    WHERE \n        Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7,\n  Ems.Campo_Livre8,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10,\n  Ems.Campo_Livre11,\n  Ems.Campo_Livre12,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Pfr.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Proposta_Frete Pfr on Pfr.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<style type=\"text/css\">\nbody,td,tr{ color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; padding-left:5px}\np{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:10.0pt; text-align:justify}\n.p_instrucoes{ font-family: Calibri, Arial, Helvetica, sans-serif; font-size:8.5pt; text-align:justify}\n.topo{ text-align:center; font-size:18px; font-weight:600; color:#FF0000}\n.negrito{ font-weight:600;}\n.vermelho{ color:#FF0000; font-weight:600;}\n.fundo{ color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Destaque\">; font-weight:600; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; font-size:11.0pt;}\n.tabela_taxa_titulo{ color:#000000; font-weight:600; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size:11.0pt; border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.tabela_taxa{ color:#000000; background:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Cinza\">; font-size:11.0pt;}\n.sublinhado { text-decoration: underline;}\n.borda{ border-left:solid; border-right:solid; border-bottom:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 1px 0px 1px;}\n.borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n.borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n</style>\n</head>\n<align=\"left\" table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n   \n</table>\n<body>\n[Address.Detail]\n<Print Dataset=\"Contato_Pricing\" FieldName=\"Contato_Grupo_Origem\">;feller@texshipping.com;joao.becker@texshipping.com\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"EMail\">\n\n[Subject.Header]\nCANCELAMENTO DO PROCESSO – REF: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - Refe. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\">\n[Subject.Footer]\n[Report.Detail]\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f4f4f7\">\n    <tr>\n        <td align=\"center\" style=\"padding: 20px 0;\">\n            <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"border-radius: 8px; border: 1px solid #dddddd;\">\n                <tr>\n                    <td height=\"6\" bgcolor=\"#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">\" style=\"background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; font-size: 0; line-height: 0;\">&nbsp;</td>\n                </tr>\n                <tr>\n                    <td style=\"padding: 40px 30px; font-family: Helvetica, Arial, sans-serif;\">\n                        <font face=\"Helvetica, Arial, sans-serif\" color=\"#333333\" style=\"font-size: 22px; font-weight: bold;\">\n                            <b>Olá,</b>\n                        </font>\n                        <br><br>\n                        <font face=\"Helvetica, Arial, sans-serif\" color=\"#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">\" style=\"font-size: 14px; line-height: 24px;\">\n                            Informamos que o seguinte processo foi <b>cancelado</b>:\n                        </font>\n                        <br><br>\n                        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8f9fa\">\n                            <tr>\n                                <td width=\"4\" bgcolor=\"#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">\" style=\"background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;\"></td>\n                                <td style=\"padding: 15px;\">\n                                    <font face=\"Helvetica, Arial, sans-serif\" color=\"#999999\" style=\"font-size: 11px; text-transform: uppercase;\">\n                                        Número do Processo\n                                    </font>\n                                    <br>\n                                    <font face=\"Helvetica, Arial, sans-serif\" color=\"#333333\" style=\"font-size: 18px; font-weight: bold;\">\n                                        <b><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></b>\n                                    </font>\n                                </td>\n                            </tr>\n                        </table>\n                        <br>\n                        <font face=\"Helvetica, Arial, sans-serif\" color=\"#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">\" style=\"font-size: 14px; font-weight: bold;\">\n                            <b>Motivo do cancelamento:</b>\n                        </font>\n                        <br>\n                        <font face=\"Helvetica, Arial, sans-serif\" color=\"#555555\" style=\"font-size: 14px; line-height: 24px;\">\n                            <Print Dataset=\"Processo\" FieldName=\"Observacao_Processo\">\n                        </font>\n                        <br><br><br>\n                        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                            <tr>\n                                <td style=\"border-bottom: 1px solid #eeeeee;\"></td>\n                            </tr>\n                        </table>\n                        <br>\n                        <font face=\"Helvetica, Arial, sans-serif\" color=\"#999999\" style=\"font-size: 12px;\">\n                            Este é um e-mail automático. Por favor, não responda.\n                        </font>\n                    </td>\n                </tr>\n            </table>\n            <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                <tr>\n                    <td height=\"20\">&nbsp;</td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Solicitar coleta EA (Modelo para TEX) Kauan.html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Operacional\" Sql=\"Select DISTINCT\n       Atv.IdAtividade,\n    Lhs.IdLogistica_House,\n    Lms.IdLogistica_Master,\n    CAST(Lhs.Local_Coleta AS VARCHAR(MAX)) AS Local_Coleta,\n    CAST(Lhs.Local_Entrega_Origem AS VARCHAR(MAX)) AS Local_Entrega,\n    Lhs.Data_Previsao_Coleta as Data_Coleta,\n    Lhs.Data_Previsao_Entrega_Origem as Chegada,\n     CASE Lhs.Tipo_Servico \n        WHEN 0 THEN '(Não informado)'\n        WHEN 1 THEN 'Door to door'\n        WHEN 2 THEN 'Door to port'\n        WHEN 3 THEN 'Port to door'\n        WHEN 4 THEN 'Port to port'\n        WHEN 5 THEN 'Port to ramp'\n        ELSE ''\n    END as Tipo_Servico,\n    CAST(Mer.Nome AS VARCHAR(MAX)) as Mercadoria,\n    CAST(Moe.Nome AS VARCHAR(MAX)) as Moeda,\n    Lhs.Metros_Cubicos,\n    Lhs.Quantidade_Volumes,\n    Lhs.Valor_Mercadoria,\n    Lhs.Importancia_Segurada,\n    CASE Lhs.Seguro WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Seguro,\n    CASE Lhs.Carga_Perigosa WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Carga_Perigosa,\n    Lah.Peso_taxado,\n    Lhs.Peso_Bruto,\n    Lhs.Numero_Processo,\n    Lgp.Valor_Data as Deadline\nFROM\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_House Lah ON Lah.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Mercadoria Mer ON Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN\n    cad_Moeda Moe ON Moe.IdMoeda = Lhs.IdMoeda_Mercadoria\nLEFT OUTER JOIN\nvis_logistica_prazo Lgp ON Lgp.IdLogistica_House = Lhs.IdLogistica_House and Lgp.IdConfiguracao_Campo_Livre = 141\nWHERE\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Embalagens\" Sql=\"Select\n    CAST(Tmb.Nome AS VARCHAR(MAX)) as Embalagemm,\n    Lgm.Quantidade as Quantidade_Emb,\n    REPLACE(CAST(Lgm.Altura AS DECIMAL(10,2)), '.', ',') + ' cm' as Altura_Emb,\n    REPLACE(CAST(Lgm.Largura AS DECIMAL(10,2)), '.', ',') + ' cm' as Largura_Emb,\n    REPLACE(CAST(Lgm.Comprimento AS DECIMAL(10,2)), '.', ',') + ' cm' as Comprimento_Emb,\n    REPLACE(CAST(Lgm.Metros_Cubicos AS DECIMAL(10,3)), '.', ',') + ' m³' as Met_Cub_Emb,\n    REPLACE(CAST(Lgm.Peso_Liquido AS DECIMAL(10,3)), '.', ',') + ' kg' as Peso_Liq_Emb,\n    REPLACE(CAST(Lgm.Peso_Bruto AS DECIMAL(10,3)), '.', ',') + ' kg' as Peso_But_Emb,\n    REPLACE(CAST(Lgm.Peso_Cubado AS DECIMAL(10,3)), '.', ',') + ' kg' as Peso_Cub_Emb\nFROM\n    mov_Atividade Atv\nJOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJOIN\n    mov_Logistica_Embalagem Lgm ON Lgm.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Tipo_Embalagem Tmb ON Tmb.IdTipo_Embalagem = Lgm.IdTipo_Embalagem\nWHERE\n    Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Pge.IdGrupo_Envio_Mensagem,\n  Pcn.Nome,\n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n Pge.IdGrupo_Envio_Mensagem = 13\n and\n  Atv.IdAtividade = :IdAtividade\">\n    \n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa da proposta\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7,\n  Ems.Campo_Livre8,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10,\n  Ems.Campo_Livre11,\n  Ems.Campo_Livre12,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do proposta */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n<html>\n    <head>\n      <meta charset=\"utf-8\" />\n      <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n      <title>Page Title</title>\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nSolicitar Coleta (EA) - Número Processo:'<Print Dataset=\"Operacional\" FieldName=\"Numero_Processo\">'\n[Subject.Footer]\n\n\n[Report.Detail]\n  <style>\n    * { box-sizing: border-box; }\n    body, td, tr, p { font-family: 'Segoe UI', Calibri, Verdana, Arial, sans-serif; font-size: 10pt; color: #7F7F7F; }  \n    .negrito { font-weight: bold; color: #000000; }\n    .titulo-card { font-weight: bold; font-size: 14px; color: #000000; }\n    .texto-centro { text-align: center; }\n    .texto-direita { text-align: right; }\n    .pad-box { padding: 15px; }\n    .pad-cell { padding: 6px; }\n    .margem-baixo { margin-bottom: 15px; }\n</style>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td align=\"center\" style=\"padding: 10px;\">\n            <img src=\"https://i.imgur.com/1kHT3xu.jpeg\" alt=\"Logo\" style=\"max-width: 250px; height: auto;\">\n        </td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 12px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            SOLICITAÇÃO DE COLETA\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #F9F9F9; padding: 20px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px; border-top: 1px solid #E0E0E0;\">\n            <div class=\"texto-centro\">\n                <span class=\"negrito\" style=\"font-size: 12pt;\">Prezado(s),</span><br><br>\n                Favor providenciar a seguinte coleta e entrega conforme dados abaixo:\n            </div>\n        </td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            DADOS GERAIS\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr>\n                    <td width=\"25%\" class=\"pad-cell\"><span class=\"negrito\">Número Processo:</span></td>\n                    <td width=\"75%\" class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Numero_Processo\"></td>\n                </tr>\n                <tr><td colspan=\"2\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n                \n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Local de Coleta:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Local_Coleta\"></td>\n                </tr>\n                <tr><td colspan=\"2\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Local de Entrega:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Local_Entrega\"></td>\n                </tr>\n                <tr><td colspan=\"2\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Datas:</span></td>\n                    <td class=\"pad-cell\">\n                        <strong>Coleta:</strong> <Print Dataset=\"Operacional\" FieldName=\"Data_Coleta\"> &nbsp;|&nbsp; \n                        <strong>Entrega:</strong> <Print Dataset=\"Operacional\" FieldName=\"Chegada\">\n                    </td>\n                </tr>\n                <tr><td colspan=\"2\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Tipo de Serviço:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Tipo_Servico\"></td>\n                </tr>\n                <tr><td colspan=\"2\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                     <td class=\"pad-cell\"><span class=\"negrito\">Deadline:</span></td>\n                     <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Deadline\"></td>\n                </tr>\n                \n            </table>\n        </td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px; font-family: sans-serif;\">\n    <tr>\n        <td style=\"background-color: #FFE777; padding: 5px 15px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0; font-weight: bold; font-size: 14px;\">\n            Contatos\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 15px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr>\n                    <td width=\"15%\" style=\"font-weight: bold; color: #333;\">Representante:</td>\n                    <td width=\"35%\" style=\"color: #666;\"><Print Dataset=\"Contatos\" FieldName=\"Nome\"></td>\n                    <td width=\"50%\" style=\"color: #666;\"><Print Dataset=\"Contatos\" FieldName=\"Email\"></td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            DADOS DA CARGA\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Mercadoria:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Mercadoria\"></td>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Grupo:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Mercadoria\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Carga Perigosa:</span></td>\n                    <td class=\"pad-cell\"><strong>[ <Print Dataset=\"Operacional\" FieldName=\"Carga_Perigosa\"> ]</strong></td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Seguro:</span></td>\n                    <td class=\"pad-cell\"><strong>[ <Print Dataset=\"Operacional\" FieldName=\"Seguro\"> ]</strong></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Peso Bruto:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Peso_Bruto\"> kg</td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Peso Taxado:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Peso_taxado\"> kg</td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Qtd. Volumes:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Quantidade_Volumes\"></td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Cubagem:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Metros_Cubicos\"> m³</td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Valor Mercadoria:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Valor_Mercadoria\"></td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Moeda:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Moeda\"></td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px; font-family: sans-serif;\">\n\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 12px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0; font-weight: bold; text-align: center;\">\n            LISTA DE CARGA\n        </td>\n    </tr>\n\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 15px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <SubReport Name=\"Embalagens\" Dataset=\"Embalagens\">\n                [Embalagens.Detail]\n                \n             \n                <tr>\n                    <td width=\"20%\" style=\"padding: 5px; font-weight: bold;\">Embalagem:</td>\n                    <td width=\"30%\" style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Embalagemm\"></td>\n                    <td width=\"20%\" style=\"padding: 5px; font-weight: bold;\">Qtd:</td>\n                    <td width=\"30%\" style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Quantidade_Emb\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n               \n                <tr>\n                    <td style=\"padding: 5px; font-weight: bold;\">Comprimento:</td>\n                    <td style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Comprimento_Emb\"></td>\n                    <td style=\"padding: 5px; font-weight: bold;\">Largura:</td>\n                    <td style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Largura_Emb\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td style=\"padding: 5px; font-weight: bold;\">Altura:</td>\n                    <td style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Altura_Emb\"></td>\n                    <td style=\"padding: 5px; font-weight: bold;\">Cubagem:</td>\n                    <td style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Met_Cub_Emb\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n\n                <tr>\n                    <td style=\"padding: 5px; font-weight: bold;\">Peso Bruto:</td>\n                    <td style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Peso_But_Emb\"></td>\n                    <td style=\"padding: 5px; font-weight: bold;\">Peso Líquido:</td>\n                    <td style=\"padding: 5px;\"><Print Dataset=\"Embalagens\" FieldName=\"Peso_Liq_Emb\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td style=\"padding: 5px; font-weight: bold;\">Peso Cubado:</td>\n                    <td style=\"padding: 5px;\" colspan=\"3\"><Print Dataset=\"Embalagens\" FieldName=\"Peso_Cub_Emb\"></td>\n                </tr>\n\n\n                <tr><td colspan=\"4\" style=\"border-bottom: 3px solid #BFBFBF; padding-top: 5px;\"></td></tr>\n                [Report.Footer]\n            </table>\n        </td>\n    </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            DADOS PARA FATURAMENTO\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Razão Social:</span></td>\n                    <td width=\"80%\" colspan=\"3\" class=\"pad-cell\">TEX SHIPPING LTDA</td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Endereço:</span></td>\n                    <td colspan=\"3\" class=\"pad-cell\">RUA DR. PEDRO FERREIRA, 333 - SALA 802/803, CENTRO, ITAJAÍ/SC - BRAZIL</td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">CEP:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\">88301-030</td>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">CNPJ:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\">33.435.091/0001-47</td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"margin-top: 10px;\">\n    <tr>\n        <td align=\"center\">\n            Favor confirmar o recebimento de instruções, aguardamos novidades.\n        </td>\n    </tr>\n</table>\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Solicitar reserva de embarque - EA.html",
        "conteudo": "[Report.Header]\n<html>\n<DataSet Name=\"Operacional\" Sql=\"Select DISTINCT\n    Atv.IdAtividade,\n    Lhs.IdLogistica_House,\n    Lms.IdLogistica_Master,\n    Lms.Numero_Conhecimento,\n    Lhs.Referencia_Externa,\n    Oro.Nome as Origem,\n    Ord.Nome as Destino,\n    Lhs.Numero_Processo,\n    Lvo.Data_Previsao_Embarque,\n    CAST(Mer.Nome AS VARCHAR(MAX)) as Mercadoria,\n    Lms.Peso_bruto,\n    Lam.Peso_Taxado,\n    Lms.Quantidade_Volumes as Volumes,\n    CAST(Moe.Nome AS VARCHAR(MAX)) as Moeda,\n    Lhs.Metros_Cubicos,\n    Lhs.Quantidade_Volumes,\n    Lhs.Valor_Mercadoria,\n    Lhs.Importancia_Segurada,\n    Lhs.Peso_Bruto,\n    CASE Lhs.Seguro WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Seguro,\n    CASE Lhs.Carga_Perigosa WHEN 0 THEN 'Não' WHEN 1 THEN 'Sim' END as Carga_Perigosa,\n    Lah.Peso_taxado\nFROM\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Viagem Lgv ON Lgv.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    mov_Logistica_Viagem Lvo on Lvo.IdLogistica_house = Lhs.IdLogistica_House and Lvo.Tipo_Viagem = 4\nLEFT OUTER JOIN\n    cad_Origem_Destino Oro on Oro.IdOrigem_Destino = Lvo.IdOrigem\nLEFT OUTER JOIN\n    cad_Origem_Destino Ord on Ord.IdOrigem_Destino = Lvo.IdDestino\nLEFT OUTER JOIN\n    cad_Mercadoria Mer ON Mer.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN\n    cad_Moeda Moe ON Moe.IdMoeda = Lhs.IdMoeda_Mercadoria\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLEFT OUTER JOIN\n    mov_Logistica_Aerea_House Lah ON Lah.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\n    Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Embalagens\" Sql=\"Select\n    CAST(Tmb.Nome AS VARCHAR(MAX)) as Embalagemm,\n    Lgm.Quantidade as Quantidade_Emb,\n    Lgm.Altura as Altura_Emb,\n    Lgm.Largura as Largura_Emb,\n    Lgm.Comprimento as Comprimento_Emb,\n    Lgm.Metros_Cubicos as Met_Cub_Emb,\n    Lgm.Peso_Liquido as Peso_Liq_Emb,\n    Lgm.Peso_Bruto as Peso_But_Emb,\n    Lgm.Peso_Cubado as Peso_Cub_Emb\nFROM\n    mov_Atividade Atv\nJOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJOIN\n    mov_Logistica_Embalagem Lgm ON Lgm.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n    cad_Tipo_Embalagem Tmb ON Tmb.IdTipo_Embalagem = Lgm.IdTipo_Embalagem\nWHERE\n    Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Taxas\" Sql=\"Select\n      Lte.Nome as Taxa_Nome,\n      Mop.Sigla as Moeda,\n      Ltx.Valor_Pagamento_Unitario as Valor_Unitario,\n      SUM(Ltx.Valor_Pagamento_Unitario) OVER() as Total_Pagamento_Unitario,\n      SUM(Ltx.Valor_Pagamento_Total) OVER() as Total_Pagamento_Total,\n      Ltx.valor_Pagamento_Minimo as Valor_Minimo,\n      Txl.Tipo\nFROM\n    mov_Atividade Atv\nJOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJOIN\n    mov_Logistica_Taxa Ltx ON Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLEFT JOIN\n    cad_Taxa_Logistica_Exibicao Lte ON Lte.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLEFT JOIN\n    cad_Moeda Mop ON Mop.IdMoeda = Ltx.IdMoeda_Pagamento\nLEFT JOIN\n    cad_Taxa_Logistica Txl on Txl.IdTaxa_Logistica =  Lte.IdTaxa_Logistica\nWHERE\n    Atv.IdAtividade = :IdAtividade\nAND\nLtx.Origem_Taxa = 1\nORDER BY Lte.Nome\">\n\n<DataSet Name=\"Contatos\" Sql=\"Select\n  Pge.IdGrupo_Envio_Mensagem,\n  Pcn.Nome,\n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n Pge.IdGrupo_Envio_Mensagem = 13\n and\n  Atv.IdAtividade = :IdAtividade\">\n\n<head>\n    <meta charset=\"utf-8\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <title>Solicitação de Reserva</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n</head>\n\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nSolicitar Reserva de Embarque - Processo: <Print Dataset=\"Operacional\" FieldName=\"Numero_Processo\">\n[Subject.Footer]\n\n\n[Report.Detail]\n<style>\n    * { box-sizing: border-box; }\n    body, td, tr, p { font-family: 'Segoe UI', Calibri, Verdana, Arial, sans-serif; font-size: 10pt; color: #7F7F7F; }  \n    .negrito { font-weight: bold; color: #000000; }\n    .titulo-card { font-weight: bold; font-size: 14px; color: #000000; }\n    .texto-centro { text-align: center; }\n    .texto-direita { text-align: right; }\n    .pad-box { padding: 15px; }\n    .pad-cell { padding: 6px; }\n    .margem-baixo { margin-bottom: 15px; }\n</style>\n\n<!-- LOGO -->\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td align=\"center\" style=\"padding: 10px;\">\n            <img src=\"https://i.imgur.com/1kHT3xu.jpeg\" alt=\"Logo\" style=\"max-width: 250px; height: auto;\">\n        </td>\n    </tr>\n</table>\n\n<!-- AVISO -->\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 12px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            SOLICITAÇÃO DE RESERVA\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #F9F9F9; padding: 20px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px; border-top: 1px solid #E0E0E0;\">\n            <div class=\"texto-centro\">\n                <span class=\"negrito\" style=\"font-size: 12pt;\">Prezado(s),</span><br><br>\n                Favor realizar a reserva de embarque conforme os detalhes abaixo:\n            </div>\n        </td>\n    </tr>\n</table>\n\n<!-- DADOS DO PROCESSO (OPERACIONAL) -->\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            DADOS DO PROCESSO\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Processo:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Numero_Processo\"></td>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Referência:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Referencia_Externa\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Origem:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Origem\"></td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Destino:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Destino\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Data Embarque:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Data_Previsao_Embarque\"></td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Mercadoria:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Operacional\" FieldName=\"Mercadoria\"></td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n<!-- TOTAIS DA CARGA (OPERACIONAL) -->\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            RESUMO DA CARGA\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr>\n                    <td width=\"25%\" class=\"pad-cell texto-centro\">\n                        <span class=\"negrito\">Peso Bruto Total</span><br>\n                        <Print Dataset=\"Operacional\" FieldName=\"Peso_Bruto\"> kg\n                    </td>\n                    <td width=\"25%\" class=\"pad-cell texto-centro\" style=\"border-left: 1px solid #EEEEEE;\">\n                        <span class=\"negrito\">Volumes Totais</span><br>\n                        <Print Dataset=\"Operacional\" FieldName=\"Quantidade_Volumes\">\n                    </td>\n                    <td width=\"25%\" class=\"pad-cell texto-centro\" style=\"border-left: 1px solid #EEEEEE;\">\n                        <span class=\"negrito\">Cubagem Total</span><br>\n                        <Print Dataset=\"Operacional\" FieldName=\"Metros_Cubicos\"> m³\n                    </td>\n                     <td width=\"25%\" class=\"pad-cell texto-centro\" style=\"border-left: 1px solid #EEEEEE;\">\n                        <span class=\"negrito\">Carga Perigosa</span><br>\n                        <Print Dataset=\"Operacional\" FieldName=\"Carga_Perigosa\">\n                    </td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n<!-- LISTA DE CARGA (SUBREPORT EMBALAGENS) -->\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0;\">\n            DETALHES DA EMBALAGEM\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <SubReport Name=\"Embalagens\" Dataset=\"Embalagens\">\n                [Embalagens.Detail]\n                <tr>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Embalagem:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\"><Print Dataset=\"Embalagens\" FieldName=\"Embalagemm\"></td>\n                    <td width=\"20%\" class=\"pad-cell\"><span class=\"negrito\">Qtd:</span></td>\n                    <td width=\"30%\" class=\"pad-cell\"><Print Dataset=\"Embalagens\" FieldName=\"Quantidade_Emb\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Medidas (CxLxA):</span></td>\n                    <td class=\"pad-cell\">\n                        <Print Dataset=\"Embalagens\" FieldName=\"Comprimento_Emb\"> x \n                        <Print Dataset=\"Embalagens\" FieldName=\"Largura_Emb\"> x \n                        <Print Dataset=\"Embalagens\" FieldName=\"Altura_Emb\">\n                    </td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Cubagem:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Embalagens\" FieldName=\"Met_Cub_Emb\"> m³</td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                <tr>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Peso Bruto:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Embalagens\" FieldName=\"Peso_But_Emb\"> kg</td>\n                    <td class=\"pad-cell\"><span class=\"negrito\">Peso Líquido:</span></td>\n                    <td class=\"pad-cell\"><Print Dataset=\"Embalagens\" FieldName=\"Peso_Liq_Emb\"> kg</td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 2px solid #BFBFBF;\"></td></tr>\n                [Embalagens.Footer]\n            </table>\n        </td>\n    </tr>\n</table>\n\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" style=\"border-collapse: separate; border-spacing: 0; margin-bottom: 20px;\">\n    <tr>\n        <td class=\"titulo-card texto-centro\" style=\"background-color: #FFE777; padding: 10px; border: 1px solid #BFBFBF; border-radius: 15px 15px 0 0; border-bottom: 0; font-weight: bold; text-align: center;\">\n            FRETES DO PROCESSO\n        </td>\n    </tr>\n    <tr>\n        <td style=\"background-color: #FFFFFF; padding: 10px; border: 1px solid #BFBFBF; border-radius: 0 0 15px 15px;\">\n            <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                <tr style=\"background-color: #F0F0F0;\">\n                    <td width=\"35%\" class=\"pad-cell negrito\" style=\"padding: 5px; font-weight: bold;\">Descrição</td>\n                    <td width=\"15%\" class=\"pad-cell negrito texto-centro\" style=\"padding: 5px; font-weight: bold; text-align: center;\">Moeda</td>\n                    <td width=\"25%\" class=\"pad-cell negrito texto-direita\" style=\"padding: 5px; font-weight: bold; text-align: right;\">Valor Unitário</td>\n                    <td width=\"25%\" class=\"pad-cell negrito texto-direita\" style=\"padding: 5px; font-weight: bold; text-align: right;\">Valor Mínimo</td>\n                </tr>\n\n                <SubReport Name=\"Taxas\" Dataset=\"Taxas\">\n                [Taxas.Detail]\n                <tr>\n                    <td class=\"pad-cell\" style=\"padding: 5px;\"><Print Dataset=\"Taxas\" FieldName=\"Taxa_Nome\"></td>\n                    <td class=\"pad-cell texto-centro\" style=\"padding: 5px; text-align: center;\"><Print Dataset=\"Taxas\" FieldName=\"Moeda\"></td>\n                    <td class=\"pad-cell texto-direita\" style=\"padding: 5px; text-align: right;\"><Print Dataset=\"Taxas\" FieldName=\"Valor_Unitario\"></td>\n                    <td class=\"pad-cell texto-direita\" style=\"padding: 5px; text-align: right;\"><Print Dataset=\"Taxas\" FieldName=\"Valor_Minimo\"></td>\n                </tr>\n                <tr><td colspan=\"4\" style=\"border-bottom: 1px solid #EEEEEE;\"></td></tr>\n\n                [Taxas.Footer]\n                <tr style=\"background-color: #F0F0F0; font-weight: bold;\">\n                    <td colspan=\"3\" class=\"pad-cell negrito texto-direita\" style=\"padding: 10px; border-top: 2px solid #BFBFBF; text-align: right;\">\n                        TOTAL PAGAMENTO TOTAL:\n                    </td>\n                    <td class=\"pad-cell negrito texto-direita\" style=\"padding: 10px; border-top: 2px solid #BFBFBF; text-align: right;\">\n                        <Print Dataset=\"Taxas\" FieldName=\"Total_Pagamento_Total\">\n                    </td>\n                </tr>\n                </SubReport>\n            </table>\n        </td>\n    </tr>\n</table>\n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Modelo de Mensagens\\Untitled-1.html",
        "conteudo": "<DataSet><Parameters><Item Name=\"Tipo\" Type=\"ftSmallint\"/><Item Name=\"Modalidade\" Type=\"ftSmallint\"/><Item Name=\"Imprimir_Formulario\" Type=\"ftBoolean\"/><Item Name=\"Imprimir_Assinatura\" Type=\"ftBoolean\"/><Item Name=\"IdConhecimento_Embarque\" Type=\"ftInteger\"/></Parameters><CommandText>Select\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Bld.IdConhecimento_Embarque,\n  Bld.IdLogistica_House,\n  Bld.Data,\n  Bld.Port_Of_Loading,\n  Bld.Port_Of_Discharge,\n  Bld.Ocean_Vessel,\n  Bld.Voyage_Number,\n  CONCAT(Bld.Ocean_Vessel,' / ',Bld.Voyage_Number) AS Navio_Viagem,\n  Bld.Booking_No,[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Ctr.Nome_Fantasia as Cia_Transporte_Fantasia,\n  Ctr.Correspondencia as Cia_Transporte_Correspondencia,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'MARITIME EXPORT'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'MARITIME IMPORT'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \n  Lhs.IdLogistica_House,\n  Lme.Quantidade,\n  Lme.Free_Time_Master_Origem,\n  Lme.Free_Time_House_Origem,\n  Lme.Free_Time_Master_Destino,\n  Lme.Free_Time_House_Destino,\n  Emr.Descricao as Cntr\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\nAcm.IdAcompanhamento,\nAcm.Data,\nAcm.Descricao,\nAcm.Tipo,\nRsp.Nome as Responsavel\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\ncad_Modelo_Mensagem Mmn ON Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLeft Outer Join\ncad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\nAtv.IdAtividade = :IdAtividade\nAnd\nAcm.Tipo = 1\nAnd\nMmn.IdGrupo_Envio_Mensagem = Acm.IdGrupo_Envio_Mensagem\nORDER BY\nAcm.Data DESC,\nAcm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n    Pcn.Email,\n    Atv.IdProjeto_Atividade\nFrom\n    mov_Atividade Atv\nLEFT OUTER JOIN\n    cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nLEFT OUTER JOIN\n    mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\n    cad_Pessoa Psa ON Psa.IdPessoa = Lhs.IdTransportadora_Destino\nLEFT OUTER JOIN\n  cad_Pessoa_Contato Pcn on Pcn.IdPessoa = Psa.IdPessoa\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nLEFT OUTER JOIN\n  cad_Contato_Grupo_Envio Cge ON Cge.IdPessoa_Contato = Pcn.IdPessoa_Contato\nWhere\n  Mmn.IdGrupo_Envio_Mensagem = Cge.IdGrupo_Envio_Mensagem\nAND\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <title>Page Title</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\nshipping@bosswoodproducts.com\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nBOSS WOOD PRODUCTS - <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - FOLLOW-UP\n[Subject.Footer]\n\n[Report.Detail]\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n    </tr>\n  </table>\n</span>\n  <br>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td rowspan=\"6\" width=\"50%\" class=\"text-center logo-espacamento\"><Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\"></td>\n    <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n    <td width=\"38%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n  <tr>\n      <td width=\"12%\" class=\"negrito\">REFERENCE:</td>\n      <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">DATE:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td class=\"negrito\">HBL:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"negrito\">VESSEL/VOY:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  <tr>\n      <td class=\"negrito\">ORIGIN:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"negrito\">DESTINATION:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">ETD:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">ETA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">ATD:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"negrito\">ATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">CARRIER:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n      <td class=\"negrito\">FREIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n  </tr>\n  <tr>\n      <td class=\"negrito\">GOODS:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"negrito\">GROSS WEIGHT:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td>           \n  </tr>\n  <tr>\n      <td class=\"negrito\">PACKAGES:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n      <td class=\"negrito\">M3:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n  </tr>\n  <tr>\n    <td class=\"negrito\">COINTAINERS:</td>\n    <td><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n    <td class=\"negrito\">BOOKING:</td>\n    <td><Print Dataset=\"Processo\" FieldName=\"Numero_Reserva\"></td>\n  </tr>\n</table>\n\n<SubReport NameSource=\"Processo\" NameField=\"Tipo_Carga_Detalhe\">\n\n<tr>\n  <td class=\"line-height-3_cor-fundo\" colspan=\"4\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n</tr>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td class=\"cor-fundo-2 borda_sem_direita\" width=\"20%\"><span class=\"negrito\">DATE</span></td>\n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"80%\"><span class=\"negrito\">DESCRIPTION</span></td>\n      </tr>\n      <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n      <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      <tr>\n        <td colspan=\"6\" heigth=\"3\"></td>\n      </tr>\n    </table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n[FCL.Detail]\n<table width=\"775\" class=\"borda\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr class=\"cor-fundo_cor-fonte-white\">   \n        <td class=\"negrito\">QUANT.</td>\n        <td class=\"negrito\">EQUIPMENT</td>\n        <td class=\"negrito\">FREE TIME</td>        \n    </tr>\n    <br>\n  <Subreport Dataset=\"Carga\" Name=\"Equipamentos\">\n</table>\n\n[Equipamentos.Detail]\n<tr>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Quantidade\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Cntr\"></td>\n  <td class=\"negrito\"><Print Dataset=\"Carga\" FieldName=\"Free_Time_House_Destino\"> Days</td>\n</tr>\n\n[Report.Footer]\n</body>\n</html>\n\n  Bld.Shipper_Exporter,\n  Bld.Originals,\n  Bld.Consignee,\n  Bld.Notify,\n  Bld.Pre_Carriage_By,\n  Bld.Place_Of_Receipt,\n  Bld.Place_Of_Delivery,\n  Bld.Marks_And_Numbers,\n  Bld.Description_Of_Packages,\n  Bld.Number_Of_Containers,\n  Bld.Measurement,\n  Bld.Gross_Weight,\n  Bld.Net_Weight,\n  Bld.Number_Copy_BL,\n  Bld.Number_Original_BL,\n  Bld.Numero as BL_Number,\n  Bld.BL_Number_Master,\n  Bld.Place_Issue,\n  Bld.Purchase_Order,\n  Bld.Also_Notify,\n  Bld.As_Agent,\n  Case \n    When Lms.Tipo_Operacao = 1 Then Ago.Correspondencia /*Importação*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Correspondencia /*Exportação*/ \n  End As Agente,\n  Agd.Correspondencia AS Agente_Destino,\n  Cast(:Tipo as int) as Parametro_Tipo,\n  Cast(:Modalidade as int) as Parametro_Modalidade,\n  Cast(:Imprimir_Formulario as bit) as Parametro_Imprimir_Formulario,\n  Cast(:Imprimir_Assinatura as bit) as Parametro_Imprimir_Assinatura\nFrom\n  vis_Bill_Lading Bld\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Bld.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  vis_Agente_Carga Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  vis_Agente_Carga Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nWhere\n  Bld.IdConhecimento_Embarque = :IdConhecimento_Embarque</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Monitoramento\\TLogisticaHouse conclui atividade se processo cancelado.sql",
        "conteudo": "<Dados_Registro><Monitoramento><CommandText>\n  IF (@Evento IN(1,3)\n    AND EXISTS(\n      SELECT\n        Cmp.query('.')\n      FROM @Parametros.nodes('/Parametros/Evento[@Classe=\"TLogisticaHouse\"]/Campos/Item') as Campos(Cmp)\n      WHERE Cmp.value('@Nome', 'VarChar(Max)') IN('Situacao_Agenciamento')\n    ))\n  BEGIN \n    SELECT\n      @Situacao = CASE\n        WHEN hs.Situacao_Agenciamento= 7 /*Cancelada*/ THEN 4 /*Concluída*/\n        ELSE NULL\n      END\n    FROM mov_Logistica_House hs \n    LEFT OUTER JOIN (\n      SELECT\n        RANK() OVER(PARTITION BY atv.IdProjeto_Atividade, atv.IdTarefa ORDER BY atv.IdProjeto_Atividade, atv.IdTarefa) as Indice,\n        atv.IdProjeto_Atividade,\n        atv.IdAtividade,\n        atv.Situacao\n      FROM mov_Atividade atv\n      WHERE atv.IdTarefa = @IdTarefa\n      ) atv ON atv.IdProjeto_Atividade = hs.IdProjeto_Atividade AND atv.Indice = 1\n    WHERE hs.IdProjeto_Atividade = @IdProjeto_Atividade\n  END\n</CommandText></Monitoramento></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Monitoramento\\TLogisticaHouse Não iniciada ao abrir processo com campo livre de seguro ou campo seguro flegado.html",
        "conteudo": "<Dados_Registro><Monitoramento><CommandText>\nIf (@Evento in (1,3 /*Inserir/Atualizar*/))\nAnd\n  Exists(\n    Select\n      Cmp.query('.')\n    From\n      @Parametros.nodes('/Parametros/Evento[@Classe=\"TLogisticaHouse\"]/Campos/Item') as Campos(Cmp)\n    Where\n      Cmp.value('@Nome', 'VarChar(Max)') in ('IdLogistica_House'))\nBegin\n  Select\n    @Situacao = Case\n      When (Atv.Situacao in (6 /*Cancelada*/, 5 /*Não realizada*/, 4 /*Concluída*/) ) Then NULL\n      When ( (Atv.Situacao IS NULL) AND Txt.Valor_Boleano = 1 or Lhs.Seguro = 1) Then 1 /*Não iniciada*/\n      Else NULL\n    End\n  From \n    mov_Logistica_House Lhs\n  Left Outer join\n\t(Select\n\t\tOfr.IdOferta_Frete,\n\t\tOfc.Valor_Boleano\n\tFrom\n\t\tmov_Oferta_Frete Ofr\n\tLeft Outer Join\n\t\tmov_Proposta_Frete Pfr On Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n\tLeft Outer Join\n\t    vis_Oferta_Frete_Campo_Livre Ofc On Ofc.IdOferta_Frete = Ofr.IdOferta_Frete and Ofc.IdConfiguracao_Campo_Livre = 177) Txt on Txt.IdOferta_Frete = COALESCE(Lhs.IdOferta_Frete,Lhs.IdOferta_Frete_Original)\n  Left Outer Join (\n    Select\n      Row_Number() Over (\n        Partition By\n          Atv.IdProjeto_Atividade,\n          Atv.IdTarefa\n        Order By\n          Atv.IdProjeto_Atividade,\n          Atv.IdTarefa) as Indice,\n      Atv.IdProjeto_Atividade,\n      Atv.IdAtividade,\n      Atv.Situacao\n    From\n      mov_Atividade Atv\n    Where\n      Atv.IdTarefa = @IdTarefa) Atv on (Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade) And (Atv.Indice = 1)\n  Where\n     Lhs.IdProjeto_Atividade = @IdProjeto_Atividade\nEnd</CommandText></Monitoramento></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Monitoramento\\TLogisticaHouseNão iniciada ao flegar 'Seguro'.html",
        "conteudo": "<Dados_Registro><Monitoramento><CommandText>\nIf (@Evento in (1 /*Inserir*/, 3 /* atualizar */))\nAnd\n  Exists(\n    Select\n      Cmp.query('.')\n    From\n      @Parametros.nodes('/Parametros/Evento[@Classe=\"TLogisticaHouse\"]/Campos/Item') as Campos(Cmp)\n    Where\n      Cmp.value('@Nome', 'VarChar(Max)') in ('Seguro'))\nBegin\n  Select\n    @Situacao = Case\n       When Lhs.Seguro = 1 and Atv.Situacao is null Then 1 /*Não iniciada*/\n       When Lhs.Seguro = 1 and Atv.Situacao in (1 /* Não iniciada */, 2 /* Em andamento */, 3 /* Paralisada */) Then 1 /*Não iniciada*/\n      Else NULL\n    End\n  From\n    mov_Logistica_Master Lms\n  Left Outer Join\n    mov_Logistica_House Lhs on Lhs.IdLogistica_Master = Lms.IdLogistica_Master\n  Left Outer Join (\n    Select\n      Row_Number() Over (\n        Partition By\n          Atv.IdProjeto_Atividade,\n          Atv.IdTarefa\n        Order By\n          Atv.IdProjeto_Atividade,\n          Atv.IdTarefa) as Indice,\n      Atv.IdProjeto_Atividade,\n      Atv.IdAtividade,\n      Atv.Situacao\n    From\n      mov_Atividade Atv\n    Where\n      Atv.IdTarefa = @IdTarefa) Atv on (Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade) And (Atv.Indice = 1)\n  Where\n     Lhs.IdProjeto_Atividade = @IdProjeto_Atividade\nEnd</CommandText></Monitoramento></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Monitoramento\\TLogisticaMaster Concluída ao preencher Data_Desembarque  #45105.html",
        "conteudo": "<Dados_Registro><Monitoramento><CommandText>\nIf (@Evento in (1 /*Inserir*/, 3 /* atualizar */))\nAnd\n  Exists(\n    Select\n      Cmp.query('.')\n    From\n      @Parametros.nodes('/Parametros/Evento[@Classe=\"TLogisticaMaster\"]/Campos/Item') as Campos(Cmp)\n    Where\n      Cmp.value('@Nome', 'VarChar(Max)') in ('Data_Desembarque'))\nBegin\n  Select\n    @Situacao = Case\n       When Atv.Situacao is null Then 4 /* Concluída */\n       When Atv.Situacao in (1 /* Não iniciada */, 2 /* Em andamento */, 3 /* Paralisada */) Then 4 /* Concluída */\n      Else NULL\n    End\n  From\n    mov_Logistica_Master Lms\n  Left Outer Join\n    mov_Logistica_House Lhs on Lhs.IdLogistica_Master = Lms.IdLogistica_Master\n  Left Outer Join (\n    Select\n      Row_Number() Over (\n        Partition By\n          Atv.IdProjeto_Atividade,\n          Atv.IdTarefa\n        Order By\n          Atv.IdProjeto_Atividade,\n          Atv.IdTarefa) as Indice,\n      Atv.IdProjeto_Atividade,\n      Atv.IdAtividade,\n      Atv.Situacao\n    From\n      mov_Atividade Atv\n    Where\n      Atv.IdTarefa = @IdTarefa) Atv on (Atv.IdProjeto_Atividade = Lhs.IdProjeto_Atividade) And (Atv.Indice = 1)\n  Where\n     Lhs.IdProjeto_Atividade = @IdProjeto_Atividade\nEnd</CommandText></Monitoramento></Dados_Registro>\n\n\nTLogisticaMaster: Concluída ao preencher Data_Desembarque"
    },
    {
        "caminho": "Scripts\\Relatórios\\Command_EM_BILL_LADING.sql",
        "conteudo": "Select\n  @IdTemplate = \n  (Case When @Parameters.value('(/Parameters/Item[@Name=\"Imprimir_Formulario\"])[1]', 'bit') = 1 Then 2\n  When @Parameters.value('(/Parameters/Item[@Name=\"Imprimir_Assinatura\"])[1]', 'bit') = 1 Then 5 Else 1 End),\n  @Show = Cast(Case\n    When (Lms.Tipo_Operacao = 1 /* Exportação */) and (Lms.Modalidade_Processo = 2 /* marítimo */) Then 5\n    \n    Else 0\n  End as Bit),\n  @Auto_Close_Exportar = 1,\n  @Arquivo_Exportar = 'HBL_'+ Cem.Numero,\n  @Classe_Exportar = 'TProjetoAtividadeArquivo',\n  @Fields_Exportar = '<Fields><Item Name=\"IdProjeto_Atividade\" Value=\"' + Cast(Lhs.IdProjeto_Atividade as VarChar(Max)) + '\"/><Item Name=\"IdArquivo_Grupo\" Value=\"10\"/></Fields>',\n  @Tipo_Bloqueio = 0,\n  @Mensagem_Bloqueio = ''\nFrom\n  mov_Conhecimento_Embarque Cem\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Cem.IdLogistica_House\nJoin\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nWhere\n  Cem.IdConhecimento_Embarque = @Parameters.value('(/Parameters/Item[@Name=\"IdConhecimento_Embarque\"])[1]', 'int')"
    },
    {
        "caminho": "Scripts\\Relatórios\\EM - BILL LADING # Vox #45674.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"Tipo\" Type=\"ftSmallint\"/><Item Name=\"Modalidade\" Type=\"ftSmallint\"/><Item Name=\"Imprimir_Formulario\" Type=\"ftBoolean\"/><Item Name=\"Imprimir_Assinatura\" Type=\"ftBoolean\"/><Item Name=\"IdConhecimento_Embarque\" Type=\"ftInteger\"/></Parameters><CommandText>Select\n  Bld.IdConhecimento_Embarque,\n  FORMAT(Slgv.Data_Embarque, 'dd/MM/yyyy') as Data_Embarque,\n  Slgv.Sigla as Origem,\n  Bill.Place_Issue,\n  Bld.IdLogistica_House,\n  Bld.Data,\n  Bld.Port_Of_Loading,\n  Bld.Port_Of_Discharge,\n  Nvo.Nome AS Navio,\n  Lmm.Viagem_Navio,\n  Bld.Ocean_Vessel,\n  Bld.Voyage_Number,\n  Bld.Booking_No,\n  Bld.Shipper_Exporter,\n  Bld.Originals,\n  Bld.Consignee,\n  Bld.Notify,\n  Bld.Pre_Carriage_By,\n  Bld.Place_Of_Receipt,\n  Bld.Place_Of_Delivery,\n  Bld.Marks_And_Numbers,\n  Bld.Description_Of_Packages,\n  Bld.Number_Of_Containers,\n  Bld.Measurement,\n  Bld.Gross_Weight,\n  Bld.Net_Weight,\n  Bld.Number_Copy_BL,\n  Bld.Number_Original_BL,\n  Bld.Numero as BL_Number,\n  Bld.BL_Number_Master,\n  Bld.Place_Issue,\n  Bld.Purchase_Order,\n  Bld.Also_Notify,\n  Admo.Consignee_Master AS Csne_Master_Agente_Origem,\n  Admd.Consignee_Master AS Csne_Master_Agente_Destino,\n  Case\n   When Bld.NCM_Description is null Then '0'\n   When Bld.NCM_Description is not null Then Bld.NCM_description\n  End As NCM,\n  Bld.As_Agent, \n  Case \n    When Lms.Tipo_Operacao = 1 Then Ago.Correspondencia /*Importação*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Correspondencia /*Exportação*/ \n  End As Agente,\n  Agd.Correspondencia as Agente_Exportacao,\n  Lhs.Modalidade_Pagamento as Modalidade_Pagamento_House,\n  Cast(:Tipo as int) as Parametro_Tipo,\n  Cast(:Modalidade as int) as Parametro_Modalidade,\n  Cast(:Imprimir_Formulario as bit) as Parametro_Imprimir_Formulario,\n  Cast(:Imprimir_Assinatura as bit) as Parametro_Imprimir_Assinatura\nFrom\n  vis_Bill_Lading Bld\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Bld.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Navio Nvo on Nvo.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  vis_Agente_Carga Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  vis_Agente_Carga Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLEFT OUTER JOIN\n  cad_Agente_Carga_Dados_Master Admo ON Admo.IdAgente_Carga = Ago.IdPessoa\nLEFT OUTER JOIN\n  cad_Agente_Carga_Dados_Master Admd ON Admd.IdAgente_Carga = Agd.IdPessoa\n  LEFT OUTER JOIN \nmov_Bill_Lading Bill ON Bill.IdConhecimento_Embarque = Bld.IdConhecimento_Embarque\nLEFT OUTER JOIN(\nSELECT\nLgv.IdOrigem,\nLgv.IdLogistica_House,\nCod.Sigla,\nLgv.Data_Embarque\nFROM\nmov_Logistica_Viagem Lgv\nLeft Outer Join\ncad_Origem_Destino Cod ON Cod.IdOrigem_Destino = Lgv.IdOrigem\nWHERE\nTipo_Viagem = 4) Slgv ON Slgv.IdLogistica_House = Lhs.IdLogistica_House\nWhere\n  Bld.IdConhecimento_Embarque = :IdConhecimento_Embarque</CommandText></DataSet>\n\n\n  "
    },
    {
        "caminho": "Scripts\\Relatórios\\LINHA BASE EXTRAIDA DO SISTEMA PARA FATURAMENTO.chd",
        "conteudo": "[Consulta]\nCampos=90\nLocates=0\nCommandTextHash=38d16de199043d19ebcd8436a55da4cc\nCommandText=\"SELECT \",\"  Tst.Numero_Processo,\",\"  Tst.Responsavel_Operacional,\",\"  Tst.Cliente,\",\"  Tst.Exportador,\",\"  Tst.Despachante,\",\"  Tst.Referencia_Cliente,\",\"  Tst.Consignatario,\",\"  Tst.Booking,\",\"  Tst.Conf,\",\"  Tst.Data_Retirada_Container,\",\"  Tst.Local_Retirada_Container,\",\"  Tst.Local_Entrega_Container,\",\"  Tst.Numero_Container,\",\"  Tst.Deadline_Draft,\",\"  '' as Dummy_1,\",\"  Tst.Envio_Draft_BL,\",\"  Tst.Liberacao_BL,\",\"  Tst.Deadline_VGM,\",\"  '' as Dummy_2,\",\"  Tst.Envio_VGM,\",\"  Tst.Deadline_Carga,\",\"  '' as Dummy_3,\",\"  Tst.Data_Deposito_Container,\",\"  Tst.Numero_MBL,\",\"  Tst.Numero_HBL,\",\"  Tst.Mercadoria,\",\"  Tst.Navio,\",\"  Tst.Viagem_Navio,\",\"  Tst.Origem,\",\"  Tst.Destino,\",\"  Tst.Pais_Destino,\",\"  Tst.Via,\",\"  Tst.Data_Saida,\",\"  Tst.Fatura_Frete_Compra,\",\"  Tst.Fatura_Locais_Compra,\",\"  Tst.Dias_Em_Aberto_C,\",\"  Tst.Fatura_Frete_Venda,\",\"  Tst.Fatura_Locais_Venda,\",\"  Tst.Data_Chegada,\",\"  Tst.Aviso_Chegada,\",\"  Tst.Companhia_Transporte,\",\"  Tst.Dias_Em_Aberto_V,\",\"  Tst.Agente_Internacional,\",\"  Tst.Valor_Compra_Unitario,\",\"  Tst.Valor_Compra_Total,\",\"  Tst.Free_Detention_Compra,\",\"  Tst.PP_CC_PA,\",\"  Tst.Valor_Venda_Unitaria,\",\"  Tst.Valor_Venda_Total,\",\"  Tst.Free_Dentention_Venda,\",\"  Tst.Qtde_Cntr,\",\"  Tst.Dias_Detention,\",\"  Tst.Profit_USD,\",\"  Tst.Equipamento,\",\"  Tst.Frete_Agente_Pgto,\",\"  Tst.BL_BRL_Pagamento,\",\"  Tst.THC_Pagamento,\",\"  Tst.Total_THC_Pagamento,\",\"  Tst.Taxas_BRL_Pagamento,\",\"  Tst.Taxas_USD_Pagamento,\",\"  Tst.Taxas_EUR_Pagamento,\",\"  Tst.Total_Detention_Pgto,\",\"  Tst.Taxa_Cambio_USD_Pgto,\",\"  Tst.Total_BRL_Pagamento,\",\"  Tst.Data_Pagamento,\",\"  Tst.Frete_Agente_Rcbto,\",\"  Tst.BL_BRL_Recebimento,\",\"  Tst.THC_Recebimento,\",\"  Tst.Total_THC_Recebimento,\",\"  Tst.Taxas_BRL_Recebimento,\",\"  Tst.Taxas_USD_Recebimento,\",\"  Tst.Taxas_EUR_Recebimento,\",\"  Tst.Total_Detention_Rcbto,\",\"  Tst.Taxa_Cambio_USD_Rcbto,\",\"  Tst.Outras_Taxas_BRL,\",\"  Tst.Total_BRL_Recebimento,\",\"  Tst.Data_Recebimento,\",\"  Tst.Frete_C,\",\"  Tst.Locais_C,\",\"  Tst.Fatura,\",\"  Tst.Vencimento_C,\",\"  Tst.Frete_V,\",\"  Tst.Locais_V,\",\"  Tst.Taxas_Banco,\",\"  Tst.Profit_Liquido,\",\"  Tst.Fatura_Cliente,\",\"  Tst.Vencimento_V,\",\"  Tst.Vendedor,\",\"  Tst.Data_Reserva,\",\"  Tst.Observaçoes\",\"FROM \",\"(SELECT \",\"  Lhs.Data_Abertura_Processo,\",\"  Lhs.Numero_Processo,\",\"  Rsp.Nome AS Responsavel_Operacional,\",\"  Cli.Nome AS Cliente,\",\"  Exp.Nome AS Exportador,\",\"  Dpc.Nome AS Despachante,\",\"  Lhs.Referencia_Cliente,\",\"  Imp.Nome AS Consignatario,\",\"  Lms.Numero_Reserva AS Booking,\",\"  CASE WHEN Lms.Numero_Reserva IS NULL THEN 'NÃO' ELSE 'SIM' END Conf,\",\"  Lmc.Data_Retirada_Container,\",\"  Trr.Nome AS Local_Retirada_Container,\",\"  Tra.Nome AS Local_Entrega_Container,\",\"  Lmc.Numero_Container,\",\"  Drc.Valor_Data as Deadline_Draft,\",\"  '' AS Envio_Draft_BL,\",\"  CASE \",\"    WHEN Bil.Originals = 1 THEN 'Destino' \",\"    WHEN Bil.Originals = 2 THEN 'Express release' \",\"    WHEN Bil.Originals = 3 THEN 'Origem' \",\"    WHEN Bil.Originals = 4 THEN 'Sea waybill' \",\"    WHEN Bil.Originals = 5 THEN 'Outro' \",\"  END AS Liberacao_BL,\",\"  '' AS Deadline_VGM,\",\"  '' AS Envio_VGM,\",\"  '' AS Deadline_Carga,\",\"  Lmc.Data_Deposito_Container,\",\"  Lms.Numero_Conhecimento AS Numero_MBL,\",\"  Lhs.Conhecimentos AS Numero_HBL,\",\"  Mer.Nome AS Mercadoria,\",\"  Nav.Nome AS Navio,\",\"  Lmm.Viagem_Navio,\",\"  Org.Nome AS Origem,\",\"  Dst.Nome AS Destino,\",\"  Pdt.Nome AS Pais_Destino,\",\"  Ult.Nome AS Via,\",\"  Lms.Data_Embarque AS Data_Saida,\",\"  '' AS Fatura_Frete_Compra,\",\"  '' AS Fatura_Locais_Compra,\",\"  '' AS Dias_Em_Aberto_C,\",\"  '' AS Fatura_Frete_Venda,\",\"  '' AS Fatura_Locais_Venda,\",\"  Lms.Data_Desembarque AS Data_Chegada,\",\"  Lms.Transit_Time AS Aviso_Chegada,\",\"  Cia.Nome AS Companhia_Transporte,\",\"  '' AS Dias_Em_Aberto_V, \",\"  Agd.Nome AS Agente_Internacional,\",\"  Vlp.Valor_Pagamento_Unitario AS Valor_Compra_Unitario,\",\"  Vlt.Valor_Compra_Total,\",\"  Lmc.Free_Detention_Compra,\",\"  CASE \",\"    WHEN Lms.Modalidade_Pagamento = 1 THEN 'Collect/Prepaid'\",\"    WHEN Lms.Modalidade_Pagamento = 2 THEN 'Collect'\",\"    WHEN Lms.Modalidade_Pagamento = 3 THEN 'Prepaid'\",\"    WHEN Lms.Modalidade_Pagamento = 4 THEN 'Prepaid abroad'\",\"  END AS PP_CC_PA,\",\"  Vlp.Valor_Recebimento_Unitario AS Valor_Venda_Unitaria,\",\"  Vlt.Valor_Venda_Total,\",\"  Lmc.Free_Dentention_Venda,\",\"  Cnt.Qtde_Cntr,\",\"  Lmc.Dias_Detention,\",\"  (Vlt.Valor_Venda_Total - Vlt.Valor_Compra_Total) AS Profit_USD,\",\"  Eqm.Descricao AS Equipamento,\",\"  Fra.Valor_Compra_Total AS Frete_Agente_Pgto,\",\"  Lib.Valor_Compra_Total AS BL_BRL_Pagamento,\",\"  Thc.Valor_Pagamento_Unitario AS THC_Pagamento,\",\"  Thc.Valor_Compra_Total AS Total_THC_Pagamento,\",\"  Txs.Taxas_BRL_Pagamento,\",\"  Txu.Taxas_USD_Pagamento,\",\"  Txe.Taxas_EUR_Pagamento,\",\"  Lmc.Total_Detention_Pagamento AS Total_Detention_Pgto,\",\"  '' AS Taxa_Cambio_USD_Pgto,\",\"  Ttb.Total_BRL_Pagamento,\",\"  '' AS Data_Pagamento,\",\"  Frv.Valor_Venda_Total AS Frete_Agente_Rcbto,\",\"  Lir.Valor_Venda_Total AS BL_BRL_Recebimento,\",\"  Thr.Valor_Recebimento_Unitario AS THC_Recebimento,\",\"  Thr.Valor_Venda_Total AS Total_THC_Recebimento,\",\"  Txr.Taxas_BRL_Recebimento, \",\"  Tru.Taxas_USD_Recebimento,\",\"  Tre.Taxas_EUR_Recebimento,\",\"  Lmc.Total_Detention_Recebimento AS Total_Detention_Rcbto,\",\"  '' AS Taxa_Cambio_USD_Rcbto,\",\"  '' AS Outras_Taxas_BRL,\",\"  Trc.Total_BRL_Recebimento,\",\"  '' AS Data_Recebimento,\",\"  '' AS Frete_C,\",\"  '' AS Locais_C, \",\"  '' AS Fatura,\",\"  '' AS Vencimento_C,\",\"  '' AS Frete_V,\",\"  '' AS Locais_V, \",\"  '' AS Taxas_Banco,\",\"  (Trc.Total_BRL_Recebimento - Ttb.Total_BRL_Pagamento) AS Profit_Liquido,\",\"  '' AS Fatura_Cliente,\",\"  '' AS Vencimento_V,\",\"  Vnd.Nome AS Vendedor,\",\"  '' AS Data_Reserva,\",\"  Ctf.Numero_Contrato AS Observaçoes \",\"FROM \",\"  mov_Logistica_House Lhs \",\"LEFT OUTER JOIN \",\"  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",\"LEFT OUTER JOIN \",\"  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\",\"LEFT OUTER JOIN \",\"  cad_Navio Nav on Nav.IdNavio = Lmm.IdNavio\",\"LEFT OUTER JOIN \",\"  vis_Bill_Lading Bil on Bil.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN \",\"  mov_Contrato_Frete Ctf on Ctf.IdContrato_Frete = Lhs.IdContrato_Frete\",\"LEFT OUTER JOIN\",\"  mov_Projeto_Atividade Pat on Pat.IdProjeto_Atividade = Lhs.IdProjeto_Atividade\",\"LEFT OUTER JOIN\",\"  mov_Projeto_Atividade_Responsavel Par on Par.IdProjeto_Atividade = Pat.IdProjeto_Atividade And Par.IdPapel_Projeto = 2 /*OPERACIONAL*/\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Rsp on Rsp.IdPessoa = Par.IdResponsavel\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Cli on Cli.IdPessoa = Lhs.IdCliente\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Exp on Exp.IdPessoa = Lhs.IdExportador\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Dpc on Dpc.IdPessoa = Lhs.IdDespachante_Aduaneiro\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador /*Consignatário*/\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    ROW_NUMBER() OVER(PARTITION BY Lmc.IdLogistica_House ORDER BY Lmc.IdLogistica_Maritima_Container DESC) AS Indice,\",\"    Lmc.IdLogistica_House,\",\"    Lmc.Data_Descarga_Retirada AS Data_Retirada_Container,\",\"    Lmc.Number AS Numero_Container,\",\"    Lmc.Data_Devolucao AS Data_Deposito_Container,\",\"    Lmc.Free_Time_Master AS Free_Detention_Compra,\",\"    Lmc.Free_Time_House AS Free_Dentention_Venda,\",\"    DATEDIFF(DAY, Lmc.Data_Descarga_Retirada, Lmc.Data_Devolucao) + 1 AS Dias_Detention,\",\"    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Pagamento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_Master) AS Total_Detention_Pagamento,\",\"    ((DATEDIFF(DAY, Lmc.Data_Incidencia_Recebimento, Lmc.Data_Devolucao) + 1) - Lmc.Free_Time_House) AS Total_Detention_Recebimento\",\"  FROM\",\"    mov_Logistica_Maritima_Container Lmc) Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House AND Lmc.Indice = 1   \",\"LEFT OUTER JOIN \",\"  cad_Pessoa Tra on Tra.IdPessoa = Lmm.IdTerminal_Atracacao\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Trr on Trr.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\",\"LEFT OUTER JOIN \",\"  vis_Logistica_Prazo Drc On (Drc.IdLogistica_House = Lhs.IdLogistica_House) And (Drc.Identificador Like 'DEADLINE_DRAFT_CLIENTE')\",\"LEFT OUTER JOIN \",\"  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino \",\"LEFT OUTER JOIN \",\"  cad_Pais Pdt on Pdt.IdPais = Dst.IdPais\",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Lms.IdDestino_Final\",\"LEFT OUTER JOIN \",\"  mov_Logistica_Viagem Lvg on Lvg.IdLogistica_House = Lhs.IdLogistica_House AND Lvg.Ultima_Viagem = 1 \",\"LEFT OUTER JOIN \",\"  cad_Origem_Destino Ult on Ult.IdOrigem_Destino = Lvg.IdOrigem\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Cia on Cia.IdPessoa = Lms.IdCompanhia_Transporte\",\"LEFT OUTER JOIN \",\"  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\",\"/*VALOR UNITARIO DA TAXA DO FRETE*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    Tle.Nome As Taxa,\",\"    /*PAGAMENTO*/\",\"    Mpg.Sigla AS Moeda_Frete_Pagamento,\",\"    Ltx.Valor_Pagamento_Unitario,\",\"    Ltx.Valor_Pagamento_Total,\",\"    /*RECEBIMENTO*/\",\"    Mrc.Sigla AS Moead_Frete_Recebimento,\",\"    Ltx.Valor_Recebimento_Unitario,\",\"    Ltx.Valor_Recebimento_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  LEFT OUTER JOIN \",\"    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\",\"  WHERE \",\"    Tle.IdTaxa_Logistica_Exibicao = 2 /*FRETE MARITIMO*/) Vlp on Vlp.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN\",\"   (SELECT \",\"    Ltx.IdLogistica_House,\",\"    /*PAGAMENTO*/\",\"    SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total,\",\"    /*RECEBIMENTO*/\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  LEFT OUTER JOIN \",\"    cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao \",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\",\"  LEFT OUTER JOIN \",\"    cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\",\"  WHERE \",\"    Ltx.Origem_Taxa = 1 /*Frete*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Vlt on Vlt.IdLogistica_House = Lhs.IdLogistica_House\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"     Lmc.IdLogistica_House,\",\"     COUNT(Lmc.IdLogistica_Maritima_Container) AS Qtde_Cntr\",\"   FROM \",\"     mov_Logistica_Maritima_Container Lmc \",\"   GROUP BY \",\"     Lmc.IdLogistica_House) Cnt on Cnt.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN  \",\"  mov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House \",\"LEFT OUTER JOIN \",\"  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Valor_Compra_Total\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Pagar_Para = 3 /*AGENTE NO DESTINO*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Fra on Fra.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE PAGAMENTO PARA O AGENTE NO DESTINO*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lib on Lib.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA LIBERAÇÃO DE BL*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  Ltx.Valor_Pagamento_Unitario,\",\"  Ltx.Valor_Pagamento_Total AS Valor_Compra_Total\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thc on Thc.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE PAGAMENTO DA TAXA THC ORIGEM*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_BRL_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"  AND Ltx.IdMoeda_Pagamento = 20 /*BRL*/\",\"  AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Txs on Txs.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM BRL*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_USD_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"  AND Ltx.IdMoeda_Pagamento = 141 /*USD*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Txu on Txu.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM USD*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Total) AS Taxas_EUR_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"WHERE \",\"  Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"  /*AND Ltx.IdMoeda_Pagamento = 43 /*EUR*/ REQ #45683*/\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Txe on Txe.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL PAGAMENTO DAS TAXAS DE ORIGEM EM EUR*/\",\"LEFT OUTER JOIN\",\"  (SELECT \",\"  Ltx.IdLogistica_House,\",\"  SUM(Ltx.Valor_Pagamento_Corrente) AS Total_BRL_Pagamento\",\"FROM \",\"  vis_Logistica_taxa Ltx\",\"GROUP BY \",\"  Ltx.IdLogistica_House) Ttb on Ttb.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Receber_De = 2 /*AGENTE NO DESTINO*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Frv on Frv.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DE RECEBIMENTO PARA O AGENTE NO DESTINO*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.IdTaxa_Logistica_Exibicao = 6 /*LIBERAÇÃO DE BL*/) Lir on Lir.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA LIBERAÇÃO DE BL*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    Ltx.Valor_Recebimento_Unitario,\",\"    Ltx.Valor_Recebimento_Total AS Valor_Venda_Total\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    (Ltx.IdTaxa_Logistica_Exibicao in (113,7,49)) /*THC ORIGEM - CAPATAZIA FCL - LCL*/) Thr on Thr.IdLogistica_House = Lhs.IdLogistica_House  /*TOTAL DE RECEBIMENTO DA TAXA THC ORIGEM*/ \",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_BRL_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"    AND Ltx.IdMoeda_Recebimento = 20 /*BRL*/\",\"    AND Ltx.IdTaxa_Logistica_Exibicao not in (2, 6, 7, 49, 113) /*FRETE - BL - THC/CAPATAZIA FCL - LCL*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Txr on Txr.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM BRL*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_USD_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"    AND Ltx.IdMoeda_Recebimento = 141 /*USD*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Tru on Tru.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIMENTO DAS TAXAS DE ORIGEM EM USD*/\",\"LEFT OUTER JOIN \",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Total) AS Taxas_EUR_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  WHERE \",\"    Ltx.Origem_Taxa = 2 /*ORIGEM*/\",\"    /*AND Ltx.IdMoeda_Recebimento = 43 /*EUR*/ REQ #45683*/\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Tre on Tre.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL RECEBIEMNTO DAS TAXAS DE ORIGEM EM EUR*/\",\"LEFT OUTER JOIN\",\"  (SELECT \",\"    Ltx.IdLogistica_House,\",\"    SUM(Ltx.Valor_Recebimento_Corrente) AS Total_BRL_Recebimento\",\"  FROM \",\"    vis_Logistica_taxa Ltx\",\"  GROUP BY \",\"    Ltx.IdLogistica_House) Trc on Trc.IdLogistica_House = Lhs.IdLogistica_House /*TOTAL DAS TAXAS DE PAGAMENTO EM BRL*/\",\"  WHERE \",\"    Lms.Data_Embarque >= DATEADD(DAY, -30, GETDATE())\",\") Tst\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Numero_Processo\nCampo[0].DisplayLabel=N° Processo\nCampo[0].Origin=Tst.Numero_Processo\nCampo[0].Width=100\nCampo[1].FieldName=Responsavel_Operacional\nCampo[1].DisplayLabel=Responsável Operacional\nCampo[1].Origin=Tst.Responsavel_Operacional\nCampo[1].Width=120\nCampo[2].FieldName=Cliente\nCampo[2].DisplayLabel=Cliente\nCampo[2].Origin=Tst.Cliente\nCampo[2].Width=120\nCampo[3].FieldName=Exportador\nCampo[3].DisplayLabel=Exportador\nCampo[3].Origin=Tst.Exportador\nCampo[3].Width=120\nCampo[4].FieldName=Despachante\nCampo[4].DisplayLabel=Despachante\nCampo[4].Origin=Tst.Despachante\nCampo[4].Width=100\nCampo[5].FieldName=Referencia_Cliente\nCampo[5].DisplayLabel=Referência Cliente\nCampo[5].Origin=Tst.Referencia_Cliente\nCampo[5].Width=100\nCampo[6].FieldName=Consignatario\nCampo[6].DisplayLabel=Consignatario\nCampo[6].Origin=Tst.Consignatario\nCampo[6].Width=100\nCampo[7].FieldName=Booking\nCampo[7].DisplayLabel=Booking\nCampo[7].Origin=Tst.Booking\nCampo[7].Width=110\nCampo[8].FieldName=Conf\nCampo[8].DisplayLabel=Conferido\nCampo[8].Origin=Tst.Conf\nCampo[8].Width=40\nCampo[9].FieldName=Data_Retirada_Container\nCampo[9].DisplayLabel=Data Retirada Container\nCampo[9].Origin=Tst.Data_Retirada_Container\nCampo[9].Width=120\nCampo[9].DisplayFormat=dd/MM/yyyy\nCampo[10].FieldName=Local_Retirada_Container\nCampo[10].DisplayLabel=Local Retirada Container\nCampo[10].Origin=Tst.Local_Retirada_Container\nCampo[10].Width=150\nCampo[11].FieldName=Local_Entrega_Container\nCampo[11].DisplayLabel=Local Entrega Container\nCampo[11].Origin=Tst.Local_Entrega_Container\nCampo[11].Width=120\nCampo[12].FieldName=Numero_Container\nCampo[12].DisplayLabel=N° Container\nCampo[12].Origin=Tst.Numero_Container\nCampo[12].Width=120\nCampo[13].FieldName=Deadline_Draft\nCampo[13].DisplayLabel=Deadline Draft\nCampo[13].Origin=Tst.Deadline_Draft\nCampo[13].Width=100\nCampo[13].DisplayFormat=dd/MM/yyyy\nCampo[14].FieldName=Dummy_1\nCampo[14].DisplayLabel=Dummy 1\nCampo[14].Origin=Dummy_1\nCampo[14].Width=80\nCampo[15].FieldName=Envio_Draft_BL\nCampo[15].DisplayLabel=Envio Draft BL\nCampo[15].Origin=Tst.Envio_Draft_BL\nCampo[15].Width=50\nCampo[16].FieldName=Liberacao_BL\nCampo[16].DisplayLabel=Liberação BL\nCampo[16].Origin=Tst.Liberacao_BL\nCampo[16].Width=100\nCampo[17].FieldName=Deadline_VGM\nCampo[17].DisplayLabel=Deadline VGM\nCampo[17].Origin=Tst.Deadline_VGM\nCampo[17].Width=80\nCampo[18].FieldName=Dummy_2\nCampo[18].DisplayLabel=Dummy 2\nCampo[18].Origin=Dummy_2\nCampo[18].Width=80\nCampo[19].FieldName=Envio_VGM\nCampo[19].DisplayLabel=Envio VGM\nCampo[19].Origin=Tst.Envio_VGM\nCampo[19].Width=50\nCampo[20].FieldName=Deadline_Carga\nCampo[20].DisplayLabel=Deadline Carga\nCampo[20].Origin=Tst.Deadline_Carga\nCampo[20].Width=80\nCampo[21].FieldName=Dummy_3\nCampo[21].DisplayLabel=Dummy 3\nCampo[21].Origin=Dummy_3\nCampo[21].Width=80\nCampo[22].FieldName=Data_Deposito_Container\nCampo[22].DisplayLabel=Data Deposito Container\nCampo[22].Origin=Tst.Data_Deposito_Container\nCampo[22].Width=100\nCampo[22].DisplayFormat=dd/MM/yyyy\nCampo[23].FieldName=Numero_MBL\nCampo[23].DisplayLabel=Número MBL\nCampo[23].Origin=Tst.Numero_MBL\nCampo[23].Width=110\nCampo[24].FieldName=Numero_HBL\nCampo[24].DisplayLabel=Número HBL\nCampo[24].Origin=Tst.Numero_HBL\nCampo[24].Width=110\nCampo[25].FieldName=Mercadoria\nCampo[25].DisplayLabel=Mercadoria\nCampo[25].Origin=Tst.Mercadoria\nCampo[25].Width=120\nCampo[26].FieldName=Navio\nCampo[26].DisplayLabel=Navio\nCampo[26].Origin=Tst.Navio\nCampo[26].Width=100\nCampo[27].FieldName=Viagem_Navio\nCampo[27].DisplayLabel=Viagem Navio\nCampo[27].Origin=Tst.Viagem_Navio\nCampo[27].Width=100\nCampo[28].FieldName=Origem\nCampo[28].DisplayLabel=Origem\nCampo[28].Origin=Tst.Origem\nCampo[28].Width=100\nCampo[29].FieldName=Destino\nCampo[29].DisplayLabel=Destino\nCampo[29].Origin=Tst.Destino\nCampo[29].Width=100\nCampo[30].FieldName=Pais_Destino\nCampo[30].DisplayLabel=Pais Destino\nCampo[30].Origin=Tst.Pais_Destino\nCampo[30].Width=100\nCampo[31].FieldName=Via\nCampo[31].DisplayLabel=Via\nCampo[31].Origin=Tst.Via\nCampo[31].Width=100\nCampo[32].FieldName=Data_Saida\nCampo[32].DisplayLabel=Data Saída\nCampo[32].Origin=Tst.Data_Saida\nCampo[32].Width=100\nCampo[32].DisplayFormat=dd/MM/yyyy\nCampo[33].FieldName=Fatura_Frete_Compra\nCampo[33].DisplayLabel=Fatura Frete Compra\nCampo[33].Origin=Tst.Fatura_Frete_Compra\nCampo[33].Width=80\nCampo[34].FieldName=Fatura_Locais_Compra\nCampo[34].DisplayLabel=Fatura Locais Compra\nCampo[34].Origin=Tst.Fatura_Locais_Compra\nCampo[34].Width=80\nCampo[35].FieldName=Dias_Em_Aberto_C\nCampo[35].DisplayLabel=Dias Em Aberto Compra\nCampo[35].Origin=Tst.Dias_Em_Aberto_C\nCampo[35].Width=80\nCampo[36].FieldName=Fatura_Frete_Venda\nCampo[36].DisplayLabel=Fatura Frete Venda\nCampo[36].Origin=Tst.Fatura_Frete_Venda\nCampo[36].Width=80\nCampo[37].FieldName=Fatura_Locais_Venda\nCampo[37].DisplayLabel=Fatura Locais Venda\nCampo[37].Origin=Tst.Fatura_Locais_Venda\nCampo[37].Width=80\nCampo[38].FieldName=Data_Chegada\nCampo[38].DisplayLabel=Data_Chegada\nCampo[38].Origin=Tst.Data_Chegada\nCampo[38].Width=100\nCampo[38].DisplayFormat=dd/MM/yyyy\nCampo[39].FieldName=Aviso_Chegada\nCampo[39].DisplayLabel=Aviso Chegada\nCampo[39].Origin=Tst.Aviso_Chegada\nCampo[39].Width=50\nCampo[40].FieldName=Companhia_Transporte\nCampo[40].DisplayLabel=Companhia Transporte\nCampo[40].Origin=Tst.Companhia_Transporte\nCampo[40].Width=100\nCampo[41].FieldName=Dias_Em_Aberto_V\nCampo[41].DisplayLabel=Dias Em Aberto Venda\nCampo[41].Origin=Tst.Dias_Em_Aberto_V\nCampo[41].Width=80\nCampo[42].FieldName=Agente_Internacional\nCampo[42].DisplayLabel=Agente Internacional\nCampo[42].Origin=Tst.Agente_Internacional\nCampo[42].Width=110\nCampo[43].FieldName=Valor_Compra_Unitario\nCampo[43].DisplayLabel=Valor Compra Unitário\nCampo[43].Origin=Tst.Valor_Compra_Unitario\nCampo[43].Width=100\nCampo[43].DisplayFormat=#0.00\nCampo[44].FieldName=Valor_Compra_Total\nCampo[44].DisplayLabel=Valor Compra Total\nCampo[44].Origin=Tst.Valor_Compra_Total\nCampo[44].Width=100\nCampo[44].DisplayFormat=#0.00\nCampo[45].FieldName=Free_Detention_Compra\nCampo[45].DisplayLabel=Free Detention Compra\nCampo[45].Origin=Tst.Free_Detention_Compra\nCampo[45].Width=50\nCampo[46].FieldName=PP_CC_PA\nCampo[46].DisplayLabel=PP CC PA\nCampo[46].Origin=Tst.PP_CC_PA\nCampo[46].Width=100\nCampo[47].FieldName=Valor_Venda_Unitaria\nCampo[47].DisplayLabel=Valor Venda Unitária\nCampo[47].Origin=Tst.Valor_Venda_Unitaria\nCampo[47].Width=100\nCampo[47].DisplayFormat=#,0.00\nCampo[48].FieldName=Valor_Venda_Total\nCampo[48].DisplayLabel=Valor Venda Total\nCampo[48].Origin=Tst.Valor_Venda_Total\nCampo[48].Width=100\nCampo[48].DisplayFormat=#,0.00\nCampo[49].FieldName=Free_Dentention_Venda\nCampo[49].DisplayLabel=Free Dentention Venda\nCampo[49].Origin=Tst.Free_Dentention_Venda\nCampo[49].Width=50\nCampo[50].FieldName=Qtde_Cntr\nCampo[50].DisplayLabel=Quantidade Container\nCampo[50].Origin=Tst.Qtde_Cntr\nCampo[50].Width=50\nCampo[51].FieldName=Dias_Detention\nCampo[51].DisplayLabel=Dias Detention\nCampo[51].Origin=Tst.Dias_Detention\nCampo[51].Width=50\nCampo[52].FieldName=Profit_USD\nCampo[52].DisplayLabel=Profit USD\nCampo[52].Origin=Tst.Profit_USD\nCampo[52].Width=100\nCampo[52].DisplayFormat=USD#,#0.00\nCampo[53].FieldName=Equipamento\nCampo[53].DisplayLabel=Equipamento\nCampo[53].Origin=Tst.Equipamento\nCampo[53].Width=100\nCampo[54].FieldName=Frete_Agente_Pgto\nCampo[54].DisplayLabel=Frete Agente Pagamento\nCampo[54].Origin=Tst.Frete_Agente_Pgto\nCampo[54].Width=100\nCampo[54].DisplayFormat=#,0.00\nCampo[55].FieldName=BL_BRL_Pagamento\nCampo[55].DisplayLabel=BL BRL Pagamento\nCampo[55].Origin=Tst.BL_BRL_Pagamento\nCampo[55].Width=100\nCampo[55].DisplayFormat=#,0.00\nCampo[56].FieldName=THC_Pagamento\nCampo[56].DisplayLabel=THC Pagamento\nCampo[56].Origin=Tst.THC_Pagamento\nCampo[56].Width=100\nCampo[56].DisplayFormat=#,0.00\nCampo[57].FieldName=Total_THC_Pagamento\nCampo[57].DisplayLabel=Total THC Pagamento\nCampo[57].Origin=Tst.Total_THC_Pagamento\nCampo[57].Width=100\nCampo[57].DisplayFormat=#,0.00\nCampo[58].FieldName=Taxas_BRL_Pagamento\nCampo[58].DisplayLabel=Taxas BRL Pagamento\nCampo[58].Origin=Tst.Taxas_BRL_Pagamento\nCampo[58].Width=100\nCampo[58].DisplayFormat=#,0.00\nCampo[59].FieldName=Taxas_USD_Pagamento\nCampo[59].DisplayLabel=Taxas USD Pagamento\nCampo[59].Origin=Tst.Taxas_USD_Pagamento\nCampo[59].Width=100\nCampo[59].DisplayFormat=USD#,#0.00\nCampo[60].FieldName=Taxas_EUR_Pagamento\nCampo[60].DisplayLabel=Outras Taxas Pagamento\nCampo[60].Origin=Tst.Taxas_EUR_Pagamento\nCampo[60].Width=100\nCampo[60].DisplayFormat=#,#0.00\nCampo[61].FieldName=Total_Detention_Pgto\nCampo[61].DisplayLabel=Total Detention Pagamento\nCampo[61].Origin=Tst.Total_Detention_Pgto\nCampo[61].Width=100\nCampo[61].DisplayFormat=50\nCampo[62].FieldName=Taxa_Cambio_USD_Pgto\nCampo[62].DisplayLabel=Taxa_Cambio_USD_Pagamento\nCampo[62].Origin=Tst.Taxa_Cambio_USD_Pgto\nCampo[62].Width=100\nCampo[63].FieldName=Total_BRL_Pagamento\nCampo[63].DisplayLabel=Total BRL Pagamento\nCampo[63].Origin=Tst.Total_BRL_Pagamento\nCampo[63].Width=100\nCampo[63].DisplayFormat=#,0.00\nCampo[64].FieldName=Data_Pagamento\nCampo[64].DisplayLabel=Data Pagamento\nCampo[64].Origin=Tst.Data_Pagamento\nCampo[64].Width=80\nCampo[65].FieldName=Frete_Agente_Rcbto\nCampo[65].DisplayLabel=Frete Agente Recebimento\nCampo[65].Origin=Tst.Frete_Agente_Rcbto\nCampo[65].Width=100\nCampo[65].DisplayFormat=#,0.00\nCampo[66].FieldName=BL_BRL_Recebimento\nCampo[66].DisplayLabel=BL BRL Recebimento\nCampo[66].Origin=Tst.BL_BRL_Recebimento\nCampo[66].Width=100\nCampo[66].DisplayFormat=#,0.00\nCampo[67].FieldName=THC_Recebimento\nCampo[67].DisplayLabel=THC Recebimento\nCampo[67].Origin=Tst.THC_Recebimento\nCampo[67].Width=100\nCampo[67].DisplayFormat=#,0.00\nCampo[68].FieldName=Total_THC_Recebimento\nCampo[68].DisplayLabel=Total THC Recebimento\nCampo[68].Origin=Tst.Total_THC_Recebimento\nCampo[68].Width=100\nCampo[68].DisplayFormat=#,0.00\nCampo[69].FieldName=Taxas_BRL_Recebimento\nCampo[69].DisplayLabel=Taxas BRL Recebimento\nCampo[69].Origin=Tst.Taxas_BRL_Recebimento\nCampo[69].Width=100\nCampo[69].DisplayFormat=#,0.00\nCampo[70].FieldName=Taxas_USD_Recebimento\nCampo[70].DisplayLabel=Taxas USD Recebimento\nCampo[70].Origin=Tst.Taxas_USD_Recebimento\nCampo[70].Width=100\nCampo[70].DisplayFormat=USD#,#0.00\nCampo[71].FieldName=Taxas_EUR_Recebimento\nCampo[71].DisplayLabel=Outras Taxas Recebimento\nCampo[71].Origin=Tst.Taxas_EUR_Recebimento\nCampo[71].Width=100\nCampo[71].DisplayFormat=#,#0.00\nCampo[72].FieldName=Total_Detention_Rcbto\nCampo[72].DisplayLabel=Total Detention Recebimento\nCampo[72].Origin=Tst.Total_Detention_Rcbto\nCampo[72].Width=100\nCampo[73].FieldName=Taxa_Cambio_USD_Rcbto\nCampo[73].DisplayLabel=Taxa Cambio USD Recebimento\nCampo[73].Origin=Tst.Taxa_Cambio_USD_Rcbto\nCampo[73].Width=100\nCampo[74].FieldName=Outras_Taxas_BRL\nCampo[74].DisplayLabel=Outras taxas BRL\nCampo[74].Origin=Tst.Outras_Taxas_BRL\nCampo[74].Width=80\nCampo[75].FieldName=Total_BRL_Recebimento\nCampo[75].DisplayLabel=Total BRL Recebimento\nCampo[75].Origin=Tst.Total_BRL_Recebimento\nCampo[75].Width=100\nCampo[75].DisplayFormat=#,0.00\nCampo[76].FieldName=Data_Recebimento\nCampo[76].DisplayLabel=Data Recebimento\nCampo[76].Origin=Tst.Data_Recebimento\nCampo[76].Width=80\nCampo[77].FieldName=Frete_C\nCampo[77].DisplayLabel=Frete C\nCampo[77].Origin=Tst.Frete_C\nCampo[77].Width=80\nCampo[78].FieldName=Locais_C\nCampo[78].DisplayLabel=Locais C\nCampo[78].Origin=Tst.Locais_C\nCampo[78].Width=80\nCampo[79].FieldName=Fatura\nCampo[79].DisplayLabel=Fatura\nCampo[79].Origin=Tst.Fatura\nCampo[79].Width=80\nCampo[80].FieldName=Vencimento_C\nCampo[80].DisplayLabel=Vencimento C\nCampo[80].Origin=Tst.Vencimento_C\nCampo[80].Width=80\nCampo[81].FieldName=Frete_V\nCampo[81].DisplayLabel=Frete V\nCampo[81].Origin=Tst.Frete_V\nCampo[81].Width=80\nCampo[82].FieldName=Locais_V\nCampo[82].DisplayLabel=Locais V\nCampo[82].Origin=Tst.Locais_V\nCampo[82].Width=80\nCampo[83].FieldName=Taxas_Banco\nCampo[83].DisplayLabel=Taxas Banco\nCampo[83].Origin=Tst.Taxas_Banco\nCampo[83].Width=80\nCampo[84].FieldName=Profit_Liquido\nCampo[84].DisplayLabel=Profit Liquido\nCampo[84].Origin=Tst.Profit_Liquido\nCampo[84].Width=100\nCampo[84].DisplayFormat=#,0.00\nCampo[85].FieldName=Fatura_Cliente\nCampo[85].DisplayLabel=Fatura Cliente\nCampo[85].Origin=Tst.Fatura_Cliente\nCampo[85].Width=80\nCampo[86].FieldName=Vencimento_V\nCampo[86].DisplayLabel=Vencimento V\nCampo[86].Origin=Tst.Vencimento_V\nCampo[86].Width=80\nCampo[87].FieldName=Vendedor\nCampo[87].DisplayLabel=Vendedor\nCampo[87].Origin=Tst.Vendedor\nCampo[87].Width=120\nCampo[88].FieldName=Data_Reserva\nCampo[88].DisplayLabel=Data Reserva\nCampo[88].Origin=Tst.Data_Reserva\nCampo[88].Width=80\nCampo[89].FieldName=Observaçoes\nCampo[89].DisplayLabel=Observações\nCampo[89].Origin=Tst.Observaçoes\nCampo[89].Width=120\n\n[FieldDefs]\nCount=90\nItems[0].Name=Numero_Processo\nItems[0].DataType=ftString\nItems[0].Precision=0\nItems[0].Size=25\nItems[1].Name=Responsavel_Operacional\nItems[1].DataType=ftString\nItems[1].Precision=0\nItems[1].Size=75\nItems[2].Name=Cliente\nItems[2].DataType=ftString\nItems[2].Precision=0\nItems[2].Size=75\nItems[3].Name=Exportador\nItems[3].DataType=ftString\nItems[3].Precision=0\nItems[3].Size=75\nItems[4].Name=Despachante\nItems[4].DataType=ftString\nItems[4].Precision=0\nItems[4].Size=75\nItems[5].Name=Referencia_Cliente\nItems[5].DataType=ftString\nItems[5].Precision=0\nItems[5].Size=400\nItems[6].Name=Consignatario\nItems[6].DataType=ftString\nItems[6].Precision=0\nItems[6].Size=75\nItems[7].Name=Booking\nItems[7].DataType=ftString\nItems[7].Precision=0\nItems[7].Size=25\nItems[8].Name=Conf\nItems[8].DataType=ftString\nItems[8].Precision=0\nItems[8].Size=3\nItems[9].Name=Data_Retirada_Container\nItems[9].DataType=ftDateTime\nItems[9].Precision=0\nItems[9].Size=0\nItems[10].Name=Local_Retirada_Container\nItems[10].DataType=ftString\nItems[10].Precision=0\nItems[10].Size=75\nItems[11].Name=Local_Entrega_Container\nItems[11].DataType=ftString\nItems[11].Precision=0\nItems[11].Size=75\nItems[12].Name=Numero_Container\nItems[12].DataType=ftString\nItems[12].Precision=0\nItems[12].Size=50\nItems[13].Name=Deadline_Draft\nItems[13].DataType=ftDateTime\nItems[13].Precision=0\nItems[13].Size=0\nItems[14].Name=Dummy_1\nItems[14].DataType=ftString\nItems[14].Precision=0\nItems[14].Size=1\nItems[15].Name=Envio_Draft_BL\nItems[15].DataType=ftString\nItems[15].Precision=0\nItems[15].Size=1\nItems[16].Name=Liberacao_BL\nItems[16].DataType=ftString\nItems[16].Precision=0\nItems[16].Size=15\nItems[17].Name=Deadline_VGM\nItems[17].DataType=ftString\nItems[17].Precision=0\nItems[17].Size=1\nItems[18].Name=Dummy_2\nItems[18].DataType=ftString\nItems[18].Precision=0\nItems[18].Size=1\nItems[19].Name=Envio_VGM\nItems[19].DataType=ftString\nItems[19].Precision=0\nItems[19].Size=1\nItems[20].Name=Deadline_Carga\nItems[20].DataType=ftString\nItems[20].Precision=0\nItems[20].Size=1\nItems[21].Name=Dummy_3\nItems[21].DataType=ftString\nItems[21].Precision=0\nItems[21].Size=1\nItems[22].Name=Data_Deposito_Container\nItems[22].DataType=ftDateTime\nItems[22].Precision=0\nItems[22].Size=0\nItems[23].Name=Numero_MBL\nItems[23].DataType=ftString\nItems[23].Precision=0\nItems[23].Size=50\nItems[24].Name=Numero_HBL\nItems[24].DataType=ftMemo\nItems[24].Precision=0\nItems[24].Size=0\nItems[25].Name=Mercadoria\nItems[25].DataType=ftString\nItems[25].Precision=0\nItems[25].Size=50\nItems[26].Name=Navio\nItems[26].DataType=ftString\nItems[26].Precision=0\nItems[26].Size=50\nItems[27].Name=Viagem_Navio\nItems[27].DataType=ftString\nItems[27].Precision=0\nItems[27].Size=25\nItems[28].Name=Origem\nItems[28].DataType=ftString\nItems[28].Precision=0\nItems[28].Size=50\nItems[29].Name=Destino\nItems[29].DataType=ftString\nItems[29].Precision=0\nItems[29].Size=50\nItems[30].Name=Pais_Destino\nItems[30].DataType=ftString\nItems[30].Precision=0\nItems[30].Size=50\nItems[31].Name=Via\nItems[31].DataType=ftString\nItems[31].Precision=0\nItems[31].Size=50\nItems[32].Name=Data_Saida\nItems[32].DataType=ftDateTime\nItems[32].Precision=0\nItems[32].Size=0\nItems[33].Name=Fatura_Frete_Compra\nItems[33].DataType=ftString\nItems[33].Precision=0\nItems[33].Size=1\nItems[34].Name=Fatura_Locais_Compra\nItems[34].DataType=ftString\nItems[34].Precision=0\nItems[34].Size=1\nItems[35].Name=Dias_Em_Aberto_C\nItems[35].DataType=ftString\nItems[35].Precision=0\nItems[35].Size=1\nItems[36].Name=Fatura_Frete_Venda\nItems[36].DataType=ftString\nItems[36].Precision=0\nItems[36].Size=1\nItems[37].Name=Fatura_Locais_Venda\nItems[37].DataType=ftString\nItems[37].Precision=0\nItems[37].Size=1\nItems[38].Name=Data_Chegada\nItems[38].DataType=ftDateTime\nItems[38].Precision=0\nItems[38].Size=0\nItems[39].Name=Aviso_Chegada\nItems[39].DataType=ftSmallint\nItems[39].Precision=0\nItems[39].Size=0\nItems[40].Name=Companhia_Transporte\nItems[40].DataType=ftString\nItems[40].Precision=0\nItems[40].Size=75\nItems[41].Name=Dias_Em_Aberto_V\nItems[41].DataType=ftString\nItems[41].Precision=0\nItems[41].Size=1\nItems[42].Name=Agente_Internacional\nItems[42].DataType=ftString\nItems[42].Precision=0\nItems[42].Size=75\nItems[43].Name=Valor_Compra_Unitario\nItems[43].DataType=ftBCD\nItems[43].Precision=19\nItems[43].Size=2\nItems[44].Name=Valor_Compra_Total\nItems[44].DataType=ftBCD\nItems[44].Precision=38\nItems[44].Size=2\nItems[45].Name=Free_Detention_Compra\nItems[45].DataType=ftSmallint\nItems[45].Precision=0\nItems[45].Size=0\nItems[46].Name=PP_CC_PA\nItems[46].DataType=ftString\nItems[46].Precision=0\nItems[46].Size=15\nItems[47].Name=Valor_Venda_Unitaria\nItems[47].DataType=ftBCD\nItems[47].Precision=19\nItems[47].Size=2\nItems[48].Name=Valor_Venda_Total\nItems[48].DataType=ftBCD\nItems[48].Precision=38\nItems[48].Size=2\nItems[49].Name=Free_Dentention_Venda\nItems[49].DataType=ftSmallint\nItems[49].Precision=0\nItems[49].Size=0\nItems[50].Name=Qtde_Cntr\nItems[50].DataType=ftInteger\nItems[50].Precision=0\nItems[50].Size=0\nItems[51].Name=Dias_Detention\nItems[51].DataType=ftInteger\nItems[51].Precision=0\nItems[51].Size=0\nItems[52].Name=Profit_USD\nItems[52].DataType=ftBCD\nItems[52].Precision=38\nItems[52].Size=2\nItems[53].Name=Equipamento\nItems[53].DataType=ftString\nItems[53].Precision=0\nItems[53].Size=200\nItems[54].Name=Frete_Agente_Pgto\nItems[54].DataType=ftBCD\nItems[54].Precision=38\nItems[54].Size=2\nItems[55].Name=BL_BRL_Pagamento\nItems[55].DataType=ftBCD\nItems[55].Precision=19\nItems[55].Size=2\nItems[56].Name=THC_Pagamento\nItems[56].DataType=ftBCD\nItems[56].Precision=19\nItems[56].Size=2\nItems[57].Name=Total_THC_Pagamento\nItems[57].DataType=ftBCD\nItems[57].Precision=19\nItems[57].Size=2\nItems[58].Name=Taxas_BRL_Pagamento\nItems[58].DataType=ftBCD\nItems[58].Precision=38\nItems[58].Size=2\nItems[59].Name=Taxas_USD_Pagamento\nItems[59].DataType=ftBCD\nItems[59].Precision=38\nItems[59].Size=2\nItems[60].Name=Taxas_EUR_Pagamento\nItems[60].DataType=ftBCD\nItems[60].Precision=38\nItems[60].Size=2\nItems[61].Name=Total_Detention_Pgto\nItems[61].DataType=ftInteger\nItems[61].Precision=0\nItems[61].Size=0\nItems[62].Name=Taxa_Cambio_USD_Pgto\nItems[62].DataType=ftString\nItems[62].Precision=0\nItems[62].Size=1\nItems[63].Name=Total_BRL_Pagamento\nItems[63].DataType=ftBCD\nItems[63].Precision=38\nItems[63].Size=7\nItems[64].Name=Data_Pagamento\nItems[64].DataType=ftString\nItems[64].Precision=0\nItems[64].Size=1\nItems[65].Name=Frete_Agente_Rcbto\nItems[65].DataType=ftBCD\nItems[65].Precision=38\nItems[65].Size=2\nItems[66].Name=BL_BRL_Recebimento\nItems[66].DataType=ftBCD\nItems[66].Precision=19\nItems[66].Size=2\nItems[67].Name=THC_Recebimento\nItems[67].DataType=ftBCD\nItems[67].Precision=19\nItems[67].Size=2\nItems[68].Name=Total_THC_Recebimento\nItems[68].DataType=ftBCD\nItems[68].Precision=19\nItems[68].Size=2\nItems[69].Name=Taxas_BRL_Recebimento\nItems[69].DataType=ftBCD\nItems[69].Precision=38\nItems[69].Size=2\nItems[70].Name=Taxas_USD_Recebimento\nItems[70].DataType=ftBCD\nItems[70].Precision=38\nItems[70].Size=2\nItems[71].Name=Taxas_EUR_Recebimento\nItems[71].DataType=ftBCD\nItems[71].Precision=38\nItems[71].Size=2\nItems[72].Name=Total_Detention_Rcbto\nItems[72].DataType=ftInteger\nItems[72].Precision=0\nItems[72].Size=0\nItems[73].Name=Taxa_Cambio_USD_Rcbto\nItems[73].DataType=ftString\nItems[73].Precision=0\nItems[73].Size=1\nItems[74].Name=Outras_Taxas_BRL\nItems[74].DataType=ftString\nItems[74].Precision=0\nItems[74].Size=1\nItems[75].Name=Total_BRL_Recebimento\nItems[75].DataType=ftBCD\nItems[75].Precision=38\nItems[75].Size=7\nItems[76].Name=Data_Recebimento\nItems[76].DataType=ftString\nItems[76].Precision=0\nItems[76].Size=1\nItems[77].Name=Frete_C\nItems[77].DataType=ftString\nItems[77].Precision=0\nItems[77].Size=1\nItems[78].Name=Locais_C\nItems[78].DataType=ftString\nItems[78].Precision=0\nItems[78].Size=1\nItems[79].Name=Fatura\nItems[79].DataType=ftString\nItems[79].Precision=0\nItems[79].Size=1\nItems[80].Name=Vencimento_C\nItems[80].DataType=ftString\nItems[80].Precision=0\nItems[80].Size=1\nItems[81].Name=Frete_V\nItems[81].DataType=ftString\nItems[81].Precision=0\nItems[81].Size=1\nItems[82].Name=Locais_V\nItems[82].DataType=ftString\nItems[82].Precision=0\nItems[82].Size=1\nItems[83].Name=Taxas_Banco\nItems[83].DataType=ftString\nItems[83].Precision=0\nItems[83].Size=1\nItems[84].Name=Profit_Liquido\nItems[84].DataType=ftBCD\nItems[84].Precision=38\nItems[84].Size=7\nItems[85].Name=Fatura_Cliente\nItems[85].DataType=ftString\nItems[85].Precision=0\nItems[85].Size=1\nItems[86].Name=Vencimento_V\nItems[86].DataType=ftString\nItems[86].Precision=0\nItems[86].Size=1\nItems[87].Name=Vendedor\nItems[87].DataType=ftString\nItems[87].Precision=0\nItems[87].Size=75\nItems[88].Name=Data_Reserva\nItems[88].DataType=ftString\nItems[88].Precision=0\nItems[88].Size=1\nItems[89].Name=Observaçoes\nItems[89].DataType=ftString\nItems[89].Precision=0\nItems[89].Size=50\n\n"
    },
    {
        "caminho": "Scripts\\Relatórios\\Relatório de Profit.txt",
        "conteudo": "data abertura do processo (operacional)\nnumero do processo (operacional)\ncliente (operacional)\n\nUSD (fechamento comercial)\nBRL (fechamento comercial)\nUSD - PARA REAL (CONVERSAO DA ABERTURA)\ntotal (conversao + lucro estimado real)\n \n \nUM TOTAL ABAIXO (soma da coluna total)\n\n\"Começar a consulta pelo logistica house\""
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\OFERTA_MARITIMA_COM_SOMA  - OFERTA_TAXA_DESTINO copy.html",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Tle.Nome,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then case When Tle.IdTaxa_Logistica_Exibicao = 479 then 'Sob custos de origem e frete' else 'por Processo'/*Peso Cubado*/ end\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 22 Then case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob valor da mercadoria' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*valor antigo por tonelada*/\n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*VALOR ANTIGO por Tonelada*/\n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 3 /*Destino*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\OFERTA_MARITIMA_COM_SOMA  - OFERTA_TAXA_ORIGEM.html",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Tle.Nome,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then case When Tle.IdTaxa_Logistica_Exibicao = 479 then 'Sob custos de origem e frete' else 'por Processo'/*Peso Cubado*/ end\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 22 Then case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob valor da mercadoria' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*valor antigo por tonelada*/\n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*VALOR ANTIGO por Tonelada*/\n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 3 /*Destino*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\OFERTA_TAXA_ORIGEM - ORIGINAL.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 2 /*Origem*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>\t<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*de por tonelada alterado para 'por w/m'*/ \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 2 /*Origem*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\OFERTA_TAXA_ORIGEM.txt",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*de por tonelada alterado para 'por w/m'*/ \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*de por tonelada alterado para 'por w/m'*/ \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 2 /*Origem*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\QUALITY CONSULTA RELATORIO.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Size=\"0\"/></Parameters><CommandText>Declare\n  @IdOferta_Frete IdLongo\n  \nSet @IdOferta_Frete = :IdOferta_Frete\nSelect\n @IdOferta_Frete As IdOferta_Frete,\n Stuff(Cast((Select ' + ' + Tmd.Moeda_Recebimento + ' ' + Format(Tmd.Valor, 'N', 'pt-br') From (Select\n    Ttx.IdOferta_Frete,\n    Ttx.Moeda as Moeda_Recebimento,\n    sum(Ttx.Valor) As Valor\n  From\n    (Select\n        Ofr.IdOferta_Frete,\n        Mrc.Sigla as Moeda,\n       \n\n        Oft.Valor_Recebimento_Total As Valor\n      From\n        mov_Oferta_Frete Ofr\n  Join\n    mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n      Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n        And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n        And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n        And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n        And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n        And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n          Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n          Or (Oft.Origem_Taxa = 1 /* Frete */)))\n  Join\n    cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\n  Left Outer Join\n    cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\n  Left Outer Join\n    mov_Proposta_Frete Pfr on Pfr.IdProposta_Frete = Ofr.IdProposta_Frete\n  Where\n    Oft.Exibir_Cliente = 1\n  and\n    Oft.Valor_Recebimento_Total &lt;&gt; 0\n  and\n    Ofr.IdOferta_Frete =@IdOferta_Frete\n  Union All\n      \nSelect \n  Ofr.IdOferta_Frete,\n  Msg.Sigla as Moeda_Recebimento,\n  CASE \n      WHEN ((Pfc.Importancia_Segurada * Pfc.Percentual_Seguro) / 100) &lt; IsNull(Oft_Seg.Valor_Recebimento_Minimo, 0) \n            AND IsNull(Oft_Seg.Valor_Recebimento_Minimo, 0) &gt; 0 THEN \n          Oft_Seg.Valor_Recebimento_Minimo\n      ELSE \n          ((Pfc.Importancia_Segurada * Pfc.Percentual_Seguro) / 100)\n  END As Valor  \nFrom\n  mov_Oferta_Frete Ofr\nLeft outer Join\n  mov_Proposta_Frete_Carga Pfc On Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nLeft Outer Join\n  cad_Moeda Msg On Msg.IdMoeda = Pfc.IdMoeda_Mercadoria\nLeft Outer Join \n  mov_Oferta_Frete_Taxa Oft_Seg On Oft_Seg.IdOferta_Frete = Ofr.IdOferta_Frete\nLeft Outer Join \n  cad_Taxa_Logistica_Exibicao Tle_Seg On Tle_Seg.IdTaxa_Logistica_Exibicao = Oft_Seg.IdTaxa_Logistica_Exibicao\nLeft Outer Join \n  cad_Taxa_Logistica Tlg_Seg On Tlg_Seg.IdTaxa_Logistica = Tle_Seg.IdTaxa_Logistica \nWhere\n  Ofr.IdOferta_Frete = @IdOferta_Frete\n  AND Tlg_Seg.IdTaxa_Logistica = 26\n\t) As Ttx\n  Group By\n    Ttx.IdOferta_Frete,\n    Ttx.Moeda) As Tmd For Xml Path, Type).query('data(.)') As VarChar(Max)), 1, 2, '') As Total_Moeda</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\TAXAS_RECEBIMENTO_FATURA - NEWEST #45146.txt",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdRegistro_Recebimento\" Type=\"ftInteger\" Test=\"13\"/></Parameters><CommandText>Select\n  Ltx.IdRegistro_Recebimento,\n  Ltx.IdLogistica_Taxa,\n  Ltx.Origem_Taxa,\n  Ltx.Observacao,\n  Mrc.Sigla as Moeda,\n  Ltx.Valor_Recebimento_Unitario,\n  Ltx.Quantidade_Recebimento,\n  Ltx.Valor_Recebimento_Total,\n  Tle.Nome as Taxa,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  case When Ltx.Tipo_Recebimento = 1 Then ' ' /*(Sem cobrança)*/\n        When Ltx.Tipo_Recebimento = 2 Then ' ' /*Processo*/\n        When Ltx.Tipo_Recebimento = 3 Then  ' ' /*Peso Cubado*/\n        When Ltx.Tipo_Recebimento = 4 Then  ' ' /*Peso Taxado*/\n        When Ltx.Tipo_Recebimento = 5 Then  ' ' /*Peso Bruto*/\n        When Ltx.Tipo_Recebimento = 6 Then  ' ' /*Metro Cubico*/\n        When Ltx.Tipo_Recebimento = 7 Then  ' ' /*Conhecimento*/\n        When Ltx.Tipo_Recebimento = 8 Then  ' ' /*invoice*/\n        When Ltx.Tipo_Recebimento = 9 Then  ' ' /*Volumes*/\n        When Ltx.Tipo_Recebimento = 10 Then  ' ' /*Equipamento*/\n        When Ltx.Tipo_Recebimento = 11 Then  ' ' /*Equipamento*/\n        When Ltx.Tipo_Recebimento = 12 Then  ' ' /*Teu*/\n        When Ltx.Tipo_Recebimento = 13 Then  ' %' /*Percentual*/\n        When Ltx.Tipo_Recebimento = 14 Then  ' '\n        When Ltx.Tipo_Recebimento = 15 Then  ' ' /*Via Master*/\n        When Ltx.Tipo_Recebimento = 16 Then  ' ' /*Via house*/\n        When Ltx.Tipo_Recebimento = 17 Then  ' ' /*Peso Considerado*/\n  end as Valor_Unitario_Tipo,\n  Cast(Case\n    When Ltx.IdMoeda_Recebimento = Lft.IdMoeda Then 1\n    When (Ltx.IdMoeda_Recebimento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n    When (Ltx.IdMoeda_Recebimento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n    Else 0\n  End As Float) As Fator,\n  Round((Ltx.Valor_Recebimento_Total *  \n   Case\n     When Ltx.IdMoeda_Recebimento = Lft.IdMoeda Then 1\n     When (Ltx.IdMoeda_Recebimento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n     When (Ltx.IdMoeda_Recebimento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n     Else 0\n   End), 2) As Valor_Corrente,\n   Eqm.Descricao as Ue\nFrom\n  mov_Logistica_Taxa Ltx\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\nLeft Outer Join\n  mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n    And ((Ltx.IdMoeda_Recebimento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n    Or (Ltx.IdMoeda_Recebimento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem))\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Ltx.IdEquipamento_Maritimo\nWhere\n  Ltx.IdRegistro_Recebimento =:IdRegistro_Recebimento\nOrder By\n  Ltx.Origem_Taxa</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\Fonde de dados\\Usuario_Logado.txt",
        "conteudo": "<DataSet><CommandText>Select\n  Fnc.IdPessoa,\n  Fnc.Nome as Funcionario,\n  Fnc.EMail\nFrom\n  sys_Usuario Usr\nJoin\n  #Global_Var Gvr on Gvr.Variavel Like 'IdUsuario' And Usr.IdUsuario = Gvr.Valor\nJoin\n  vis_Funcionario Fnc on Fnc.IdUsuario_Correspondente = Usr.IdUsuario\n</CommandText></DataSet>\n\nusuario logado"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\174 - OFERTA_TAXA_ORIGEM - LOG.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &amp;gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &amp;gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 2 /*Origem*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\174 - OFERTA_TAXA_ORIGEM - SISTEMA.sql",
        "conteudo": "174 - OFERTA_TAXA_ORIGEM - SISTEMA\n<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Tle.Nome,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then case When Tle.IdTaxa_Logistica_Exibicao = 479 then 'Sob custos de origem e frete' else 'por Processo'/*Peso Cubado*/ end\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 22 Then case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob valor da mercadoria' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*valor antigo por tonelada*/\n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*VALOR ANTIGO por Tonelada*/\n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 3 /*Destino*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\175 - OFERTA_TAXA_DESTINO - LOG.sql",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Tle.Nome,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then case When Tle.IdTaxa_Logistica_Exibicao = 479 then 'Sob custos de origem e frete' else 'por Processo'/*Peso Cubado*/ end\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 22 Then case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob valor da mercadoria' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 3 /*Destino*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\175 - OFERTA_TAXA_DESTINO - SISTEMA.txt",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Tle.Nome,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then case When Tle.IdTaxa_Logistica_Exibicao = 479 then 'Sob custos de origem e frete' else 'por Processo'/*Peso Cubado*/ end\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 22 Then case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob valor da mercadoria' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 23 Then 'Por Tonelada'\n        When Oft.Tipo_Recebimento = 17 Then\n        \n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*valor antigo por tonelada*/\n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 23 Then 'Por Tonelada'\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*VALOR ANTIGO por Tonelada*/\n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 3 /*Destino*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\2023 - TRANSBORDO - TEX  #44968 BKP.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n    CASE\n  WHEN Trt.Nome IS NOT NULL AND Lhs.Tipo_Carga = 4 /*LCL*/ THEN CONCAT(' (',Trt.Nome,') ') ELSE '' END as Tipo_Terminal,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'Variavel_Armador'\n  else 'Variavel_Modalidade'\n  end as Variavel,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'ARMADOR:'\n  else 'MODALIDADE:'\n  end as Titulo_Variavel,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 59162 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 48952 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n   CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971)  THEN 'Titulo_Referencia'\n  else 'Referencia_Titulo'\n  end as Referencia_Variavel,\n  COALESCE(Agm.Nome,Ctr.Nome) as Armador_Nome,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Nvi.Nome as Navio,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Agm on Agm.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Tabela_transbordo_OLD\" Sql=\"Select\n  CASE\n  WHEN Nvit.Nome IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Nvit.Nome as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Ptr.Nome as Origem_Completa,\n  Ptd.Nome as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Nvit.Nome As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt On Lmt.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\n  cad_Origem_Destino Ptd on Ptd.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Navio Nvit On Nvit.IdNavio = Lmt.IdNavio\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nWhere\n  Atv.IdAtividade= :IdAtividade\n  order by Lmt.Data_Previsao_Embarque desc\">\n\n<DataSet Name=\"Tabela_transbordo\" Sql=\"Select\n  CASE\n    WHEN Lmt.Navio IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Lmt.Navio as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Lmt.Porto_Transbordo as Origem_Completa,\n  Lmt.Porto_Desembarque as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lmt.Navio As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join(\n  SELECT\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.Data_Desembarque Desc)As Ranking,\n    Lgv.IdLogistica_House,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Van.Data_Desembarque as Data_Chegada,\n    Van.Data_Previsao_Desembarque as Data_Previsao_Chegada,\n    Nvo.Nome as Navio,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.IdLogistica_Viagem,\n    Lgv.Numero_Controle as Numero_BL,\n    Lgv.Data_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque, \n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Case\n      When Lgv.Tipo_Servico = 0 Then 'Não informado'\n      When Lgv.Tipo_Servico = 1 Then 'Transbordo'\n      When Lgv.Tipo_Servico = 2 Then 'Cabotagem'\n      End As Tipo\n  From\n    mov_Logistica_Viagem Lgv\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  JOIN \n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Precedencia - 1\n  Left Outer Join\n    cad_Navio Nvo on Nvo.IdNavio = Lgv.IdNavio\n  ) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade= :IdAtividade\norder by \n  Lmt.IdLogistica_Viagem asc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga_Detalhada\" Sql=\"Select \nEqm.Rank,\nLhs.IdLogistica_House,\nEqm.Quantidade,\nLmc.Free_Time_Master,\nLmc.Free_Time_House,\nEmr.IdEquipamento_Maritimo,\nLmc.Number,\nDateadd(Day, Lmc.Free_Time_House, Lms.Data_Desembarque) As Data_Devolucao,\nSUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1) AS Tamanho_Equipamento,\nCase\n  When Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\n  When Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\n  When Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 13 Then '' /**/\n  When Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd AS Equipamento\nFROM \nmov_Atividade Atv\nLEFT OUTER JOIN \nmov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \ncad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nLeft Outer Join(\nSelect\nRank() OVER(PARTITION BY IdLogistica_House ORDER BY Eqm.Descricao) AS Rank,\nLme.IdLogistica_House,\nEqm.Descricao as Equipamento,\nLme.Quantidade\nFrom\nmov_Logistica_Maritima_Equipamento Lme\nLeft Outer Join\ncad_Equipamento_Maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\n) Eqm ON Eqm.IdLogistica_House = Lhs.IdLogistica_House and Eqm.Rank = 1\nWHERE \nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \nLhs.IdLogistica_House,\nLme.Quantidade,\nLme.Free_Time_House_Destino,\nEmr.Descricao as Cntr,\nCONCAT(Lme.Quantidade,'x', SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1), ' ' , Case\nWhen Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\nWhen Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\nWhen Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 13 Then '' /**/\nWhen Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd, ' (', Lme.Free_Time_House_Destino, ' Dias)') AS Equipamento\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n\n  \n  <title>FOLLOW UP</title>\n\n  <meta charset=\"utf-8\"> \n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> \n  <meta http-equiv=\"pragma\" content=\"no-cache\"> \n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0\"> \n  <meta name=\"google\" value=\"notranslate\">\n  <meta name=\"format-detection\" content=\"telephone=no\">\n  <meta name=\"scriptVer\" content=\"20231117004.14\">\n  <meta name=\"hashedPath\" content=\"\">\n  <meta name=\"physicalRing\" content=\"WW\">\n  <meta name=\"environment\" content=\"Prod\">\n  <meta name=\"bootFlights\" content=\"localStorageOwaPrefix,fwk-analytics-addons,cal-getTimeZoneOffsetsV2,acctPersistenceSourceIdV2,dev-offlineMultiAccountDB,auth-getAuthTokenV2,cal-publishedCalendarV2,shellmultiorigin:394927,limitfoldersonboot:474919,oobe-welcome-spinner:407828,react18:477911\"> \n  <meta name=\"cdnUrl\" content=\"//res.cdn.office.net/\">\n  <meta name=\"backupCdnUrl\" content=\"//res-h3.public.cdn.office.net/\">\n  <meta name=\"cdnContainer\" content=\"owamail/\">\n  <meta name=\"devCdnUrl\" content=\"\">\n  <meta name=\"ariaUrl\" content=\"\">\n  <meta name=\"webServerForest\" content=\"lamp152\">\n  <meta name=\"webServerClique\" content=\"CLLAMP152CPQ00\"> \n  <meta name=\"compactAriaUrl\" content=\"\">\n  <meta name=\"wcssFrameUrl\" content=\"https://webshell.suite.office.com\">\n  <meta name=\"wcssFrameUrls\" content=\"{'DefaultUrl':'https://webshell.suite.office.com','WwdbUrl':'https://wwdb.webshell.suite.office.com','EudbUrl':'https://eudb.webshell.suite.office.com'}\"> \n  <meta name=\"scriptPath\" content=\"react18/scripts/\">\n  <meta name=\"owaIsAuthenticated\" content=\"{{IsAuthenticated}}\">\n  <meta name=\"jsTimestamp\" content=\"1701290110391\"> \n  <meta name=\"publicUrl\" content=\"https://outlook.office.com\">\n\n  <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n  <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap\" rel=\"stylesheet\">\n  <style media=\"screen and (prefers-reduced-motion: reduce)\" data-make-styles-bucket=\"m\"></style>\n  <style media=\"(forced-colors: active)\" data-make-styles-bucket=\"m\"></style>\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    body,td,tr,p{ font-family: 'Montserrat', sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n      \n    .box_color_yellow { text-align: center; font-weight:700 ; border-width: 30px; background: rgb(255, 221, 114); color: black;}\n    .box_color_grey { text-align: center; border: 10px; background: #808080; color: white;}\n    .grey { color: #808080; }\n    .espacamento-20 {padding: 20px; box-sizing: border-box;}\n    .destacado {font-weight: 600;}\n    .borda-espacada{ border-style:solid; border-color: #808080; border-width: 1px 1px 1px 1px; padding: 2.5px;} \n    .destacado-grey {font-weight: 600; color: #808080;}\n    .borda_sem_baixo{ text-align: center; border-top:solid; border-right:solid; border-left:solid; border-width: 1px 1px 1px 1px; border-color:#808080;}\n    .borda_sem_direita_acomp{ border-bottom:solid; border-top:solid; border-left:solid; border-color: #808080; color: #808080; border-width: 1px 1px 1px 1px}\n    .box_color_noright { border-bottom:solid; border-top:solid; border-right:solid; border-width: 0.2px; color:#808080; border-color: rgb(128, 128, 128);}\n    .text-center-20 { text-align: center; font-size: 20px; font-weight: bold; color: #808080;}\n\n\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<SubReport NameField=\"Referencia_Variavel\" NameSource=\"Processo\">\n[Subject.Footer]\n  \n  \n[Report.Detail]\n<SubReport Name =\"Logo_Andre\" Dataset=\"Processo\">\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>  \n    <td width=\"775\" class=\"box_color_yellow\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n  </tr>\n</table>\n\n<br>\n<br>\n\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td>CLIENTE:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n      <td>DATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td width=\"12%\">TEX#:</td>\n      <td width=\"38%\" class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td>REF:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>\n    <td class=\"box_color_grey\" colspan=\"4\">INFORMAÇÕES DE EMBARQUE</td>\n  </tr>\n</table>\n<br>\n\n<table class=\"borda-espacada\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"20%\" class=\"grey\">EXPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n    <td width=\"20%\" class=\"grey\">IMPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">HBL:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"grey\">NAVIO/VIAGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  </tr>\n  <tr>\n      <td class=\"grey\">ORIGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"grey\">DESTINO:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">ETD:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"grey\">ETA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">EMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"destacado-grey\">DESEMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MBL:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Titulo_Variavel\"></td>\n      <td class=\"grey\"><SubReport NameField=\"Variavel\" NameSource=\"Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MERCADORIA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"grey\">TIPO (FREE TIME):</td>\n      <td class=\"grey\"><SubReport Name=\"Equipamento_Sub\" Dataset=\"Carga\"></td>\n  </tr>\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DA CARGA</td>\n  </tr>\n</table>\n\n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">TIPOS DE EQUIPAMENTOS:</td>\n    <td class=\"grey\">CONTAINERS:</td>\n    <td class=\"grey\">LIMITE DE DEVOLUÇÃO:</td>\n  </tr>\n\n  <SubReport Name=\"Carga_Detalhada_Sub\" Dataset=\"Carga_Detalhada\">\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DE TRANSBORDO</td>\n  </tr>\n</table>\n \n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">PORTO TRANSBORDO</td>\n    <td class=\"grey\">PORTO DESEMBARQUE</td>\n    <td class=\"grey\">NAVIO/VIAGEM</td>\n    <td class=\"grey\">PREV. CHEGADA</td>\n    <td class=\"grey\">CONF. CHEGADA</td>\n    <td class=\"grey\">PREV. EMBARQUE</td>\n    <td class=\"grey\">CONF. EMBARQUE</td>\n  </tr>\n <SubReport Name=\"Transbordo\" Dataset=\"Tabela_transbordo\">\n </table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"20\">\n  <tr>\n    <td class=\"text-center-20\">HISTÓRICO</td>\n  </tr>\n</table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"borda_sem_direita_acomp\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n    <td class=\"box_color_noright\" width=\"80%\"><span class=\"negrito\">DESCRITIVO</span></td>\n  </tr>\n\n    <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n    <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      \n  <tr>\n    <td colspan=\"6\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Logo_Andre.Detail]\n<td colspan=\"2\">\n    <img src=<Print Dataset=\"Processo\" FieldName=\"Logo_Variavel\"> class=\"display-none\"/>\n</td>\n\n[Variavel_Armador.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Armador_Nome\">\n \n[Variavel_Modalidade.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Tipo_Carga_Detalhe\"> <Print Dataset=\"Processo\" FieldName=\"Tipo_Terminal\">\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n\n[Titulo_Referencia]\nTransbordo - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\"> - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> \n\n[Referencia_Titulo]\nTransbordo - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">\n\n\n\n[Transbordo.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Origem_Completa\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Destino_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Navio_Completo\"> / <Print Dataset=\"Tabela_transbordo\" FieldName=\"Viagem_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Embarque_Completa\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n\n[Carga_Detalhada_Sub.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Tamanho_Equipamento\">' <Print Dataset=\"Carga_Detalhada\" FieldName=\"Equipamento\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Number\"></td>\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Data_Devolucao\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n[Equipamento_Sub.Detail]\n<Print Dataset=\"Carga\" FieldName=\"Equipamento\">, \n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\2023 - TRANSBORDO - TEX  #44968.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n    CASE\n  WHEN Trt.Nome IS NOT NULL AND Lhs.Tipo_Carga = 4 /*LCL*/ THEN CONCAT(' (',Trt.Nome,') ') ELSE '' END as Tipo_Terminal,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'Variavel_Armador'\n  else 'Variavel_Modalidade'\n  end as Variavel,\n  CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971) THEN 'ARMADOR:'\n  else 'MODALIDADE:'\n  end as Titulo_Variavel,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 59162 THEN 'https://i.imgur.com/zVpIZy3.png'\n  WHEN Cln.IdPessoa = 48952 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n   CASE\n  WHEN Cln.IdPessoa IN (58934,59162,49971)  THEN 'Titulo_Referencia'\n  else 'Referencia_Titulo'\n  end as Referencia_Variavel,\n  COALESCE(Agm.Nome,Ctr.Nome) as Armador_Nome,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Nvi.Nome as Navio,\n  CASE\n  WHEN Cln.IdPessoa = 58934 THEN 'https://i.imgur.com/zVpIZy3.png'\n  else 'https://i.imgur.com/zVpIZy3.png'\n  end as Logo_Variavel,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome_Fantasia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome_Fantasia /*Importacao - Agente na origem*/\n  End as Agente_Fantasia,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Correspondencia /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Correspondencia /*Importacao - Agente na origem*/\n  End as Agente_Correspondencia,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Agm on Agm.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n<DataSet Name=\"Tabela_transbordo_OLD\" Sql=\"Select\n  CASE\n  WHEN Nvit.Nome IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Nvit.Nome as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Ptr.Nome as Origem_Completa,\n  Ptd.Nome as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Nvit.Nome As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Transbordo Lmt On Lmt.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\nLeft Outer Join\n  cad_Origem_Destino Ptd on Ptd.IdOrigem_Destino = Lmt.IdPorto_Desembarque\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Navio Nvit On Nvit.IdNavio = Lmt.IdNavio\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nWhere\n  Atv.IdAtividade= :IdAtividade\n  order by Lmt.Data_Previsao_Embarque desc\">\n\n<DataSet Name=\"Tabela_transbordo\" Sql=\"Select\n  CASE\n    WHEN Lmt.Navio IS NULL then ' ' else 'Transbordo'\n  end as Tabela_Condicao,\n  Lmt.Navio as Navio_Completo,\n  Lmt.Viagem as Viagem_Completo,\n  Lmt.Porto_Transbordo as Origem_Completa,\n  Lmt.Porto_Desembarque as Destino_Completo,\n  Lmt.Data_Embarque as Data_Embarque_Completa,\n  Lmt.Data_Previsao_Embarque as Data_Previsao_Embarque,\n  Lmt.Data_Previsao_Chegada as Data_Previsao_Chegada,\n  Lmt.Data_Chegada as Data_Chegada,\n  Lmt.Data_Desembarque as Data_Desembarque_Completa,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lmt.Navio As Navio_Transbordo,\n  Lmt.Viagem as Viagem_Transbordo\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join(\n  SELECT\n    Rank() Over (Partition By Lgv.IdLogistica_House Order By Lgv.Data_Desembarque Desc)As Ranking,\n    Lgv.IdLogistica_House,\n    Org.Nome as Porto_Transbordo,\n    Dst.Nome as Porto_Desembarque,\n    Van.Data_Desembarque as Data_Chegada,\n    Van.Data_Previsao_Desembarque as Data_Previsao_Chegada,\n    Nvo.Nome as Navio,\n    Lgv.Viagem_Voo as Viagem,\n    Lgv.IdLogistica_Viagem,\n    Lgv.Numero_Controle as Numero_BL,\n    Lgv.Data_Embarque,\n    Lgv.Data_Previsao_Embarque,\n    Lgv.Data_Previsao_Desembarque, \n    Lgv.Data_Desembarque,\n    Lgv.Observacao,\n    Case\n      When Lgv.Tipo_Servico = 0 Then 'Não informado'\n      When Lgv.Tipo_Servico = 1 Then 'Transbordo'\n      When Lgv.Tipo_Servico = 2 Then 'Cabotagem'\n      End As Tipo\n  From\n    mov_Logistica_Viagem Lgv\n  Left Outer Join\n    cad_Origem_Destino Org on Org.IdOrigem_Destino = Lgv.IdOrigem\n  Left Outer Join\n    cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lgv.IdDestino\n  JOIN \n    mov_Logistica_Viagem Van on Van.IdLogistica_House = Lgv.IdLogistica_House AND Van.Sequencia = Lgv.Precedencia - 1\n  Left Outer Join\n    cad_Navio Nvo on Nvo.IdNavio = Lgv.IdNavio\n  ) Lmt on Lmt.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nWhere\n  Atv.IdAtividade= :IdAtividade\norder by \n  Lmt.IdLogistica_Viagem asc\">\n\n<DataSet Name=\"Container\" Sql=\"Select\n  Lmc.IdLogistica_House,\n  Lmc.Number as Cntr,\n  Lmc.Tare,\n  Lmc.Seal,\n  Lmc.Bar_Seal,\n  Lmc.Quantity,\n  Lmc.Measurement,\n  Lmc.Gross_Weight,\n  Lmc.Net_Weight,\n  Lmc.Consolidacao,\n  Eqm.Descricao as Ue\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join  \n  mov_Logistica_Maritima_Container Lmc on Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  vis_Bill_Lading Bld on Bld.IdConhecimento_Embarque = Lmc.IdConhecimento_Embarque\nLeft Outer Join\n  cad_Equipamento_Maritimo Eqm on Eqm.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n<DataSet Name=\"Carga_Detalhada\" Sql=\"Select \nEqm.Rank,\nLhs.IdLogistica_House,\nEqm.Quantidade,\nLmc.Free_Time_Master,\nLmc.Free_Time_House,\nEmr.IdEquipamento_Maritimo,\nLmc.Number,\nDateadd(Day, Lmc.Free_Time_House, Lms.Data_Desembarque) As Data_Devolucao,\nSUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1) AS Tamanho_Equipamento,\nCase\n  When Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\n  When Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\n  When Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\n  When Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\n  When Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\n  When Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\n  When Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\n  When Emr.IdEquipamento_Maritimo = 13 Then '' /**/\n  When Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\n  When Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\n  When Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd AS Equipamento\nFROM \nmov_Atividade Atv\nLEFT OUTER JOIN \nmov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLEFT OUTER JOIN\nmov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLEFT OUTER JOIN\nmov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN \ncad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Lmc.IdEquipamento_Maritimo\nLeft Outer Join(\nSelect\nRank() OVER(PARTITION BY IdLogistica_House ORDER BY Eqm.Descricao) AS Rank,\nLme.IdLogistica_House,\nEqm.Descricao as Equipamento,\nLme.Quantidade\nFrom\nmov_Logistica_Maritima_Equipamento Lme\nLeft Outer Join\ncad_Equipamento_Maritimo Eqm ON Eqm.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\n) Eqm ON Eqm.IdLogistica_House = Lhs.IdLogistica_House and Eqm.Rank = 1\nWHERE \nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Carga\" Sql=\"Select \nLhs.IdLogistica_House,\nLme.Quantidade,\nLme.Free_Time_House_Destino,\nEmr.Descricao as Cntr,\nCONCAT(Lme.Quantidade,'x', SUBSTRING(Emr.Descricao, 1, CHARINDEX(' ', Emr.Descricao) - 1), ' ' , Case\nWhen Emr.IdEquipamento_Maritimo = 1 Then 'TK' /*Tank*/\nWhen Emr.IdEquipamento_Maritimo = 2 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 3 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 4 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 5 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 6 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 7 Then 'PM' /*Plataform*/\nWhen Emr.IdEquipamento_Maritimo = 8 Then 'FR' /*Flat Rack*/\nWhen Emr.IdEquipamento_Maritimo = 9 Then 'HC' /*High Cube*/\nWhen Emr.IdEquipamento_Maritimo = 10 Then 'DRY' /*Dry Box*/\nWhen Emr.IdEquipamento_Maritimo = 11 Then 'OT' /*Open Top*/\nWhen Emr.IdEquipamento_Maritimo = 12 Then 'RH' /*Reefer*/\nWhen Emr.IdEquipamento_Maritimo = 13 Then '' /**/\nWhen Emr.IdEquipamento_Maritimo = 14 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 15 Then 'NOR' /*Nor*/\nWhen Emr.IdEquipamento_Maritimo = 16 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 17 Then 'MAFI' /*Mafi*/\nWhen Emr.IdEquipamento_Maritimo = 18 Then 'OG' /**/\nEnd, ' (', Lme.Free_Time_House_Destino, ' Dias)') AS Equipamento\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\nmov_Logistica_Maritima_Equipamento Lme on Lme.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\ncad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Lme.IdEquipamento_Maritimo\nWhere\nAtv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\nORDER BY\n Acm.Data DESC,\n Acm.IdAcompanhamento DESC\">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,  \n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n\n  \n  <title>FOLLOW UP</title>\n\n  <meta charset=\"utf-8\"> \n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> \n  <meta http-equiv=\"pragma\" content=\"no-cache\"> \n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0\"> \n  <meta name=\"google\" value=\"notranslate\">\n  <meta name=\"format-detection\" content=\"telephone=no\">\n  <meta name=\"scriptVer\" content=\"20231117004.14\">\n  <meta name=\"hashedPath\" content=\"\">\n  <meta name=\"physicalRing\" content=\"WW\">\n  <meta name=\"environment\" content=\"Prod\">\n  <meta name=\"bootFlights\" content=\"localStorageOwaPrefix,fwk-analytics-addons,cal-getTimeZoneOffsetsV2,acctPersistenceSourceIdV2,dev-offlineMultiAccountDB,auth-getAuthTokenV2,cal-publishedCalendarV2,shellmultiorigin:394927,limitfoldersonboot:474919,oobe-welcome-spinner:407828,react18:477911\"> \n  <meta name=\"cdnUrl\" content=\"//res.cdn.office.net/\">\n  <meta name=\"backupCdnUrl\" content=\"//res-h3.public.cdn.office.net/\">\n  <meta name=\"cdnContainer\" content=\"owamail/\">\n  <meta name=\"devCdnUrl\" content=\"\">\n  <meta name=\"ariaUrl\" content=\"\">\n  <meta name=\"webServerForest\" content=\"lamp152\">\n  <meta name=\"webServerClique\" content=\"CLLAMP152CPQ00\"> \n  <meta name=\"compactAriaUrl\" content=\"\">\n  <meta name=\"wcssFrameUrl\" content=\"https://webshell.suite.office.com\">\n  <meta name=\"wcssFrameUrls\" content=\"{'DefaultUrl':'https://webshell.suite.office.com','WwdbUrl':'https://wwdb.webshell.suite.office.com','EudbUrl':'https://eudb.webshell.suite.office.com'}\"> \n  <meta name=\"scriptPath\" content=\"react18/scripts/\">\n  <meta name=\"owaIsAuthenticated\" content=\"{{IsAuthenticated}}\">\n  <meta name=\"jsTimestamp\" content=\"1701290110391\"> \n  <meta name=\"publicUrl\" content=\"https://outlook.office.com\">\n\n  <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n  <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap\" rel=\"stylesheet\">\n  <style media=\"screen and (prefers-reduced-motion: reduce)\" data-make-styles-bucket=\"m\"></style>\n  <style media=\"(forced-colors: active)\" data-make-styles-bucket=\"m\"></style>\n\n  <style>\n    * { box-sizing: border-box; }\n    .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    body,td,tr,p{ font-family: 'Montserrat', sans-serif; font-size:10.0pt; }\n    .title { font-weight: bold; position: absolute; right: 28px; bottom: 28px; font-size: 14pt; }\n    .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n    .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n    th { font-size: 14px; }\n    .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n    .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n    .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n    .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n    .text-center { text-align: center; }\n    .text-left { text-align: left; }\n    .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n    .cor-fonte-white { color: white; }\n    .negrito { font-weight: bold; }\n    .sem-negrito { font-weight: normal; }\n    .font-size-14 { font-size: 14px; }\n    .font-size-11 { font-size: 11pt; }\n    .margin-bottom-5 { margin-bottom: 5px; }\n    .line-height-3 { line-height: 3px; }\n\n    .line-height-3_cor-fundo { line-height: 3px; background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">;}\n    .text-left_negrito { text-align: left; font-weight: bold;}\n    .cor-fundo_cor-fonte-white { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; color: white;}\n    .cor-fundo-2_borda-sem-direita { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .cor-fundo-2_borda-sem-esquerda { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n    .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n    .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n    .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px;}\n\n      \n    .box_color_yellow { text-align: center; font-weight:700 ; border-width: 30px; background: rgb(255, 221, 114); color: black;}\n    .box_color_grey { text-align: center; border: 10px; background: #808080; color: white;}\n    .grey { color: #808080; }\n    .espacamento-20 {padding: 20px; box-sizing: border-box;}\n    .destacado {font-weight: 600;}\n    .borda-espacada{ border-style:solid; border-color: #808080; border-width: 1px 1px 1px 1px; padding: 2.5px;} \n    .destacado-grey {font-weight: 600; color: #808080;}\n    .borda_sem_baixo{ text-align: center; border-top:solid; border-right:solid; border-left:solid; border-width: 1px 1px 1px 1px; border-color:#808080;}\n    .borda_sem_direita_acomp{ border-bottom:solid; border-top:solid; border-left:solid; border-color: #808080; color: #808080; border-width: 1px 1px 1px 1px}\n    .box_color_noright { border-bottom:solid; border-top:solid; border-right:solid; border-width: 0.2px; color:#808080; border-color: rgb(128, 128, 128);}\n    .text-center-20 { text-align: center; font-size: 20px; font-weight: bold; color: #808080;}\n\n\n\n  </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">;\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\n<SubReport NameField=\"Referencia_Variavel\" NameSource=\"Processo\">\n[Subject.Footer]\n  \n  \n[Report.Detail]\n<SubReport Name =\"Logo_Andre\" Dataset=\"Processo\">\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>  \n    <td width=\"775\" class=\"box_color_yellow\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n  </tr>\n</table>\n\n<br>\n<br>\n\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n      <td>CLIENTE:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n  </tr>\n  <tr>\n      <td>DATA:</td>\n      <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td width=\"12%\">TEX#:</td>\n      <td width=\"38%\" class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n  </tr>\n  <tr>\n      <td>REF:</td>\n      <td class=\"negrito\"><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n  </tr>\n  <tr>\n      <td width=\"12%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n      <td width=\"40%\">&nbsp <!-- &nbsp preenche espaço vazio --></td>\n  </tr>\n</table>\n\n<table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"5\">\n  <tr>\n    <td class=\"box_color_grey\" colspan=\"4\">INFORMAÇÕES DE EMBARQUE</td>\n  </tr>\n</table>\n<br>\n\n<table class=\"borda-espacada\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td width=\"20%\" class=\"grey\">EXPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n    <td width=\"20%\" class=\"grey\">IMPORTADOR:</td>\n    <td width=\"30%\" class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">HBL:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>\n      <td class=\"grey\">NAVIO/VIAGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Navio\"> / <Print Dataset=\"Processo\" FieldName=\"Viagem_Navio\"></td>       \n  </tr>\n  <tr>\n      <td class=\"grey\">ORIGEM:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n      <td class=\"grey\">DESTINO:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">ETD:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"grey\">ETA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"destacado-grey\">EMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n      <td class=\"destacado-grey\">DESEMBARQUE:</td>\n      <td class=\"destacado-grey\"><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\" DisplayFormat=\"dd/mm/yyyy\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MBL:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Titulo_Variavel\"></td>\n      <td class=\"grey\"><SubReport NameField=\"Variavel\" NameSource=\"Processo\"></td>\n  </tr>\n  <tr>\n      <td class=\"grey\">MERCADORIA:</td>\n      <td class=\"grey\"><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n      <td class=\"grey\">TIPO (FREE TIME):</td>\n      <td class=\"grey\"><SubReport Name=\"Equipamento_Sub\" Dataset=\"Carga\"></td>\n  </tr>\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DA CARGA</td>\n  </tr>\n</table>\n\n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">TIPOS DE EQUIPAMENTOS:</td>\n    <td class=\"grey\">CONTAINERS:</td>\n    <td class=\"grey\">LIMITE DE DEVOLUÇÃO:</td>\n  </tr>\n\n  <SubReport Name=\"Carga_Detalhada_Sub\" Dataset=\"Carga_Detalhada\">\n</table>\n\n<br>\n<table class=\"borda_sem_baixo\" width=\"775\">\n  <tr>\n    <td>INFORMAÇÕES DE TRANSBORDO</td>\n  </tr>\n</table>\n \n<table width=\"775\" class=\"borda-espacada\">\n  <tr style=\"text-align: center;\">\n    <td class=\"grey\">PORTO TRANSBORDO</td>\n    <td class=\"grey\">PORTO DESEMBARQUE</td>\n    <td class=\"grey\">NAVIO/VIAGEM</td>\n    <td class=\"grey\">PREV. CHEGADA</td>\n    <td class=\"grey\">CONF. CHEGADA</td>\n    <td class=\"grey\">PREV. EMBARQUE</td>\n    <td class=\"grey\">CONF. EMBARQUE</td>\n  </tr>\n <SubReport Name=\"Transbordo\" Dataset=\"Tabela_transbordo\">\n </table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"20\">\n  <tr>\n    <td class=\"text-center-20\">HISTÓRICO</td>\n  </tr>\n</table>\n\n<br>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n    <td class=\"borda_sem_direita_acomp\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n    <td class=\"box_color_noright\" width=\"80%\"><span class=\"negrito\">DESCRITIVO</span></td>\n  </tr>\n\n    <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n    <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      \n  <tr>\n    <td colspan=\"6\" heigth=\"3\"></td>\n  </tr>\n</table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Logo_Andre.Detail]\n<td colspan=\"2\">\n    <img src=<Print Dataset=\"Processo\" FieldName=\"Logo_Variavel\"> class=\"display-none\"/>\n</td>\n\n[Variavel_Armador.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Armador_Nome\">\n \n[Variavel_Modalidade.Detail]\n<Print Dataset=\"Processo\" FieldName=\"Tipo_Carga_Detalhe\"> <Print Dataset=\"Processo\" FieldName=\"Tipo_Terminal\">\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n  <!-- TESTE PARA TRAZER A PREVISAO DE CHEGADA NO DESTINO COM A DATA  -->\n  <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\"> \n        <tr>\n            <td class=\"cor-fundo-2 text-center negrito\" style=\"padding: 15px; font-size: 14px;\">\n                Previsão de chegada no destino final: <Print Dataset=\"Processo\" FieldName=\"Destino\"> no dia: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">.\n            </td>\n        </tr>\n    </table>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n\n\n[Titulo_Referencia]\nTransbordo - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\"> - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> \n\n[Referencia_Titulo]\nTransbordo - Ref. Cliente: <Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"> - Processo: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - <Print Dataset=\"Processo\" FieldName=\"Importador\"> - HBL: <Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"> - ETA: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">\n\n\n\n[Transbordo.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Origem_Completa\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Destino_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Navio_Completo\"> / <Print Dataset=\"Tabela_transbordo\" FieldName=\"Viagem_Completo\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Chegada\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Previsao_Embarque\" DisplayFormat=\"dd/MM/yyyy\">\n <td class=\"grey\"><Print Dataset=\"Tabela_transbordo\" FieldName=\"Data_Embarque_Completa\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n\n[Carga_Detalhada_Sub.Detail]\n<tr style=\"text-align: center;\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Tamanho_Equipamento\">' <Print Dataset=\"Carga_Detalhada\" FieldName=\"Equipamento\">\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Number\"></td>\n <td class=\"grey\"><Print Dataset=\"Carga_Detalhada\" FieldName=\"Data_Devolucao\" DisplayFormat=\"dd/MM/yyyy\"></td>\n</tr>\n\n[Equipamento_Sub.Detail]\n<Print Dataset=\"Carga\" FieldName=\"Equipamento\">, \n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\DESTINO.txt",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Tle.Nome,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then case When Tle.IdTaxa_Logistica_Exibicao = 479 then 'Sob custos de origem e frete' else 'por Processo'/*Peso Cubado*/ end\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then  case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob o valor da mercadoria' else'por KG'/*Peso Taxado*/ end\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then case When Tle.IdTaxa_Logistica_Exibicao = 9 then 'Sob custos de origem e frete' else 'por Percentual' end\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 21 Then case WHEN (Ofr.Tipo_Operacao = 2 and Ofr.Modalidade_Processo = 1) THEN '% sobre importância segurada' When Tle.IdTaxa_Logistica_Exibicao = 35 then 'Sob o valor CIF' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 22 Then case When Tle.IdTaxa_Logistica_Exibicao = 73 then 'Sob valor da mercadoria' else '% sobre importância segurada' end\n        When Oft.Tipo_Recebimento = 23 Then 'Por Tonelada' /*campo novo*/\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' /*Chamado 45057 e 45140*/ /*valor antigo nesse campo 'por Tonelada'*/\n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 23 Then 'Por Tonelada' /*campo novo*/\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 3 /*Destino*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\ORIGEM.txt",
        "conteudo": "<DataSet><Parameters><Item Name=\"IdOferta_Frete\" Type=\"ftInteger\" Test=\"16\"/></Parameters><CommandText>Select\n  Oft.IdOferta_Frete_Taxa,\n  Ofr.IdOferta_Frete,\n  Oft.IdTaxa_Logistica_Exibicao,\n  Oft.IdEquipamento_Maritimo,\n  Oft.IdMoeda_Pagamento,\n  Oft.IdMoeda_Recebimento,\n  Oft.IdConta_Pagamento,\n  Oft.IdPessoa_Pagamento,\n  Oft.IdPessoa_Recebimento,\n  Oft.IdCompanhia_Transporte,\n  Oft.IdOrigem_Destino,\n  Oft.IdProposta_Frete_Carga,\n  Oft.Pagar_Para,\n  Oft.Receber_De,\n  Oft.Quantidade_Pagamento,\n  Oft.Quantidade_Recebimento,\n  Oft.Valor_Pagamento_Unitario,\n  Oft.Valor_Pagamento_Minimo,\n  Oft.Valor_Pagamento_Total,\n  Oft.Valor_Recebimento_Unitario,\n  Oft.Valor_Recebimento_Minimo,\n  Oft.Valor_Recebimento_Total,\n  case When Oft.Tipo_Recebimento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Recebimento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Recebimento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Recebimento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Recebimento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Recebimento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Recebimento = 8 Then 'por Invoice'\n        When Oft.Tipo_Recebimento = 9 Then 'por Volume'\n        When Oft.Tipo_Recebimento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Recebimento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Recebimento = 12 Then 'por TEU'\n        When Oft.Tipo_Recebimento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Recebimento = 14 Then ''/*livre*/\n        When Oft.Tipo_Recebimento = 15 Then '/Via Master'\n        When Oft.Tipo_Recebimento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 23 Then 'Por Tonelada' /*campo novo*/\n        When Oft.Tipo_Recebimento = 17 Then\n        Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por w/m' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else ' por Tonelada ou w/m' \n              End \n            Else 'por Tonelada ou w/m' \n          End\n  end as Tipo_Recebimento_escrito,\n    case When Oft.Tipo_Pagamento = 1 Then ''/*(Sem cobrança)*/\n        When Oft.Tipo_Pagamento = 2 Then 'por Processo'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 3 Then 'por KG'/*Peso Cubado*/\n        When Oft.Tipo_Pagamento = 4 Then 'por KG'/*Peso Taxado*/\n        When Oft.Tipo_Pagamento = 5 Then 'por KG'/*Peso Bruto*/\n        When Oft.Tipo_Pagamento = 6 Then 'por CBM'/*Metro Cubico*/\n        When Oft.Tipo_Pagamento = 7 Then case Ofr.Modalidade_Processo When 1 then 'por HAWB' When 2 then 'por HBL'  else NULL end\n        When Oft.Tipo_Pagamento = 8 Then 'por Invoice'\n        When Oft.Tipo_Pagamento = 9 Then 'por Volumes'\n        When Oft.Tipo_Pagamento = 10 Then 'por CNTR' /*Equipamento*/\n        When Oft.Tipo_Pagamento = 11 Then 'por ' + Emr.Descricao\n        When Oft.Tipo_Pagamento = 12 Then 'por Teu'\n        When Oft.Tipo_Pagamento = 13 Then 'por Percentual'/*Percentual*/\n        When Oft.Tipo_Pagamento = 14 Then ''/*livre*/\n        When Oft.Tipo_Pagamento = 15 Then '/Via Master'\n        When Oft.Tipo_Pagamento = 16 Then '/Via house'\n        When Oft.Tipo_Recebimento = 23 Then 'Por Tonelada' /*campo novo*/\n        When Oft.Tipo_Pagamento = 17 Then\n          Case Pfc.Tipo_Carga \n            When 1 /*Aereo*/ then 'por KG' \n            When 4 /*LCL*/then \n              Case  \n                When Coalesce(Pfc.Peso_Considerado,0) = Coalesce(Pfc.Metros_Cubicos,0) then 'por CBM' \n                When Coalesce(Pfc.Peso_Considerado,0) &gt; Coalesce(Pfc.Metros_Cubicos,0) then 'por Tonelada' \n                Else 'por Tonelada ou CBM' \n              End \n            Else 'por Tonelada ou CBM' \n          End  end as Tipo_Pagamento_escrito,\n  Oft.Tipo_Pagamento,\n  Oft.Tipo_Recebimento,\n  Oft.Modalidade_Processo,\n  Oft.Tipo_Operacao,\n  Oft.Origem_Taxa,\n  Oft.Categoria,\n  Oft.Data_Validade,\n  Oft.Trecho,\n  Oft.Exibir_Cliente,\n  Oft.Complemento,\n  Oft.Observacao,\n  Tle.Nome As Taxa_Logistica_Exibicao,\n  Tle.Nome_Internacional as Taxa_Internacional,\n  Mpg.Sigla As Moeda_Pagamento,\n  Mrc.Sigla As Moeda_Recebimento,\n  Cpg.Nome As Conta_Pagamento,\n  Ppg.Nome As Pessoa_Pagamento,\n  Prc.Nome As Pessoa_Recebimento,\n  Emr.Descricao as Equipamento_Maritimo,\n  Case\n    When Oft.IdOferta_Frete Is NULL Then 2 /* Proposta */\n    Else 1 /* Oferta */\n  End As Vinculo\nFrom\n  mov_Oferta_Frete Ofr\nJoin\n  mov_Oferta_Frete_Taxa Oft On Oft.IdOferta_Frete = Ofr.IdOferta_Frete /* Taxas da Oferta */\n    Or ((Oft.IdProposta_Frete = Ofr.IdProposta_Frete) /* Taxas da Proposta */\n      And (Oft.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga)\n      And (Oft.IdCompanhia_Transporte = Ofr.IdCompanhia_Transporte Or Oft.IdCompanhia_Transporte Is NULL)\n      And (Oft.Modalidade_Processo = Ofr.Modalidade_Processo)\n      And (Oft.Tipo_Operacao = Ofr.Tipo_Operacao)\n      And ((Oft.Origem_Taxa = 2 /* Origem */ And Oft.IdOrigem_Destino = Ofr.IdOrigem)\n        Or (Oft.Origem_Taxa = 3 /* Destino */ And Oft.IdOrigem_Destino = Ofr.IdDestino)\n        Or (Oft.Origem_Taxa = 1 /* Frete */)))\nJoin\n  cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Oft.IdTaxa_Logistica_Exibicao\nJoin\n  cad_Taxa_Logistica Tlg on Tlg.IdTaxa_Logistica = Tle.IdTaxa_Logistica\nLeft Outer Join\n  cad_Moeda Mpg On Mpg.IdMoeda = Oft.IdMoeda_Pagamento\nLeft Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Oft.IdMoeda_Recebimento\nLeft Outer Join\n  cad_Conta_Corrente Cpg On Cpg.IdConta_Corrente = Oft.IdConta_Pagamento\nLeft Outer Join\n  cad_Pessoa Ppg On Ppg.IdPessoa = Oft.IdPessoa_Pagamento\nLeft Outer Join\n  cad_Pessoa Prc On Prc.IdPessoa = Oft.IdPessoa_Recebimento\nLeft Outer Join\n  cad_Equipamento_Maritimo Emr on Emr.IdEquipamento_Maritimo = Oft.IdEquipamento_Maritimo\nLeft Outer Join\n  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete_Carga = Ofr.IdProposta_Frete_Carga\nWhere\n  Oft.Exibir_Cliente = 1\nand\n  Oft.Escalonar = 0\nAnd\n  Oft.Tipo_Recebimento not in (1)\nand\n  Oft.Origem_Taxa = 2 /*Origem*/\nand\n  Ofr.IdOferta_Frete = :IdOferta_Frete\nOrder By\n  Case Tlg.Tipo\n    When 1 /* frete */ Then 0\n    Else 1\n  End, Oft.Origem_Taxa,  Tle.Nome</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\PROJETO 2019 - EA FOLLOW UP - TEX.Header].html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  FORMAT(Lms.Data_Previsao_Desembarque, 'dd/MM/yyyy') AS Data_Previsao_Desembarque_F,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,\n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n    <style>\n        * { box-sizing: border-box; }\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n        .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n        th { padding: 1px 4px; font-size: 14px; }\n        td { padding: 1px 4px; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .text-center { text-align: center; }\n        .logo-espacamento { padding: 16px 0;}\n        .text-left { text-align: left; }\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-white { color: white; }\n        .negrito { font-weight: bold; }\n        .sem-negrito { font-weight: normal; }\n        .logo-assinatura { padding-right: 4px; border-right: 2px solid #204080; }\n        .td-contato { padding-left: 4px; }\n        .font-size-14 { font-size: 14px; }\n        .font-size-11 { font-size: 11pt; }\n        .margin-bottom-5 { margin-bottom: 5px; }\n        .line-height-3 { line-height: 3px; }\n\n        .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n        .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nFOLLOW-UP <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"> - PROCESSO: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> / <Print Dataset=\"Processo\" FieldName=\"Destino\">\n[Subject.Footer]\n\n[Report.Detail]\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n    </tr>\n  </table>\n</span>\n    <br>\n    \n    <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td rowspan=\"6\" width=\"50%\" class=\"text-center logo-espacamento\">\n                <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\">\n            </td>\n            <td width=\"12%\">&nbsp;</td>\n            <td width=\"38%\">&nbsp;</td>\n        </tr>\n        <tr>\n            <td width=\"12%\" class=\"negrito\">REFERÊNCIA:</td>\n            <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CLIENTE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">DATA:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">REF. CLIENTE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n        </tr>\n        <tr>\n            <td width=\"12%\">&nbsp;</td>\n            <td width=\"40%\">&nbsp;</td>\n        </tr>\n    </table>\n\n    <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td class=\"line-height-3 cor-fundo\" colspan=\"4\">&nbsp;</td>\n        </tr>\n    </table>\n\n    <table class=\"borda_sem_baixo\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td width=\"24%\" class=\"negrito\">EXPORTADOR:</td>\n            <td width=\"26%\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n            <td width=\"20%\" class=\"negrito\">IMPORTADOR:</td>\n            <td width=\"30%\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n        </tr>\n            <td class=\"negrito\">MAWB:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n            <td class=\"negrito\">HAWB:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>       \n        <tr>\n            <td class=\"negrito\">ORIGEM:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n            <td class=\"negrito\">DESTINO:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">LOCAL DE RECEBIMENTO:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Local_Recebimento\"></td>\n            <td class=\"negrito\">DESTINO FINAL:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Destino_Final\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">PREV. DE EMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\"></td>\n            <td class=\"negrito\">PREV. DE DESEMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">DATA DE EMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n            <td class=\"negrito\">DATA DE DESEMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CIA DE TRANSPORTE:</td>\n            <td colspan=\"3\"><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">MODALIDADE DE PAGAMENTO:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n            <td class=\"negrito\">MERCADORIA:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n        </tr>\n    </table>\n    <table class=\"borda_sem_cima\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n          <td class=\"negrito\" width=\"12%\">PESO BRUTO:</td>\n          <td width=\"20%\"><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td>           \n          <td class=\"negrito\" width=\"17%\">QTDE DE VOLUMES:</td>\n          <td width=\"20%\"><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n          <td class=\"negrito\" width=\"9%\">CUBAGEM:</td>\n          <td width=\"21%\"><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n      </tr>\n    </table>\n    <br>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td class=\"cor-fundo-2 borda_sem_direita\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"80%\"><span class=\"negrito\">DESCRIÇÃO</span></td>\n      </tr>\n      <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n      <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      <tr>\n        <td colspan=\"2\" heigth=\"3\"></td>\n      </tr>\n    </table>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n         <td colspan=\"6\"><signature></td>\n      </tr>\n    </table>\n\n    <br>\n    <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td class=\"cor-fundo-2 text-center negrito\" style=\"padding: 15px; font-size: 14px;\">\n                Previsão de chegada no destino final: <Print Dataset=\"Processo\" FieldName=\"Destino\"> no dia: <Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque_F\">.\n            </td>\n        </tr>\n    </table>\n    [Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n  \n\n[Report.Footer]\n</body>\n</html>"
    },
    {
        "caminho": "Scripts\\Relatórios\\TEX\\PROJETO 2019 - EA FOLLOW UP -bkp.html",
        "conteudo": "[Report.Header]\n<DataSet Name=\"Processo\" Sql=\"Select\n  Lhs.IdLogistica_House,\n  Getdate() As Data_Atual,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Abertura_Processo,\n  Lms.Data_Embarque,\n  Lms.Data_Desembarque,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lhs.Conhecimentos,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Cln.Nome as Cliente,\n  Cln.Nome_Fantasia as Cliente_Fantasia,\n  Cln.Correspondencia as Cliente_Correspondencia,\n  Ept.Nome as Exportador,\n  Ept.Nome_Fantasia As Exportador_Fantasia,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Nome as Importador_Fantasia,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Nty.Nome as Notify,\n  Nty.Nome_Fantasia as Notify_Fantasia,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Lrc.Nome As Local_Recebimento,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final, \n  Ctr.Nome as Cia_Transporte,\n  Nvi.Nome as Navio,\n  Lmm.Viagem_Navio,\n  Lam.Numero_Voo,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Agd.Nome /*Exportacao - Agente no destino*/\n    When Lms.Tipo_Operacao = 2 Then Ago.Nome /*Importacao - Agente na origem*/\n  End as Agente,\n  Mer.Nome as Mercadoria,\n  Lhs.Quantidade_Volumes,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado,\n  Lhs.Instrucoes_Cliente,\n  Lhs.Instrucoes_Agente,\n  Rpr.Nome as Representante,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  Case\n    When Lhs.Tipo_Carga = 0 Then 'Não especificado'\n    When Lhs.Tipo_Carga = 1 Then 'Aéreo'\n    When Lhs.Tipo_Carga = 2 Then 'Break-Bulk'\n    When Lhs.Tipo_Carga = 3 Then 'FCL'\n    When Lhs.Tipo_Carga = 4 Then 'LCL'\n    When Lhs.Tipo_Carga = 5 Then 'RO-RO'\n    When Lhs.Tipo_Carga = 6 Then 'Rodoviário'\n  End As Tipo_Carga_Detalhe,\n  case \n    When Lms.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lms.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lms.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lms.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_Master,\n  case \n    When Lhs.Modalidade_Pagamento = 1 Then 'NÃO INFORMADO'\n    When Lhs.Modalidade_Pagamento = 2 Then 'COLLECT'\n    When Lhs.Modalidade_Pagamento = 3 Then 'PREPAID'\n    When Lhs.Modalidade_Pagamento = 4 Then 'PREPAID ABROAD'\n  end as Modalidade_Pagamento_House,\n  case \n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 1 Then 'EXPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 2 Then 'EXPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'EXPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 1 Then 'IMPORTAÇÃO AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 2 Then 'IMPORTAÇÃO MARÍTIMA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'IMPORTAÇÃO TERRESTRE'\n    When Lms.Tipo_Operacao = 1 and Lms.Modalidade_Processo = 3 Then 'NACIONAL AÉREA'\n    When Lms.Tipo_Operacao = 2 and Lms.Modalidade_Processo = 3 Then 'NACIONAL MARÍTIMA (CABOTAGEM)'\n    When Lms.Tipo_Operacao = 3 and Lms.Modalidade_Processo = 3 Then 'NACIONAL TERRESTRE'\n  end as Tipo_Modalidade\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  vis_Representante_Colaborador Rpr on Rpr.IdPessoa = Lhs.IdRepresentante\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nWhere\n  Atv.IdAtividade=:IdAtividade\">\n\n\n<DataSet Name=\"Acompanhamento\" Sql=\"Select\n  Acm.IdAcompanhamento,\n  Acm.Data,\n  Acm.Descricao,\n  Acm.Tipo,\n  Rsp.Nome as Responsavel\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Acompanhamento Acm on Acm.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  cad_Pessoa Rsp on Rsp.IdPessoa = Acm.IdResponsavel\nWhere\n  Atv.IdAtividade = :IdAtividade\nAnd\n  Acm.Tipo = 1\norder by Acm.Data desc \">\n\n\n<DataSet Name=\"Contatos\" Sql=\"Select \n  Pcn.Email\nFrom\n  mov_Atividade Atv\nJoin\n  cad_Modelo_Mensagem Mmn on Mmn.IdModelo_Mensagem = Atv.IdModelo_Mensagem\nJoin\n  mov_Projeto_Atividade_Contato Pac on Pac.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nJoin\n  cad_Pessoa_Contato Pcn on (Pcn.IdPessoa_Contato = Pac.IdPessoa_Contato)\nAnd\n  (NullIf(LTrim(Pcn.Email), '') Is Not Null)\nJoin\n  mov_Projeto_Atividade_Grupo_Envio Pge on Pge.IdProjeto_Atividade_Contato = Pac.IdProjeto_Atividade_Contato\nAnd\n  Pge.IdGrupo_Envio_Mensagem = Mmn.IdGrupo_Envio_Mensagem\nWhere\n  Atv.IdAtividade = :IdAtividade\">\n\n\n<DataSet Name=\"Formatacao\" Sql=\"Declare\n  @IdAtividade IdLongo,\n  @Origem_Modelo TipoFixo\n\nSelect\n  @IdAtividade = :IdAtividade,\n  @Origem_Modelo = 2\n\n/* Origem modelo\n1 - Empresa do processo\n2 - Empresa logada */\n\nSelect\n  Emp.Nome,\n  Emp.Nome as Empresa_Logada,\n  Ems.Campo_Livre1 as Cor_Cabecalho,\n  Ems.Campo_Livre2 as Cor_Fonte_Destaque,\n  Ems.Campo_Livre3 as Cor_Fundo_Destaque,\n  Ems.Campo_Livre4 as Cor_Borda,\n  Ems.Campo_Livre5 as Cor_Fonte_Normal,\n  Ems.Campo_Livre6 as Cor_Fundo_Cinza,  \n  Ems.Campo_Livre7 as Cor_Fundo_RTM,\n  Ems.Campo_Livre8 as Cor_Memo_RTM,\n  Ems.Campo_Livre9,\n  Ems.Campo_Livre10 as Cor_Fundo_2,\n  Ems.Campo_Livre11 as Cor_Fundo_3,\n  Ems.Campo_Livre12 as Logo_Assinatura,\n  Ems.Campo_Livre13 as Link_Logo\nFrom\n(\n  Select Top 1\n    Cast(Valor As Integer) As IdEmpresa_Sistema\n  From\n    #Global_Var\n  Where\n    Variavel = 'IdEmpresa_Sistema'\n) Elg\nCross Apply\n(\n Select\n    Lhs.IdEmpresa_Sistema\n  From\n    mov_Atividade Atv\n  Join\n    mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\n  Where\n    Atv.IdAtividade = @IdAtividade\n) Epr\nJoin\n  vis_Empresa Emp on Emp.IdEmpresa_Sistema =\n    Case @Origem_Modelo\n      When 1 /* Empresa do processo */ Then Epr.IdEmpresa_Sistema\n      When 2 /* Empresa logada */ Then Elg.IdEmpresa_Sistema\n    End\nJoin\n  cad_Pessoa Ems on Ems.IdPessoa = Emp.IdPessoa\">\n\n\n<html>\n<head>\n    <style>\n        * { box-sizing: border-box; }\n        body,td,tr,p{ font-family: Calibri, Verdana, Arial, Helvetica, sans-serif; font-size:10.0pt; }\n        .border-table { border: 1px solid <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-collapse: collapse; }\n        .border-top { border-top: 1px solid #145DBB; border-collapse: collapse; }\n        th { padding: 1px 4px; font-size: 14px; }\n        td { padding: 1px 4px; }\n        .cabecalho { background-color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Cabecalho\">; text-align: right; font-weight: bold; font-size: 20px; padding: 25px 25px;border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .cor-linha { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; line-height: 6px; }\n        .cor-fundo { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_Destaque\">; }\n        .cor-fundo-2 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_2\">; }\n        .cor-fundo-3 { background: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fundo_3\">; }\n        .text-center { text-align: center; }\n        .logo-espacamento { padding: 16px 0;}\n        .text-left { text-align: left; }\n        .cor-fonte { color: #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Fonte_Normal\">; }\n        .cor-fonte-white { color: white; }\n        .negrito { font-weight: bold; }\n        .sem-negrito { font-weight: normal; }\n        .logo-assinatura { padding-right: 4px; border-right: 2px solid #204080; }\n        .td-contato { padding-left: 4px; }\n        .font-size-14 { font-size: 14px; }\n        .font-size-11 { font-size: 11pt; }\n        .margin-bottom-5 { margin-bottom: 5px; }\n        .line-height-3 { line-height: 3px; }\n\n        .borda_linha {border:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\"> #<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 8px 2px 0px 2px;}\n        .borda{ border-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_cima{ border-top-style:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_baixo{ border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita{ border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda_baixo{ border-left:solid; border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_esquerda{ border-left:solid; border-right:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_baixo{ border-right:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_direita_cima{ border-right:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda{ border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_cima{ border-left:solid; border-top:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_esquerda_baixo{ border-left:solid; border-bottom:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_baixo{ border-top:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_cima{ border-bottom:solid; border-right:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_direita{ border-bottom:solid; border-top:solid; border-left:solid; border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n        .borda_sem_esquerda{ border-bottom:solid; border-top:solid; border-right:solid;  border-color:#<Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Cor_Borda\">; border-width: 1px 1px 1px 1px}\n\n    </style>\n</head>\n<body>\n[Address.Detail]\n<SubReport Name=\"Contatos\" Dataset=\"Contatos\">\n\n[CC.Detail]\n\n[Contatos.AfterPrior]\n;  \n[Contatos.Detail]\n<Print Dataset=\"Contatos\" FieldName=\"Email\">\n\n[Subject.Header]\nFOLLOW-UP <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"> - PROCESSO: <Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"> - CLIENTE: <Print Dataset=\"Processo\" FieldName=\"Cliente\"> - <Print Dataset=\"Processo\" FieldName=\"Origem\"> / <Print Dataset=\"Processo\" FieldName=\"Destino\">\n[Subject.Footer]\n\n[Report.Detail]\n<span>\n  <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n    <tr>\n      <td class=\"cabecalho\">FOLLOW UP - <Print Dataset=\"Processo\" FieldName=\"Tipo_modalidade\"></td>\n    </tr>\n  </table>\n</span>\n    <br>\n   \n    <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td rowspan=\"6\" width=\"50%\" class=\"text-center logo-espacamento\">\n                <Print Dataset=\"Formatacao\" Html=\"False\" FieldName=\"Link_Logo\">\n            </td>\n            <td width=\"12%\">&nbsp;</td>\n            <td width=\"38%\">&nbsp;</td>\n        </tr>\n        <tr>\n            <td width=\"12%\" class=\"negrito\">REFERÊNCIA:</td>\n            <td width=\"38%\"><Print Dataset=\"Processo\" FieldName=\"Numero_Processo\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CLIENTE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Cliente\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">DATA:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Atual\" DisplayFormat=\"dd/mm/yyyy\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">REF. CLIENTE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Referencia_Cliente\"></td>\n        </tr>\n        <tr>\n            <td width=\"12%\">&nbsp;</td>\n            <td width=\"40%\">&nbsp;</td>\n        </tr>\n    </table>\n\n    <table class=\"borda\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td class=\"line-height-3 cor-fundo\" colspan=\"4\">&nbsp;</td>\n        </tr>\n    </table>\n\n    <table class=\"borda_sem_baixo\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n        <tr>\n            <td width=\"24%\" class=\"negrito\">EXPORTADOR:</td>\n            <td width=\"26%\"><Print Dataset=\"Processo\" FieldName=\"Exportador\"></td>\n            <td width=\"20%\" class=\"negrito\">IMPORTADOR:</td>\n            <td width=\"30%\"><Print Dataset=\"Processo\" FieldName=\"Importador\"></td>\n        </tr>\n            <td class=\"negrito\">MAWB:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Conhecimento_Master\"></td>\n            <td class=\"negrito\">HAWB:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Conhecimentos\"></td>       \n        <tr>\n            <td class=\"negrito\">ORIGEM:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Origem\"></td>\n            <td class=\"negrito\">DESTINO:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Destino\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">LOCAL DE RECEBIMENTO:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Local_Recebimento\"></td>\n            <td class=\"negrito\">DESTINO FINAL:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Destino_Final\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">PREV. DE EMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Embarque\"></td>\n            <td class=\"negrito\">PREV. DE DESEMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Previsao_Desembarque\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">DATA DE EMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Embarque\"></td>\n            <td class=\"negrito\">DATA DE DESEMBARQUE:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Data_Desembarque\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">CIA DE TRANSPORTE:</td>\n            <td colspan=\"3\"><Print Dataset=\"Processo\" FieldName=\"Cia_Transporte\"></td>\n        </tr>\n        <tr>\n            <td class=\"negrito\">MODALIDADE DE PAGAMENTO:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Modalidade_Pagamento_House\"></td>\n            <td class=\"negrito\">MERCADORIA:</td>\n            <td><Print Dataset=\"Processo\" FieldName=\"Mercadoria\"></td>\n        </tr>\n    </table>\n    <table class=\"borda_sem_cima\" width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n          <td class=\"negrito\" width=\"12%\">PESO BRUTO:</td>\n          <td width=\"20%\"><Print Dataset=\"Processo\" FieldName=\"Peso_Bruto\" DisplayFormat=\",0.00 Kgs\"></td>           \n          <td class=\"negrito\" width=\"17%\">QTDE DE VOLUMES:</td>\n          <td width=\"20%\"><Print Dataset=\"Processo\" FieldName=\"Quantidade_Volumes\" DisplayFormat=\",0.00\"></td>\n          <td class=\"negrito\" width=\"9%\">CUBAGEM:</td>\n          <td width=\"21%\"><Print Dataset=\"Processo\" FieldName=\"Metros_Cubicos\" DisplayFormat=\",0.00 m³\"></td>\n      </tr>\n    </table>\n    <br>\n\n    <table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n      <tr>\n        <td class=\"cor-fundo-2 borda_sem_direita\" width=\"20%\"><span class=\"negrito\">DATA</span></td>\n        <td class=\"cor-fundo-2 borda_sem_esquerda\" width=\"80%\"><span class=\"negrito\">DESCRIÇÃO</span></td>\n      </tr>\n      <SubReport Name=\"Follow_Destaque\" Dataset=\"Acompanhamento\" RecordCount=\"1\">  \n      <SubReport Name=\"Follow_Outros\" Dataset=\"Acompanhamento\" StartRecord=\"2\">\n      <tr>\n        <td colspan=\"6\" heigth=\"3\"></td>\n      </tr>\n    </table>\n\n<table width=\"775\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr>\n     <td colspan=\"6\"><signature></td>\n  </tr>\n</table>\n\n[Follow_Destaque.Detail]\n  <tr>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></span></td>\n    <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><span class=\"negrito\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></span></td>\n  </tr>\n\n[Follow_Outros.Detail] \n <tr>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"20%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Data\" DisplayFormat=\"dd/mm/yyyy hh:nn\"></td>\n   <td class=\"borda_baixo\" valign=\"top\" width=\"80%\"><Print Dataset=\"Acompanhamento\" FieldName=\"Descricao\"></td>\n </tr>\n  \n\n[Report.Footer]\n</body>\n</html>\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\#44906.sql",
        "conteudo": "SELECT\nTx1.IdLogistica_House,\n  Tx1.Pessoa_Fatura AS Pessoa_BL,\n  Tx1.Moeda AS Moeda_BL,\n  Tx1.Taxa_Internacional AS Taxa_Internacional_BL,\n  Tx1.Fator AS Fator_BL,\n  Tx2.Moeda AS Moeda_EX,\n  Tx2.Taxa_Internacional AS Taxa_Internacional_EX,\n  Tx2.Fator AS Fator_EX,\n  Tx1.Email,\n  Tx1.numero_processo\nFROM\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master \n  Left outer join\n  cad_pessoa Eml ON Eml.IdPessoa = Lhs.IdCliente\nLeft Outer Join (\nSELECT\n  Ltx.IdLogistica_House,\n  Pes.Nome as Pessoa_Fatura,\n  Mrc.Sigla AS Moeda,\n  Tle.Nome_Internacional AS Taxa_Internacional,\n  Cast(Case\n    When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n    Else 0\n  End As Float) As Fator,\n  Tle.IdTaxa_Logistica_Exibicao,\n  Pes.email,\n  Lhs.numero_Processo\nFROM\n  mov_Logistica_Taxa Ltx\n  Left Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\nLeft Outer Join \n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n    And ((Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n    Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem))\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n  left outer join\n  cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\nWhere\n  Lft.IdPessoa = Lms.IdCompanhia_Transporte \nAND\n  Tle.IdTaxa_Logistica_Exibicao IN (6)\n)Tx1 on Tx1.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join (\nSELECT\n  Ltx.IdLogistica_House,\n  Pes.Nome as Pessoa_Fatura,\n  Mrc.Sigla AS Moeda,\n  Tle.Nome_Internacional AS Taxa_Internacional,\n  Cast(Case\n    When Ltx.IdMoeda_Pagamento = Lft.IdMoeda Then 1\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino) Then Lfc.Fator_Conversao\n    When (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem) Then Round(1 / Lfc.Fator_Conversao, 6)\n    Else 0\n  End As Float) As Fator,\n  Tle.IdTaxa_Logistica_Exibicao\nFROM\n  mov_Logistica_Taxa Ltx\n  Left Outer Join\n  cad_Moeda Mrc On Mrc.IdMoeda = Ltx.IdMoeda_Pagamento\nLeft Outer Join\n  vis_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\nLeft Outer Join \n  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Ltx.IdLogistica_House\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Fatura_Conversao Lfc On (Lfc.IdLogistica_Fatura = Lft.IdRegistro_Financeiro)\n    And ((Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Origem) And (Lft.IdMoeda = Lfc.IdMoeda_Destino)\n    Or (Ltx.IdMoeda_Pagamento = Lfc.IdMoeda_Destino) And (Lft.IdMoeda = Lfc.IdMoeda_Origem))\nLeft Outer Join\n  cad_Taxa_Logistica_Exibicao Tle on Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\n  left outer join\n  cad_pessoa Pes ON Pes.IdPessoa = Lft.IdPessoa\nWHERE\n  Lft.IdPessoa = Lms.IdCompanhia_Transporte \nAND\n  Tle.IdTaxa_Logistica_Exibicao IN (85)\n)Tx2 on Tx2.IdLogistica_House = Lhs.IdLogistica_House\nWHERE\n  Atv.IdAtividade = 2756002\n  \n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Ajustar link Imgur.txt",
        "conteudo": "/*ASSINATURA DE EMAIL*/\nUPDATE cad_Conta_Email \nSET \n\tAssinatura=REPLACE(CAST(Assinatura as VARCHAR(MAX)), 'https://imgur.com/', 'https://i.imgur.com/') \nWHERE\n\tAssinatura LIKE '%https://imgur.com/%'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Aplicar módulo para todos os usuários.txt",
        "conteudo": "DECLARE\n\t@IdModulo INT\n\n/*INFORMAR O IdModulo*/\n--SELECT * FROM sys_Modulo\nSET @IdModulo =  /*HeadCARGO Web - Standard*/\n\nIF @IdModulo BETWEEN 1 AND 48\nBEGIN\n\tDELETE FROM sys_Modulo_Usuario\n\tWHERE\n\t\tIdModulo = @IdModulo\n\n\tINSERT INTO sys_Modulo_Usuario (\n    IdModulo,\n    IdUsuario\n  )\n\tSELECT\n\t\t@IdModulo AS IdModulo,\n\t\tUsr.IdUsuario AS IdUsuario\n\tFROM\n\t\tsys_Usuario Usr\n\tLEFT OUTER JOIN\n\t\tsys_Modulo_Usuario Mdl ON Mdl.IdUsuario = Usr.IdUsuario AND Mdl.IdModulo = @IdModulo\n\tWHERE\n\t\tUsr.Ativo = 1\n\n\tprint 'Módulo aplicado: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEND\n\tELSE print 'Módulo não encontrado'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Aplicar papel a todos os usuários ativos.sql",
        "conteudo": "DECLARE\n\t@Nome_Papel VARCHAR(50),\n\t@IdPapel_Aplicar INT,\n\t@Max INT\n\n/*INFORMAR O NOME DO PAPEL*/\nSET @Nome_Papel = ''\n\nSET @IdPapel_Aplicar = (SELECT IdPapel FROM sys_Papel WHERE NOME LIKE @Nome_Papel)\nSet @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\nIF @IdPapel_Aplicar IS NOT NULL\nBEGIN\n\t/*REALIZA O INSERT DE TODOS OS MEMBROS AO PAPEL*/\n\tINSERT INTO sys_Papel_Membro (\n\t    IdPapel_Membro,\n\t    IdPapel_Superior,\n\t    IdUsuario,\n\t    IdPapel\n\t  )\n\tSELECT\n\t\tRank() Over (Order By Usr.IdUsuario) + @Max AS IdPapel_Membro,\n\t\t@IdPapel_Aplicar AS IdPapel_Superior,\n\t\tUsr.IdUsuario AS IdUsuario,\n\t\tNULL AS IdPapel\n\tFROM\n\t\tsys_Usuario Usr\n\tLEFT OUTER JOIN\n\t\tsys_Papel_Membro Ppm ON Ppm.IdUsuario = Usr.IdUsuario AND Ppm.IdPapel_Superior = @IdPapel_Aplicar\n\tWHERE\n\t\tUsr.Ativo = 1\n\t\tAND\n\t\tPpm.IdUsuario IS NULL\n\t\tAND\n\t\t(Usr.Nome NOT LIKE '%.headsoft%'\n\t\tAND Usr.Nome NOT LIKE 'dbo'\n\t\tAND Usr.Nome NOT LIKE '%tracking%')\n\n\t\tprint 'Papéis aplicados: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEND\n\tprint 'Papel não encontrado'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Attach arquivos modelo mensagem.txt",
        "conteudo": "[Attach]\n<DataSet Name=\"Attach\" Sql=\"Select\n  Arq.Nome,\n  Arq.IdDados_Arquivo\nFrom\n  mov_Atividade Atv\nLEFT OUTER Join\n  arq_Arquivo Arq on Arq.IdArquivo = 183974 /* Informações sobre seguro */\nWhere\n  Atv.IdAtividade = :IdAtividade\nOrder By\n  Arq.Data_Criacao Desc\">\n[Attach.Detail]\n<SubReport Name=\"Comprovantes\" Dataset=\"Attach\" Binary=\"True\">\n\n[Comprovantes.Name]\n<Print DataSet=\"Attach\" FieldName=\"Nome\">\n\n[Comprovantes.FileData.Id]\n<Print DataSet=\"Attach\" FieldName=\"IdDados_Arquivo\">\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Attach de arquivos com FileStream.txt",
        "conteudo": "CREATE DATABASE HeadCargo_Teste \nON PRIMARY \n(NAME = HeadCARGO_Sis, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\HeadCARGO_Sis.mdf'),\n(NAME = HeadCARGO_Arq, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\HeadCARGO_Arq.ndf'),\n(NAME = HeadCARGO_Aux, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\HeadCARGO_Aux.ndf'),\n(NAME = HeadCARGO_Cad, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\HeadCARGO_Cad.ndf'),\n(NAME = HeadCARGO_Mov, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\HeadCARGO_Mov.ndf'),\n\nFILEGROUP ARQ CONTAINS FILESTREAM( NAME = ARQ, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\Arquivos')\n\nLOG ON (NAME = HeadCARGO_Log, FILENAME = 'D:\\TI\\HEADSOFT\\Bases de Arquivos anteriores\\AA_20200216_DB\\DB\\HeadCARGO_Log.ldf')\n\nFOR ATTACH\n\nGO"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Base para obter Campo livre e valor padrão.sql",
        "conteudo": "LEFT OUTER JOIN\n(\n    SELECT\n    Lhs.IdLogistica_House\n\t, Ccl.Identificador\n\t, Ccl.Exibicao_Padrao\n\t, Ccl.Itens\n\t, Lpr.IdCampo_Livre\n\t, Lpr.Valor_Alfanumerico\n\t, Lpr.Valor_Texto\n\t, Lpr.Valor_Boleano\n\t, Lpr.Valor_Tipo_Fixo\n\t, Lpr.Valor_Inteiro\n\t, Lpr.Valor_Data\n\t, Lpr.Valor_Real4\n  FROM\n    mov_Logistica_House Lhs\n  CROSS JOIN\n    cad_Configuracao_Campo_Livre Ccl\n  LEFT OUTER JOIN\n    vis_Logistica_Prazo Lpr \n\t  ON Lpr.IdLogistica_House = Lhs.IdLogistica_House\n\t  AND Lpr.Identificador = Ccl.Identificador\n) Lp1 ON Lp1.IdLogistica_House = Lhs.IdLogistica_House AND Lp1.Identificador = 'Inserir_identificador_aqui'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Bls Configurações.txt",
        "conteudo": "operacional > processo > blls > cargo > ncm - description\n\nrelatorio\n- relacionado a bl-, arrumar o select em fonte de dados para contrar o campo\n- usar campo memo\n- habilitar streach\n- retirar auto display"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Cancelar faturas.txt",
        "conteudo": "Declare\n  @Data DateTime,\n  @IdFuncionario Integer\n\n \n\nSet @Data = '01/01/2015'\nSet @IdFuncionario = 1\n\n \n\nUpdate mov_Fatura_Financeira\nSet\n  Situacao = 6, /* Cancelada */\n  Data_Cancelamento = GetDate(),\n  IdResponsavel_Cancelamento = @IdFuncionario\nWhere\n  Situacao = 1 /* Em aberto */\nAnd\n  Data <= @Data"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Comanda Anexar.txt",
        "conteudo": "Select\n@Show = Cast(Case\n  When (Lms.Modalidade_Processo = 1 /* Aereo */) And (Lft.Tipo_Fatura = 2 /*Recebimento*/) Or (Lft.Tipo_Fatura = 3 /*Agente*/) or (Lhs.Desembaraco_Aduaneiro =1 )  Then 1\n  Else 0\n  End as Bit),\n @Arquivo_Exportar =  'REC – '+ Replace(Lhs.Numero_Processo, '/', ''),\n @Classe_Exportar = 'TProjetoAtividadeArquivo',\n @Fields_Exportar = '<Fields><Item Name=\"IdProjeto_Atividade\" Value=\"' + Cast(Lhs.IdProjeto_Atividade as VarChar(Max)) + '\"/><Item Name=\"IdArquivo_Grupo\" Value=\"2\"/></Fields>',\n @Tipo_Bloqueio = CAST(Case\n  When Lft.Situacao = 2 then 1\n  Else 5  End as INT),\n @Mensagem_Bloqueio = 'Não permitido imprimir recibo de fatura em aberto!'\nFrom\n vis_Logistica_Fatura Lft\nLeft Outer Join\n mov_Fatura_Financeira Ffn on Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\nLeft Outer Join\n mov_Logistica_House Lhs on Lhs.IdLogistica_House = Lft.IdLogistica_House\nJoin\n mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nWhere\n Lft.IdRegistro_Financeiro = @Parameters.value('(/Parameters/Item[@Name=\"IdRegistro_Financeiro\"])[1]', 'int')"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Consulta Fatura Seguro - AGL.txt",
        "conteudo": "SELECT TOP(10)\n  Cli.Nome AS Cliente,\n  Lhs.Numero_Processo AS Referencia,\n  CASE\n    WHEN Lhs.Seguro = 0 THEN 'NAO'\n\tWHEN Lhs.Seguro = 1 THEN 'SIM'\n  END AS Seguro,\n  Tle.Nome AS Taxa,\n  Ltx.Valor_Pagamento_Total AS Valor_Compra,\n  Ltx.Valor_Recebimento_Total AS Valor_Venda,\n  Lhs.Valor_Mercadoria,\n  Lhs.Importancia_Segurada,\n  Lhs.Percentual_Seguro\nFROM\n  mov_Logistica_House Lhs\nLEFT OUTER JOIN \n  mov_Logistica_Taxa Ltx ON Ltx.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  vis_Logistica_Fatura Lft ON Lft.IdLogistica_House = Lhs.IdLogistica_house\n\n/*CADASTROS*/\nLEFT OUTER JOIN\n  cad_Pessoa Cli ON Cli.IdPessoa = Lhs.IdCliente\nLEFT OUTER JOIN\n  cad_Taxa_Logistica_Exibicao Tle ON Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao\nWHERE\n  Tle.IdTaxa_Logistica_Exibicao IN (35, 444) /*SEGURO DE CARGA, SEGURO (0,07 COM DDR)*/\n\n\n  SELECT\n  *\n  FROM\n  cad_Taxa_Logistica_Exibicao\n  WHERE\n  Nome Like '%SEGURO%'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\consultar tabelas modificadas.sql",
        "conteudo": "DECLARE @Tabela    VARCHAR(MAX) = 'mov_Proposta_Frete'\nDECLARE @PK1_Nome  VARCHAR(200) = 'IdProposta_Frete'\nDECLARE @PK1_Valor VARCHAR(MAX) = '27111'\n\n-- Opcionais, use apenas quando precisar se não, deixe-os em branco!\n\nDECLARE @PK2_Nome  VARCHAR(200) = ''\nDECLARE @PK2_Valor VARCHAR(MAX) = ''\nDECLARE @PK3_Nome  VARCHAR(200) = ''\nDECLARE @PK3_Valor VARCHAR(MAX) = ''\n\nDECLARE @Data_Inicio_Texto  VARCHAR(20) = '01/10/2025' -- dd/MM/yyyy\nDECLARE @Usar_Hoje_Termino  BIT         = 1            -- 1 = usar GETDATE(); 0 = usar @Data_Termino_Texto\nDECLARE @Data_Termino_Texto VARCHAR(20) = ''           -- dd/MM/yyyy (use se @Usar_Hoje_Termino = 0)\n\n-- ?? OUTROS FILTROS\n\nDECLARE @IdUsuario IdCurto  = 0  -- 0 = Todos\nDECLARE @Tipo      TipoFixo = 0  -- 0 = Todos | 1=Inserção | 2=Exclusão | 3=Alteração\n\n\n\n\n/* -----------------------------------\n   ?? Variáveis internas\n----------------------------------- */\nDECLARE\n  @Primary_Keys  XML,\n  @Data_Inicio   DATETIME,\n  @Data_Termino  DATETIME,\n  @SQL           NVARCHAR(MAX),\n  @Filtro_Tabela VARCHAR(MAX),\n  @Filtro_Campo  VARCHAR(MAX),\n  @Filtro_Tipo   VARCHAR(MAX),\n  @IdExprList    NVARCHAR(MAX),\n  @IdExprCount   INT,\n  @ExprId        NVARCHAR(MAX),\n  @OrderBy       NVARCHAR(MAX)\n\n-- Normaliza entradas\nSET @PK1_Nome  = NULLIF(LTRIM(RTRIM(@PK1_Nome)) , '')\nSET @PK1_Valor = NULLIF(LTRIM(RTRIM(@PK1_Valor)), '')\nSET @PK2_Nome  = NULLIF(LTRIM(RTRIM(@PK2_Nome)) , '')\nSET @PK2_Valor = NULLIF(LTRIM(RTRIM(@PK2_Valor)), '')\nSET @PK3_Nome  = NULLIF(LTRIM(RTRIM(@PK3_Nome)) , '')\nSET @PK3_Valor = NULLIF(LTRIM(RTRIM(@PK3_Valor)), '')\n\nSET @Data_Inicio_Texto  = NULLIF(LTRIM(RTRIM(@Data_Inicio_Texto)) , '')\nSET @Data_Termino_Texto = NULLIF(LTRIM(RTRIM(@Data_Termino_Texto)), '')\nSET @Tabela             = NULLIF(LTRIM(RTRIM(@Tabela))            , '')\n\n-- Monta a lista de PKs\nDECLARE @PK_Input TABLE (Nome VARCHAR(200), Valor VARCHAR(MAX))\nIF @PK1_Nome IS NOT NULL AND @PK1_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK1_Nome, @PK1_Valor)\nIF @PK2_Nome IS NOT NULL AND @PK2_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK2_Nome, @PK2_Valor)\nIF @PK3_Nome IS NOT NULL AND @PK3_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK3_Nome, @PK3_Valor)\n\n-- Constrói o XML <PrimaryKeys>\nSET @Primary_Keys = (\n  SELECT Nome AS [@Nome], Valor AS [@Value]\n  FROM @PK_Input\n  FOR XML PATH('Item'), ROOT('PrimaryKeys'), TYPE\n)\n\n-- Converte Data_Inicio\nSET @Data_Inicio =\n  COALESCE(\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 103),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 120),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto)\n  )\n\n-- Define Data_Termino (fim do dia quando informar texto)\nIF @Usar_Hoje_Termino = 1\n  SET @Data_Termino = GETDATE()\nELSE\n  SET @Data_Termino =\n    DATEADD(SECOND, 86399,\n      COALESCE(\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 103),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 120),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto)\n      )\n    )\n\n-- ?? Agrupar múltiplos valores por campo\nDECLARE @FiltroXml TABLE (Nome VARCHAR(MAX), VALUE VARCHAR(MAX))\nINSERT INTO @FiltroXml\nSELECT\n  Pks.value('@Nome',  'VARCHAR(MAX)') AS Nome,\n  Pks.value('@Value', 'VARCHAR(MAX)') AS Value\nFROM\n  @Primary_Keys.nodes('/PrimaryKeys/Item') AS PrimaryKeys(Pks)\n\n-- ?? Filtros dinâmicos\nSET @Filtro_Tabela = ''\nIF @Tabela IS NOT NULL\n  SET @Filtro_Tabela = '[@Nome=\"'+@Tabela+'\"]'\n\nSET @Filtro_Campo = ''\nSELECT @Filtro_Campo = @Filtro_Campo +\n  '[Campo[@Nome=\"'+Nome+'\" and (' +\n  STRING_AGG('@Value=\"'+VALUE+'\"', ' or ') +\n  ')]]'\nFROM @FiltroXml\nGROUP BY Nome\n\nSET @Filtro_Tipo = ''\nIF @Tipo <> 0\n  SET @Filtro_Tipo = '[@Tipo=\"'+CAST(@Tipo AS VARCHAR(MAX))+'\"]'\n\n/* ?? Expressão de Id segura (numérica) */\nSET @IdExprList  = ''\nSET @IdExprCount = 0\n\nIF @PK1_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK2_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK3_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @IdExprCount = 0\n  SET @ExprId = 'NULL'\nELSE IF @IdExprCount = 1\n  SET @ExprId = @IdExprList\nELSE\n  SET @ExprId = 'COALESCE(' + @IdExprList + ')'\n\n-- ORDER BY dinâmico (se não houver PK, ordena só pela data)\nIF @IdExprCount = 0\n  SET @OrderBy = 'ORDER BY Ltb.Data_Inicio'\nELSE\n  SET @OrderBy = 'ORDER BY ' + @ExprId + ', Ltb.Data_Inicio'\n\n-- ?? Consulta dinâmica\nSET @SQL = '\nSELECT\n    Usr.Nome AS Usuario,\n    CONVERT(VARCHAR(10), Ltb.Data_Inicio , 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Inicio , 108) AS Data_Inicio_Transacao,\n    CONVERT(VARCHAR(10), Ltb.Data_Termino, 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Termino, 108) AS Data_Termino_Transacao,\n    DATEDIFF(SECOND, Ltb.Data_Inicio, Ltb.Data_Termino) AS Tempo_Transacao,\n    Dlg.value(''../@WindowsUser'',  ''VARCHAR(MAX)'') AS Usuario_Windows,\n    Dlg.value(''../@ComputerName'', ''VARCHAR(MAX)'') AS Computador,\n    Dlg.value(''@Nome'',           ''VARCHAR(MAX)'')  AS Tabela,\n    ' + @ExprId + ' AS Id,\n    CASE Dlg.value(''@Tipo'', ''SMALLINT'')\n         WHEN 1 THEN ''INSERÇÃO''\n         WHEN 2 THEN ''EXCLUSÃO''\n         WHEN 3 THEN ''ALTERAÇÃO''\n         ELSE CAST(Dlg.value(''@Tipo'', ''SMALLINT'') AS VARCHAR(10))\n    END AS Tipo,\n    CONVERT(VARCHAR(10), CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 103)\n      + '' '' +\n    CONVERT(VARCHAR(8),  CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 108) AS Data,\n    Dlg.query(''<Campos>{Campo}</Campos>'') AS Campos\nFROM\n    sys_Log_Tabela Ltb\nCROSS APPLY\n    Ltb.Dados_Log.nodes(''/Log/Tabela' + @Filtro_Tabela + @Filtro_Tipo + @Filtro_Campo + ''') AS DadosLog(Dlg)\nJOIN\n    sys_Usuario Usr ON Usr.IdUsuario = Ltb.IdUsuario\nWHERE\n    ((@IdUsuario = 0) OR (Ltb.IdUsuario = @IdUsuario))\n    AND (\n        ((@Data_Inicio IS NULL) AND (@Data_Termino IS NULL)) OR\n        (Ltb.Data_Inicio  BETWEEN @Data_Inicio AND @Data_Termino) OR\n        (Ltb.Data_Termino BETWEEN @Data_Inicio AND @Data_Termino)\n    )\n' + @OrderBy + '\n'\n\n-- ?? Execução\nEXEC sp_executesql \n  @SQL, \n  N'@Data_Inicio DATETIME, @Data_Termino DATETIME, @IdUsuario IdCurto',\n  @Data_Inicio  = @Data_Inicio,\n  @Data_Termino = @Data_Termino,\n  @IdUsuario    = @IdUsuario\n "
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Copiar Usuário - Criação novo.txt",
        "conteudo": "<Dados_Registro><CommandText>\nSELECT\n  @Acao = CASE\n    WHEN Bloqueado = 1 THEN 5 /* aviso */\n    ELSE 0\n  END,\n  @Mensagem = CAST(CASE\n    WHEN Bloqueado = 1 THEN 'Apenas o financeiro pode executar essa ação!.'\n    ELSE NULL\n  END AS VARCHAR(MAX))\nFROM\n  (\n  SELECT\n    CAST(CASE\n        WHEN (Lft.Tipo_Fatura = 1) AND (Rfn.IdPessoa = Lms.IdCompanhia_Transporte) THEN 1\n        ELSE 0\n    END AS BIT) as Bloqueado\n  FROM\n    (\n    SELECT\n        Prm.value('Item[@Nome=\"IdRegistro_Financeiro\"][1]/@Value', 'int') as IdRegistro_Financeiro\n    FROM\n      @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)\n  ) Prm\n    LEFT OUTER JOIN\n      mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Prm.IdRegistro_Financeiro\n    LEFT OUTER JOIN\n      mov_Logistica_Fatura Lft On Lft.IdRegistro_Financeiro = Rfn.IdRegistro_Financeiro\n    LEFT OUTER JOIN\n      mov_Logistica_House Lhs On Lhs.IdLogistica_House = Lft.IdLogistica_House\n    LEFT OUTER JOIN\n      mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n  ) Blq\n</CommandText></Dados_Registro>"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Copiar Usuário - Perfil Existente ( ATUALIZADO FLAUVI ).sql",
        "conteudo": "--Begin Tran Teste\nSET NOCOUNT ON\nDeclare\n  @Usuario_Origem NomeCurto,\n  @Usuario_Destino NomeCurto,\n  @Copiar_Consultas Boleano,\n  @Copiar_Modulos Boleano,\n  @Copiar_Papeis Boleano,\n  @Copiar_Persistencias Boleano\n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */\nSet @Usuario_Origem = ''\nSet @Usuario_Destino = ''\nSet @Copiar_Consultas = 1\nSet @Copiar_Modulos = 1\nSet @Copiar_Papeis = 1\nSet @Copiar_Persistencias = 0\n/* FINAL */\nDeclare\n  @IdUsuario_Origem IdCurto,\n  @IdUsuario_Destino IdCurto,\n  @Max IdLongo\n\n \n\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)\nIf @IdUsuario_Origem Is Null\nBegin\n  Print 'Usuário origem não encontrado para a cópia.'\n  Return\nEnd\n\n \n\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)\nIf @IdUsuario_Destino Is Null\nBegin\n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)\n  Begin\n    Print 'É necessário especificar um nome de usuário destino para a cópia.'\n    Return\n  End\n\n \n\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1\n  Insert Into sys_Usuario (\n    IdUsuario,\n    Nome,\n    Senha,\n    Data_Criacao,\n    Ativo,\n    Alterar_Senha,\n    Bloqueado\n  )\n  Values (\n    @IdUsuario_Destino,\n    @Usuario_Destino,\n    LOWER(CONVERT(VARCHAR(32), HashBytes('MD5', (LOWER(SUBSTRING(@Usuario_Destino, 1,1)+SUBSTRING(@Usuario_Destino, (CASE WHEN CHARINDEX('.', @Usuario_Destino) != 0 THEN CHARINDEX('.', @Usuario_Destino)+1 WHEN CHARINDEX(' ', @Usuario_Destino) != 0 THEN CHARINDEX(' ', @Usuario_Destino)+1 ELSE -1 END) , 1)+CAST(YEAR(GETDATE()) as VARCHAR(10))))), 2)),\n    GetDate(),\n    1, 0, 0\n  )\n\n \n\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n\n \n\n  print 'Usuário criado.'\nEnd\n\n \n\nIf @Copiar_Consultas = 1\nBegin\n  Delete From sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Consulta_Usuario (\n    IdConsulta,\n    IdUsuario,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  )\n  Select\n    IdConsulta,\n    @IdUsuario_Destino,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  From\n    sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n\n \n\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nIf @Copiar_Modulos = 1\nBegin\n  Delete From sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Modulo_Usuario (\n    IdModulo,\n    IdUsuario\n  )\n  Select\n    IdModulo,\n    @IdUsuario_Destino as IdUsuario\n  From\n    sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nIf @Copiar_Papeis = 1\nBegin\n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\n \n\n  Delete From sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Papel_Membro (\n    IdPapel_Membro,\n    IdPapel_Superior,\n    IdUsuario,\n    IdPapel\n  )\n  Select\n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,\n    IdPapel_Superior,\n    @IdUsuario_Destino as IdUsuario,\n    IdPapel\n  From\n    sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n \n\n  If @@ROWCOUNT > 0\n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'\nEnd\n\n \n\nIf @Copiar_Persistencias = 1\nBegin\n  Update Dst Set\n    Dados = Src.Dados\n  From\n    sys_Persistencia Src\n  Join\n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia\n  and\n    Dst.IdUsuario = @IdUsuario_Destino\n  Where  \n    Src.IdUsuario = @IdUsuario_Origem\n\n \n\n  if @@ROWCOUNT > 0\n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n \n\n  Insert Into sys_Persistencia (\n    IdPersistencia,\n    IdUsuario,\n    Dados\n  )\n  Select\n    IdPersistencia,\n    @IdUsuario_Destino as IdUsuario,\n    Dados\n  From\n    sys_Persistencia\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  If @@ROWCOUNT > 0\n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nSET NOCOUNT OFF\n\n \n\n--Rollback Tran Teste"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Copiar Usuário - Perfil Existente ( SENHA AUTOMATICA ).txt",
        "conteudo": "--Begin Tran Teste\nSET NOCOUNT ON\nDeclare\n  @Usuario_Origem NomeCurto,\n  @Usuario_Destino NomeCurto,\n  @Copiar_Consultas Boleano,\n  @Copiar_Modulos Boleano,\n  @Copiar_Papeis Boleano,\n  @Copiar_Persistencias Boleano\n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */\nSet @Usuario_Origem = ''\nSet @Usuario_Destino = ''\nSet @Copiar_Consultas = 1\nSet @Copiar_Modulos = 1\nSet @Copiar_Papeis = 1\nSet @Copiar_Persistencias = 0\n/* FINAL */\nDeclare\n  @IdUsuario_Origem IdCurto,\n  @IdUsuario_Destino IdCurto,\n  @Max IdCurto\n\n \n\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)\nIf @IdUsuario_Origem Is Null\nBegin\n  Print 'Usuário origem não encontrado para a cópia.'\n  Return\nEnd\n\n \n\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)\nIf @IdUsuario_Destino Is Null\nBegin\n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)\n  Begin\n    Print 'É necessário especificar um nome de usuário destino para a cópia.'\n    Return\n  End\n\n \n\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1\n  Insert Into sys_Usuario (\n    IdUsuario,\n    Nome,\n    Senha,\n    Data_Criacao,\n    Ativo\n  )\n  Values (\n    @IdUsuario_Destino,\n    @Usuario_Destino,\n    LOWER(CONVERT(VARCHAR(32), HashBytes('MD5', (LOWER(SUBSTRING(@Usuario_Destino, 1,1)+SUBSTRING(@Usuario_Destino, (CASE WHEN CHARINDEX('.', @Usuario_Destino) != 0 THEN CHARINDEX('.', @Usuario_Destino)+1 WHEN CHARINDEX(' ', @Usuario_Destino) != 0 THEN CHARINDEX(' ', @Usuario_Destino)+1 ELSE -1 END) , 1)+CAST(YEAR(GETDATE()) as VARCHAR(10))))), 2)),\n    GetDate(),\n    1\n  )\n\n \n\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n\n \n\n  print 'Usuário criado.'\nEnd\n\n \n\nIf @Copiar_Consultas = 1\nBegin\n  Delete From sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Consulta_Usuario (\n    IdConsulta,\n    IdUsuario,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  )\n  Select\n    IdConsulta,\n    @IdUsuario_Destino,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  From\n    sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n\n \n\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nIf @Copiar_Modulos = 1\nBegin\n  Delete From sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Modulo_Usuario (\n    IdModulo,\n    IdUsuario\n  )\n  Select\n    IdModulo,\n    @IdUsuario_Destino as IdUsuario\n  From\n    sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nIf @Copiar_Papeis = 1\nBegin\n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\n \n\n  Delete From sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Papel_Membro (\n    IdPapel_Membro,\n    IdPapel_Superior,\n    IdUsuario,\n    IdPapel\n  )\n  Select\n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,\n    IdPapel_Superior,\n    @IdUsuario_Destino as IdUsuario,\n    IdPapel\n  From\n    sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n \n\n  If @@ROWCOUNT > 0\n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'\nEnd\n\n \n\nIf @Copiar_Persistencias = 1\nBegin\n  Update Dst Set\n    Dados = Src.Dados\n  From\n    sys_Persistencia Src\n  Join\n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia\n  and\n    Dst.IdUsuario = @IdUsuario_Destino\n  Where  \n    Src.IdUsuario = @IdUsuario_Origem\n\n \n\n  if @@ROWCOUNT > 0\n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n \n\n  Insert Into sys_Persistencia (\n    IdPersistencia,\n    IdUsuario,\n    Dados\n  )\n  Select\n    IdPersistencia,\n    @IdUsuario_Destino as IdUsuario,\n    Dados\n  From\n    sys_Persistencia\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  If @@ROWCOUNT > 0\n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nSET NOCOUNT OFF\n\n \n\n--Rollback Tran Teste"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Copiar Usuário - Perfil Existente.txt",
        "conteudo": "--Begin Tran Teste\n\nSET NOCOUNT ON\n\nDeclare\n  @Usuario_Origem NomeCurto,\n  @Usuario_Destino NomeCurto,\n  @Copiar_Consultas Boleano,\n  @Copiar_Modulos Boleano,\n  @Copiar_Papeis Boleano,\n  @Copiar_Persistencias Boleano\n\n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */\n\nSet @Usuario_Origem = ''\nSet @Usuario_Destino = ''\nSet @Copiar_Consultas = 1\nSet @Copiar_Modulos = 1\nSet @Copiar_Papeis = 1\nSet @Copiar_Persistencias = 0\n\n/* FINAL */\n\nDeclare\n  @IdUsuario_Origem IdCurto,\n  @IdUsuario_Destino IdCurto,\n  @Max IdCurto\n\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)\nIf @IdUsuario_Origem Is Null\nBegin\n  Print 'Usuário origem não encontrado para a cópia.'\n  Return\nEnd\n\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)\nIf @IdUsuario_Destino Is Null\nBegin\n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)\n  Begin\n    Print 'É necessário especificar um nome de usuário destino para a cópia.'\n    Return\n  End\n\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1\n  Insert Into sys_Usuario (\n    IdUsuario,\n    Nome,\n    Senha,\n    Data_Criacao,\n    Ativo\n  )\n  Values (\n    @IdUsuario_Destino,\n    @Usuario_Destino,\n    'e8d95a51f3af4a3b134bf6bb680a213a',\n    GetDate(),\n    1\n  )\n\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n\n  print 'Usuário criado.'\nEnd\n\nIf @Copiar_Consultas = 1\nBegin\n  Delete From sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Consulta_Usuario (\n    IdConsulta,\n    IdUsuario,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  )\n  Select\n    IdConsulta,\n    @IdUsuario_Destino,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  From\n    sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\nIf @Copiar_Modulos = 1\nBegin\n  Delete From sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Modulo_Usuario (\n    IdModulo,\n    IdUsuario\n  )\n  Select\n    IdModulo,\n    @IdUsuario_Destino as IdUsuario\n  From\n    sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n\n  print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\nIf @Copiar_Papeis = 1\nBegin\n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\n  Delete From sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Papel_Membro (\n    IdPapel_Membro,\n    IdPapel_Superior,\n    IdUsuario,\n    IdPapel\n  )\n  Select\n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,\n    IdPapel_Superior,\n    @IdUsuario_Destino as IdUsuario,\n    IdPapel\n  From\n    sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n  If @@ROWCOUNT > 0\n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'\nEnd\n\nIf @Copiar_Persistencias = 1\nBegin\n  Update Dst Set\n    Dados = Src.Dados\n  From\n    sys_Persistencia Src\n  Join\n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia\n  and\n    Dst.IdUsuario = @IdUsuario_Destino\n  Where  \n    Src.IdUsuario = @IdUsuario_Origem\n\n  if @@ROWCOUNT > 0\n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n  Insert Into sys_Persistencia (\n    IdPersistencia,\n    IdUsuario,\n    Dados\n  )\n  Select\n    IdPersistencia,\n    @IdUsuario_Destino as IdUsuario,\n    Dados\n  From\n    sys_Persistencia\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n\n  If @@ROWCOUNT > 0\n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\nSET NOCOUNT OFF\n\n--Rollback Tran Teste\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\CORRECOES UNIQUE 3 (1).sql",
        "conteudo": "/* LOGISTICA MOEDA */\nSELECT\n  IdLogistica_House, \n  IdMoeda,\n  COUNT(1) AS Qtde\nFROM\n  mov_Logistica_Moeda Lmd\nGROUP BY\n  IdLogistica_House, \n  IdMoeda\nHAVING\n  COUNT(1) > 1\n\n/* LOGISTICA VIAGEM */\nSELECT\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo\nFROM\n  mov_Logistica_House Lhs\nJOIN\n  (SELECT\n    IdLogistica_House, \n    Sequencia,\n    COUNT(1) AS Qtde\n  FROM\n    mov_Logistica_Viagem\n  GROUP BY\n    IdLogistica_House, \n    Sequencia\n  HAVING\n    COUNT(1) > 1\n  ) Grp ON Grp.IdLogistica_House = Lhs.IdLogistica_House\nORDER BY\n  Lhs.Numero_Processo\n\n/* LOGISTICA CAMPO LIVRE */\nSELECT\n  Lcl.IdLogistica_House,\n  Lcl.IdCampo_Livre,\n  Lhs.Numero_Processo,\n  Ccl.Identificador\nFROM\n  (SELECT\n    IdLogistica_House, \n    IdConfiguracao_Campo_Livre,\n    COUNT(1) AS Qtde\n  FROM\n    vis_Logistica_Campo_Livre\n  GROUP BY\n    IdLogistica_House, \n    IdConfiguracao_Campo_Livre\n  HAVING\n    COUNT(1) > 1\n  ) Grp\nJOIN\n  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Grp.IdLogistica_House\nJOIN\n  cad_Configuracao_Campo_Livre Ccl ON Ccl.IdConfiguracao_Campo_Livre = Grp.IdConfiguracao_Campo_Livre\nJOIN\n  vis_Logistica_Campo_Livre Lcl ON Lcl.IdLogistica_House = Grp.IdLogistica_House\n    AND Lcl.IdConfiguracao_Campo_Livre = Grp.IdConfiguracao_Campo_Livre\nORDER BY\n  Lhs.Numero_Processo,\n  Ccl.Identificador\n\nDECLARE @CamposLivres TABLE(\n  IdCampo_Livre Integer)\nINSERT INTO @CamposLivres\n(IdCampo_Livre)\nSELECT\n  Tst.IdCampo_Livre\nFROM\n  (SELECT\n    Lcl.IdCampo_Livre, \n    ROW_NUMBER() OVER(PARTITION BY Lcl.IdLogistica_House, Lcl.IdConfiguracao_Campo_Livre, Valor_AlfaNumerico, Valor_Boleano, Valor_Tipo_Fixo, Valor_Inteiro, Valor_Data, Valor_Real4 ORDER BY Lcl.IdCampo_Livre) AS Indice \n  FROM\n    vis_Logistica_Campo_Livre Lcl\n  JOIN\n    (SELECT\n      IdLogistica_House, \n      IdConfiguracao_Campo_Livre,\n      COUNT(1) AS Qtde\n    FROM\n      vis_Logistica_Campo_Livre\n    GROUP BY\n      IdLogistica_House, \n      IdConfiguracao_Campo_Livre\n    HAVING\n      COUNT(1) > 1\n    ) Grp ON Grp.IdLogistica_House = Lcl.IdLogistica_House AND Grp.IdConfiguracao_Campo_Livre = Lcl.IdConfiguracao_Campo_Livre\n  ) Tst  \nWHERE\n  Tst.Indice = 2\n\nDELETE FROM mov_Logistica_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @CamposLivres)\n\nDELETE FROM mov_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @CamposLivres)\n\n/* LOGISTICA PRAZO  */\nSELECT\n  Lcl.IdLogistica_House,\n  Lcl.IdCampo_Livre,\n  Lhs.Numero_Processo,\n  Ccl.Identificador\nFROM\n  (SELECT\n    IdLogistica_House, \n    IdConfiguracao_Campo_Livre,\n    COUNT(1) AS Qtde\n  FROM\n    vis_Logistica_Prazo\n  GROUP BY\n    IdLogistica_House, \n    IdConfiguracao_Campo_Livre\n  HAVING\n    COUNT(1) > 1\n  ) Grp\nJOIN\n  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Grp.IdLogistica_House\nJOIN\n  cad_Configuracao_Campo_Livre Ccl ON Ccl.IdConfiguracao_Campo_Livre = Grp.IdConfiguracao_Campo_Livre\nJOIN\n  vis_Logistica_Prazo Lcl ON Lcl.IdLogistica_House = Grp.IdLogistica_House\n    AND Lcl.IdConfiguracao_Campo_Livre = Grp.IdConfiguracao_Campo_Livre\nORDER BY\n  Lhs.Numero_Processo,\n  Ccl.Identificador\n\nDECLARE @Prazos TABLE(\n  IdCampo_Livre Integer)\nINSERT INTO @Prazos\n(IdCampo_Livre)\nSELECT\n  Tst.IdCampo_Livre\nFROM\n  (SELECT\n    Lpr.IdCampo_Livre, \n    ROW_NUMBER() OVER(PARTITION BY Lpr.IdLogistica_House, Lpr.IdConfiguracao_Campo_Livre, Valor_AlfaNumerico, Valor_Boleano, Valor_Tipo_Fixo, Valor_Inteiro, Valor_Data, Valor_Real4 ORDER BY Lpr.IdCampo_Livre) AS Indice \n  FROM\n    vis_Logistica_Prazo Lpr\n  JOIN\n    (SELECT\n      IdLogistica_House, \n      IdConfiguracao_Campo_Livre,\n      COUNT(1) AS Qtde\n    FROM\n      vis_Logistica_Prazo\n    GROUP BY\n      IdLogistica_House, \n      IdConfiguracao_Campo_Livre\n    HAVING\n      COUNT(1) > 1\n    ) Grp ON Grp.IdLogistica_House = Lpr.IdLogistica_House AND Grp.IdConfiguracao_Campo_Livre = Lpr.IdConfiguracao_Campo_Livre\n  ) Tst  \nWHERE\n  Tst.Indice = 2\n\nDELETE FROM mov_Logistica_Prazo\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @Prazos)\n\nDELETE FROM mov_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @Prazos)\n\n/* OFERTA FRETE FECHAMENTO */\nSELECT\n  IdOferta_Frete, \n  IdMoeda,\n  COUNT(1) AS Qtde\nFROM\n  mov_Oferta_Frete_Fechamento\nGROUP BY\n  IdOferta_Frete, \n  IdMoeda\nHAVING\n  COUNT(1) > 1\n\n/* OFERTA FRETE VIAGEM */\nSELECT\n  Ofr.IdOferta_Frete,\n  Ofr.Numero_Oferta\nFROM\n  mov_Oferta_Frete Ofr\nJOIN\n  (SELECT\n    IdOferta_Frete, \n    Sequencia,\n    COUNT(1) AS Qtde\n  FROM\n    mov_Oferta_Frete_Viagem\n  GROUP BY\n    IdOferta_Frete, \n    Sequencia\n  HAVING\n    COUNT(1) > 1\n  ) Grp ON  Grp.IdOferta_Frete = Ofr.IdOferta_Frete\n\n/* OFERTA FRETE CAMPO LIVRE */\nSELECT\n  IdOferta_Frete, \n  IdConfiguracao_Campo_Livre,\n  COUNT(1) AS Qtde\nFROM\n  vis_Oferta_Frete_Campo_Livre\nGROUP BY\n  IdOferta_Frete, \n  IdConfiguracao_Campo_Livre\nHAVING\n  COUNT(1) > 1\n\nDECLARE @CamposLivres TABLE(\n  IdCampo_Livre Integer)\nINSERT INTO @CamposLivres\n(IdCampo_Livre)\nSELECT\n  Tst.IdCampo_Livre\nFROM\n  (SELECT\n    Lcl.IdCampo_Livre, \n    ROW_NUMBER() OVER(PARTITION BY Lcl.IdLogistica_House, Lcl.IdConfiguracao_Campo_Livre, Valor_AlfaNumerico, Valor_Boleano, Valor_Tipo_Fixo, Valor_Inteiro, Valor_Data, Valor_Real4 ORDER BY Lcl.IdCampo_Livre) AS Indice \n  FROM\n    vis_Oferta_Frete_Campo_Livre Lcl\n  JOIN\n    (SELECT\n      IdOferta_Frete, \n      IdConfiguracao_Campo_Livre,\n      COUNT(1) AS Qtde\n    FROM\n      vis_Oferta_Frete_Campo_Livre\n    GROUP BY\n      IdOferta_Frete, \n      IdConfiguracao_Campo_Livre\n    HAVING\n      COUNT(1) > 1\n    ) Grp ON Grp.IdOferta_Frete = Lcl.IdOferta_Frete AND Grp.IdConfiguracao_Campo_Livre = Lcl.IdConfiguracao_Campo_Livre\n  ) Tst  \nWHERE\n  Tst.Indice = 2\n\nDELETE FROM mov_Oferta_Frete_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @CamposLivres)\n\nDELETE FROM mov_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @CamposLivres)\n\n/* PROJETO ATIVIDADE RESPONSAVEL */\nSELECT\n  Pat.Referencia,\n  Ppr.Nome AS Papel_Projeto\nFROM\n  (SELECT\n    IdProjeto_Atividade, \n    IdPapel_Projeto,\n    COUNT(1) AS Qtde\n  FROM\n    mov_Projeto_Atividade_Responsavel\n  GROUP BY\n    IdProjeto_Atividade, \n    IdPapel_Projeto\n  HAVING\n    COUNT(1) > 1\n  ) Grp\nJOIN\n  mov_Projeto_Atividade Pat ON Pat.IdProjeto_Atividade = Grp.IdProjeto_Atividade\nJOIN\n  cad_Papel_Projeto Ppr ON Ppr.IdPapel_Projeto = Grp.IdPapel_Projeto\n\nDELETE FROM mov_Projeto_Atividade_Responsavel\nWHERE\n  IdProjeto_Atividade_Responsavel IN \n  (SELECT\n    IdProjeto_Atividade_Responsavel\n  FROM\n    (SELECT\n      Par.IdProjeto_Atividade_Responsavel,\n      ROW_NUMBER() OVER(PARTITION BY Par.IdProjeto_Atividade, Par.IdPapel_Projeto ORDER BY Par.IdProjeto_Atividade_Responsavel) AS Indice\n    FROM\n      mov_Projeto_Atividade_Responsavel Par\n    JOIN\n      (SELECT\n        IdProjeto_Atividade, \n        IdPapel_Projeto,\n        COUNT(1) AS Qtde\n      FROM\n        mov_Projeto_Atividade_Responsavel\n      GROUP BY\n        IdProjeto_Atividade, \n        IdPapel_Projeto\n      HAVING\n        COUNT(1) > 1\n      ) Grp ON Grp.IdProjeto_Atividade = Par.IdProjeto_Atividade AND Grp.IdPapel_Projeto = Par.IdPapel_Projeto\n    ) Tst\n  WHERE\n    Tst.Indice > 1)\n\n/* PESSOA CAMPO LIVRE */\nSELECT\n  IdPessoa, \n  IdConfiguracao_Campo_Livre,\n  COUNT(1) AS Qtde\nFROM\n  vis_Pessoa_Campo_Livre\nGROUP BY\n  IdPessoa, \n  IdConfiguracao_Campo_Livre\nHAVING\n  COUNT(1) > 1\n\nDECLARE @CamposLivres TABLE(\n  IdCampo_Livre Integer)\nINSERT INTO @CamposLivres\n(IdCampo_Livre)\nSELECT\n  Tst.IdCampo_Livre\nFROM\n  (SELECT\n    Lcl.IdCampo_Livre, \n    ROW_NUMBER() OVER(PARTITION BY Lcl.IdLogistica_House, Lcl.IdConfiguracao_Campo_Livre, Valor_AlfaNumerico, Valor_Boleano, Valor_Tipo_Fixo, Valor_Inteiro, Valor_Data, Valor_Real4 ORDER BY Lcl.IdCampo_Livre) AS Indice \n  FROM\n    vis_Pessoa_Campo_Livre_Consulta Lcl\n  JOIN\n    (SELECT\n      IdPessoa, \n      IdConfiguracao_Campo_Livre,\n      COUNT(1) AS Qtde\n    FROM\n      vis_Pessoa_Campo_Livre_Consulta\n    GROUP BY\n      IdPessoa, \n      IdConfiguracao_Campo_Livre\n    HAVING\n      COUNT(1) > 1\n    ) Grp ON Grp.IdPessoa = Lcl.IdPessoa AND Grp.IdConfiguracao_Campo_Livre = Lcl.IdConfiguracao_Campo_Livre\n  ) Tst  \nWHERE\n  Tst.Indice = 2\n\nDELETE FROM mov_Pessoa_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @CamposLivres)\n\nDELETE FROM mov_Campo_Livre\nWHERE\n  IdCampo_Livre IN (SELECT IdCampo_Livre FROM @CamposLivres)\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Corrigir caracter especial do modelo de mensagem.txt",
        "conteudo": "UPDATE cad_Modelo_Mensagem SET Corpo=REPLACE(CAST(Corpo as VARCHAR(MAX)), '; charset=utf-8', '') WHERE Corpo LIKE '%; charset=utf-8%'\n\nOU\n\nUPDATE cad_Modelo_Mensagem SET Corpo=REPLACE(CAST(Corpo as VARCHAR(MAX)), '<meta charset=\"utf-8\" />', '') WHERE Corpo LIKE '%<meta charset=\"utf-8\" />%'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Criar usuário NOVO 2025.txt",
        "conteudo": "--Begin Tran Teste\nSET NOCOUNT ON\nDeclare\n  @Usuario_Origem NomeCurto,\n  @Usuario_Destino NomeCurto,\n  @Copiar_Consultas Boleano,\n  @Copiar_Modulos Boleano,\n  @Copiar_Papeis Boleano,\n  @Copiar_Persistencias Boleano\n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */\nSet @Usuario_Origem = ''\nSet @Usuario_Destino = ''\nSet @Copiar_Consultas = 1\nSet @Copiar_Modulos = 1\nSet @Copiar_Papeis = 1\nSet @Copiar_Persistencias = 0\n/* FINAL */\nDeclare\n  @IdUsuario_Origem IdCurto,\n  @IdUsuario_Destino IdCurto,\n  @Max IdLongo\n\n \n\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)\nIf @IdUsuario_Origem Is Null\nBegin\n  Print 'Usuário origem não encontrado para a cópia.'\n  Return\nEnd\n\n \n\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)\nIf @IdUsuario_Destino Is Null\nBegin\n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)\n  Begin\n    Print 'É necessário especificar um nome de usuário destino para a cópia.'\n    Return\n  End\n\n \n\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1\n  Insert Into sys_Usuario (\n    IdUsuario,\n    Nome,\n    Senha,\n    Data_Criacao,\n    Ativo,\n    Alterar_Senha,\n    Bloqueado\n  )\n  Values (\n    @IdUsuario_Destino,\n    @Usuario_Destino,\n    LOWER(CONVERT(VARCHAR(32), HashBytes('MD5', (LOWER(SUBSTRING(@Usuario_Destino, 1,1)+SUBSTRING(@Usuario_Destino, (CASE WHEN CHARINDEX('.', @Usuario_Destino) != 0 THEN CHARINDEX('.', @Usuario_Destino)+1 WHEN CHARINDEX(' ', @Usuario_Destino) != 0 THEN CHARINDEX(' ', @Usuario_Destino)+1 ELSE -1 END) , 1)+CAST(YEAR(GETDATE()) as VARCHAR(10))))), 2)),\n    GetDate(),\n    1, 0, 0\n  )\n\n \n\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n\n \n\n  print 'Usuário criado.'\nEnd\n\n \n\nIf @Copiar_Consultas = 1\nBegin\n  Delete From sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Consulta_Usuario (\n    IdConsulta,\n    IdUsuario,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  )\n  Select\n    IdConsulta,\n    @IdUsuario_Destino,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  From\n    sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n\n \n\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nIf @Copiar_Modulos = 1\nBegin\n  Delete From sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Modulo_Usuario (\n    IdModulo,\n    IdUsuario\n  )\n  Select\n    IdModulo,\n    @IdUsuario_Destino as IdUsuario\n  From\n    sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nIf @Copiar_Papeis = 1\nBegin\n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\n \n\n  Delete From sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Destino\n\n \n\n  Insert Into sys_Papel_Membro (\n    IdPapel_Membro,\n    IdPapel_Superior,\n    IdUsuario,\n    IdPapel\n  )\n  Select\n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,\n    IdPapel_Superior,\n    @IdUsuario_Destino as IdUsuario,\n    IdPapel\n  From\n    sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n \n\n  If @@ROWCOUNT > 0\n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'\nEnd\n\n \n\nIf @Copiar_Persistencias = 1\nBegin\n  Update Dst Set\n    Dados = Src.Dados\n  From\n    sys_Persistencia Src\n  Join\n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia\n  and\n    Dst.IdUsuario = @IdUsuario_Destino\n  Where  \n    Src.IdUsuario = @IdUsuario_Origem\n\n \n\n  if @@ROWCOUNT > 0\n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n \n\n  Insert Into sys_Persistencia (\n    IdPersistencia,\n    IdUsuario,\n    Dados\n  )\n  Select\n    IdPersistencia,\n    @IdUsuario_Destino as IdUsuario,\n    Dados\n  From\n    sys_Persistencia\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n\n \n\n  If @@ROWCOUNT > 0\n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\n\n \n\nSET NOCOUNT OFF\n\n \n\n--Rollback Tran Teste"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Criar View.txt",
        "conteudo": "USE [HeadCargo_Projeto]\nGO\n\n/****** Object:  View [dbo].[vis_BI_Processo]    Script Date: 28/11/2018 14:05:39 ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[vis_BI_Processo] As\nSELECT\n  Lhs.Numero_Processo,\n  Lhs.Data_Abertura_Processo,\n  Lhs.IdCLiente,\n  lhe.Observacao,\n  Cln.Nome as Cliente,\n\tMcl.Nome As Municipio_Cliente,\n\tUcl.Sigla As UF_Cliente,\n\tPcl.Nome as Pais_Cliente,\n  CASE Lhs.Situacao_Agenciamento WHEN 1 THEN 'Processo aberto' WHEN 2 THEN 'Em andamento' WHEN 3 THEN 'Liberado faturamento' WHEN 4 THEN 'Faturado' WHEN 5 THEN 'Finalizado' WHEN 6 THEN 'Auditado' WHEN 7 THEN 'Cancelado' END Situcao_Agenciamento,\n  CASE Lms.Tipo_Operacao WHEN 1 THEN 'Exportação' WHEN 2 THEN 'Importação' WHEN 3 THEN 'Nacional' END as Tipo_Operacao,\n  CASE Lms.Modalidade_Processo WHEN 1 THEN 'Aéreo' WHEN 2 THEN 'Marítimo' WHEN 3 THEN 'Terrestre' END as Modalidade_Processo,\n  CASE WHEN Lms.Tipo_Operacao= 1 AND Lms.Modalidade_Processo = 1 THEN 'Aéreo exportação' WHEN Lms.Tipo_Operacao= 1 AND Lms.Modalidade_Processo = 2 THEN 'Marítimo exportação' WHEN Lms.Tipo_Operacao= 1 AND Lms.Modalidade_Processo = 3 THEN 'Terrestre exportação' WHEN Lms.Tipo_Operacao= 2 AND Lms.Modalidade_Processo = 1 THEN 'Aéreo importação' WHEN Lms.Tipo_Operacao= 2 AND Lms.Modalidade_Processo = 2 THEN 'Marítimo importação' WHEN Lms.Tipo_Operacao= 2 AND Lms.Modalidade_Processo = 3 THEN 'Terrestre importação' WHEN Lms.Tipo_Operacao= 3 AND Lms.Modalidade_Processo = 1 THEN 'Aéreo nacional' WHEN Lms.Tipo_Operacao= 3 AND Lms.Modalidade_Processo = 2 THEN 'Cabotagem' WHEN Lms.Tipo_Operacao= 3 AND Lms.Modalidade_Processo = 3 THEN 'Terrestre nacional' END as Modalidade_Tipo_Processo,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Lms.Data_Desembarque,\n  Lhs.Data_Liberado_Faturamento,\n  Lhs.Data_Faturado,\n  Lhs.Data_Recebimento_Local,\n  Lhs.Data_Pagamento_Local,\n  CASE Lms.Situacao_Embarque WHEN 0 THEN 'Pré-processo' WHEN 1 THEN 'Aguardando embarque' WHEN 2 THEN 'Embarcado' WHEN 3 THEN 'Desembarcado' WHEN 4 THEN 'Cancelado' END as Situacao_Embarque,\n  CASE Lhs.Encaminhado_Por WHEN 1 THEN 'Empresa' WHEN 2 THEN 'Agente local' WHEN 3 THEN 'Agente exterior' WHEN 4 THEN 'Associação internacional' WHEN 5 THEN 'Despachante' WHEN 6 THEN 'Comercial' END as Encaminhado_Por,\n  Lhs.IdVendedor,\n  Vnd.Nome as Vendedor,\n  Ins.Nome as Inside_Sales,\n  Pcg.Nome as Pricing,\n  Op1.Nome as Operacional_1,\n  Fno.Nome as Financeiro_Operacional,\n  Emp.Nome as Empresa,\n  Lhs.Peso_Cubado as Peso_Cubado_House,\n  Lms.Peso_Cubado as Peso_Cubado_Master,\n  Lmh.Total_Container_20,\n  Lmh.Total_Container_40,\n  Lmo.Lucro_Abertura,\n  Lmo.Lucro_Estimado,\n  Lmo.Lucro_Efetivo,\n  --Lmo.Lucro_Estimado_Faturado,\n  Lhs.Agenciamento_Carga,\n  Lhs.Desembaraco_Aduaneiro,\n  Lhs.Demurrage_Detention,\n  Lms.IdAgente_Origem,\n  Ago.Nome as Agente_Origem,\n  Lms.IdAgente_Destino,\n  Agd.Nome as Agente_Destino,\n  CASE Lms.Tipo_Operacao WHEN 1 THEN Agd.Nome WHEN 2 THEN Ago.Nome ELSE NULL END as Agente_Exterior,\n  Lhs.IdImportador,\n  Imp.Nome as Importador,\n  Lhs.IdExportador,\n  Ept.Nome as Exportador,\n  Lms.IdCompanhia_Transporte,\n  Cia.Nome as Cia_Transporte,\n  CASE Lhs.Modalidade_Pagamento WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_House,\n  CASE Lms.Modalidade_Pagamento WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_Master,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Lhs.Conhecimentos as Booking,\n  CASE Lhs.Situacao_Pagamento WHEN 0 THEN 'Sem pagamento' WHEN 1 THEN 'Em aberto' WHEN 2 THEN 'Parcialmente pago' WHEN 3 THEN 'Pago' END as Situacao_Pagamento,\n  CASE Lhs.Situacao_Recebimento WHEN 0 THEN 'Sem pagamento' WHEN 1 THEN 'Em aberto' WHEN 2 THEN 'Parcialmente pago' WHEN 3 THEN 'Pago' END as Situacao_Recebimento,\n  CASE Lhs.Situacao_Acerto_Agente WHEN 0 THEN 'Sem acerto com agente' WHEN 1 THEN 'Em aberto' WHEN 2 THEN 'Parcialmente quitado' WHEN 3 THEN 'Quitado' END as Situacao_Acerto_Agente,\n  Lms.Transit_Time,\n  CASE Lms.Master_Direto WHEN 1 THEN 'Sim' ELSE 'Não' END as Master_Direto,\n  Org.Nome as Origem,\n  Porg.Nome as Pais_Origem,\n  Dst.Nome as Destino,\n  Pdst.Nome as Pais_Destino,\n  Dstf.Nome as Destino_Final,\n  Inc.Nome as Incoterm,\n  CASE Lhs.Tipo_Frete WHEN 1 THEN 'FAK' WHEN 2 THEN 'NAC' WHEN 3 THEN 'BID' WHEN 4 THEN 'Long Term' WHEN 5 THEN 'SPOT' WHEN 6 THEN 'Extra Loader' END as Tipo_Frete,\n  CASE Lhs.Tipo_Carga WHEN 1 THEN 'Aéreo' WHEN 2 THEN 'Break-Bulk' WHEN 3 THEN 'FCL' WHEN 4 THEN 'LCL' WHEN 5 THEN 'RO-RO' WHEN 6 THEN 'Rodoviário' ELSE 'Não especificado' END as Tipo_Carga,\n  Lhs.Data_Fechamento_Cambio,\n  Lhs.IdDespachante_Aduaneiro,\n  Dpc.Nome as Despachante,\n  Lmh.Equipamentos,\n  Mcd.Nome as Mercadoria\nFROM\n  mov_Logistica_House Lhs\nJOIN\n  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nJOIN\n  vis_Cliente Cln ON Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Municipio Mcl On Mcl.IdMunicipio = Cln.IdMunicipio\nLeft Outer Join\n  cad_Unidade_Federativa Ucl On Ucl.IdUnidade_Federativa = Cln.IdUnidade_Federativa\nLeft Outer Join\n  cad_Pais Pcl on Pcl.IdPais = Cln.IdPais\nLEFT OUTER JOIN\n  vis_Funcionario Vnd ON Vnd.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel PIns ON PIns.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND PIns.IdPapel_Projeto = 4\nLEFT OUTER JOIN\n  vis_Funcionario Ins ON Ins.IdPessoa = PIns.IdResponsavel\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel PPcg ON PPcg.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND PPcg.IdPapel_Projeto = 5\nLEFT OUTER JOIN\n  vis_Funcionario Pcg ON Pcg.IdPessoa = PPcg.IdResponsavel\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel POp1 ON POp1.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND POp1.IdPapel_Projeto = 2\nLEFT OUTER JOIN\n  vis_Funcionario Op1 ON Op1.IdPessoa = POp1.IdResponsavel\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel PFno ON PFno.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND PFno.IdPapel_Projeto = 1\nLEFT OUTER JOIN\n  vis_Funcionario Fno ON Fno.IdPessoa = PFno.IdResponsavel\nLEFT OUTER JOIN\n  sys_Empresa_Sistema Emp ON Emp.IdEmpresa_Sistema = Lhs.IdEmpresa_Sistema\nLEFT OUTER JOIN\n  mov_Logistica_Maritima_House Lmh ON Lmh.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  cad_Moeda Mcr ON Mcr.Moeda_Corrente = 1\nLEFT OUTER JOIN\n  mov_Logistica_Moeda Lmo ON Lmo.IdLogistica_House = Lhs.IdLogistica_House AND Lmo.IdMoeda = Mcr.IdMoeda\nLEFT OUTER JOIN\n  cad_Pessoa Ago ON Ago.IdPessoa = Lms.IdAgente_Origem\nLEFT OUTER JOIN\n  cad_Pessoa Agd ON Agd.IdPessoa = Lms.IdAgente_Destino\nLEFT OUTER JOIN\n  cad_Pessoa Imp ON Imp.IdPessoa = Lhs.IdImportador\nLEFT OUTER JOIN\n  cad_Pessoa Ept ON Ept.IdPessoa = Lhs.IdExportador\nLEFT OUTER JOIN\n  cad_Pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN\n  cad_Origem_Destino Org ON Org.IdOrigem_Destino = Lms.IdOrigem\nLEFT OUTER JOIN\n  cad_Pais Porg ON Porg.IdPais = Org.IdPais\nLEFT OUTER JOIN\n  cad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nLEFT OUTER JOIN\n  cad_Pais Pdst ON Pdst.IdPais = Dst.IdPais\nLEFT OUTER JOIN\n  cad_Origem_Destino Dstf ON Dstf.IdOrigem_Destino = Lms.IdDestino_Final\nLEFT OUTER JOIN\n  cad_Incoterm Inc ON Inc.IdIncoterm = Lhs.IdIncoterm\nLEFT OUTER JOIN\n  cad_Pessoa Dpc ON Dpc.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLEFT OUTER JOIN\n  cad_Mercadoria Mcd ON Mcd.IdMercadoria = Lhs.IdMercadoria\nLEFT OUTER JOIN\n  mov_Logistica_Historico_Embarque lhe on lhe.IdLogistica_Master = lhs.IdLogistica_Master\n\nGO"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\CSS Acesso.txt",
        "conteudo": "Base CSS\n\n35.247.222.64\\HeadCargo,28000 - Senha: H&ads0ft_2019log Provider=SQLOLEDB.1;Password=H&ads0ft_2019log;Persist Security Info=True;User ID=sa;Initial Catalog=HeadCargo;Data Source=35.247.222.64,28000\n\nSenha: H&ads0ft_2019log\n\nBase "
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Data formato Excel para SQL e vice versa.sql",
        "conteudo": "select\n    cast('43861.875433912' - 2e as datetime) as ExcelToSql, -- even varchar works!\n    cast(cast('2020-01-31 21:00:37.490' as datetime) + 2e as float) as SqlToExcel"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\DELETE BOLETOS.sql",
        "conteudo": "--___________________________________CONSULTAR_______________________________________\nDECLARE @IdBoleto_Cobranca INT\nDECLARE @Consulta_BOLETO INT\n\nSET @IdBoleto_Cobranca = 61 -- AQUI IdBoleto_Cobranca\nSET @Consulta_BOLETO = @IdBoleto_Cobranca\n\nselect * From aux_Fatura_Financeira_Boleto Where IdBoleto_Cobranca = @Consulta_BOLETO\nselect * From mov_Boleto_Cobranca_Arquivo Where\tIdBoleto_Cobranca = @Consulta_BOLETO\nselect * From mov_Lote_Cobranca_Boleto Where IdBoleto_Cobranca = @Consulta_BOLETO\nselect * From mov_Retorno_Cobranca_Boleto Where IdBoleto_Cobranca = @Consulta_BOLETO\nselect * From mov_Boleto_Cobranca Where\tIdBoleto_Cobranca = @Consulta_BOLETO\n\n--___________________________________DELETE__________________________________________\n\n/*DECLARE @IdBoleto_Cobranca INT\nDECLARE @Consulta_DELETE INT\n\nSET @IdBoleto_Cobranca =  -- AQUI IdBoleto_Cobranca\nSET @Consulta_DELETE = @IdBoleto_Cobranca\n\ndelete From aux_Fatura_Financeira_Boleto Where IdBoleto_Cobranca = @Consulta_DELETE\ndelete From mov_Boleto_Cobranca_Arquivo Where\tIdBoleto_Cobranca = @Consulta_DELETE\ndelete From mov_Lote_Cobranca_Boleto Where IdBoleto_Cobranca = @Consulta_DELETE\n/*delete From mov_Retorno_Cobranca_Boleto Where IdBoleto_Cobranca = @Consulta_DELETE*/\ndelete From mov_Boleto_Cobranca Where\tIdBoleto_Cobranca = @Consulta_DELETE*/"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Envolvidos Contatos Externos Processo.sql",
        "conteudo": "/*\n\tCriado por: Max Dolabella\n\tData: 2022-06-04\n\tDescrição: Obtém os contatos externos do processo\n\tlocalizado na aba Processo -> Contatos -> Envolvidos\n*/\n\nSELECT \n\tLhs.IdLogistica_House,\n\tPct.EMail as Pessoa_Contato_EMail\nFROM \n\tmov_Logistica_House Lhs\nLEFT OUTER JOIN\n\tmov_Projeto_Atividade_Contato Pac ON Pac.IdProjeto_Atividade = Lhs.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Pac.IdPessoa_Contato\nLEFT OUTER JOIN\n\tcad_Pessoa Pss ON Pss.IdPessoa = Pct.IdPessoa\nWhere\n\nLhs.IdLogistica_House = 89771"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Envolvidos Responsaveis Internos Processo.sql",
        "conteudo": "/*\n\tCriado por: Max Dolabella\n\tData: 2022-06-04\n\tDescrição: Obtém os Responsáveis Internos do processo\n\tlocalizado na aba Processo -> Contatos -> Envolvidos\n*/\n\nSELECT \n\tLhs.IdLogistica_House,\n\tPpr.IdPapel_Projeto,\n\tPar.IdResponsavel,\n\tPpr.Nome as Papel_Projeto,\n\tFnc.Nome as Responsavel,\n\tFnc.EMail as Responsavel_EMail,\n\tFnc.Fone as Responsavel_Fone\nFROM \n\tmov_Logistica_House Lhs\nLEFT OUTER JOIN\n\tmov_Projeto_Atividade_Responsavel Par ON Par.IdProjeto_Atividade = Lhs.IdProjeto_Atividade\nLEFT OUTER JOIN\n\tvis_Funcionario Fnc ON Fnc.IdPessoa = Par.IdResponsavel\nLEFT OUTER JOIN\n\tcad_Papel_Projeto Ppr ON Ppr.IdPapel_Projeto = Par.IdPapel_Projeto"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Erro Financeiro V284 (Divergencia de Valores).sql",
        "conteudo": "/*\n\nEXEC sp_columns @table_name='mov_Fatura_Financeira', @column_name='Valor_Corrente'\nIF @@ROWCOUNT = 0\nBEGIN\n  ALTER TABLE dbo.mov_Fatura_Financeira\n  ADD Valor_Corrente Moeda\n\n  EXEC('UPDATE mov_Fatura_Financeira\n  SET\n    Valor_Corrente = ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Fatura_Financeira Ffn\n  JOIN\n    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro')\nEND\nGO\n\n*/\n  SELECT\n    Ffn.Valor_Corrente,\n    ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Fatura_Financeira Ffn\n  JOIN\n    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\n  WHERE\n    ISNULL(Ffn.Valor_Corrente, 0) <> ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n\n  /*UPDATE mov_Fatura_Financeira\n  SET\n    Valor_Corrente = ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Fatura_Financeira Ffn\n  JOIN\n    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\n  WHERE\n    ISNULL(Ffn.Valor_Corrente, 0) <> ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)*/\n\n\n  SELECT\n    Rfn.IdRegistro_Financeiro,\n    Rfn.Valor_Corrente,\n    ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Registro_Financeiro Rfn\n  WHERE\n    Rfn.Valor_Corrente <> ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)\n\n  /*UPDATE mov_Registro_Financeiro\n  SET\n    Valor_Corrente = ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Registro_Financeiro Rfn\n  WHERE\n    Rfn.Valor_Corrente <> ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)*/"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Excluir CE Mercante.txt",
        "conteudo": "﻿DECLARE @IdConhecimento_Embarque Integer, @IdMercante_Conhecimento Integer, @IdMercante_Item_Carga Integer, @IdMercante_Manifesto_Carga Integer, @Conhecimentos_House VARCHAR(MAX)\n\nSELECT @IdMercante_Manifesto_Carga = IdMercante_Manifesto_Carga,@Conhecimentos_House = Conhecimentos_House FROM mov_Mercante_Manifesto_Carga WHERE Numero_BL_Master = 'LS15TJ1806928N'\n\nSELECT @IdConhecimento_Embarque =  IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE Numero = @Conhecimentos_House\n\nSELECT @IdMercante_Conhecimento = IdMercante_Conhecimento FROM mov_Mercante_Conhecimento WHERE IdConhecimento_Embarque = @IdConhecimento_Embarque\n\nSELECT @IdMercante_Item_Carga = IdMercante_Item_Carga FROM mov_Mercante_Item_Carga WHERE IdMercante_Conhecimento = @IdMercante_Conhecimento\n\nDELETE FROM mov_Mercante_Item_Carga_NCM WHERE IdMercante_Item_Carga = @IdMercante_Item_Carga\n\nDELETE FROM mov_Mercante_Item_Carga WHERE IdMercante_Item_Carga = @IdMercante_Item_Carga\n\nDELETE FROM mov_Mercante_Transbordo_Exterior WHERE IdMercante_Conhecimento = @IdMercante_Conhecimento\n\nDELETE FROM mov_Mercante_Componente_Frete WHERE IdMercante_Conhecimento = @IdMercante_Conhecimento\n\nDELETE FROM mov_Mercante_Conhecimento WHERE IdMercante_Conhecimento = @IdMercante_Conhecimento\n\nDELETE FROM mov_Mercante_Manifesto_Tramite WHERE IdMercante_Manifesto_Carga = @IdMercante_Manifesto_Carga\n\nDELETE FROM mov_Mercante_Manifesto_Carga WHERE IdMercante_Manifesto_Carga = @IdMercante_Manifesto_Carga\n\nSELECT *  FROM mov_Conhecimento_Embarque WHERE IdConhecimento_Embarque = @IdConhecimento_Embarque\n\nSELECT * FROM mov_Bill_Lading WHERE IdConhecimento_Embarque = @IdConhecimento_Embarque"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Excluir Nota Fiscal ok.txt",
        "conteudo": "DECLARE @IdNota_Fiscal_Servico INT \nSET @IdNota_Fiscal_Servico = \n\nDELETE \nFROM \naux_Nota_Fiscal_Servico_Fatura\nWHERE \nIdNota_Fiscal_Servico = @IdNota_Fiscal_Servico\n\nDELETE FROM \nmov_Nota_Fiscal_Servico_Item\nWHERE \nIdNota_Fiscal_Servico = @IdNota_Fiscal_Servico\n\nDELETE FROM \nmov_Nota_Fiscal_Servico\nWHERE \nIdNota_Fiscal_Servico = @IdNota_Fiscal_Servico"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Excluir Nota Fiscal.txt",
        "conteudo": "DECLARE @IdNota_Fiscal_Servico INT\nDECLARE @IdNota_Fiscal_Servico_Excluir INT\n\nSET @IdNota_Fiscal_Servico =  /* COLOCAR ID PARA CHECAR BANCO DE DADOS */\n\nSET @IdNota_Fiscal_Servico_Excluir =  /* COLOCAR ID PARA EXCLUIR DO BANCO DE DADOS */\n\n/* Checa o banco de dados */\nSELECT\n\t*\nFROM\n\tmov_Nota_Fiscal_Servico Nfs\nWHERE\n\tNfs.IdNota_Fiscal_Servico = @IdNota_Fiscal_Servico\n\nSELECT\n\t*\nFROM\n\taux_Nota_Fiscal_Servico_Fatura Nfs\nWHERE\n\tNfs.IdNota_Fiscal_Servico = @IdNota_Fiscal_Servico\n\nSELECT\n\t*\nFROM\n\tmov_Nota_Fiscal_Servico_Item Nfs\nWHERE\n\tNfs.IdNota_Fiscal_Servico = @IdNota_Fiscal_Servico\n\n\t/* Exclui a ID selecionada do banco de dados */\n\n--DELETE\n--FROM\n--\tmov_Nota_Fiscal_Servico_Item\n--WHERE\n--\tIdNota_Fiscal_Servico = @IdNota_Fiscal_Servico_Excluir;\n\n--DELETE\n--FROM\n--\taux_Nota_Fiscal_Servico_Fatura\n--WHERE\n--\tIdNota_Fiscal_Servico = @IdNota_Fiscal_Servico_Excluir;\n\n--DELETE \n--FROM\n--\tmov_Nota_Fiscal_Servico\n--WHERE\n--\tIdNota_Fiscal_Servico = @IdNota_Fiscal_Servico_Excluir;\n\t"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Excluir Processo com Vinculos ATUALIZADO.txt",
        "conteudo": "﻿Declare @IdLogistica_House int = 7562\n\nUpdate mov_Logistica_House set IdProcesso_Origem_Clonagem = null where IdProcesso_Origem_Clonagem = @IdLogistica_House\n\n\nDelete\nFrom\n  mov_Logistica_Maritima_Container\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Logistica_Maritima_Container WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete \nFrom\n  mov_Bill_Lading \nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Air_Waybill\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_conhecimento_Aereo_Nacional\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Logistica_Moeda_Historico\nWhere \n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Conhecimento_Embarque\nWhere \n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom \n  mov_Conhecimento_Embarque\nWhere\n  IdLogistica_House = @IdLogistica_House\n\nDelete\nfrom \n  mov_Logistica_Prazo \nWhere\n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Campo_Livre\nWhere\n  IdCampo_Livre in (Select\n  IdCampo_Livre\nfrom \n  mov_Logistica_Prazo \nWhere\n  IdLogistica_House = @IdLogistica_House)\n\nDelete\nfrom mov_Historico_Processo_Oferta\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Moeda\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Maritima_Equipamento\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Viagem\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Maritima_House\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Comissao\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Bill_Lading_NCM\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Historico_Liberacao_Booking\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Conhecimento_Embarque\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Embalagem\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Taxa\nwhere idlogistica_house = @IdLogistica_House\n\n\nDelete\nFrom\n  mov_Logistica_Fatura_Conversao \nWhere\n  IdLogistica_Fatura IN (Select IdRegistro_Financeiro From mov_Logistica_Fatura Where IdLogistica_House = @IdLogistica_House)\n\n\nDelete\nFrom\n  mov_Logistica_Fatura\nWHERE\n  IdLogistica_House = @IdLogistica_House\n\n\nDelete\nfrom mov_Logistica_House\nwhere idlogistica_house = @IdLogistica_House"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Excluir processos com vínculo ATUALIZADO FLAUVI.txt",
        "conteudo": "Declare @IdLogistica_House int = /*AQUI IDLOGISTICA_HOUSE*/\n\nUpdate mov_Logistica_House set IdProcesso_Origem_Clonagem = null where IdProcesso_Origem_Clonagem = @IdLogistica_House\n\n\nDelete\nFrom\n  mov_Logistica_Maritima_Container\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Logistica_Maritima_Container WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Air_Waybill_Goods\nWhere\n  IdAir_Waybill IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Bill_Lading_NCM\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Included_Custom_Notes\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_CCT_Aereo_Tramite\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Logistica_Taxa_Composicao\nWhere\n  IdLogistica_Taxa IN (SELECT IdLogistica_Taxa FROM mov_Logistica_Taxa WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete \nFrom\n  mov_Bill_Lading \nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Air_Waybill\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_conhecimento_Aereo_Nacional\nWhere\n  IdConhecimento_Embarque IN (SELECT IdConhecimento_Embarque FROM mov_Conhecimento_Embarque WHERE IdLogistica_House = @IdLogistica_House)\n\nDelete\nFrom\n  mov_Logistica_Viagem_Historico\nWhere \n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Logistica_Aerea_House\nWhere \n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Logistica_Seguro\nWhere \n  IdProcesso_Origem = @IdLogistica_House\n\nDelete\nFrom\n  mov_Logistica_Moeda_Historico\nWhere \n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Demurrage_Tarifa\nWhere \n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Logistica_Campo_Livre\nWhere \n  IdLogistica_House = @IdLogistica_House\n\n\nDelete\nFrom \n  mov_Conhecimento_Embarque\nWhere\n  IdLogistica_House = @IdLogistica_House\n\nDelete\nfrom \n  mov_Logistica_Prazo \nWhere\n  IdLogistica_House = @IdLogistica_House\n\nDelete\nFrom\n  mov_Campo_Livre\nWhere\n  IdCampo_Livre in (Select\n  IdCampo_Livre\nfrom \n  mov_Logistica_Prazo \nWhere\n  IdLogistica_House = @IdLogistica_House)\n\nDelete\nfrom mov_Historico_Processo_Oferta\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Moeda\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Maritima_Equipamento\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Viagem\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Maritima_House\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Comissao\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Bill_Lading_NCM\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Historico_Liberacao_Booking\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Conhecimento_Embarque\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Embalagem\nwhere idlogistica_house = @IdLogistica_House\n\nDelete\nfrom mov_Logistica_Taxa\nwhere idlogistica_house = @IdLogistica_House\n\n\nDelete\nFrom\n  mov_Logistica_Fatura_Conversao \nWhere\n  IdLogistica_Fatura IN (Select IdRegistro_Financeiro From mov_Logistica_Fatura Where IdLogistica_House = @IdLogistica_House)\n\n\nDelete\nFrom\n  mov_Logistica_Fatura\nWHERE\n  IdLogistica_House = @IdLogistica_House\n\n\nDelete\nfrom mov_Logistica_House\nwhere idlogistica_house = @IdLogistica_House"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Guia HeadSoft.txt",
        "conteudo": "                                     \n******************************************\nSEMPRE EXECUTAR COMO ADM O CLIENTE DE VPN!\n******************************************\n\n**** Acesso HeadSoft Nelsonheusi ****\n\n\nVPN (Permite acesso somente aos tres servidores)\nRodar instalador .exe \nusuário: headsoft\nPass: He@d$OfT.2016\n\n\nAplicação com defeito (WTS01)\nIP: 172.19.190.158\nUser: nelsonheusi\\headsoft\nPass: Head$oft.2017\n\n\nAplicação em produção \nIP: 172.19.190.248  (WTS03)\nUser: nelsonheusi\\headsoft\nPass: Head$oft.2017\n\n\nBanco de dados (W2008-DB02)\nIP: 172.19.190.98\nUser: administrador\nPass: techy.2009"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Habilitar Usuário.txt",
        "conteudo": "SELECT * FROM sys_Usuario\nwhere Nome LIKE '%nome_do_usuário%'\n\nupdate sys_Usuario set Ativo = 1\nwhere IdUsuario = 87 -- código_do_usuário"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Histórico de Email (Resposta).txt",
        "conteudo": "<DataSet Name=\"Email_Selecionado\" Sql=\"Select\nAtv.IdProjeto_Atividade,\nMsg.Assunto,\nMsg.Data_Envio,\nMsg.Destinatarios_Email,\nMsg.Destinatarios_Email_Cc,\nMsg.Corpo_Mensagem,\nMsg.Remetente_Email,\nMsg.Email_Data_Enviado,\nMsg.Email_Enviado,\nMsg.Remetente_Email\nFrom\nmov_Atividade Atv\nLeft Outer Join\nmov_Projeto_Atividade_Mensagem Pat on Pat.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer join\nmov_Mensagem Msg on Msg.IdMensagem = Pat.IdMensagem\nWhere\nPat.Selecionado_Resposta = 1\nAnd \nAtv.IdAtividade = :IdAtividade\">\n\n<SubReport Name=\"Email_Resposta\" DataSet=\"Email_Selecionado\">\n\n[Email_Resposta.Detail]\n<Table >\n<tr><td class=\"borda_cima\"></td></tr> \n<tr>\n<td><span=\"negrito\">De:</span> <Print Dataset=\"Email_Selecionado\" FieldName=\"Remetente_Email\"></td>\n</tr>\n<tr>\n<td><span=\"negrito\">Enviada em:</span> <Print Dataset=\"Email_Selecionado\" FieldName=\"Data_Envio\"></td>\n</tr>\n<tr>\n<td><span=\"negrito\">Para:</span> <Print Dataset=\"Email_Selecionado\" FieldName=\"Destinatarios_Email\"></td>\n</tr>\n<tr>\n<td><span=\"negrito\">Assunto:</span> <Print Dataset=\"Email_Selecionado\" FieldName=\"Assunto\"></td>\n</tr>\n<tr>\n<td><p><Print Dataset=\"Email_Selecionado\" FieldName=\"Corpo_Mensagem\" compressed=\"True\" Html=\"False\"></p></td>\n</tr> \n</table>"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Indice.txt",
        "conteudo": "ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Inset vinculo IBGE Municipios.sql",
        "conteudo": "/*Select Para verificar os vinculos existentes*/\nSelect\n  *\nFrom\n  aux_IBGE_Municipio_Link\n\n/*Select Para verificar os possiveis links que podem ser feitos*/\nSELECT \n  Mun.IdMunicipio,\n  Mun.Nome,\n  Ibge.IdIBGE_Municipio,\n  Ibge.Municipio\nFROM \n  cad_Municipio Mun\nJoin\n  Aux_IBGE_Unidade_Federativa_Link Ufd on Ufd.IdUnidade_Federativa = Mun.IdUnidade_Federativa\nJoin\n  cad_IBGE_Unidade_Federativa Cuf on Cuf.IdIBGE_Unidade_Federativa = Ufd.IdIBGE_Unidade_Federativa\nJoin\n  (SELECT\n  *,\n  ROW_NUMBER() OVER(PARTITION BY Codigo_Municipio ORDER BY CASE WHEN Municipio = Distrito THEN 0 ELSE 1 END, IdIBGE_Municipio) AS Indice\nFROM\n  cad_IBGE_Municipio) ibge ON Ibge.Indice = 1 AND ibge.Municipio = Mun.Nome And Ibge.Codigo_UF = Cuf.Codigo\nOrder By\n   Mun.IdMunicipio\n\n/*Apos efetuar a exclusão dos vinculos existentes, Efetuar a nova inserção dos vinculos*/\nINSERT INTO aux_IBGE_Municipio_Link (IdIBGE_Municipio, IdMunicipio)\nSELECT \n  Ibge.IdIBGE_Municipio,\n  Mun.IdMunicipio\nFROM \n  cad_Municipio Mun\nJOIN \n  Aux_IBGE_Unidade_Federativa_Link Ufd ON Ufd.IdUnidade_Federativa = Mun.IdUnidade_Federativa\nJOIN \n  cad_IBGE_Unidade_Federativa Cuf ON Cuf.IdIBGE_Unidade_Federativa = Ufd.IdIBGE_Unidade_Federativa\nJOIN (\n    SELECT \n      *,\n      ROW_NUMBER() OVER(PARTITION BY Codigo_Municipio ORDER BY CASE WHEN Municipio = Distrito THEN 0 ELSE 1 END, IdIBGE_Municipio) AS Indice\n    FROM cad_IBGE_Municipio\n) ibge ON Ibge.Indice = 1 AND ibge.Municipio = Mun.Nome AND Ibge.Codigo_UF = Cuf.Codigo \nORDER BY \n  Mun.IdMunicipio"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Link IBGE UNIDADE FEDERATIVA.sql",
        "conteudo": "/*Select Para verificar os vinculos existentes*/\nselect\n  *\nFrom\n  Aux_IBGE_Unidade_Federativa_Link\n\n/*Select Para verificar os possiveis links que podem ser feitos*/\nSELECT \n  Unf.IdUnidade_Federativa,\n  Ibge.IdIBGE_Unidade_Federativa\nFROM \n  cad_Unidade_Federativa Unf\nJOIN \n  cad_IBGE_Unidade_Federativa ibge ON ibge.NOME = Unf.NOME\n\n\n/*Apos efetuar a exclusão dos vinculos existentes, Efetuar a nova inserção dos vinculos*/\n--INSERT INTO Aux_IBGE_Unidade_Federativa_Link (IdUnidade_Federativa, IdIBGE_Unidade_Federativa)\n--SELECT \n--  Unf.IdUnidade_Federativa,\n--  Ibge.IdIBGE_Unidade_Federativa\n--FROM \n--  cad_Unidade_Federativa Unf\n--JOIN \n--  cad_IBGE_Unidade_Federativa ibge ON ibge.NOME = Unf.NOME"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Listar usuários logados e matar acesso.txt",
        "conteudo": "exec sp_who2\n\nkill 69   "
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Logs de Tabelas.txt",
        "conteudo": "Declare\n  @IdUsuario IdCurto,\n  @Primary_Keys Xml,\n  @Data_Inicio Data,\n  @Data_Termino Data,\n  @Tabela VarChar(Max),\n  @Tipo TipoFixo,\n  @SQL nVarChar(Max)\n\nSet @Data_Inicio = CONVERT(date,'2019-11-01')\nSet @Data_Termino = GETDATE()\nSet @IdUsuario = 0\nSet @Tabela = 'mov_Logistica_Taxa'\nSet @Primary_Keys = '<PrimaryKeys><Item Nome=\"IdTaxa_Logistica_Exibicao\" Value=\"90\"/></PrimaryKeys>'\nSet @Tipo = 0\n\n/*\nSet @Data_Inicio = NULL\nSet @Data_Termino = NULL\nSet @IdUsuario = 0\nSet @Tabela = 'arq_Arquivo'\nSet @Primary_Keys = '<PrimaryKeys>\n  <Item Nome=\"IdArquivo\" Value=\"49\"/>\n</PrimaryKeys>'\nSet @Tipo = 1\n*/\n\nDeclare\n  @Filtro_Tabela VarChar(Max),\n  @Filtro_Campo VarChar(Max),\n  @Filtro_Tipo VarChar(Max)\n\nSet @Filtro_Tabela = ''\nIf Nullif(LTrim(@Tabela), '') Is Not Null\n  Set @Filtro_Tabela = '[@Nome=\"'+@Tabela+'\"]'\n\nDeclare Campos Cursor For\nSelect\n  Pks.value('@Nome', 'VarChar(Max)') as Nome,\n  Pks.value('@Value', 'VarChar(Max)') as Value\nFrom\n  @Primary_Keys.nodes('/PrimaryKeys/Item') as PrimaryKeys(Pks)\n\nOpen Campos\n\nDeclare\n  @Campo_Nome VarChar(Max),\n  @Campo_Value VarChar(Max)\n\nFetch Next From Campos Into\n  @Campo_Nome,\n  @Campo_Value\n\nSet @Filtro_Campo = ''\nWhile @@FETCH_STATUS = 0\nBegin\n  Set @Filtro_Campo = @Filtro_Campo + '[Campo[@Nome=\"'+@Campo_Nome+'\"][@Value=\"'+@Campo_Value+'\"]]'\n\n  Fetch Next From Campos Into\n    @Campo_Nome,\n    @Campo_Value\nend\n\nClose Campos\nDeallocate Campos\n\nSet @Filtro_Tipo = ''\nIf @Tipo <> 0\n  Set @Filtro_Tipo = '[@Tipo=\"'+Cast(@Tipo as VarChar(Max))+'\"]'\n\nSet @SQL = 'Select\n  Usr.Nome as Usuario,\n  Ltb.Data_Inicio as Data_Inicio_Transacao,\n  Ltb.Data_Termino as Data_Termino_Transacao,\n  DateDiff(second, Ltb.Data_Inicio, Ltb.Data_Termino) as Tempo_Transacao,\n  Dlg.value(''../@WindowsUser'', ''VarChar(Max)'') as Usuario_Windows,\n  Dlg.value(''../@ComputerName'', ''VarChar(Max)'') as Computador,\n  Dlg.value(''@Nome'', ''VarChar(Max)'') as Tabela,\n  Dlg.value(''@Tipo'', ''smallint'') as Tipo,\n  Convert(DateTime, Dlg.value(''@Data'', ''VarChar(max)''), 101) as Data,\n  Dlg.value(''@Indice'', ''int'') as Indice,\n  Dlg.query(''<Campos>{Campo}</Campos>'') as Campos\nFrom\n  sys_Log_Tabela Ltb\nCross Apply\n  Ltb.Dados_Log.nodes(''/Log/Tabela'+@Filtro_Tabela+@Filtro_Tipo+@Filtro_Campo+''') as DadosLog(Dlg)\nJoin\n  sys_Usuario Usr on Usr.IdUsuario = Ltb.IdUsuario\nWhere\n  ((@IdUsuario = 0) or (Ltb.IdUsuario = @IdUsuario))\nAnd\n  (((@Data_Inicio Is Null) And (@Data_Termino Is Null))\n    Or ((Ltb.Data_Inicio Between @Data_Inicio And @Data_Termino)\n    Or (Ltb.Data_Termino Between @Data_Inicio And @Data_Termino)))\nOrder By\n  Ltb.Data_Inicio,\n  Dlg.value(''@Indice'', ''int'')'\n\nexec sp_executesql @SQL, N'@Data_Inicio Data, @Data_Termino Data, @IdUsuario IdCurto', @Data_Inicio=@Data_Inicio, @Data_Termino=@Data_Termino, @IdUsuario=@IdUsuario"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Log_Geral.txt",
        "conteudo": "Select\n  Ltb.*,\n  Dlg.query('.')\nFrom\n  sys_Log_Tabela Ltb\nCross Apply\n  Dados_Log.nodes('/Log/Tabela\n    [@Nome=\"mov_Logistica_House\"]\n    [Campo[@Nome=\"Numero_Processo\"][@Value=\"IA0820ITJ1426\"]]') as Dados_Log(Dlg)\nWhere\n  Ltb.Data_Inicio >= '2020-09-01'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Mensagem de E-mail.txt",
        "conteudo": "﻿Ajuste mensagem de email\n> montar o select, depois o html, depois o detail para que possa ser verificado as informações."
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\PORTAL WEB - Compartilhar todos os acompanhamentos.sql",
        "conteudo": "INSERT INTO Web_Shared_With\n(Id, Origin, OriginId, IdProjeto_Atividade, Client, Shipper, Consignee, Notify, Customs_Broker, Seller, Origin_Carrier, Destination_Carrier, \n  Representative, Destination_Representative, Indication, Origin_Agent, Destination_Agent, System_Company, IdUsuario, Date)\n\nSELECT\n  NEWID() AS Id,\n  2 AS Origin,\n  Acm.IdAcompanhamento,\n  Acm.IdProjeto_Atividade,\n  1 AS Client,\n  0 AS Shipper,\n  0 AS Consignee,\n  0 AS Notify,\n  0 AS Customs_Broker,\n  0 AS Seller,\n  0 AS Origin_Carrier,\n  0 AS Destination_Carrier,\n  0 AS Representative,\n  0 AS Destination_Representative,\n  0 AS Indication,\n  0 AS Origin_Agent,\n  0 AS Destination_Agent,\n  0 AS System_Company,\n  1 AS IdUsuario,\n  GETDATE() AS Date\nFROM\n  mov_Acompanhamento Acm\nLEFT OUTER JOIN\n  Web_Shared_With Wsw ON Wsw.Origin = 2 AND Wsw.OriginId = Acm.IdAcompanhamento\nWHERE\n\tAcm.Tipo = 1 AND Wsw.Id IS NULL"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\PORTAL WEB - Compartilhar todos os processos.sql",
        "conteudo": "INSERT INTO Web_Shared_With\n(Id, Origin, OriginId, IdProjeto_Atividade, Client, Shipper, Consignee, Notify, Customs_Broker, Seller, Origin_Carrier, Destination_Carrier, \n  Representative, Destination_Representative, Indication, Origin_Agent, Destination_Agent, System_Company, IdUsuario, Date)\nSELECT\n  NEWID() AS Id,\n  1 AS Origin,\n  Lhs.IdLogistica_House AS OriginId,\n  Lhs.IdProjeto_Atividade,\n  1 AS Client,\n  0 AS Shipper,\n  0 AS Consignee,\n  0 AS Notify,\n  0 AS Customs_Broker,\n  0 AS Seller,\n  0 AS Origin_Carrier,\n  0 AS Destination_Carrier,\n  0 AS Representative,\n  0 AS Destination_Representative,\n  0 AS Indication,\n  0 AS Origin_Agent,\n  0 AS Destination_Agent,\n  0 AS System_Company,\n  1 AS IdUsuario,\n  GETDATE() AS Date\nFROM\n  mov_Logistica_House Lhs\nLEFT OUTER JOIN\n  Web_Shared_With Wsw ON Wsw.Origin = 1 AND Wsw.OriginId = Lhs.IdLogistica_House\nWHERE\n  Wsw.Id IS NULL"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\PORTAL WEB - Desativa processos antes de 2024 liberados no portal.sql",
        "conteudo": "UPDATE Web_Shared_With\nSET\n  Client = 0,\n  Customs_Broker = 0\nFROM\n  Web_Shared_With Wsw\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Wsw.OriginId\nWHERE\n  Wsw.Origin = 1\n  AND \n  Lhs.Data_Abertura_Processo < '2024'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\PORTAL WEB - UPDATE desativação de acompanhamentos de processos anteriores de 2024.sql",
        "conteudo": "UPDATE Web_Shared_With\nSET\n\tClient = 0\nFROM\n  Web_Shared_With Wsw\nLEFT OUTER JOIN\n  mov_Acompanhamento Acm ON Acm.IdAcompanhamento = Wsw.OriginId\nLEFT OUTER JOIN\n  mov_Logistica_House Lhs ON Lhs.IdProjeto_Atividade = Wsw.IdProjeto_Atividade\nWHERE\n  Wsw.Origin = 2\n  AND\n  Lhs.Data_Abertura_Processo < '2024'\n  AND\n  Wsw.Date = '2024-08-28 15:23:07.327'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\PUXAR CONTATOS DO GRUPO DE CONTATOS.sql",
        "conteudo": "Select\n  Tpc.Nome as Tipo_Processo,\n  getDate() as Data_Atual,\n  Lhs.IdLogistica_House,\n  Lhs.Numero_Processo,\n  Lhs.Referencia_Externa,\n  Lhs.Referencia_Cliente,\n  Lhs.Local_Entrega,\n  Lhs.Local_Coleta,\n  Lhs.Data_Entrega,\n  Lhs.NCM_Descricao,\n  Lhs.Conhecimentos,\n  Lms.Data_Previsao_Desembarque,\n  Lms.Data_Desembarque,\n  Coalesce (Lms.Data_Embarque, Lms.Data_Previsao_Embarque) as Embarque,\n  Coalesce (Lms.Data_Desembarque, Lms.Data_Previsao_Desembarque) as Desembarque,\n  Lms.Numero_Reserva,\n  Lms.Numero_Conhecimento as Documento_Master,\n  Cln.Nome as Cliente,\n  Cln.Cpf_Cnpj as Cliente_CNPJ,\n  Ept.Nome as Exportador,\n  Ept.Correspondencia as Exportador_Correspondencia,\n  Imp.Nome as Importador,\n  Imp.Correspondencia as Importador_Correspondencia,\n  Imp.Cpf_Cnpj as Importador_CNPJ,\n  Nty.Nome as Notify,\n  Nty.Cpf_Cnpj as Notify_CNPJ,\n  Nty.Correspondencia as Notify_Correspondencia,\n  Org.Nome as Origem,\n  Dst.Nome as Destino,\n  Dfn.Nome as Destino_Final,\n  Ctr.Nome as Cia_Transporte,\n  Coalesce(Trb.Viagem,Lmm.Viagem_Navio) as Numero_Viagem,\n  Coalesce(Trb.Navio_Transbordo,Nvi.Nome) as Navio,\n  Case\n    When Lms.Tipo_Operacao = 1 Then Ago.Nome /*Importacao - Agente na origem*/\n    When Lms.Tipo_Operacao = 2 Then Agd.Nome /*Exportacao - Agente no destino*/\n  End as Agente,\n  Mer.Nome as Mercadoria,\n  Lam.Numero_Voo,\n  Lhs.Metros_Cubicos,\n  Lhs.Peso_Liquido,\n  Lhs.Peso_Bruto,\n  Lhs.Peso_Cubado,\n  Lhs.Peso_Considerado,\n  Lam.Peso_Taxado as Peso_Taxado_Master,\n  Lah.Peso_Taxado as Peso_Taxado_House,\n  Lhs.Quantidade_Volumes,\n  Ofr.Numero_Oferta,\n  Inc.Nome as Incoterm,\n  Lhs.Observacao,\n  Aga.Nome as Agencia_Maritima_Aerea,\n  Aga.Correspondencia as Agencia_MA_Correspondencia,\n  Tat.Nome as Terminal_Atracacao,\n  Trt.Nome as Terminal_Redestinacao,\n  coalesce(Lhs.Data_Coleta,Lhs.Data_Previsao_Coleta) as Data_Coleta,\n  coalesce(Lhs.Data_Entrega,Lhs.Data_Previsao_Entrega) as Data_Entrega,\n  Nsr.Descricao as Nivel_Servico,\n  Mok.Valor_Data as Mantra_Ok,\n  Lmm.Numero_CE,\n  CASE\n  Lms.IdDestino\n  WHEN 370 /*Guarulhos GRU*/ THEN (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 1\n        FOR XML PATH('')), 1, 1, '')\n  ) \n  WHEN 380 /*Viracopos VCP*/ THEN (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 2\n        FOR XML PATH('')), 1, 1, '')\n  ) \n  WHEN 377 /*Recife REC*/ THEN (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 3\n        FOR XML PATH('')), 1, 1, '')\n  )\n WHEN 379 /*Salvador SSA*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 4\n        FOR XML PATH('')), 1, 1, '')\n  )\n   WHEN 368 /*Fortaleza FOR*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 5\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 369 /*Rio de Janeiro GIG*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 6\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 366 /*Curitiba CWB*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 7\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 373 /*Manaus MAO*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 8\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 376 /*Porto Alegre POA*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 9\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 374 /*Natal NAT*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 10\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 364 /*Brasilia BSB*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 11\n        FOR XML PATH('')), 1, 1, '')\n  )  \n  WHEN 365 /*Belo Horizonte CNF*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 12\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 375 /*Navegantes NVT*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 13\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 381 /*Vitória VIX*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 14\n        FOR XML PATH('')), 1, 1, '')\n  ) \n   WHEN 371 /*Goiânia GYN*/ THEN\n  (\n    SELECT STUFF((\n        SELECT DISTINCT\n\t\t';' + Pct.EMail\n        FROM \n\t\tcad_Grupo_Contato Gct\n        LEFT OUTER JOIN \n\t\tcad_Grupo_Contato_Item Gci ON Gci.IdGrupo_Contato = Gct.IdGrupo_Contato\n        LEFT OUTER JOIN \n\t\tcad_Pessoa_Contato Pct ON Pct.IdPessoa_Contato = Gci.IdPessoa_Contato\n        WHERE \n\t\tGct.IdGrupo_Contato = 15\n        FOR XML PATH('')), 1, 1, '')\n  ) ELSE NULL\nEND AS Contatos_Grupos\nFrom\n  mov_Atividade Atv\nLeft Outer Join\n  mov_Logistica_House Lhs on Lhs.IdProjeto_Atividade = Atv.IdProjeto_Atividade\nLeft Outer Join\n  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_Master Lam on Lam.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Aerea_House Lah on Lah.IdLogistica_House = Lhs.IdLogistica_House\nLeft Outer Join\n  cad_Pessoa Tat on Tat.IdPessoa = Lmm.IdTerminal_Atracacao\nLeft Outer Join\n  cad_Pessoa Trt on Trt.IdPessoa = Lmm.IdTerminal_Retirada_Redestinar\nLeft Outer Join\n  cad_Origem_Destino Dfn on Dfn.IdOrigem_Destino = Lms.IdDestino_Final\nLeft Outer Join\n  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\nLeft Outer Join\n  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\nLeft Outer Join\n  cad_Pessoa Cln on Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\nLeft Outer Join\n  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\nLeft Outer Join\n  cad_Pessoa Nty on Nty.IdPessoa = Lhs.IdNotify\nLeft Outer Join\n  cad_Pessoa Ago on Ago.IdPessoa = Lms.IdAgente_Origem\nLeft Outer Join\n  cad_Pessoa Agd on Agd.IdPessoa = Lms.IdAgente_Destino\nLeft Outer Join\n  cad_Pessoa Aga on Aga.IdPessoa = Lms.IdAgencia_Maritima_Aerea\nLeft Outer Join\n  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\nLeft Outer Join\n  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\nLeft Outer Join\n  cad_Mercadoria Mer on Mer.IdMercadoria = Lhs.IdMercadoria\nLeft Outer Join\n  cad_Incoterm Inc on Inc.IdIncoterm = Lhs.IdIncoterm\nLeft Outer Join\n  mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Lhs.IdOferta_Frete\nLeft Outer Join\n  cad_Nivel_Servico_Aereo Nsr on Nsr.IdNivel_Servico_Aereo = Lah.IdNivel_Servico_Aereo\nLeft Outer Join\n  cad_Tipo_Processo Tpc on Tpc.IdTipo_Processo = Lhs.IdTipo_Processo\nLeft Outer Join\n  vis_Logistica_Campo_Livre Mok On (Mok.IdLogistica_House = Lhs.IdLogistica_House) And (Mok.Identificador Like 'Mantra_Ok')\nLeft Outer Join\n  (Select\n    Lmt.IdLogistica_Master,\n    Lmt.Viagem,\n    Lmt.Data_Desembarque,\n    Lmt.Data_Embarque,\n    Lmt.Data_Chegada,\n    Ptr.Nome As Porto_Transbordo,\n    Pds.Nome As Porto_Desembarque,\n    Nvi.Nome As Navio_Transbordo,\n    Rank() Over (Partition By Lmt.IdLogistica_Master Order By Lmt.IdLogistica_Master, Lmt.Data_Previsao_Chegada Desc, Lmt.IdLogistica_Maritima_Transbordo)As Ranking\n  From\n    mov_Logistica_Maritima_Transbordo Lmt\n  Left Outer Join\n    cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\n  Left Outer Join\n    cad_Origem_Destino Pds on Pds.IdOrigem_Destino = Lmt.IdPorto_Desembarque\n  Left Outer Join\n    cad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\n  ) As Trb On (Trb.IdLogistica_Master = Lhs.IdLogistica_Master) And (Trb.Ranking = 1)\nWhere\n  Atv.IdAtividade= "
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Rastaurar Fatura.txt",
        "conteudo": "﻿Declare\n  @IdFatura_Financeira Integer\n\nSet @IdFatura_Financeira = 105012 /* SETA O ID DA FATURA FINANCEIRA */\n\nUpdate mov_Fatura_Financeira\nSet\n  Situacao = 1,\n  Data_Pagamento = NULL,\n  Valor_Residual = Valor,\n  Total_Multa = NULL,\n  Total_Juros = NULL,\n  Total_Acrescimo = NULL,\n  Total_Desconto = NULL,\n  Total_Abatimento = NULL,\n  Total_Pago = NULL,\n  Total_Pago_Corrente = NULL\nWhere\n  IdFatura_Financeira = @IdFatura_Financeira\n\nUpdate mov_Registro_Financeiro\nSet\n  Situacao = 1\nWhere\n  IdRegistro_Financeiro = (Select IdRegistro_Financeiro From mov_Fatura_Financeira Where IdFatura_Financeira = @IdFatura_Financeira)"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Rebuild todas as tabelas.txt",
        "conteudo": "USE  Headcargo /*__REPLACE_WITH_DATABASE_NAME__*/\nGO\n\nPrint 'Selecting Index Fragmentation in the database.'\n\nSELECT\n  DB_NAME(DPS.DATABASE_ID) AS [DatabaseName]\n ,OBJECT_NAME(DPS.OBJECT_ID) AS TableName\n ,SI.NAME AS IndexName\n ,DPS.INDEX_TYPE_DESC AS IndexType\n ,DPS.AVG_FRAGMENTATION_IN_PERCENT AS AvgPageFragmentation\n ,DPS.PAGE_COUNT AS PageCounts\nFROM sys.dm_db_index_physical_stats (DB_ID(), NULL, NULL, NULL, NULL) DPS -- N'LIMITED') DPS\nINNER JOIN sysindexes SI\n    ON DPS.OBJECT_ID = SI.ID\n    AND DPS.INDEX_ID = SI.INDID\nORDER BY DPS.avg_fragmentation_in_percent DESC\nGO\n\n/*Fix the fragmentation with a rebuild: */\nPrint 'Rebuilding indexes on every table in the database.'\n\nEXEC sp_MSforeachtable @command1=\"print 'Rebuilding indexes for ?' ALTER INDEX ALL ON ? REBUILD WITH (FILLFACTOR = 90)\"\nGO\n\n/* Fix the fragmentation with reorganize: */\nPrint 'Reorganizing indexes on every table in the database.'\n\nEXEC sp_MSforeachtable @command1=\"print 'Reorganizing indexes for ?' ALTER INDEX ALL ON ? REORGANIZE\"\nGO\n\nexec sp_updatestats"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Relatório lcl.txt",
        "conteudo": "USE [HeadCargo]\nGO\n\n/****** Object:  View [dbo].[vis_BI_Processo]    Script Date: 28/11/2018 14:05:39 ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[vis_BI_Processo] As\nSELECT\n  Lhs.Numero_Processo,\n  Lhs.Data_Abertura_Processo,\n  Lhs.IdCLiente,\n  Cln.Nome as Cliente,\n\tMcl.Nome As Municipio_Cliente,\n\tUcl.Sigla As UF_Cliente,\n\tPcl.Nome as Pais_Cliente,\n  CASE Lhs.Situacao_Agenciamento WHEN 1 THEN 'Processo aberto' WHEN 2 THEN 'Em andamento' WHEN 3 THEN 'Liberado faturamento' WHEN 4 THEN 'Faturado' WHEN 5 THEN 'Finalizado' WHEN 6 THEN 'Auditado' WHEN 7 THEN 'Cancelado' END Situcao_Agenciamento,\n  CASE Lms.Tipo_Operacao WHEN 1 THEN 'Exportação' WHEN 2 THEN 'Importação' WHEN 3 THEN 'Nacional' END as Tipo_Operacao,\n  CASE Lms.Modalidade_Processo WHEN 1 THEN 'Aéreo' WHEN 2 THEN 'Marítimo' WHEN 3 THEN 'Terrestre' END as Modalidade_Processo,\n  CASE WHEN Lms.Tipo_Operacao= 1 AND Lms.Modalidade_Processo = 1 THEN 'Aéreo exportação' WHEN Lms.Tipo_Operacao= 1 AND Lms.Modalidade_Processo = 2 THEN 'Marítimo exportação' WHEN Lms.Tipo_Operacao= 1 AND Lms.Modalidade_Processo = 3 THEN 'Terrestre exportação' WHEN Lms.Tipo_Operacao= 2 AND Lms.Modalidade_Processo = 1 THEN 'Aéreo importação' WHEN Lms.Tipo_Operacao= 2 AND Lms.Modalidade_Processo = 2 THEN 'Marítimo importação' WHEN Lms.Tipo_Operacao= 2 AND Lms.Modalidade_Processo = 3 THEN 'Terrestre importação' WHEN Lms.Tipo_Operacao= 3 AND Lms.Modalidade_Processo = 1 THEN 'Aéreo nacional' WHEN Lms.Tipo_Operacao= 3 AND Lms.Modalidade_Processo = 2 THEN 'Cabotagem' WHEN Lms.Tipo_Operacao= 3 AND Lms.Modalidade_Processo = 3 THEN 'Terrestre nacional' END as Modalidade_Tipo_Processo,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Embarque,\n  Lms.Data_Previsao_Desembarque,\n  Lms.Data_Desembarque,\n  Lhs.Data_Liberado_Faturamento,\n  Lhs.Data_Faturado,\n  Lhs.Data_Recebimento_Local,\n  Lhs.Data_Pagamento_Local,\n  CASE Lms.Situacao_Embarque WHEN 0 THEN 'Pré-processo' WHEN 1 THEN 'Aguardando embarque' WHEN 2 THEN 'Embarcado' WHEN 3 THEN 'Desembarcado' WHEN 4 THEN 'Cancelado' END as Situacao_Embarque,\n  CASE Lhs.Encaminhado_Por WHEN 1 THEN 'Empresa' WHEN 2 THEN 'Agente local' WHEN 3 THEN 'Agente exterior' WHEN 4 THEN 'Associação internacional' WHEN 5 THEN 'Despachante' WHEN 6 THEN 'Comercial' END as Encaminhado_Por,\n  Lhs.IdVendedor,\n  Vnd.Nome as Vendedor,\n  Ins.Nome as Inside_Sales,\n  Pcg.Nome as Pricing,\n  Op1.Nome as Operacional_1,\n  Fno.Nome as Financeiro_Operacional,\n  Emp.Nome as Empresa,\n  Lhs.Peso_Cubado as Peso_Cubado_House,\n  Lms.Peso_Cubado as Peso_Cubado_Master,\n  Lmh.Total_Container_20,\n  Lmh.Total_Container_40,\n  Lmo.Lucro_Abertura,\n  Lmo.Lucro_Estimado,\n  Lmo.Lucro_Efetivo,\n  Lmo.Lucro_Estimado_Faturado,\n  Lhs.Agenciamento_Carga,\n  Lhs.Desembaraco_Aduaneiro,\n  Lhs.Demurrage_Detention,\n  Lms.IdAgente_Origem,\n  Ago.Nome as Agente_Origem,\n  Lms.IdAgente_Destino,\n  Agd.Nome as Agente_Destino,\n  CASE Lms.Tipo_Operacao WHEN 1 THEN Agd.Nome WHEN 2 THEN Ago.Nome ELSE NULL END as Agente_Exterior,\n  Lhs.IdImportador,\n  Imp.Nome as Importador,\n  Lhs.IdExportador,\n  Ept.Nome as Exportador,\n  Lms.IdCompanhia_Transporte,\n  Cia.Nome as Cia_Transporte,\n  CASE Lhs.Modalidade_Pagamento WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_House,\n  CASE Lms.Modalidade_Pagamento WHEN 1 THEN 'Collect/Prepaid' WHEN 2 THEN 'Collect' WHEN 3 THEN 'Prepaid' WHEN 4 THEN 'Prepaid Abroad' END as Modalidade_Pagamento_Master,\n  Lms.Numero_Conhecimento as Conhecimento_Master,\n  Lhs.Conhecimentos as Booking,\n  CASE Lhs.Situacao_Pagamento WHEN 0 THEN 'Sem pagamento' WHEN 1 THEN 'Em aberto' WHEN 2 THEN 'Parcialmente pago' WHEN 3 THEN 'Pago' END as Situacao_Pagamento,\n  CASE Lhs.Situacao_Recebimento WHEN 0 THEN 'Sem pagamento' WHEN 1 THEN 'Em aberto' WHEN 2 THEN 'Parcialmente pago' WHEN 3 THEN 'Pago' END as Situacao_Recebimento,\n  CASE Lhs.Situacao_Acerto_Agente WHEN 0 THEN 'Sem acerto com agente' WHEN 1 THEN 'Em aberto' WHEN 2 THEN 'Parcialmente quitado' WHEN 3 THEN 'Quitado' END as Situacao_Acerto_Agente,\n  Lms.Transit_Time,\n  CASE Lms.Master_Direto WHEN 1 THEN 'Sim' ELSE 'Não' END as Master_Direto,\n  Org.Nome as Origem,\n  Porg.Nome as Pais_Origem,\n  Dst.Nome as Destino,\n  Pdst.Nome as Pais_Destino,\n  Dstf.Nome as Destino_Final,\n  Inc.Nome as Incoterm,\n  CASE Lhs.Tipo_Frete WHEN 1 THEN 'FAK' WHEN 2 THEN 'NAC' WHEN 3 THEN 'BID' WHEN 4 THEN 'Long Term' WHEN 5 THEN 'SPOT' WHEN 6 THEN 'Extra Loader' END as Tipo_Frete,\n  CASE Lhs.Tipo_Carga WHEN 1 THEN 'Aéreo' WHEN 2 THEN 'Break-Bulk' WHEN 3 THEN 'FCL' WHEN 4 THEN 'LCL' WHEN 5 THEN 'RO-RO' WHEN 6 THEN 'Rodoviário' ELSE 'Não especificado' END as Tipo_Carga,\n  Lhs.Data_Fechamento_Cambio,\n  Lhs.IdDespachante_Aduaneiro,\n  Dpc.Nome as Despachante,\n  Lmh.Equipamentos,\n  Mcd.Nome as Mercadoria\nFROM\n  mov_Logistica_House Lhs\nJOIN\n  mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nJOIN\n  vis_Cliente Cln ON Cln.IdPessoa = Lhs.IdCliente\nLeft Outer Join\n  cad_Municipio Mcl On Mcl.IdMunicipio = Cln.IdMunicipio\nLeft Outer Join\n  cad_Unidade_Federativa Ucl On Ucl.IdUnidade_Federativa = Cln.IdUnidade_Federativa\nLeft Outer Join\n  cad_Pais Pcl on Pcl.IdPais = Cln.IdPais\nLEFT OUTER JOIN\n  vis_Funcionario Vnd ON Vnd.IdPessoa = Lhs.IdVendedor\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel PIns ON PIns.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND PIns.IdPapel_Projeto = 4\nLEFT OUTER JOIN\n  vis_Funcionario Ins ON Ins.IdPessoa = PIns.IdResponsavel\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel PPcg ON PPcg.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND PPcg.IdPapel_Projeto = 5\nLEFT OUTER JOIN\n  vis_Funcionario Pcg ON Pcg.IdPessoa = PPcg.IdResponsavel\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel POp1 ON POp1.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND POp1.IdPapel_Projeto = 2\nLEFT OUTER JOIN\n  vis_Funcionario Op1 ON Op1.IdPessoa = POp1.IdResponsavel\nLEFT OUTER JOIN\n  mov_Projeto_Atividade_Responsavel PFno ON PFno.IdProjeto_Atividade = Lhs.IdProjeto_Atividade AND PFno.IdPapel_Projeto = 1\nLEFT OUTER JOIN\n  vis_Funcionario Fno ON Fno.IdPessoa = PFno.IdResponsavel\nLEFT OUTER JOIN\n  sys_Empresa_Sistema Emp ON Emp.IdEmpresa_Sistema = Lhs.IdEmpresa_Sistema\nLEFT OUTER JOIN\n  mov_Logistica_Maritima_House Lmh ON Lmh.IdLogistica_House = Lhs.IdLogistica_House\nLEFT OUTER JOIN\n  cad_Moeda Mcr ON Mcr.Moeda_Corrente = 1\nLEFT OUTER JOIN\n  mov_Logistica_Moeda Lmo ON Lmo.IdLogistica_House = Lhs.IdLogistica_House AND Lmo.IdMoeda = Mcr.IdMoeda\nLEFT OUTER JOIN\n  cad_Pessoa Ago ON Ago.IdPessoa = Lms.IdAgente_Origem\nLEFT OUTER JOIN\n  cad_Pessoa Agd ON Agd.IdPessoa = Lms.IdAgente_Destino\nLEFT OUTER JOIN\n  cad_Pessoa Imp ON Imp.IdPessoa = Lhs.IdImportador\nLEFT OUTER JOIN\n  cad_Pessoa Ept ON Ept.IdPessoa = Lhs.IdExportador\nLEFT OUTER JOIN\n  cad_Pessoa Cia ON Cia.IdPessoa = Lms.IdCompanhia_Transporte\nLEFT OUTER JOIN\n  cad_Origem_Destino Org ON Org.IdOrigem_Destino = Lms.IdOrigem\nLEFT OUTER JOIN\n  cad_Pais Porg ON Porg.IdPais = Org.IdPais\nLEFT OUTER JOIN\n  cad_Origem_Destino Dst ON Dst.IdOrigem_Destino = Lms.IdDestino\nLEFT OUTER JOIN\n  cad_Pais Pdst ON Pdst.IdPais = Dst.IdPais\nLEFT OUTER JOIN\n  cad_Origem_Destino Dstf ON Dstf.IdOrigem_Destino = Lms.IdDestino_Final\nLEFT OUTER JOIN\n  cad_Incoterm Inc ON Inc.IdIncoterm = Lhs.IdIncoterm\nLEFT OUTER JOIN\n  cad_Pessoa Dpc ON Dpc.IdPessoa = Lhs.IdDespachante_Aduaneiro\nLEFT OUTER JOIN\n  cad_Mercadoria Mcd ON Mcd.IdMercadoria = Lhs.IdMercadoria\n\nGO"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Remover caracteres especiais Modelo de Mensagem.txt",
        "conteudo": "UPDATE cad_Modelo_Mensagem SET Corpo=REPLACE(CAST(Corpo as VARCHAR(MAX)), '; charset=utf-8', '') WHERE Corpo LIKE '%; charset=utf-8%'"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Remover Histórico de Processo.txt",
        "conteudo": "--------------------------------------------------\n-- QUANDO O COMPARADOR É EFETUADO ENTRE PROCESSO E OFERTA\n\nDelete From\n  mov_Historico_Processo_Oferta\nWhere\n  IdLogistica_House = 1451 /*Incluir o Id do processo que deseja excluir o histórico*/\n  \n \n--------------------------------------------------\n-- QUANDO O COMPARADOR É EFETUADO ENTRE PROCESSO E TARIFÁRIO\n \n  Delete From\n  mov_Historico_Processo_Tarifario\nWhere\n  IdLogistica_House = 1451 /*Incluir o Id do processo que deseja excluir o histórico*/"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Script CSS mensal (Alteração Lançamentos).txt",
        "conteudo": "﻿/* \nRodar o script com a seguinte ordem: \n1 - toda a movimentação da c/c 4494-6 deve ser alterada para empresa CSSLOG CWB.\n2 - toda a movimentação da c/c 0024509-4 deve ser alterada para empresa CSSLOG SPO.\n3 - alterar todos os lançamentos que contenham \"CWB\" na referência para a empresa CSSLOG CTBA, independente da conta\n4 - alterar todos os lançamentos que contenham \"SPO\" “PROJECT” e \"SSZ\" na referência para a empresa CSSLOG SPO .\n5- alterar as empresas das movimentações vinculadas a transferências para as empresas ref. as contas correntes\n*/\n\nDeclare\n  @IdEmpresa_CWB IdCurto,\n  @IdEmpresa_SPO IdCurto\n\nSet @IdEmpresa_CWB = 1\nSet @IdEmpresa_SPO = 2\n\nDeclare @Contas_CWB Table(\n  IdConta_Corrente IdCurto\n)\nInsert Into @Contas_CWB\n(IdConta_Corrente)\nSelect\n  Ccr.IdConta_Corrente\nFrom\n cad_Conta_Corrente Ccr\nWhere\n  Ccr.IdConta_Corrente in (1, 14, 15, 16, 17, 18, 19, 21, 22, 23, 28, 39, 48, 49, 61, 75)\n\nDeclare @Contas_SPO Table(\n  IdConta_Corrente IdCurto\n)\nInsert Into @Contas_SPO\n(IdConta_Corrente)\nSelect\n  Ccr.IdConta_Corrente\nFrom\n cad_Conta_Corrente Ccr\nWhere\n  Ccr.IdConta_Corrente in (29, 30, 31, 38, 43, 47, 63, 66, 67, 71, 80)\n\n/* 1 - toda a movimentação da c/c 4494-6 deve ser alterada para empresa CSSLOG CWB. */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_CWB\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  @Contas_CWB Cwb on Cwb.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  Mfn.IdEmpresa_Sistema <> @IdEmpresa_CWB\n\n/* 2 - toda a movimentação da c/c 0024509-4 deve ser alterada para empresa CSSLOG SPO. */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_SPO\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  @Contas_SPO Spo On Spo.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  IdEmpresa_Sistema <> @IdEmpresa_SPO\n\n/* 3 - alterar todos os lançamentos que contenham \"CWB\" na referência para a empresa CSSLOG CTBA, independente da conta */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_CWB\nWhere\n  (Referencia Like '%CWB%')\nAnd\n  (IdEmpresa_Sistema <> @IdEmpresa_CWB)\n\n/* 4 - alterar todos os lançamentos que contenham \"SPO\" “PROJECT” e \"SSZ\" na referência para a empresa CSSLOG SPO . */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_SPO\nWhere\n  ((Referencia Like '%SPO%') Or (Referencia Like '%SSZ%') Or (Referencia Like '%PROJECTS%'))\nAnd\n  (IdEmpresa_Sistema <> @IdEmpresa_SPO)\n\n/* 5 - altera as movimentações vinculadas a transferências para a empresa da Conta Corrente utilizada */\nUpdate mov_Movimentacao_Financeira\nSet \n  IdEmpresa_Sistema = @IdEmpresa_CWB\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  mov_Transferencia_Financeira Tfn On Tfn.IdMovimentacao_Credito = Mfn.IdMovimentacao_Financeira\n    Or Tfn.IdMovimentacao_Debito = Mfn.IdMovimentacao_Financeira\nJoin\n  @Contas_CWB Cwb On Cwb.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  Mfn.IdEmpresa_Sistema <> @IdEmpresa_CWB\n\nUpdate mov_Movimentacao_Financeira\nSet \n  IdEmpresa_Sistema = @IdEmpresa_SPO\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  mov_Transferencia_Financeira Tfn On Tfn.IdMovimentacao_Credito = Mfn.IdMovimentacao_Financeira\n    Or Tfn.IdMovimentacao_Debito = Mfn.IdMovimentacao_Financeira\nJoin\n  @Contas_SPO Spo On Spo.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  Mfn.IdEmpresa_Sistema <> @IdEmpresa_SPO"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Script CSS mensal.txt",
        "conteudo": "/* \nRodar o script com a seguinte ordem: \n1 - toda a movimentação da c/c 4494-6 deve ser alterada para empresa CSSLOG CWB.\n2 - toda a movimentação da c/c 0024509-4 deve ser alterada para empresa CSSLOG SPO.\n3 - alterar todos os lançamentos que contenham \"CWB\" na referência para a empresa CSSLOG CTBA, independente da conta\n4 - alterar todos os lançamentos que contenham \"SPO\" “PROJECT” e \"SSZ\" na referência para a empresa CSSLOG SPO .\n5- alterar as empresas das movimentações vinculadas a transferências para as empresas ref. as contas correntes\n*/\n\nDeclare\n  @IdEmpresa_CWB IdCurto,\n  @IdEmpresa_SPO IdCurto\n\nSet @IdEmpresa_CWB = 1\nSet @IdEmpresa_SPO = 2\n\nDeclare @Contas_CWB Table(\n  IdConta_Corrente IdCurto\n)\nInsert Into @Contas_CWB\n(IdConta_Corrente)\nSelect\n  Ccr.IdConta_Corrente\nFrom\n cad_Conta_Corrente Ccr\nWhere\n  Ccr.IdConta_Corrente in (1, 14, 15, 16, 17, 18, 19, 21, 22, 23, 28, 39, 48, 49, 61, 75)\n\nDeclare @Contas_SPO Table(\n  IdConta_Corrente IdCurto\n)\nInsert Into @Contas_SPO\n(IdConta_Corrente)\nSelect\n  Ccr.IdConta_Corrente\nFrom\n cad_Conta_Corrente Ccr\nWhere\n  Ccr.IdConta_Corrente in (29, 30, 31, 38, 43, 47, 63, 66, 67, 71, 80)\n\n/* 1 - toda a movimentação da c/c 4494-6 deve ser alterada para empresa CSSLOG CWB. */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_CWB\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  @Contas_CWB Cwb on Cwb.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  Mfn.IdEmpresa_Sistema <> @IdEmpresa_CWB\n\n/* 2 - toda a movimentação da c/c 0024509-4 deve ser alterada para empresa CSSLOG SPO. */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_SPO\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  @Contas_SPO Spo On Spo.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  IdEmpresa_Sistema <> @IdEmpresa_SPO\n\n/* 3 - alterar todos os lançamentos que contenham \"CWB\" na referência para a empresa CSSLOG CTBA, independente da conta */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_CWB\nWhere\n  (Referencia Like '%CWB%')\nAnd\n  (IdEmpresa_Sistema <> @IdEmpresa_CWB)\n\n/* 4 - alterar todos os lançamentos que contenham \"SPO\" “PROJECT” e \"SSZ\" na referência para a empresa CSSLOG SPO . */\nUpdate mov_Movimentacao_Financeira\nSet\n  IdEmpresa_Sistema = @IdEmpresa_SPO\nWhere\n  ((Referencia Like '%SPO%') Or (Referencia Like '%SSZ%') Or (Referencia Like '%PROJECTS%'))\nAnd\n  (IdEmpresa_Sistema <> @IdEmpresa_SPO)\n\n/* 5 - altera as movimentações vinculadas a transferências para a empresa da Conta Corrente utilizada */\nUpdate mov_Movimentacao_Financeira\nSet \n  IdEmpresa_Sistema = @IdEmpresa_CWB\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  mov_Transferencia_Financeira Tfn On Tfn.IdMovimentacao_Credito = Mfn.IdMovimentacao_Financeira\n    Or Tfn.IdMovimentacao_Debito = Mfn.IdMovimentacao_Financeira\nJoin\n  @Contas_CWB Cwb On Cwb.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  Mfn.IdEmpresa_Sistema <> @IdEmpresa_CWB\n\nUpdate mov_Movimentacao_Financeira\nSet \n  IdEmpresa_Sistema = @IdEmpresa_SPO\nFrom\n  mov_Movimentacao_Financeira Mfn\nJoin\n  mov_Transferencia_Financeira Tfn On Tfn.IdMovimentacao_Credito = Mfn.IdMovimentacao_Financeira\n    Or Tfn.IdMovimentacao_Debito = Mfn.IdMovimentacao_Financeira\nJoin\n  @Contas_SPO Spo On Spo.IdConta_Corrente = Mfn.IdConta_Corrente\nWhere\n  Mfn.IdEmpresa_Sistema <> @IdEmpresa_SPO\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Script para log em cascata.txt",
        "conteudo": "Select\n  Ltb.*,\n  Dlg.query('.')\nFrom\n  sys_Log_Tabela Ltb\nCross Apply\n  Dados_Log.nodes('/Log/Tabela\n    [@Nome=\"cad_Cargo\"]\n    [Campo[@Nome=\"IdCargo\"][@Value=\"20\"]]') as Dados_Log(Dlg)"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\SQL Viagens.sql",
        "conteudo": "Declare \n  @IdLogistica_House IdLongo,\n  @IdLogistica_Master IdLongo,\n  @Precedencia Smallint\n\nSet @IdLogistica_House = :IdLogistica_House\nSet @IdLogistica_Master = :IdLogistica_Master\nSet @Precedencia = 0\n\nSet NoCount On;\n\nIF @IdLogistica_House = 0\n  Select \n    @IdLogistica_House = Lhs.IdLogistica_House\n  From\n    mov_Logistica_House Lhs\n  Where\n    Lhs.IdLogistica_Master = @IdLogistica_Master\n\nDeclare @Pernada_Ordenacao Table\n(\n  IdLogistica_Maritima_Transbordo Integer,\n  IdLogistica_Aerea_Escala Integer,\n  IdOrigem Integer,\n  IdDestino Integer,\n  Precedencia Smallint\n)\n\nInsert Into @Pernada_Ordenacao\n  (IdLogistica_Maritima_Transbordo, IdLogistica_Aerea_Escala, IdOrigem, IdDestino, Precedencia)\nSelect\n  Lmt.IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lmt.IdPorto_Transbordo As IdOrigem,\n  Lmt.IdPorto_Desembarque As IdDestino,\n  0 As Precedencia\nFrom\n  mov_Logistica_Maritima_Transbordo Lmt\nJoin\n  mov_Logistica_House Lhs On Lhs.IdLogistica_Master = Lmt.IdLogistica_Master\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nUnion All\nSelect\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  Lae.IdLogistica_Aerea_Escala,\n  Lae.IdAeroporto_Origem As IdOrigem,\n  Lae.IdAeroporto_Destino As IdDestino,\n  0 As Precedencia\nFrom\n  mov_Logistica_Aerea_Escala Lae\nJoin\n  mov_Logistica_House Lhs On Lhs.IdLogistica_Master = Lae.IdLogistica_Master\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House;\n\nWHILE @@ROWCOUNT > 0\nBEGIN\n  Set @Precedencia = @Precedencia + 1\n\n  Update @Pernada_Ordenacao\n  Set\n    Precedencia = @Precedencia\n  Where\n    IdLogistica_Maritima_Transbordo in\n      (Select\n        Dst.IdLogistica_Maritima_Transbordo\n      From\n        @Pernada_Ordenacao Org\n      Join\n        @Pernada_Ordenacao Dst On Dst.IdOrigem = Org.IdDestino\n      Where\n        Org.Precedencia = (@Precedencia - 1))\n  Or\n    IdLogistica_Aerea_Escala in\n      (Select\n        Dst.IdLogistica_Aerea_Escala\n      From\n        @Pernada_Ordenacao Org\n      Join\n        @Pernada_Ordenacao Dst On Dst.IdOrigem = Org.IdDestino\n      Left Outer Join\n        mov_Logistica_House Lhs On Lhs.IdLogistica_House = @IdLogistica_House\n      Left Outer Join\n        mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\n      Where\n        Org.Precedencia = (@Precedencia - 1))\nEND;\n\nSet NoCount Off;\n\n/* TRANSBORDOS */\nWITH TransbordosEscalas (IdLogistica_Maritima_Transbordo,\n  IdLogistica_Aerea_Escala,\n  IdLogistica_Master,\n  IdCompanhia_Transporte,\n  IdOrigem, \n  IdDestino, \n  Data_Previsao_Chegada,\n  Data_Chegada,\n  Data_Previsao_Embarque, \n  Data_Embarque, \n  Data_Previsao_Desembarque, \n  Data_Desembarque, \n  Numero_Conhecimento, \n  IdNavio, \n  Viagem_Voo, \n  Tipo_Servico,\n  Modalidade_Transporte,\n  Indice) \nAs \n(Select\n  Lmt.IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lmt.IdLogistica_Master,\n  CAST(NULL As Integer) As IdCompanhia_Transporte,\n  Lmt.IdPorto_Transbordo As IdOrigem,\n  Lmt.IdPorto_Desembarque As IdDestino,\n  Lmt.Data_Previsao_Chegada,\n  Lmt.Data_Chegada,\n  Lmt.Data_Previsao_Embarque,\n  Lmt.Data_Embarque,\n  Lmt.Data_Previsao_Desembarque,\n  Lmt.Data_Desembarque,\n  Lmt.Numero_BL As Numero_Conhecimento,\n  Lmt.IdNavio,\n  Lmt.Viagem As Viagem_Voo,\n  Lmt.Tipo As Tipo_Servico,\n  Lms.Modalidade_Processo As Modalidade_Transporte,\n  ROW_NUMBER() OVER(PARTITION BY Lmt.IdLogistica_Master ORDER BY\n    Por.Precedencia,\n    Case /* Indicador da Data Chegada */\n      When COALESCE(Lmt.Data_Chegada, Lmt.Data_Previsao_Chegada) Is NULL Then 1\n      Else 0\n    End,\n    Case /* Indicador da Data Embarque */\n      When COALESCE(Lmt.Data_Embarque, Lmt.Data_Previsao_Embarque) Is NULL Then 1\n      Else 0\n    End,\n    COALESCE(Lmt.Data_Chegada, Lmt.Data_Previsao_Chegada),\n    COALESCE(Lmt.Data_Embarque, Lmt.Data_Previsao_Embarque),\n    Lmt.IdLogistica_Maritima_Transbordo\n  ) As Indice\nFrom\n  @Pernada_Ordenacao Por\nJoin\n  mov_Logistica_Maritima_Transbordo Lmt On Lmt.IdLogistica_Maritima_Transbordo = Por.IdLogistica_Maritima_Transbordo\nJoin\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lmt.IdLogistica_Master\nUnion All\nSelect\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  Lae.IdLogistica_Aerea_Escala,\n  Lae.IdLogistica_Master,\n  Lae.IdCompanhia_Aerea As IdCompanhia_Transporte,\n  Lae.IdAeroporto_Origem As IdOrigem,\n  Lae.IdAeroporto_Destino As IdDestino,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Chegada,\n  CAST(NULL As SmallDateTime) As Data_Chegada,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Embarque,\n  Lae.Data As Data_Embarque,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Desembarque,\n  Lae.Data_Chegada As Data_Desembarque,\n  CAST(NULL As VarChar(25)) As Numero_Conhecimento,\n  CAST(NULL As Smallint) As IdNavio,\n  Lae.Numero_Voo As Viagem_Voo,\n  CAST(NULL As Tinyint) As Tipo_Servico,\n  COALESCE(Lae.Modalidade, 1 /* Aérea */) As Modalidade_Transporte,\n  ROW_NUMBER() OVER(PARTITION BY Lae.IdLogistica_Master ORDER BY\n    Por.Precedencia,\n    Case /* Indicador da Data */\n      When Lae.Data Is NULL Then 1\n      Else 0\n    End,\n    Case /* Indicador da Data Embarque */\n      When Lae.Data_Chegada Is NULL Then 1\n      Else 0\n    End,\n    Lae.Data,\n    Lae.Data_Chegada,\n    Lae.IdLogistica_Aerea_Escala\n  ) As Indice\nFrom\n  @Pernada_Ordenacao Por\nJoin\n  mov_Logistica_Aerea_Escala Lae On Lae.IdLogistica_Aerea_Escala = Por.IdLogistica_Aerea_Escala \n),\nViagens (IdLogistica_Viagem,\n  Tipo_Viagem,\n  IdLogistica_House,\n  IdLogistica_Maritima_Transbordo,\n  IdLogistica_Aerea_Escala,\n  IdCompanhia_Transporte,\n  IdOrigem,\n  IdDestino,\n  Data_Previsao_Embarque,\n  Data_Embarque,\n  Data_Previsao_Desembarque,\n  Data_Desembarque,\n  Tipo_Servico,\n  Modalidade_Transporte,\n  Situacao_Embarque, \n  Precedencia,\n  Programado,\n  Local_Coleta,\n  Local_Entrega,\n  IdNavio,\n  IdViagem_Navio,\n  Viagem_Voo,\n  Numero_Controle,\n  Numero_Conhecimento)\nAs \n(/* COLETA */\nSelect\n  Lvg.IdLogistica_Viagem,\n  1 /* Coleta */ As Tipo_Viagem,\n  Lhs.IdLogistica_House,\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lhs.IdTransportadora_Origem As IdCompanhia_Transporte,\n  CAST(NULL As SmallInt) As IdOrigem,\n  CAST(NULL As SmallInt) As IdDestino,\n  Lhs.Data_Previsao_Coleta As Data_Previsao_Embarque,\n  Lhs.Data_Coleta As Data_Embarque,\n  Lhs.Data_Previsao_Entrega_Origem As Data_Previsao_Desembarque,\n  Lhs.Data_Entrega_Origem As Data_Desembarque,\n  Lhs.Tipo_Coleta_Entrega As Tipo_Servico,\n  Case\n    When Lhs.Modalidade_Coleta = 2 /* All rail */ Then 4 /* Ferroviário */\n    Else 3 /* Rodoviário */\n  End As Modalidade_Transporte,\n  0 As Situacao_Embarque, \n  1 As Precedencia,\n  CAST(1 As Bit) As Programado,\n  Lhs.Local_Coleta As Local_Coleta,\n  Lhs.Local_Entrega_Origem As Local_Entrega,\n  CAST(NULL As SmallInt) As IdNavio,\n  CAST(NULL As Integer) As IdViagem_Navio,\n  CAST(NULL As VarChar(25)) As Viagem_Voo,\n  CAST(NULL As VarChar(25)) As Numero_Controle,\n  CAST(NULL As VarChar(25)) As Numero_Conhecimento\nFrom\n  mov_Logistica_House Lhs\nLeft Outer Join\n  mov_Logistica_Viagem Lvg On Lvg.IdLogistica_House = @IdLogistica_House \n    And Lvg.Tipo_Viagem = 1 /* Coleta */\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nAnd\n  ((Not Lhs.Data_Previsao_Coleta Is NULL) \n  Or (Not Lhs.Data_Coleta Is NULL) \n  Or (Not Lhs.Data_Previsao_Entrega_Origem Is NULL) \n  Or (Not Lhs.Data_Entrega_Origem Is NULL)\n  Or (LTRIM(RTRIM(CAST(Lhs.Local_Coleta As VarChar(MAX)))) <> '')\n  Or (LTRIM(RTRIM(CAST(Lhs.Local_Entrega_Origem As VarChar(MAX)))) <> '')\n  Or (Not Lhs.IdTransportadora_Origem Is NULL))\nUnion All\n/* LOCAL RECEBIMENTO */\nSelect\n  Lvg.IdLogistica_Viagem,\n  3 /* Local recebimento */ As Tipo_Viagem,\n  Lhs.IdLogistica_House,\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lms.IdCompanhia_Transporte As IdCompanhia_Transporte,\n  Lms.IdLocal_Recebimento As IdOrigem,\n  Lms.IdOrigem As IdDestino,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Embarque,\n  CAST(NULL As SmallDateTime) As Data_Embarque,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Desembarque,\n  CAST(NULL As SmallDateTime) As Data_Desembarque,\n  CAST(NULL As TinyInt) As Tipo_Servico,\n  3 /* Rodoviário */ As Modalidade_Transporte,\n  0 As Situacao_Embarque, \n  1 As Precedencia,\n  CAST(1 As Bit) As Programado,\n  CAST(NULL As text) As Local_Coleta,\n  CAST(NULL As text) As Local_Entrega,\n  CAST(NULL As SmallInt) As IdNavio,\n  CAST(NULL As Integer) As IdViagem_Navio,\n  CAST(NULL As VarChar(25)) As Viagem_Voo,\n  CAST(NULL As VarChar(25)) As Numero_Controle,\n  CAST(NULL As VarChar(25)) As Numero_Conhecimento\nFrom\n  mov_Logistica_House Lhs\nJoin\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Viagem Lvg On Lvg.IdLogistica_House = Lhs.IdLogistica_House \n    And Lvg.Tipo_Viagem = 3 /* Local recebimento */\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nAnd\n  Lms.IdLocal_Recebimento <> 0\nAnd \n  Lms.IdLocal_Recebimento <> Lms.IdOrigem\nUnion All\n/* EMBARQUE INICIAL */\nSelect\n  Lvg.IdLogistica_Viagem,\n  4 /* Embarque inicial */ As Tipo_Viagem,\n  Lhs.IdLogistica_House,\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lms.IdCompanhia_Transporte As IdCompanhia_Transporte,\n  Lms.IdOrigem,\n  Case\n    When ((Lms.Modalidade_Processo = 1 /* Aéreo */) And (Trb.IdLogistica_Aerea_Escala Is NULL))\n      Or ((Lms.Modalidade_Processo = 2 /* Marítimo */) And (Trb.IdLogistica_Maritima_Transbordo Is NULL)) Then Lms.IdDestino\n    When ((Lms.Modalidade_Processo = 1 /* Aéreo */) And (Trb.IdOrigem = Lms.IdOrigem)) Then Trb.IdDestino\n    Else Trb.IdOrigem\n  End As IdDestino,\n  Lms.Data_Previsao_Embarque,\n  Lms.Data_Embarque,\n  Case\n    When ((Lms.Modalidade_Processo = 1 /* Aéreo */) And (Trb.IdLogistica_Aerea_Escala Is NULL)) \n      Or ((Lms.Modalidade_Processo = 2 /* Marítimo */) And (Trb.IdLogistica_Maritima_Transbordo Is NULL)) Then Lms.Data_Previsao_Desembarque\n    Else Trb.Data_Previsao_Chegada\n  End As Data_Previsao_Desembarque,\n  Case\n    When Trb.IdLogistica_Maritima_Transbordo Is NULL Then Lms.Data_Desembarque\n    Else Trb.Data_Chegada\n  End As Data_Desembarque,\n  CAST(NULL As TinyInt) As Tipo_Servico,\n  Lms.Modalidade_Processo As Modalidade_Transporte,\n  0 As Situacao_Embarque, \n  1 As Precedencia,\n  CAST(1 As Bit) As Programado,\n  CAST(NULL As Text) As Local_Coleta,\n  CAST(NULL As Text) As Local_Entrega,\n  Lmm.IdNavio,\n  Lmm.IdViagem_Navio,\n  Case\n    When Lms.Modalidade_Processo = 2 /* Marítimo*/ Then Lmm.Viagem_Navio\n    When Lms.Modalidade_Processo = 1 /* Aéreo */ Then Trb.Viagem_Voo\n  End As Viagem_Voo,\n  Lms.Numero_Reserva As Numero_Controle,\n  Lms.Numero_Conhecimento\nFrom\n  mov_Logistica_House Lhs\nJoin\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Maritima_Master Lmm On Lmm.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  TransbordosEscalas Trb On Trb.IdLogistica_Master = Lhs.IdLogistica_Master\n    And Trb.Indice = 1\nLeft Outer Join\n  mov_Logistica_Viagem Lvg On Lvg.IdLogistica_House = Lhs.IdLogistica_House \n    And Lvg.Tipo_Viagem = 4 /* Embarque inicial */\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nUnion All\n/* TRANSBORDOS / ESCALAS */\nSelect\n  Lvg.IdLogistica_Viagem,\n  5 /* Transbordo/Escala */ As Tipo_Viagem,\n  Lhs.IdLogistica_House,\n  Trb.IdLogistica_Maritima_Transbordo,\n  Trb.IdLogistica_Aerea_Escala,\n  COALESCE(Trb.IdCompanhia_Transporte, Lms.IdCompanhia_Transporte) As IdCompanhia_Transporte,\n  Trb.IdOrigem As IdOrigem,\n  Case\n    When ((Lms.Modalidade_Processo = 1 /* Aéreo */) And (Not (Tpr.IdLogistica_Aerea_Escala Is NULL)))\n      Or ((Lms.Modalidade_Processo = 2 /* Marítimo*/) And (Not (Tpr.IdLogistica_Maritima_Transbordo Is NULL))) Then COALESCE(Trb.IdDestino, Tpr.IdOrigem)\n    Else COALESCE(Trb.IdDestino, Lms.IdDestino)\n  End As IdDestino,\n  Trb.Data_Previsao_Embarque,\n  Trb.Data_Embarque,\n  Case\n    When ((Lms.Modalidade_Processo = 2 /* Marítimo */) And (Not (Tpr.IdLogistica_Maritima_Transbordo Is NULL))) Then COALESCE(Trb.Data_Previsao_Desembarque, Tpr.Data_Previsao_Chegada)\n    When (Tpr.IdLogistica_Maritima_Transbordo Is NULL) And (Tpr.IdLogistica_Aerea_Escala Is NULL) Then COALESCE(Trb.Data_Previsao_Desembarque, Lms.Data_Previsao_Desembarque)\n    Else Trb.Data_Previsao_Desembarque\n  End As Data_Previsao_Desembarque,\n  Case\n    When ((Lms.Modalidade_Processo = 1 /* Aéreo */) And (Not (Tpr.IdLogistica_Aerea_Escala Is NULL))) Then COALESCE(Trb.Data_Desembarque, Tpr.Data_Embarque)\n    When ((Lms.Modalidade_Processo = 2 /* Marítimo */) And (Not (Tpr.IdLogistica_Maritima_Transbordo Is NULL))) Then COALESCE(Trb.Data_Desembarque, Tpr.Data_Chegada)\n    Else COALESCE(Trb.Data_Desembarque, Lms.Data_Desembarque)\n  End As Data_Desembarque,\n  Trb.Tipo_Servico,\n  Lms.Modalidade_Processo As Modalidade_Transporte,\n  0 As Situacao_Embarque, \n  Trb.Indice As Precedencia,\n  CAST(1 As Bit) As Programado,\n  CAST(NULL As Text) As Local_Coleta,\n  CAST(NULL As Text) As Local_Entrega,\n  Trb.IdNavio,\n  CAST(NULL As Integer) As IdViagem_Navio,\n  Trb.Viagem_Voo,\n  CAST(NULL As VarChar(25)) As Numero_Controle,\n  Trb.Numero_Conhecimento\nFrom\n  TransbordosEscalas Trb\nJoin\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Trb.IdLogistica_Master\nJoin\n  mov_Logistica_House Lhs On Lhs.IdLogistica_Master = Lms.IdLogistica_Master\nLeft Outer Join\n  TransbordosEscalas Tpr On Tpr.Indice = (Trb.Indice + 1)\nLeft Outer Join\n  mov_Logistica_Viagem Lvg On Lvg.IdLogistica_Maritima_Transbordo = Trb.IdLogistica_Maritima_Transbordo\n    Or Lvg.IdLogistica_Aerea_Escala = Trb.IdLogistica_Aerea_Escala\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nAnd\n  Trb.IdOrigem <> Lms.IdOrigem\nUnion All\n/* DESTINO FINAL */\nSelect\n  Lvg.IdLogistica_Viagem,\n  6 /* Destino final */ As Tipo_Viagem,\n  Lhs.IdLogistica_House,\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lms.IdCompanhia_Transporte As IdCompanhia_Transporte,\n  Lms.IdDestino As IdOrigem,\n  Lms.IdDestino_Final As IdDestino,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Embarque,\n  CAST(NULL As SmallDateTime) As Data_Embarque,\n  CAST(NULL As SmallDateTime) As Data_Previsao_Desembarque,\n  CAST(NULL As SmallDateTime) As Data_Desembarque,\n  CAST(NULL As TinyInt) As Tipo_Servico,\n  3 /* Rodoviário */ As Modalidade_Transporte,\n  0 As Situacao_Embarque,  \n  1 As Precedencia,\n  CAST(1 As Bit) As Programado,\n  CAST(NULL As Text) As Local_Coleta,\n  CAST(NULL As Text) As Local_Entrega,\n  CAST(NULL As SmallInt) As IdNavio,\n  CAST(NULL As Integer) As IdViagem_Navio,\n  CAST(NULL As VarChar(25)) As Viagem_Voo,\n  CAST(NULL As VarChar(25)) As Numero_Controle,\n  CAST(NULL As VarChar(25)) As Numero_Conhecimento\nFrom\n  mov_Logistica_House Lhs\nJoin\n  mov_Logistica_Master Lms On Lms.IdLogistica_Master = Lhs.IdLogistica_Master\nLeft Outer Join\n  mov_Logistica_Viagem Lvg On Lvg.IdLogistica_House = Lhs.IdLogistica_House \n    And Lvg.Tipo_Viagem = 6 /* Destino Final */\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nAnd\n  Lms.IdDestino_Final <> 0\nAnd\n  Lms.IdDestino_Final <> Lms.IdDestino\nUnion All\n/* ENTREGA */\nSelect\n  Lvg.IdLogistica_Viagem,\n  8 /* Entrega */ As Tipo_Viagem,\n  Lhs.IdLogistica_House,\n  CAST(NULL As Integer) As IdLogistica_Maritima_Transbordo,\n  CAST(NULL As Integer) As IdLogistica_Aerea_Escala,\n  Lhs.IdTransportadora_Destino As IdCompanhia_Transporte,\n  CAST(NULL As SmallInt) As IdOrigem,\n  CAST(NULL As SmallInt) As IdDestino,\n  Lhs.Data_Previsao_Coleta_Destino As Data_Previsao_Embarque,\n  Lhs.Data_Coleta_Destino As Data_Embarque,\n  Lhs.Data_Previsao_Entrega As Data_Previsao_Desembarque,\n  Lhs.Data_Entrega As Data_Desembarque,\n  Lhs.Tipo_Coleta_Entrega_Destino As Tipo_Servico,\n  Case\n    When Lhs.Modalidade_Coleta = 2 /* All rail */ Then 4 /* Ferroviário */\n    Else 3 /* Rodoviário */\n  End As Modalidade_Transporte,\n  0 As Situacao_Embarque, \n  1 As Precedencia,\n  CAST(1 As Bit) As Programado,\n  Lhs.Local_Coleta_Destino As Local_Coleta,\n  Lhs.Local_Entrega As Local_Entrega,\n  CAST(NULL As SmallInt) As IdNavio,\n  CAST(NULL As Integer) As IdViagem_Navio,\n  CAST(NULL As VarChar(25)) As Viagem_Voo,\n  CAST(NULL As VarChar(25)) As Numero_Controle,\n  CAST(NULL As VarChar(25)) As Numero_Conhecimento\nFrom\n  mov_Logistica_House Lhs\nLeft Outer Join\n  mov_Logistica_Viagem Lvg On Lvg.IdLogistica_House = @IdLogistica_House \n    And Lvg.Tipo_Viagem = 8 /* Entrega */\nWhere\n  Lhs.IdLogistica_House = @IdLogistica_House\nAnd\n  ((Not Lhs.Data_Previsao_Coleta_Destino Is NULL) \n  Or (Not Lhs.Data_Coleta_Destino Is NULL) \n  Or (Not Lhs.Data_Previsao_Entrega Is NULL) \n  Or (Not Lhs.Data_Entrega Is NULL)\n  Or (LTRIM(RTRIM(CAST(Lhs.Local_Coleta_Destino As VarChar(MAX)))) <> '')\n  Or (LTRIM(RTRIM(CAST(Lhs.Local_Entrega As VarChar(MAX)))) <> '')\n  Or (Not Lhs.IdTransportadora_Destino Is NULL))\n)\nSelect\n  ROW_NUMBER() OVER(ORDER BY Vgm.Tipo_Viagem, Vgm.Precedencia) As Indice,\n  CAST(0 As Bit) As Excluir,\n\n  Vgm.IdLogistica_Viagem,\n  Vgm.Tipo_Viagem,\n  Vgm.IdLogistica_House,\n  Vgm.IdLogistica_Maritima_Transbordo,\n  Vgm.IdLogistica_Aerea_Escala,\n  Vgm.IdCompanhia_Transporte,\n  Vgm.IdOrigem,\n  Vgm.IdDestino,\n  Vgm.Data_Previsao_Embarque,\n  Vgm.Data_Embarque,\n  Vgm.Data_Previsao_Desembarque,\n  Vgm.Data_Desembarque,\n  Vgm.Tipo_Servico,\n  Vgm.Modalidade_Transporte,\n  Vgm.Situacao_Embarque, \n  Vgm.Precedencia,\n  Vgm.Programado,\n  Vgm.Local_Coleta,\n  Vgm.Local_Entrega,\n  Vgm.IdNavio,\n  Vgm.IdViagem_Navio,\n  Vgm.Viagem_Voo,\n  Vgm.Numero_Controle,\n  Vgm.Numero_Conhecimento\nFrom\n  Viagens Vgm\nLeft Outer Join\n  cad_Origem_Destino Org On Org.IdOrigem_Destino = Vgm.IdOrigem\nLeft Outer Join\n  cad_Origem_Destino Dst On Dst.IdOrigem_Destino = Vgm.IdDestino\nUnion All\nSelect\n  NULL As Indice,\n  CAST(1 As Bit) As Excluir,\n\n  NULL As IdLogistica_Viagem,\n  NULL As Tipo_Viagem,\n  NULL As IdLogistica_House,\n  NULL As IdLogistica_Maritima_Transbordo,\n  NULL As IdLogistica_Aerea_Escala,\n  NULL As IdCompanhia_Transporte,\n  NULL As IdOrigem,\n  NULL As IdDestino,\n  NULL As Data_Previsao_Embarque,\n  NULL As Data_Embarque,\n  NULL As Data_Previsao_Desembarque,\n  NULL As Data_Desembarque,\n  NULL As Tipo_Servico,\n  NULL As Modalidade_Transporte,\n  NULL As Situacao_Embarque, \n  NULL As Precedencia,\n  NULL As Programado,\n  NULL As Local_Coleta,\n  NULL As Local_Entrega,\n  NULL As IdNavio,\n  NULL As IdViagem_Navio,\n  NULL As Viagem_Voo,\n  NULL As Numero_Controle,\n  NULL As Numero_Conhecimento\nFrom\n  mov_Logistica_Viagem Lvg\nWhere\n  Lvg.IdLogistica_House = @IdLogistica_House\nAnd\n  Not Lvg.IdLogistica_Viagem In (\n    Select\n      Vgm.IdLogistica_Viagem\n    From\n      Viagens Vgm\n  )"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Tarifários marítimos e suas taxas no formato da planilha padrao excel.sql",
        "conteudo": "-- Script para obter os tarifários marítimos e suas taxas\n-- Max 2022-05-31\n\n\nSELECT \n\tCOALESCE(FORMAT(Tod.Data_Inicio_Vigencia, 'yyyy-MM-dd'), '') as Data_Inicio_Vigencia,\n\tCOALESCE(FORMAT(Tod.Data_Validade, 'yyyy-MM-dd'), '') as Data_Validade,\n\tCOALESCE(Arm.Nome , '') as Amador,\n\tCOALESCE(CASE WHEN Tod.Tipo_Pessoa = '4' /*Cliente*/ THEN Cli.Nome END, '') as Cliente,\n\tCOALESCE(CASE WHEN Tod.Tipo_Pessoa = '3' /*Representante*/ THEN Rpr.Nome END, '') as Representante,\n\tCOALESCE(CASE WHEN Tod.Tipo_Pessoa = '2' /*Empresa*/ THEN Emp.Nome END, '') as Empresa,\n\tCASE \n\t\tWHEN Tod.Tipo_Operacao = '1' THEN 'Exportação'\n\t\tWHEN Tod.Tipo_Operacao = '2' THEN 'Importação'\n\tEND as Tipo_Operacao,\n\tCASE \n\t\tWHEN Tod.Tipo_Tarifario = '3' THEN 'Local de recebimento'\n\t\tWHEN Tod.Tipo_Tarifario = '1' THEN 'Origem'\n\t\tWHEN Tod.Tipo_Tarifario = '2' THEN 'Destino'\n\t\tWHEN Tod.Tipo_Tarifario = '4' THEN 'Destino final'\n\tEND as Tipo_Tarifario,\n\tCOALESCE(Ods.Nome, '') as Porto,\n\tTlg.Nome as Taxa,\n\tCOALESCE(Emr.Descricao , '') as Equipamento,\n\tCASE \n\t\tWHEN Ttx.Tipo_Pagamento = '1' THEN '(Sem cobrança)'\n\t\tWHEN Ttx.Tipo_Pagamento = '7' THEN 'Conhecimento'\n\t\tWHEN Ttx.Tipo_Pagamento = '10' THEN 'Container'\n\t\tWHEN Ttx.Tipo_Pagamento = '8' THEN 'Invoice'\n\t\tWHEN Ttx.Tipo_Pagamento = '14' THEN 'Livre'\n\t\tWHEN Ttx.Tipo_Pagamento = '6' THEN 'Metro cúbico'\n\t\tWHEN Ttx.Tipo_Pagamento = '13' THEN 'Percentual'\n\t\tWHEN Ttx.Tipo_Pagamento = '5' THEN 'Peso bruto'\n\t\tWHEN Ttx.Tipo_Pagamento = '23' THEN 'Peso bruto/ton.'\n\t\tWHEN Ttx.Tipo_Pagamento = '17' THEN 'Peso considerado'\n\t\tWHEN Ttx.Tipo_Pagamento = '3' THEN 'Peso cubado'\n\t\tWHEN Ttx.Tipo_Pagamento = '4' THEN 'Peso taxado house'\n\t\tWHEN Ttx.Tipo_Pagamento = '18' THEN 'Peso taxado master'\n\t\tWHEN Ttx.Tipo_Pagamento = '2' THEN 'Processo'\n\t\tWHEN Ttx.Tipo_Pagamento = '12' THEN 'TEU'\n\t\tWHEN Ttx.Tipo_Pagamento = '11' THEN 'Tipo de equipamento'\n\t\tWHEN Ttx.Tipo_Pagamento = '9' THEN 'Volume'\n\t\tWHEN Ttx.Tipo_Pagamento = '16' THEN 'Via house'\n\t\tWHEN Ttx.Tipo_Pagamento = '15' THEN 'Via master'\n\t\tELSE ''\n\tEND as Tipo_Pagamento,\n\tCOALESCE(Mpg.Sigla , '') as Moeda_Pagamento,\n\tCOALESCE(CAST(Ttx.Valor_Pagamento_Unitario as VARCHAR(50)), '') as  Valor_Pagamento,\n\tCOALESCE(CAST(Ttx.Valor_Pagamento_Minimo as VARCHAR(50)), '') as Valor_Pagamento_Minimo,\n\tCASE \n\t\tWHEN Ttx.Tipo_Pagamento = '1' THEN '(Sem cobrança)'\n\t\tWHEN Ttx.Tipo_Pagamento = '7' THEN 'Conhecimento'\n\t\tWHEN Ttx.Tipo_Pagamento = '10' THEN 'Container'\n\t\tWHEN Ttx.Tipo_Pagamento = '8' THEN 'Invoice'\n\t\tWHEN Ttx.Tipo_Pagamento = '14' THEN 'Livre'\n\t\tWHEN Ttx.Tipo_Pagamento = '6' THEN 'Metro cúbico'\n\t\tWHEN Ttx.Tipo_Pagamento = '13' THEN 'Percentual'\n\t\tWHEN Ttx.Tipo_Pagamento = '5' THEN 'Peso bruto'\n\t\tWHEN Ttx.Tipo_Pagamento = '23' THEN 'Peso bruto/ton.'\n\t\tWHEN Ttx.Tipo_Pagamento = '17' THEN 'Peso considerado'\n\t\tWHEN Ttx.Tipo_Pagamento = '3' THEN 'Peso cubado'\n\t\tWHEN Ttx.Tipo_Pagamento = '4' THEN 'Peso taxado house'\n\t\tWHEN Ttx.Tipo_Pagamento = '18' THEN 'Peso taxado master'\n\t\tWHEN Ttx.Tipo_Pagamento = '2' THEN 'Processo'\n\t\tWHEN Ttx.Tipo_Pagamento = '12' THEN 'TEU'\n\t\tWHEN Ttx.Tipo_Pagamento = '11' THEN 'Tipo de equipamento'\n\t\tWHEN Ttx.Tipo_Pagamento = '9' THEN 'Volume'\n\t\tWHEN Ttx.Tipo_Pagamento = '16' THEN 'Via house'\n\t\tWHEN Ttx.Tipo_Pagamento = '15' THEN 'Via master'\n\t\tELSE ''\n\tEND as Tipo_Recebimento,\n\tCOALESCE(Mrc.Sigla , '') as Moeda_Recebimento,\n\tCOALESCE(CAST(Ttx.Valor_Recebimento_Unitario as VARCHAR(50)), '') as Valor_Recebimento,\n\tCOALESCE(CAST(Ttx.Valor_Recebimento_Minimo as VARCHAR(50)), '') as Valor_Recebimento_Minimo,\n\tCASE \n\t\tWHEN Ttx.Tipo_Pagamento = '1' THEN 'Valor fixo'\n\t\tWHEN Ttx.Tipo_Pagamento = '2' THEN 'Valor mínimo compra'\n\t\tWHEN Ttx.Tipo_Pagamento = '3' THEN 'Repasse compra'\n\t\tWHEN Ttx.Tipo_Pagamento = '4' THEN 'Valor acréscimo compra'\n\t\tWHEN Ttx.Tipo_Pagamento = '5' THEN '% acréscimo compra'\n\t\tELSE ''\n\tEND as Tipo_Valor_Recebimento\n\nfrom \n\tmov_Tarifario_Origem_Destino Tod -- pág 162 Dic de dados\nleft outer join\n\tcad_Pessoa Arm ON Arm.IdPessoa = Tod.IdCompanhia_Transporte -- Armador\nleft outer join\n\tcad_Pessoa Pes ON Pes.IdPessoa = Tod.IdPessoa -- (Não informado)\nleft outer join\n\tcad_Pessoa Agn ON Agn.IdPessoa = Tod.IdPessoa -- Agente\nleft outer join\n\tcad_Pessoa Emp ON Emp.IdPessoa = Tod.IdPessoa -- Empresa\nleft outer join\n\tcad_Pessoa Rpr ON Rpr.IdPessoa = Tod.IdPessoa -- Representante\nleft outer join\n\tcad_Pessoa Cli ON Cli.IdPessoa = Tod.IdPessoa -- Cliente\nleft outer join\n\tcad_Origem_Destino Ods ON Ods.IdOrigem_Destino = Tod.IdOrigem_Destino\n\n-- TAXAS\nleft outer join\n\tmov_Tarifario_Taxa Ttx ON Ttx.IdTarifario_Origem_Destino = Tod.IdTarifario_Origem_Destino\nleft outer join\n\tcad_Taxa_Logistica Tlg ON Tlg.IdTaxa_Logistica = Ttx.IdTaxa_Logistica\nleft outer join\n\tcad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Ttx.IdEquipamento_Maritimo\nleft outer join\n\tcad_Moeda Mpg ON Mpg.IdMoeda = Ttx.IdMoeda_Pagamento\nleft outer join\n\tcad_Moeda Mrc ON Mrc.IdMoeda = Ttx.IdMoeda_Recebimento\n\t\nWhere \n\tTod.Modalidade = 2 /*Marítimo*/\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Tarifários marítimos e suas taxas.sql",
        "conteudo": "-- Script para obter os tarifários marítimos e suas taxas\n-- Max 2022-05-31\n\n\nSELECT \n\tTod.IdTarifario_Origem_Destino,\n\tTtx.IdTaxa_Logistica,\n\tTod.Numero,\n\tCOALESCE(FORMAT(Tod.Data_Inicio_Vigencia, 'yyyy-MM-dd'), '') as Data_Inicio_Vigencia,\n\tCOALESCE(FORMAT(Tod.Data_Validade, 'yyyy-MM-dd'), '') as Data_Validade,\n\tCASE \n\t\tWHEN Tod.Tipo_Operacao = '1' THEN 'Exportação'\n\t\tWHEN Tod.Tipo_Operacao = '2' THEN 'Importação'\n\tEND as Tipo_Operacao,\n\tCOALESCE(Arm.Nome , '') as Amador,\n\tCASE \n\t\tWHEN Tod.Tipo_Tarifario = '3' THEN 'Local de recebimento'\n\t\tWHEN Tod.Tipo_Tarifario = '1' THEN 'Origem'\n\t\tWHEN Tod.Tipo_Tarifario = '2' THEN 'Destino'\n\t\tWHEN Tod.Tipo_Tarifario = '4' THEN 'Destino final'\n\tEND as Tipo_Tarifario,\n\tCOALESCE(Ods.Nome, '') as Porto,\n\tCASE \n\t\tWHEN Tod.Tipo_Pessoa = '0' THEN '(Não informado)'\n\t\tWHEN Tod.Tipo_Pessoa = '1' THEN 'Agente'\n\t\tWHEN Tod.Tipo_Pessoa = '2' THEN 'Empresa'\n\t\tWHEN Tod.Tipo_Pessoa = '3' THEN 'Representante'\n\t\tWHEN Tod.Tipo_Pessoa = '4' THEN 'Cliente'\n\t\tELSE ''\n\tEND as Tipo_Pessoa,\n\tCOALESCE(CASE \n\t\tWHEN Tod.Tipo_Pessoa = '0' /*Não informado*/ THEN Pes.Nome\n\t\tWHEN Tod.Tipo_Pessoa = '1' /*Agente*/ THEN Agn.Nome\n\t\tWHEN Tod.Tipo_Pessoa = '2' /*Empresa*/ THEN Emp.Nome\n\t\tWHEN Tod.Tipo_Pessoa = '3' /*Representante*/ THEN Rpr.Nome\n\t\tWHEN Tod.Tipo_Pessoa = '4' /*Cliente*/ THEN Cli.Nome\n\tEND, '') as Pessoa,\n\tTlg.Nome as Taxa,\n\tCOALESCE(Emr.Descricao , '') as Equipamento,\n\tCASE \n\t\tWHEN Ttx.Tipo_Pagamento = '1' THEN '(Sem cobrança)'\n\t\tWHEN Ttx.Tipo_Pagamento = '7' THEN 'Conhecimento'\n\t\tWHEN Ttx.Tipo_Pagamento = '10' THEN 'Container'\n\t\tWHEN Ttx.Tipo_Pagamento = '8' THEN 'Invoice'\n\t\tWHEN Ttx.Tipo_Pagamento = '14' THEN 'Livre'\n\t\tWHEN Ttx.Tipo_Pagamento = '6' THEN 'Metro cúbico'\n\t\tWHEN Ttx.Tipo_Pagamento = '13' THEN 'Percentual'\n\t\tWHEN Ttx.Tipo_Pagamento = '5' THEN 'Peso bruto'\n\t\tWHEN Ttx.Tipo_Pagamento = '23' THEN 'Peso bruto/ton.'\n\t\tWHEN Ttx.Tipo_Pagamento = '17' THEN 'Peso considerado'\n\t\tWHEN Ttx.Tipo_Pagamento = '3' THEN 'Peso cubado'\n\t\tWHEN Ttx.Tipo_Pagamento = '4' THEN 'Peso taxado house'\n\t\tWHEN Ttx.Tipo_Pagamento = '18' THEN 'Peso taxado master'\n\t\tWHEN Ttx.Tipo_Pagamento = '2' THEN 'Processo'\n\t\tWHEN Ttx.Tipo_Pagamento = '12' THEN 'TEU'\n\t\tWHEN Ttx.Tipo_Pagamento = '11' THEN 'Tipo de equipamento'\n\t\tWHEN Ttx.Tipo_Pagamento = '9' THEN 'Volume'\n\t\tWHEN Ttx.Tipo_Pagamento = '16' THEN 'Via house'\n\t\tWHEN Ttx.Tipo_Pagamento = '15' THEN 'Via master'\n\t\tELSE ''\n\tEND as Tipo_Pagamento,\n\tCOALESCE(Mpg.Sigla , '') as Moeda_Pagamento,\n\tCOALESCE(CAST(Ttx.Valor_Pagamento_Unitario as VARCHAR(50)), '') as  Valor_Pagamento,\n\tCOALESCE(CAST(Ttx.Valor_Pagamento_Minimo as VARCHAR(50)), '') as Valor_Pagamento_Minimo,\n\tCASE \n\t\tWHEN Ttx.Tipo_Pagamento = '1' THEN '(Sem cobrança)'\n\t\tWHEN Ttx.Tipo_Pagamento = '7' THEN 'Conhecimento'\n\t\tWHEN Ttx.Tipo_Pagamento = '10' THEN 'Container'\n\t\tWHEN Ttx.Tipo_Pagamento = '8' THEN 'Invoice'\n\t\tWHEN Ttx.Tipo_Pagamento = '14' THEN 'Livre'\n\t\tWHEN Ttx.Tipo_Pagamento = '6' THEN 'Metro cúbico'\n\t\tWHEN Ttx.Tipo_Pagamento = '13' THEN 'Percentual'\n\t\tWHEN Ttx.Tipo_Pagamento = '5' THEN 'Peso bruto'\n\t\tWHEN Ttx.Tipo_Pagamento = '23' THEN 'Peso bruto/ton.'\n\t\tWHEN Ttx.Tipo_Pagamento = '17' THEN 'Peso considerado'\n\t\tWHEN Ttx.Tipo_Pagamento = '3' THEN 'Peso cubado'\n\t\tWHEN Ttx.Tipo_Pagamento = '4' THEN 'Peso taxado house'\n\t\tWHEN Ttx.Tipo_Pagamento = '18' THEN 'Peso taxado master'\n\t\tWHEN Ttx.Tipo_Pagamento = '2' THEN 'Processo'\n\t\tWHEN Ttx.Tipo_Pagamento = '12' THEN 'TEU'\n\t\tWHEN Ttx.Tipo_Pagamento = '11' THEN 'Tipo de equipamento'\n\t\tWHEN Ttx.Tipo_Pagamento = '9' THEN 'Volume'\n\t\tWHEN Ttx.Tipo_Pagamento = '16' THEN 'Via house'\n\t\tWHEN Ttx.Tipo_Pagamento = '15' THEN 'Via master'\n\t\tELSE ''\n\tEND as Tipo_Recebimento,\n\tCOALESCE(Mrc.Sigla , '') as Moeda_Recebimento,\n\tCOALESCE(CAST(Ttx.Valor_Recebimento_Unitario as VARCHAR(50)), '') as Valor_Recebimento,\n\tCOALESCE(CAST(Ttx.Valor_Recebimento_Minimo as VARCHAR(50)), '') as Valor_Recebimento_Minimo,\n\tCASE \n\t\tWHEN Ttx.Tipo_Pagamento = '1' THEN 'Valor fixo'\n\t\tWHEN Ttx.Tipo_Pagamento = '2' THEN 'Valor mínimo compra'\n\t\tWHEN Ttx.Tipo_Pagamento = '3' THEN 'Repasse compra'\n\t\tWHEN Ttx.Tipo_Pagamento = '4' THEN 'Valor acréscimo compra'\n\t\tWHEN Ttx.Tipo_Pagamento = '5' THEN '% acréscimo compra'\n\t\tELSE ''\n\tEND as Tipo_Valor_Recebimento\n\nfrom \n\tmov_Tarifario_Origem_Destino Tod -- pág 162 Dic de dados\nleft outer join\n\tcad_Pessoa Arm ON Arm.IdPessoa = Tod.IdCompanhia_Transporte -- Armador\nleft outer join\n\tcad_Pessoa Pes ON Pes.IdPessoa = Tod.IdPessoa -- (Não informado)\nleft outer join\n\tcad_Pessoa Agn ON Agn.IdPessoa = Tod.IdPessoa -- Agente\nleft outer join\n\tcad_Pessoa Emp ON Emp.IdPessoa = Tod.IdPessoa -- Empresa\nleft outer join\n\tcad_Pessoa Rpr ON Rpr.IdPessoa = Tod.IdPessoa -- Representante\nleft outer join\n\tcad_Pessoa Cli ON Cli.IdPessoa = Tod.IdPessoa -- Cliente\nleft outer join\n\tcad_Origem_Destino Ods ON Ods.IdOrigem_Destino = Tod.IdOrigem_Destino\n\n-- TAXAS\nleft outer join\n\tmov_Tarifario_Taxa Ttx ON Ttx.IdTarifario_Origem_Destino = Tod.IdTarifario_Origem_Destino\nleft outer join\n\tcad_Taxa_Logistica Tlg ON Tlg.IdTaxa_Logistica = Ttx.IdTaxa_Logistica\nleft outer join\n\tcad_Equipamento_Maritimo Emr ON Emr.IdEquipamento_Maritimo = Ttx.IdEquipamento_Maritimo\nleft outer join\n\tcad_Moeda Mpg ON Mpg.IdMoeda = Ttx.IdMoeda_Pagamento\nleft outer join\n\tcad_Moeda Mrc ON Mrc.IdMoeda = Ttx.IdMoeda_Recebimento\n\t\nWhere \n\tTod.Modalidade = 2 /*Marítimo*/\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Transportes Comex.txt",
        "conteudo": "1) Transporte marítimo\nO transporte marítimo é um dos mais utilizados por ser o mais barato. \nAtravés dele é possível transportar mercadorias entre os portos no território brasileiro (navegação de cabotagem),\nnas hidrovias, realizando trajetos nacionais ou internacionais (navegação interior), \ne de portos brasileiros para outros países (navegação de longo curso).\n\nO valor a ser pago no transporte dependerá da carga que está sendo transportada,\nseu peso, volume, fragilidade, valor e distância do local da saída até a entrega.\nPara transportar qualquer mercadoria para outro país é preciso um documento\nconhecido como Bill of Lading (Conhecimento de embarque).\n\n2) Transporte aéreo\nO transporte aéreo é utilizado para algumas mercadorias que necessitam ser entregues com mais urgência.\nÉ possível fazer transportes por companhias associadas ou não-associadas pela International Air Transport Association (IATA) e por serviços fretados.\nOs que escolhem transportar suas mercadorias pelos serviços associados IATA pagam uma tarifa comum, que é baseada na rota e no serviço que está sendo oferecido e o valor é fixo.\n\nPara transportar cargas por transporte aéreo é necessário que um documento, chamado Airway Bill  AWB,\nseja assinado pelo agente e pelo exportador.\n\n3) Transporte ferroviário\nAs cargas são transportadas sobre trilhos, e é mais comum usar esse transporte para conduzir cargas para os países\nlimítrofes. Ele também é considerado mais barato.\n\nPara transportar algum produto através das ferrovias para os países do MERCOSUL, \né preciso apresentar uma Carta de Porte Internacional e Declaração de Transito aduaneiro (TIF/TODA).\nPara saber o valor do frete para o transporte na exportação é preciso entrar em contato \ncom a Rede Ferroviária Federal (RFFSA).\n\n4) Transporte Rodoviário\nEle é feito através de estradas, rodovias e ruas.\nÉ recomendável usar esse transporte quando for entregar mercadorias em lugares próximos,\ncom médias distâncias, e quando houver alguma urgência, \noferecendo agilidade e flexibilidade ao transportar essas cargas. \nO valor pago pelo frete depende do volume da carga."
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Update e Rollback estantâneo no banco.txt",
        "conteudo": "BEGIN TRAN TESTE\n\n-- CÓDIGO AQUI\n\nROLLBACK TRAN TESTE"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\Usuário logado.txt",
        "conteudo": "﻿  Fcn.Nome As Funcionario_Logado,\n  Fcn.Email As Email_Funcionario_Logado,  \n  Us.Nome As Usuario_Logado,\n\nLeft Outer Join\n  #Global_Var Gvr on Gvr.Variavel Like 'IdUsuario'\nLeft Outer Join\n  vis_Funcionario Fcn on Fcn.IdUsuario_Correspondente = Gvr.Valor\nLeft Outer Join\n  Sys_Usuario Us on Us.IdUsuario = Gvr.Valor"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\ACOMPANHAMENTO CRM\\Acompanhamento CRM.chd",
        "conteudo": "[Consulta]\nCaption=CRM\nTabela=mov_Pessoa_Acompanhamento\nCampos=10\nCommandText=Select,\"  Tbl2.IdAcompanhamento,\",\"  Tbl2.Data as Data,\",\"  DatePart(year, Tbl2.Data) as Ano,\",\"  DatePart(month, Tbl2.Data) as Mes,\",\"  DatePart(day, Tbl2.Data) as Dia,\",\"  Tbl2.Descricao as Descricao,\",\"  Tbl2.IdGrupo_Tarefa as Tbl2_IdGrupo_Tarefa,\",\"  Tbl4.Nome as Grupo_Tarefa,\",\"  Tbl2.IdResponsavel as Tbl2_IdResponsavel,\",\"  Tbl6.IdPessoa as Tbl6_IdPessoa,\",\"  Tbl9.Nome as Responsavel,\",\"  Tbl1.IdPessoa,\",\"  Tbl21.Nome as Cliente\",From,\"  cad_Pessoa_Contrato_Logistica Tbl1\",\"Left Outer Join\",\"  mov_Acompanhamento Tbl2 on Tbl2.IdProjeto_Atividade = Tbl1.IdProjeto_Atividade\",\"Left Outer Join\",\"  cad_Grupo_Tarefa Tbl4 on Tbl4.IdGrupo_Tarefa = Tbl2.IdGrupo_Tarefa\",\"Left Outer Join\",\"  cad_Funcionario Tbl6 on Tbl6.IdPessoa = Tbl2.IdResponsavel\",\"Left Outer Join\",\"  cad_Pessoa Tbl9 on Tbl9.IdPessoa = Tbl6.IdPessoa\",\"Left Outer Join\",\"  cad_Pessoa Tbl21 on Tbl21.IdPessoa = Tbl1.IdPessoa\",Where,\"  Tbl2.Descricao is not null \",\"order by\",\"  Tbl4.Nome,Tbl2.IdResponsavel,Tbl2.Data\"\n\n[Campos]\nCampo[0].FieldName=IdAcompanhamento\nCampo[0].Origin=Tbl1.IdAcompanhamento\nCampo[0].PrimaryKey=1\nCampo[0].Foreign.Enabled=1\nCampo[0].Foreign.Divisao=Acompanhamento\nCampo[0].Foreign.Campo=IdAcompanhamento\nCampo[0].Foreign.Tabela=mov_Acompanhamento\nCampo[1].FieldName=Data\nCampo[1].Origin=Tbl2.Data\nCampo[1].DisplayLabel=Data Inserção\nCampo[1].Join.Enabled=1\nCampo[1].Join.Result=Data\nCampo[1].Join.Search=IdAcompanhamento\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=80\nCampo[2].FieldName=Cliente\nCampo[2].Origin=Tbl21.Nome\nCampo[2].DisplayLabel=Cliente\nCampo[2].Join.Enabled=1\nCampo[2].Join.Result=Nome\nCampo[2].Join.Search=IdPessoa\nCampo[2].Width=200\nCampo[3].FieldName=Descricao\nCampo[3].Origin=Tbl2.Descricao\nCampo[3].DisplayLabel=Descrição\nCampo[3].Join.Enabled=1\nCampo[3].Join.Result=Descricao\nCampo[3].Join.Search=IdAcompanhamento\nCampo[3].Width=300\nCampo[4].FieldName=Tbl2_IdGrupo_Tarefa\nCampo[4].Origin=Tbl2.IdGrupo_Tarefa\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Grupo_Tarefa\nCampo[4].Foreign.Campo=IdGrupo_Tarefa\nCampo[4].Foreign.Tabela=cad_Grupo_Tarefa\nCampo[4].Join.Enabled=1\nCampo[4].Join.Result=IdGrupo_Tarefa\nCampo[4].Join.Search=IdAcompanhamento\nCampo[5].FieldName=Grupo_Tarefa\nCampo[5].Origin=Tbl4.Nome\nCampo[5].DisplayLabel=Grupo Tarefa\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=Nome\nCampo[5].Join.Search=Tbl2_IdGrupo_Tarefa\nCampo[5].Width=160\nCampo[6].FieldName=Tbl2_IdResponsavel\nCampo[6].Origin=Tbl2.IdResponsavel\nCampo[6].Foreign.Enabled=1\nCampo[6].Foreign.Divisao=Funcionario\nCampo[6].Foreign.Campo=IdPessoa\nCampo[6].Foreign.Tabela=vis_Funcionario\nCampo[6].Join.Enabled=1\nCampo[6].Join.Result=IdResponsavel\nCampo[6].Join.Search=IdAcompanhamento\nCampo[7].FieldName=Tbl6_IdPessoa\nCampo[7].Origin=Tbl6.IdPessoa\nCampo[7].PrimaryKey=1\nCampo[7].Foreign.Enabled=1\nCampo[7].Foreign.Divisao=Pessoa\nCampo[7].Foreign.Campo=IdPessoa\nCampo[7].Foreign.Tabela=cad_Pessoa\nCampo[7].Join.Enabled=1\nCampo[7].Join.Result=IdPessoa\nCampo[7].Join.Search=Tbl2_IdResponsavel\nCampo[8].FieldName=Responsavel\nCampo[8].Origin=Tbl9.Nome\nCampo[8].DisplayLabel=Responsável\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Nome\nCampo[8].Join.Search=Tbl6_IdPessoa\nCampo[8].Width=200\nCampo[9].FieldName=IdPessoa\nCampo[9].Origin=Tbl1.IdPessoa\nCampo[9].Foreign.Enabled=1\nCampo[9].Foreign.Divisao=Pessoa\nCampo[9].Foreign.Campo=IdPessoa\nCampo[9].Foreign.Tabela=cad_Pessoa\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\ACOMPANHAMENTO DE COTAÇÕES\\RELATORIO ACOMPANHAMENTO DE COTACOES.chd",
        "conteudo": "[Consulta]\nCaption=ACOMPANHAMENTO DE COTAÇÕES\nTabela=mov_Oferta_Frete_Fechamento\nCampos=54\nCommandText=Select,\"  Tbl1.IdOferta_Frete_Fechamento,\",\"  Tbl1.Lucro_Estimado,\",\"  Tbl1.IdMoeda,\",\"  Tbl2.Sigla as Tbl2_Sigla,\",\"  Tbl1.IdOferta_Frete,\",\"  Tbl5.Modalidade_Processo as Tbl5_Modalidade_Processo,\",\"  Tbl5.Numero_Oferta as Tbl5_Numero_Oferta,\",\"  CASE WHEN Tbl5.Situacao = 1 THEN 'Aguardando aprovação' WHEN Tbl5.Situacao = 2 THEN 'Aprovada' WHEN Tbl5.Situacao = 3 THEN 'Não Aprovada' WHEN Tbl5.Situacao = 4 THEN 'Não Enviada' WHEN Tbl5.Situacao = 6 THEN 'Enviada' End as Tbl5_Situacao,\",\"  Tbl5.Tipo_Operacao as Tbl5_Tipo_Operacao,\",\"  Tbl5.Tipo_Servico as Tbl5_Tipo_Servico,\",\"  Tbl5.IdAgente_Destino as Tbl5_IdAgente_Destino,\",\"  Tbl7.IdPessoa as Tbl7_IdPessoa,\",\"  Tbl9.Nome as Tbl9_Nome,\",\"  Tbl5.IdAgente_Origem as Tbl5_IdAgente_Origem,\",\"  Tbl21.IdPessoa as Tbl21_IdPessoa,\",\"  Tbl23.Nome as Tbl23_Nome,\",\"  Tbl5.IdCompanhia_Transporte as Tbl5_IdCompanhia_Transporte,\",\"  Tbl35.IdPessoa as Tbl35_IdPessoa,\",\"  Tbl36.Nome as Tbl36_Nome,\",\"  Tbl5.IdDestino as Tbl5_IdDestino,\",\"  Tbl50.Nome as Tbl50_Nome,\",\"  Tbl50.IdPais as Tbl50_IdPais,\",\"  Tbl53.Nome as Tbl53_Nome,\",\"  Tbl5.IdOrigem as Tbl5_IdOrigem,\",\"  Tbl68.Nome as Tbl68_Nome,\",\"  Tbl68.IdPais as Tbl68_IdPais,\",\"  Tbl71.Nome as Tbl71_Nome,\",\"  Tbl5.IdProposta_Frete as Tbl5_IdProposta_Frete,\",\"  Tbl75.Data_Aprovacao as Tbl75_Data_Aprovacao,\",\"  Tbl75.Data_Proposta as Tbl75_Data_Proposta,\",\"  Tbl75.Tipo_Proposta as Tbl75_Tipo_Proposta,\",\"  Tbl75.IdCliente as Tbl75_IdCliente,\",\"  Tbl76.IdPessoa as Tbl76_IdPessoa,\",\"  Tbl80.Nome as Tbl80_Nome,\",\"  Tbl80.Cpf_Cnpj,\",\"  Tbl75.IdResponsavel as Tbl75_IdResponsavel,\",\"  Tbl98.IdPessoa as Tbl98_IdPessoa,\",\"  Tbl102.Nome as Tbl102_Nome,\",\"  Tbl75.IdVendedor as Tbl75_IdVendedor,\",\"  Tbl115.IdPessoa as Tbl115_IdPessoa,\",\"  Tbl119.Nome as Tbl119_Nome,\",\"  Tbl5.IdProposta_Frete_Carga as Tbl5_IdProposta_Frete_Carga,\",\"  Tbl132.Metros_Cubicos as Tbl132_Metros_Cubicos,\",\"  Tbl132.Peso_Bruto as Tbl132_Peso_Bruto,\",\"  Tbl132.Peso_Considerado as Tbl132_Peso_Considerado,\",\"  Tbl132.Peso_Cubado as Tbl132_Peso_Cubado,\",\"  Tbl132.Peso_Liquido as Tbl132_Peso_Liquido,\",\"  Tbl132.Peso_Taxado as Tbl132_Peso_Taxado,\",\"  Tbl132.Seguro as Tbl132_Seguro,\",\"  Tbl132.Tipo_Carga as Tbl132_Tipo_Carga,\",\"  Tbl132.Total_Carretas as Tbl132_Total_Carretas,\",\"  Tbl132.Total_Container_20 as Tbl132_Total_Container_20,\",\"  Tbl132.Total_Container_40 as Tbl132_Total_Container_40,\",\"  Tbl132.IdProposta_Frete as Tbl132_IdProposta_Frete\",From,\"  mov_Oferta_Frete_Fechamento Tbl1\",\"Left Outer Join\",\"  cad_Moeda Tbl2 on Tbl2.IdMoeda = Tbl1.IdMoeda\",\"Left Outer Join\",\"  mov_Oferta_Frete Tbl5 on Tbl5.IdOferta_Frete = Tbl1.IdOferta_Frete\",\"Left Outer Join\",\"  cad_Agente_Carga Tbl7 on Tbl7.IdPessoa = Tbl5.IdAgente_Destino\",\"Left Outer Join\",\"  cad_Pessoa Tbl9 on Tbl9.IdPessoa = Tbl7.IdPessoa\",\"Left Outer Join\",\"  cad_Agente_Carga Tbl21 on Tbl21.IdPessoa = Tbl5.IdAgente_Origem\",\"Left Outer Join\",\"  cad_Pessoa Tbl23 on Tbl23.IdPessoa = Tbl21.IdPessoa\",\"Left Outer Join\",\"  cad_Companhia_Transporte Tbl35 on Tbl35.IdPessoa = Tbl5.IdCompanhia_Transporte\",\"Left Outer Join\",\"  cad_Pessoa Tbl36 on Tbl36.IdPessoa = Tbl35.IdPessoa\",\"Left Outer Join\",\"  cad_Origem_Destino Tbl50 on Tbl50.IdOrigem_Destino = Tbl5.IdDestino\",\"Left Outer Join\",\"  cad_Pais Tbl53 on Tbl53.IdPais = Tbl50.IdPais\",\"Left Outer Join\",\"  cad_Origem_Destino Tbl68 on Tbl68.IdOrigem_Destino = Tbl5.IdOrigem\",\"Left Outer Join\",\"  cad_Pais Tbl71 on Tbl71.IdPais = Tbl68.IdPais\",\"Left Outer Join\",\"  mov_Proposta_Frete Tbl75 on Tbl75.IdProposta_Frete = Tbl5.IdProposta_Frete\",\"Left Outer Join\",\"  cad_Cliente Tbl76 on Tbl76.IdPessoa = Tbl75.IdCliente\",\"Left Outer Join\",\"  cad_Pessoa Tbl80 on Tbl80.IdPessoa = Tbl76.IdPessoa\",\"Left Outer Join\",\"  cad_Funcionario Tbl98 on Tbl98.IdPessoa = Tbl75.IdResponsavel\",\"Left Outer Join\",\"  cad_Pessoa Tbl102 on Tbl102.IdPessoa = Tbl98.IdPessoa\",\"Left Outer Join\",\"  cad_Funcionario Tbl115 on Tbl115.IdPessoa = Tbl75.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Tbl119 on Tbl119.IdPessoa = Tbl115.IdPessoa\",\"Left Outer Join\",\"  mov_Proposta_Frete_Carga Tbl132 on Tbl132.IdProposta_Frete_Carga = Tbl5.IdProposta_Frete_Carga\"\n\n[Campos]\nCampo[0].FieldName=IdOferta_Frete_Fechamento\nCampo[0].Origin=Tbl1.IdOferta_Frete_Fechamento\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Lucro_Estimado\nCampo[1].Origin=Tbl1.Lucro_Estimado\nCampo[1].DisplayLabel=Lucro estimado\nCampo[1].DisplayFormat=#,0.00;-#,0.00\nCampo[1].Alignment=1\nCampo[1].Width=-1\nCampo[2].FieldName=IdMoeda\nCampo[2].Origin=Tbl1.IdMoeda\nCampo[2].Foreign.Enabled=1\nCampo[2].Foreign.Divisao=Moeda\nCampo[2].Foreign.Campo=IdMoeda\nCampo[2].Foreign.Tabela=cad_Moeda\nCampo[3].FieldName=Tbl2_Sigla\nCampo[3].Origin=Tbl2.Sigla\nCampo[3].DisplayLabel=Moeda\nCampo[3].Join.Enabled=1\nCampo[3].Join.Result=Sigla\nCampo[3].Join.Search=IdMoeda\nCampo[3].Width=40\nCampo[4].FieldName=IdOferta_Frete\nCampo[4].Origin=Tbl1.IdOferta_Frete\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Oferta_Frete\nCampo[4].Foreign.Campo=IdOferta_Frete\nCampo[4].Foreign.Tabela=mov_Oferta_Frete\nCampo[5].FieldName=Tbl5_Modalidade_Processo\nCampo[5].Origin=Tbl5.Modalidade_Processo\nCampo[5].DisplayLabel=Modalidade processo\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=Modalidade_Processo\nCampo[5].Join.Search=IdOferta_Frete\nCampo[5].Width=160\nCampo[5].Items=1,2,3,4,5\nCampo[5].ItemsEx=Aéreo,Marítimo,Terrestre,Air-Air,Sea-Air\nCampo[6].FieldName=Tbl5_Numero_Oferta\nCampo[6].Origin=Tbl5.Numero_Oferta\nCampo[6].DisplayLabel=Número oferta\nCampo[6].Join.Enabled=1\nCampo[6].Join.Result=Numero_Oferta\nCampo[6].Join.Search=IdOferta_Frete\nCampo[6].Width=-1\nCampo[7].FieldName=Tbl5_Situacao\nCampo[7].DisplayLabel=Situacao\nCampo[7].Origin=CASE WHEN Tbl5.Situacao = 1 THEN 'Aguardando aprovação' WHEN Tbl5.Situacao = 2 THEN 'Aprovada' WHEN Tbl5.Situacao = 3 THEN 'Não Aprovada' WHEN Tbl5.Situacao = 4 THEN 'Não Enviada' WHEN Tbl5.Situacao = 6 THEN 'Enviada' End as Tbl5_Situacao\nCampo[7].Width=100\nCampo[8].FieldName=Tbl5_Tipo_Operacao\nCampo[8].Origin=Tbl5.Tipo_Operacao\nCampo[8].DisplayLabel=Tipo operação\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Tipo_Operacao\nCampo[8].Join.Search=IdOferta_Frete\nCampo[8].Width=160\nCampo[8].Items=1,2,3\nCampo[8].ItemsEx=Exportação,Importação,Nacional\nCampo[9].FieldName=Tbl5_Tipo_Servico\nCampo[9].Origin=Tbl5.Tipo_Servico\nCampo[9].DisplayLabel=Tipo serviço\nCampo[9].Join.Enabled=1\nCampo[9].Join.Result=Tipo_Servico\nCampo[9].Join.Search=IdOferta_Frete\nCampo[9].Width=160\nCampo[9].Items=0,1,2,3,4\nCampo[9].ItemsEx=\"(Não informado)\",\"Door to door\",\"Door to port\",\"Port to door\",\"Port to port\"\nCampo[10].FieldName=Tbl5_IdAgente_Destino\nCampo[10].Origin=Tbl5.IdAgente_Destino\nCampo[10].Foreign.Enabled=1\nCampo[10].Foreign.Divisao=Agente_Carga\nCampo[10].Foreign.Campo=IdPessoa\nCampo[10].Foreign.Tabela=vis_Agente_Carga\nCampo[10].Join.Enabled=1\nCampo[10].Join.Result=IdAgente_Destino\nCampo[10].Join.Search=IdOferta_Frete\nCampo[11].FieldName=Tbl7_IdPessoa\nCampo[11].Origin=Tbl7.IdPessoa\nCampo[11].PrimaryKey=1\nCampo[11].Foreign.Enabled=1\nCampo[11].Foreign.Divisao=Pessoa\nCampo[11].Foreign.Campo=IdPessoa\nCampo[11].Foreign.Tabela=cad_Pessoa\nCampo[11].Join.Enabled=1\nCampo[11].Join.Result=IdPessoa\nCampo[11].Join.Search=Tbl5_IdAgente_Destino\nCampo[12].FieldName=Tbl9_Nome\nCampo[12].Origin=Tbl9.Nome\nCampo[12].DisplayLabel=Agente Destino\nCampo[12].Join.Enabled=1\nCampo[12].Join.Result=Nome\nCampo[12].Join.Search=Tbl7_IdPessoa\nCampo[12].Width=200\nCampo[13].FieldName=Tbl5_IdAgente_Origem\nCampo[13].Origin=Tbl5.IdAgente_Origem\nCampo[13].Foreign.Enabled=1\nCampo[13].Foreign.Divisao=Agente_Carga\nCampo[13].Foreign.Campo=IdPessoa\nCampo[13].Foreign.Tabela=vis_Agente_Carga\nCampo[13].Join.Enabled=1\nCampo[13].Join.Result=IdAgente_Origem\nCampo[13].Join.Search=IdOferta_Frete\nCampo[14].FieldName=Tbl21_IdPessoa\nCampo[14].Origin=Tbl21.IdPessoa\nCampo[14].PrimaryKey=1\nCampo[14].Foreign.Enabled=1\nCampo[14].Foreign.Divisao=Pessoa\nCampo[14].Foreign.Campo=IdPessoa\nCampo[14].Foreign.Tabela=cad_Pessoa\nCampo[14].Join.Enabled=1\nCampo[14].Join.Result=IdPessoa\nCampo[14].Join.Search=Tbl5_IdAgente_Origem\nCampo[15].FieldName=Tbl23_Nome\nCampo[15].Origin=Tbl23.Nome\nCampo[15].DisplayLabel=Agente Origem\nCampo[15].Join.Enabled=1\nCampo[15].Join.Result=Nome\nCampo[15].Join.Search=Tbl21_IdPessoa\nCampo[15].Width=200\nCampo[16].FieldName=Tbl5_IdCompanhia_Transporte\nCampo[16].Origin=Tbl5.IdCompanhia_Transporte\nCampo[16].Foreign.Enabled=1\nCampo[16].Foreign.Divisao=Companhia_Transporte\nCampo[16].Foreign.Campo=IdPessoa\nCampo[16].Foreign.Tabela=vis_Companhia_Transporte\nCampo[16].Join.Enabled=1\nCampo[16].Join.Result=IdCompanhia_Transporte\nCampo[16].Join.Search=IdOferta_Frete\nCampo[17].FieldName=Tbl35_IdPessoa\nCampo[17].Origin=Tbl35.IdPessoa\nCampo[17].PrimaryKey=1\nCampo[17].Foreign.Enabled=1\nCampo[17].Foreign.Divisao=Pessoa\nCampo[17].Foreign.Campo=IdPessoa\nCampo[17].Foreign.Tabela=cad_Pessoa\nCampo[17].Join.Enabled=1\nCampo[17].Join.Result=IdPessoa\nCampo[17].Join.Search=Tbl5_IdCompanhia_Transporte\nCampo[18].FieldName=Tbl36_Nome\nCampo[18].Origin=Tbl36.Nome\nCampo[18].DisplayLabel=Cia de Transporte\nCampo[18].Join.Enabled=1\nCampo[18].Join.Result=Nome\nCampo[18].Join.Search=Tbl35_IdPessoa\nCampo[18].Width=200\nCampo[19].FieldName=Tbl5_IdDestino\nCampo[19].Origin=Tbl5.IdDestino\nCampo[19].Foreign.Enabled=1\nCampo[19].Foreign.Divisao=Origem_Destino\nCampo[19].Foreign.Campo=IdOrigem_Destino\nCampo[19].Foreign.Tabela=cad_Origem_Destino\nCampo[19].Join.Enabled=1\nCampo[19].Join.Result=IdDestino\nCampo[19].Join.Search=IdOferta_Frete\nCampo[20].FieldName=Tbl50_Nome\nCampo[20].Origin=Tbl50.Nome\nCampo[20].DisplayLabel=Destino\nCampo[20].Join.Enabled=1\nCampo[20].Join.Result=Nome\nCampo[20].Join.Search=Tbl5_IdDestino\nCampo[20].Width=160\nCampo[21].FieldName=Tbl50_IdPais\nCampo[21].Origin=Tbl50.IdPais\nCampo[21].Foreign.Enabled=1\nCampo[21].Foreign.Divisao=Pais\nCampo[21].Foreign.Campo=IdPais\nCampo[21].Foreign.Tabela=cad_Pais\nCampo[21].Join.Enabled=1\nCampo[21].Join.Result=IdPais\nCampo[21].Join.Search=Tbl5_IdDestino\nCampo[22].FieldName=Tbl53_Nome\nCampo[22].Origin=Tbl53.Nome\nCampo[22].DisplayLabel=País Destino\nCampo[22].Join.Enabled=1\nCampo[22].Join.Result=Nome\nCampo[22].Join.Search=Tbl50_IdPais\nCampo[22].Width=160\nCampo[23].FieldName=Tbl5_IdOrigem\nCampo[23].Origin=Tbl5.IdOrigem\nCampo[23].Foreign.Enabled=1\nCampo[23].Foreign.Divisao=Origem_Destino\nCampo[23].Foreign.Campo=IdOrigem_Destino\nCampo[23].Foreign.Tabela=cad_Origem_Destino\nCampo[23].Join.Enabled=1\nCampo[23].Join.Result=IdOrigem\nCampo[23].Join.Search=IdOferta_Frete\nCampo[24].FieldName=Tbl68_Nome\nCampo[24].Origin=Tbl68.Nome\nCampo[24].DisplayLabel=Origem\nCampo[24].Join.Enabled=1\nCampo[24].Join.Result=Nome\nCampo[24].Join.Search=Tbl5_IdOrigem\nCampo[24].Width=160\nCampo[25].FieldName=Tbl68_IdPais\nCampo[25].Origin=Tbl68.IdPais\nCampo[25].Foreign.Enabled=1\nCampo[25].Foreign.Divisao=Pais\nCampo[25].Foreign.Campo=IdPais\nCampo[25].Foreign.Tabela=cad_Pais\nCampo[25].Join.Enabled=1\nCampo[25].Join.Result=IdPais\nCampo[25].Join.Search=Tbl5_IdOrigem\nCampo[26].FieldName=Tbl71_Nome\nCampo[26].Origin=Tbl71.Nome\nCampo[26].DisplayLabel=País Origem\nCampo[26].Join.Enabled=1\nCampo[26].Join.Result=Nome\nCampo[26].Join.Search=Tbl68_IdPais\nCampo[26].Width=160\nCampo[27].FieldName=Tbl5_IdProposta_Frete\nCampo[27].Origin=Tbl5.IdProposta_Frete\nCampo[27].Foreign.Enabled=1\nCampo[27].Foreign.Divisao=Proposta_Frete\nCampo[27].Foreign.Campo=IdProposta_Frete\nCampo[27].Foreign.Tabela=mov_Proposta_Frete\nCampo[27].Join.Enabled=1\nCampo[27].Join.Result=IdProposta_Frete\nCampo[27].Join.Search=IdOferta_Frete\nCampo[28].FieldName=Tbl75_Data_Aprovacao\nCampo[28].Origin=Tbl75.Data_Aprovacao\nCampo[28].DisplayLabel=Data aprovação\nCampo[28].Join.Enabled=1\nCampo[28].Join.Result=Data_Aprovacao\nCampo[28].Join.Search=Tbl5_IdProposta_Frete\nCampo[28].DisplayFormat=dd/mm/yyyy\nCampo[28].Width=80\nCampo[29].FieldName=Tbl75_Data_Proposta\nCampo[29].Origin=Tbl75.Data_Proposta\nCampo[29].DisplayLabel=Data proposta\nCampo[29].Join.Enabled=1\nCampo[29].Join.Result=Data_Proposta\nCampo[29].Join.Search=Tbl5_IdProposta_Frete\nCampo[29].DisplayFormat=dd/mm/yyyy\nCampo[29].Width=80\nCampo[30].FieldName=Tbl75_Tipo_Proposta\nCampo[30].Origin=Tbl75.Tipo_Proposta\nCampo[30].DisplayLabel=Tipo proposta\nCampo[30].Join.Enabled=1\nCampo[30].Join.Result=Tipo_Proposta\nCampo[30].Join.Search=Tbl5_IdProposta_Frete\nCampo[30].Width=-1\nCampo[30].Items=1,2,3,4,5\nCampo[30].ItemsEx=Prospecção,\"Cliente ativo\",\"Contrato ativo\",\"Contrato inativo\",\"Acordo ativo\"\nCampo[31].FieldName=Tbl75_IdCliente\nCampo[31].Origin=Tbl75.IdCliente\nCampo[31].Foreign.Enabled=1\nCampo[31].Foreign.Divisao=Cliente\nCampo[31].Foreign.Campo=IdPessoa\nCampo[31].Foreign.Tabela=vis_Cliente\nCampo[31].Join.Enabled=1\nCampo[31].Join.Result=IdCliente\nCampo[31].Join.Search=Tbl5_IdProposta_Frete\nCampo[32].FieldName=Tbl76_IdPessoa\nCampo[32].Origin=Tbl76.IdPessoa\nCampo[32].PrimaryKey=1\nCampo[32].Foreign.Enabled=1\nCampo[32].Foreign.Divisao=Pessoa\nCampo[32].Foreign.Campo=IdPessoa\nCampo[32].Foreign.Tabela=cad_Pessoa\nCampo[32].Join.Enabled=1\nCampo[32].Join.Result=IdPessoa\nCampo[32].Join.Search=Tbl75_IdCliente\nCampo[33].FieldName=Tbl80_Nome\nCampo[33].Origin=Tbl80.Nome\nCampo[33].DisplayLabel=Cliente\nCampo[33].Join.Enabled=1\nCampo[33].Join.Result=Nome\nCampo[33].Join.Search=Tbl76_IdPessoa\nCampo[33].Width=200\nCampo[34].FieldName=Cpf_Cnpj\nCampo[34].DisplayLabel=CNPJ\nCampo[34].Origin=Tbl80.Cpf_Cnpj\nCampo[34].Width=120\nCampo[35].FieldName=Tbl75_IdResponsavel\nCampo[35].Origin=Tbl75.IdResponsavel\nCampo[35].Foreign.Enabled=1\nCampo[35].Foreign.Divisao=Funcionario\nCampo[35].Foreign.Campo=IdPessoa\nCampo[35].Foreign.Tabela=vis_Funcionario\nCampo[35].Join.Enabled=1\nCampo[35].Join.Result=IdResponsavel\nCampo[35].Join.Search=Tbl5_IdProposta_Frete\nCampo[36].FieldName=Tbl98_IdPessoa\nCampo[36].Origin=Tbl98.IdPessoa\nCampo[36].PrimaryKey=1\nCampo[36].Foreign.Enabled=1\nCampo[36].Foreign.Divisao=Pessoa\nCampo[36].Foreign.Campo=IdPessoa\nCampo[36].Foreign.Tabela=cad_Pessoa\nCampo[36].Join.Enabled=1\nCampo[36].Join.Result=IdPessoa\nCampo[36].Join.Search=Tbl75_IdResponsavel\nCampo[37].FieldName=Tbl102_Nome\nCampo[37].Origin=Tbl102.Nome\nCampo[37].DisplayLabel=Inside/Responsável\nCampo[37].Join.Enabled=1\nCampo[37].Join.Result=Nome\nCampo[37].Join.Search=Tbl98_IdPessoa\nCampo[37].Width=200\nCampo[38].FieldName=Tbl75_IdVendedor\nCampo[38].Origin=Tbl75.IdVendedor\nCampo[38].Foreign.Enabled=1\nCampo[38].Foreign.Divisao=Funcionario\nCampo[38].Foreign.Campo=IdPessoa\nCampo[38].Foreign.Tabela=vis_Funcionario\nCampo[38].Join.Enabled=1\nCampo[38].Join.Result=IdVendedor\nCampo[38].Join.Search=Tbl5_IdProposta_Frete\nCampo[39].FieldName=Tbl115_IdPessoa\nCampo[39].Origin=Tbl115.IdPessoa\nCampo[39].PrimaryKey=1\nCampo[39].Foreign.Enabled=1\nCampo[39].Foreign.Divisao=Pessoa\nCampo[39].Foreign.Campo=IdPessoa\nCampo[39].Foreign.Tabela=cad_Pessoa\nCampo[39].Join.Enabled=1\nCampo[39].Join.Result=IdPessoa\nCampo[39].Join.Search=Tbl75_IdVendedor\nCampo[40].FieldName=Tbl119_Nome\nCampo[40].Origin=Tbl119.Nome\nCampo[40].DisplayLabel=Vendedor\nCampo[40].Join.Enabled=1\nCampo[40].Join.Result=Nome\nCampo[40].Join.Search=Tbl115_IdPessoa\nCampo[40].Width=200\nCampo[41].FieldName=Tbl5_IdProposta_Frete_Carga\nCampo[41].Origin=Tbl5.IdProposta_Frete_Carga\nCampo[41].Foreign.Enabled=1\nCampo[41].Foreign.Divisao=Proposta_Frete_Carga\nCampo[41].Foreign.Campo=IdProposta_Frete_Carga\nCampo[41].Foreign.Tabela=mov_Proposta_Frete_Carga\nCampo[41].Join.Enabled=1\nCampo[41].Join.Result=IdProposta_Frete_Carga\nCampo[41].Join.Search=IdOferta_Frete\nCampo[42].FieldName=Tbl132_Metros_Cubicos\nCampo[42].Origin=Tbl132.Metros_Cubicos\nCampo[42].DisplayLabel=Metros cúbicos\nCampo[42].Join.Enabled=1\nCampo[42].Join.Result=Metros_Cubicos\nCampo[42].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[42].DisplayFormat=#,0.000 m³\nCampo[42].Alignment=1\nCampo[42].Width=-1\nCampo[43].FieldName=Tbl132_Peso_Bruto\nCampo[43].Origin=Tbl132.Peso_Bruto\nCampo[43].DisplayLabel=Peso bruto\nCampo[43].Join.Enabled=1\nCampo[43].Join.Result=Peso_Bruto\nCampo[43].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[43].DisplayFormat=#,0.000 kg\nCampo[43].Alignment=1\nCampo[43].Width=-1\nCampo[44].FieldName=Tbl132_Peso_Considerado\nCampo[44].Origin=Tbl132.Peso_Considerado\nCampo[44].DisplayLabel=Peso considerado\nCampo[44].Join.Enabled=1\nCampo[44].Join.Result=Peso_Considerado\nCampo[44].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[44].DisplayFormat=#,0.000\nCampo[44].Alignment=1\nCampo[44].Width=-1\nCampo[45].FieldName=Tbl132_Peso_Cubado\nCampo[45].Origin=Tbl132.Peso_Cubado\nCampo[45].DisplayLabel=Peso cubado\nCampo[45].Join.Enabled=1\nCampo[45].Join.Result=Peso_Cubado\nCampo[45].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[45].DisplayFormat=#,0.000 kg\nCampo[45].Alignment=1\nCampo[45].Width=-1\nCampo[46].FieldName=Tbl132_Peso_Liquido\nCampo[46].Origin=Tbl132.Peso_Liquido\nCampo[46].DisplayLabel=Peso líquido\nCampo[46].Join.Enabled=1\nCampo[46].Join.Result=Peso_Liquido\nCampo[46].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[46].DisplayFormat=#,0.000 kg\nCampo[46].Alignment=1\nCampo[46].Width=-1\nCampo[47].FieldName=Tbl132_Peso_Taxado\nCampo[47].Origin=Tbl132.Peso_Taxado\nCampo[47].DisplayLabel=Peso taxado\nCampo[47].Join.Enabled=1\nCampo[47].Join.Result=Peso_Taxado\nCampo[47].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[47].DisplayFormat=#,0.000 kg\nCampo[47].Alignment=1\nCampo[47].Width=-1\nCampo[48].FieldName=Tbl132_Seguro\nCampo[48].Origin=Tbl132.Seguro\nCampo[48].DisplayLabel=Seguro\nCampo[48].Join.Enabled=1\nCampo[48].Join.Result=Seguro\nCampo[48].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[48].DisplayFormat=Sim;Não\nCampo[48].Width=-1\nCampo[49].FieldName=Tbl132_Tipo_Carga\nCampo[49].Origin=Tbl132.Tipo_Carga\nCampo[49].DisplayLabel=Tipo carga\nCampo[49].Join.Enabled=1\nCampo[49].Join.Result=Tipo_Carga\nCampo[49].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[49].Width=160\nCampo[49].Items=1,2,3,4,5,6\nCampo[49].ItemsEx=Aéreo,Break-Bulk,FCL,LCL,RO-RO,Rodoviário\nCampo[50].FieldName=Tbl132_Total_Carretas\nCampo[50].Origin=Tbl132.Total_Carretas\nCampo[50].DisplayLabel=Total carretas\nCampo[50].Join.Enabled=1\nCampo[50].Join.Result=Total_Carretas\nCampo[50].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[50].Alignment=1\nCampo[50].Width=-1\nCampo[51].FieldName=Tbl132_Total_Container_20\nCampo[51].Origin=Tbl132.Total_Container_20\nCampo[51].DisplayLabel=Total container 20\nCampo[51].Join.Enabled=1\nCampo[51].Join.Result=Total_Container_20\nCampo[51].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[51].DisplayFormat=0\nCampo[51].Alignment=1\nCampo[51].Width=-1\nCampo[52].FieldName=Tbl132_Total_Container_40\nCampo[52].Origin=Tbl132.Total_Container_40\nCampo[52].DisplayLabel=Total container 40\nCampo[52].Join.Enabled=1\nCampo[52].Join.Result=Total_Container_40\nCampo[52].Join.Search=Tbl5_IdProposta_Frete_Carga\nCampo[52].DisplayFormat=0\nCampo[52].Alignment=1\nCampo[52].Width=-1\nCampo[53].FieldName=Tbl132_IdProposta_Frete\nCampo[53].Origin=Tbl132.IdProposta_Frete\nCampo[53].Foreign.Enabled=1\nCampo[53].Foreign.Divisao=Proposta_Frete\nCampo[53].Foreign.Campo=IdProposta_Frete\nCampo[53].Foreign.Tabela=mov_Proposta_Frete\nCampo[53].Join.Enabled=1\nCampo[53].Join.Result=IdProposta_Frete\nCampo[53].Join.Search=Tbl5_IdProposta_Frete_Carga\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\ANALITICO TAXAS\\RELATORIO ANALITICO TAXAS OK.chd",
        "conteudo": "[Consulta]\nCaption=Logística - House\nTabela=mov_Logistica_House\nCampos=47\nCommandText=Select,\"    Lcm.IdLogistica_House,\",\"    Lcm.IdLogistica_Taxa,\",\"    Lcm.IdTaxa_Logistica_Exibicao,\",\"    Lcm.Origem_Taxa,\",\"    case When (Tlc.IdTaxa_Logistica_Classificacao = 1) And (Lcm.Data_Recebimento Is Null) Then 'Adiantado' Else Null End As Taxas_Adiantadas,\",\"    Lhs.Numero_Processo,\",\"    Lcm.Taxa_Logistica_Exibicao,\",\"    Lcm.Moeda_Corrente,\",\"    Vnd.Nome_Fantasia As Vendedor,\",\"    Ept.Nome_Fantasia As Shipper,\",\"    Imp.Nome_Fantasia As Consignee,\",\"    case When Lms.Tipo_Operacao = 1 Then Ept.Nome_Fantasia Else Imp.Nome_Fantasia End As Importador_Exportador,\",\"    Lhs.Agenciamento_Carga,\",\"    Lhs.Desembaraco_Aduaneiro,\",\"    Lhs.Demurrage_Detention,\",\"    Lhs.Situacao_Agenciamento,\",\"    Lhs.Data_Acerto_Agente,\",\"    Lhs.Data_Fechamento_Cambio,\",\"    Lhs.Data_Liberado_Faturamento,\",\"    Lhs.Data_Faturado,\",\"    Lhs.Data_Auditado,\",\"    \",\"    /*Variacao Cambial*/\",\"    Case When ((Lcm.Moeda_Pagamento = Lcm.Moeda_Corrente) And (Lcm.Moeda_Recebimento = Lcm.Moeda_Corrente)) Then 0 /*Tudo em BRL*/ When (Lcm.Moeda_Pagamento <> Lcm.Moeda_Recebimento) Then 0 /*Moedas Diferentes, ignora a variacao*/ Else (coalesce(Lcm.Valor_Pagamento_Total,0) * (Lcm.Fator_Recebimento_Dinamico-(Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End))) End As Variacao_Cambial,\",,\"    /*Valores de Pagamento*/\",\"    coalesce(Ppg.Nome_Fantasia,Ppg.Nome) As Pessoa_Pagamento,\",\"    Lcm.Pagar_Para,\",\"    Lcm.Moeda_Pagamento,\",\"    Lcm.Valor_Pagamento_Total,\",\"    Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End As Fator_Pagamento_Dinamico,\",\"    Lcm.Valor_Pagamento_Dinamico,\",\"    Lcm.Data_Pagamento,\",\"    case When (Lcm.Valor_Pagamento_Total Is Null) Then 0 When (Lcm.Data_Pagamento Is Null) Then 1 Else 2 End As Pago,\",\"    Mfp.Sigla As Moeda_Fat_Pgto,\",\"    Ffp.Data_Referencia As Data_Vcto_Pgto,\",\"    Ffp.Valor_Original As Valor_Fat_Pgto,\",\"\tLcm.Numero_Fat_Pag,\",\" \",\"    /*Valores de Recebimento*/\",\"    coalesce(Prc.Nome_Fantasia,Prc.Nome) As Pessoa_Recebimento,\",\"    Lcm.Receber_De,\",\"    Lcm.Moeda_Recebimento,\",\"    Lcm.Valor_Recebimento_Total,\",\"    Lcm.Fator_Recebimento_Dinamico,\",\"    Lcm.Valor_Recebimento_Dinamico,\",\"    Lcm.Data_Recebimento,\",\"    case When (Lcm.Valor_Recebimento_Total Is Null) Then 0 When (Lcm.Data_Recebimento Is Null) Then 1 Else 2 End As Recebido,\",\"    Ffr.Valor_Original As Valor_Fat_Rcbto,\",\"    Ffr.Data_Referencia As Data_Vcto_Rcbto,\",\"    Mfr.Sigla AS Moeda_Fat_Rcbto,\",\"\tLcm.Numero_Fat_Rec,\",\"  \",\"    /*Saldos*/\",\"    Coalesce(Lcm.Valor_Recebimento_Dinamico, 0) - Coalesce(Lcm.Valor_Pagamento_Dinamico, 0) As Saldo_Dinamico,\",\"    Lcm.Saldo_Efetivo,\",\"    Lmd.Lucro_Momento As Lucro_Processo,\",\"    case When Lms.Tipo_Operacao = 1 /*Expo*/ Then Lms.Data_Embarque Else Lms.Data_Desembarque End As Data_Competencia,\",\"    Lhs.Data_Recebimento_Local As Data_Recebimento_Processo\",From,\"  (Select\",\"    Txs.IdLogistica_House,\",\"    Txs.IdLogistica_Taxa,\",\"    Txs.Origem_Taxa,\",\"    Txs.IdRegistro_Pagamento,\",\"    Txs.IdRegistro_Recebimento,\",\"    Txs.IdTaxa_Logistica_Exibicao,\",\"    Txs.Taxa_Logistica_Exibicao,\",\"    Txs.IdTaxa_Logistica_Classificacao,\",\"    Txs.Moeda_Corrente,\",,\"    /*Valores de Pagamento*/\",\"    Txs.IdPessoa_Pagamento,\",\"    Txs.Moeda_Pagamento,\",\"    Txs.Valor_Pagamento_Total,\",\"    Case\",\"      When Txs.Moeda_Pagamento = Txs.Moeda_Corrente Then 1\",\"      When (Tfp.Data_Pagamento is NUll) Then Txs.Fator_Pgto_Corrente\",\"      Else Txs.Fator_Pgto_Fatura \",\"    End As Fator_Pagamento_Dinamico,\",\"    Case\",\"      When (Tfp.Data_Pagamento is NUll) Then Txs.Pagamento_Corrente_Estimado\",\"      Else (ROUND(Case\",\"                    When Txs.Subtotal_Fatura_Pagamento = 0 Then 0\",\"                    Else Txs.Pagamento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Pagamento\",\"                    End * Tfp.Total_Pago_Corrente / 100, 2))\",\"    End As Valor_Pagamento_Dinamico,\",\"    Tfp.Data_Pagamento,\",\"    Txs.Pagar_Para,\",\"\tTxs.Numero_Fat_Pag,\",,\"    /*Valores de Recebimento*/\",\"    Txs.IdPessoa_Recebimento,\",\"    Txs.Moeda_Recebimento,\",\"    Txs.Valor_Recebimento_Total,\",\"    Case\",\"      When Txs.Moeda_Recebimento = Txs.Moeda_Corrente Then 1\",\"      When (Tfr.Data_Pagamento is NUll) Then Txs.Fator_Rcbto_Corrente\",\"      Else Txs.Fator_Rcbto_Fatura \",\"    End As Fator_Recebimento_Dinamico,\",\"    Case\",\"      When (Tfr.Data_Pagamento is NUll) Then Txs.Recebimento_Corrente_Estimado\",\"      Else (ROUND(Case\",\"                    When Txs.Subtotal_Fatura_Recebimento = 0 Then 0\",\"                    Else Txs.Recebimento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Recebimento\",\"                    End * Tfr.Total_Pago_Corrente / 100, 2))\",\"    End As Valor_Recebimento_Dinamico,\",\"    Tfr.Data_Pagamento As Data_Recebimento,\",\"    Txs.Receber_De,\",\"\tTxs.Numero_Fat_Rec,\",\"  \",\"    /*Saldos*/\",\"    Coalesce(Txs.Recebimento_Corrente_Estimado, 0) \",\"    - Coalesce(Txs.Pagamento_Corrente_Estimado, 0) As Saldo_Estimado,\",,\"    Coalesce(ROUND(Case\",\"      When Txs.Subtotal_Fatura_Recebimento = 0 Then 0\",\"      Else Txs.Recebimento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Recebimento\",\"    End * Tfr.Total_Pago_Corrente / 100, 2), 0)\",\"    - Coalesce(ROUND(Case\",\"      When Txs.Subtotal_Fatura_Pagamento = 0 Then 0\",\"      Else Txs.Pagamento_Convertido_Fatura * 100 / Txs.Subtotal_Fatura_Pagamento\",\"    End * Tfp.Total_Pago_Corrente / 100, 2), 0) As Saldo_Efetivo\",\"  From\",\"   (Select\",\"      Ltx.IdLogistica_House,\",\"      Ltx.IdTaxa_Logistica_Classificacao,\",\"      Ltx.IdLogistica_Taxa,\",\"      Ltx.IdPessoa_Pagamento,\",\"      Ltx.IdPessoa_Recebimento,\",\"      Ltx.IdRegistro_Pagamento,\",\"      Ltx.Origem_Taxa,\",\"      Ltx.IdRegistro_Recebimento,\",\"      Ltx.IdTaxa_Logistica_Exibicao,\",\"      Tle.Nome As Taxa_Logistica_Exibicao,\",\"      Mcr.Sigla As Moeda_Corrente,\",\"      Mrc.Sigla As Moeda_Recebimento,\",\"      Ltx.Valor_Recebimento_Total,\",\"      Mpg.Sigla As Moeda_Pagamento,\",\"      Ltx.Valor_Pagamento_Total,\",\"      Ltx.Pagar_Para,\",\"      Ltx.Receber_De,\",\"      Ffr.Fator_Conversao As Fator_Rcbto_Fatura,\",\"      Ffp.Fator_Conversao As Fator_Pgto_Fatura,\",\"      Fcr.Fator_Conversao As Fator_Rcbto_Corrente,\",\"      Fcp.Fator_Conversao As Fator_Pgto_Corrente,      \",\"      Case\",\"        When (Ltx.IdMoeda_Pagamento = Mcr.IdMoeda) Or (Ltx.Valor_Pagamento_Total Is NULL) Then Ltx.Valor_Pagamento_Total\",\"        When (Fcp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento And Fcp.IdMoeda_Destino = Mcr.IdMoeda) Then ROUND(Ltx.Valor_Pagamento_Total * Fcp.Fator_Conversao, 2)\",\"        When (Fcp.IdMoeda_Origem = Mcr.IdMoeda And Fcp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento) And (Coalesce(Fcp.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Pagamento_Total / Fcp.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Pagamento_Corrente_Estimado,\",\"      Case\",\"        When (Ltx.IdMoeda_Recebimento = Mcr.IdMoeda) Or (Ltx.Valor_Recebimento_Total Is NULL) Then Ltx.Valor_Recebimento_Total\",\"        When (Fcr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento And Fcr.IdMoeda_Destino = Mcr.IdMoeda) Then ROUND(Ltx.Valor_Recebimento_Total * Fcr.Fator_Conversao, 2)\",\"        When (Fcr.IdMoeda_Origem = Mcr.IdMoeda And Fcr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento) And (Coalesce(Fcr.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Recebimento_Total / Fcr.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Recebimento_Corrente_Estimado,\",\"      Case\",\"        When (Ltx.IdMoeda_Pagamento = Lfp.IdMoeda) Or (Ltx.Valor_Pagamento_Total Is NULL) Then Ltx.Valor_Pagamento_Total\",\"        When (Ffp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento) And (Ffp.IdMoeda_Destino = Lfp.IdMoeda) Then ROUND(Ltx.Valor_Pagamento_Total * Ffp.Fator_Conversao, 2)\",\"        When (Ffp.IdMoeda_Origem = Lfp.IdMoeda) And (Ffp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento) And (Coalesce(Ffp.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Pagamento_Total / Ffp.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Pagamento_Convertido_Fatura,\",\"      Case\",\"        When (Ltx.IdMoeda_Recebimento = Lfr.IdMoeda) Or (Ltx.Valor_Recebimento_Total Is NULL) Then Ltx.Valor_Recebimento_Total\",\"        When (Ffr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento) And (Ffr.IdMoeda_Destino = Lfr.IdMoeda) Then ROUND(Ltx.Valor_Recebimento_Total * Ffr.Fator_Conversao, 2)\",\"        When (Ffr.IdMoeda_Origem = Lfr.IdMoeda) And (Ffr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento) And (Coalesce(Ffr.Fator_Conversao, 0) <> 0) Then ROUND(Ltx.Valor_Recebimento_Total / Ffr.Fator_Conversao, 2)\",\"        Else 0\",\"      End As Recebimento_Convertido_Fatura,\",\"      Lfp.Subtotal As Subtotal_Fatura_Pagamento,\",\"      Lfr.Subtotal As Subtotal_Fatura_Recebimento,\",\"      Lfp.Situacao as Pagamento_Situacao,\",\"      Lfp.Natureza as Pagamento_Natureza,\",\"      Lfr.Situacao as Recebimento_Situacao,\",\"      Lfr.Natureza as Recebimento_Natureza,\",\"\t  Lfp.Numero as Numero_Fat_Pag,\",\"\t  Lfr.Numero as Numero_Fat_Rec\",\"    From\",\"      mov_Logistica_Taxa Ltx\",\"    Left Outer Join\",\"      cad_Moeda Mcr On Mcr.Moeda_Corrente = 1\",\"    Left Outer Join\",\"      cad_Moeda Mpg on Mpg.IdMoeda = Ltx.IdMoeda_Pagamento\",\"    Left Outer Join\",\"      cad_Moeda Mrc on Mrc.IdMoeda = Ltx.IdMoeda_Recebimento\",\"    Left Outer Join\",\"      cad_Taxa_Logistica_Exibicao Tle On Tle.IdTaxa_Logistica_Exibicao = Ltx.IdTaxa_Logistica_Exibicao  \",\"    Left Outer Join\",\"      vis_Logistica_Fatura Lfp On Lfp.IdRegistro_Financeiro = Ltx.IdRegistro_Pagamento\",\"    Left Outer Join\",\"      vis_Logistica_Fatura Lfr On Lfr.IdRegistro_Financeiro = Ltx.IdRegistro_Recebimento\",\"    Left Outer Join /* Fator Corrente Pagamento */\",\"      mov_Logistica_Fatura_Conversao Fcp On Fcp.IdLogistica_Fatura = Lfp.IdRegistro_Financeiro\",\"        And ((Fcp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento And Fcp.IdMoeda_Destino = Mcr.IdMoeda)\",\"        Or (Fcp.IdMoeda_Origem = Mcr.IdMoeda And Fcp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento))\",\"    Left Outer Join /* Fator Corrente Recebimento */\",\"      mov_Logistica_Fatura_Conversao Fcr On Fcr.IdLogistica_Fatura = Lfr.IdRegistro_Financeiro\",\"        And ((Fcr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento And Fcr.IdMoeda_Destino = Mcr.IdMoeda)\",\"        Or (Fcr.IdMoeda_Origem = Mcr.IdMoeda And Fcr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento))\",\"    Left Outer Join /* Fator Fatura Pagamento */\",\"      mov_Logistica_Fatura_Conversao Ffp On Ffp.IdLogistica_Fatura = Lfp.IdRegistro_Financeiro\",\"        And ((Ffp.IdMoeda_Origem = Ltx.IdMoeda_Pagamento And Ffp.IdMoeda_Destino = Lfp.IdMoeda)\",\"        Or (Ffp.IdMoeda_Origem = Lfp.IdMoeda And Ffp.IdMoeda_Destino = Ltx.IdMoeda_Pagamento))\",\"    Left Outer Join /* Fator Fatura Recebimento */\",\"      mov_Logistica_Fatura_Conversao Ffr On Ffr.IdLogistica_Fatura = Lfr.IdRegistro_Financeiro\",\"        And ((Ffr.IdMoeda_Origem = Ltx.IdMoeda_Recebimento And Ffr.IdMoeda_Destino = Lfr.IdMoeda)\",\"        Or (Ffr.IdMoeda_Origem = Lfr.IdMoeda And Ffr.IdMoeda_Destino = Ltx.IdMoeda_Recebimento))\",\"  ) Txs\",\"  Left Outer Join\",\"    Mov_Logistica_House Lhs on Lhs.IdLogistica_House = Txs.IdLogistica_House\",\"  Left Outer Join /* Totaliza as faturas de Pagamento */\",\"    (Select\",\"      Ffn.IdRegistro_Financeiro,\",\"      Ffn.Natureza,\",\"      Ffn.Situacao,\",\"      Max(Ffn.Data_Pagamento) As Data_Pagamento,\",\"      Sum(Coalesce(Ffn.Total_Pago_Corrente, 0) + Coalesce(Ffn.Total_Pago_Corrente_Unificado, 0)) As Total_Pago_Corrente\",\"    From\",\"      (Select\",\"        Lft.IdRegistro_Financeiro,\",\"        Lft.Natureza,\",\"        Lft.Situacao,\",\"        Ffn.Total_Pago_Corrente,\",\"        Run.IdMoeda,\",\"        Case\",\"          When Ffn.Data_Pagamento Is NULL Then Fun.Data_Pagamento\",\"          When Fun.Data_Pagamento Is NULL Then Ffn.Data_Pagamento\",\"          When Ffn.Data_Pagamento >= Fun.Data_Pagamento Then Ffn.Data_Pagamento\",\"          Else Fun.Data_Pagamento\",\"        End As Data_Pagamento,\",\"        CAST(ROUND(Case /* Obtêm o Percentual da Fatura Unificada no Registro Unificador */\",\"          When (Run.IdRegistro_Financeiro is NULL) or (Run.Subtotal = 0) Then 0\",\"          When (Lft.IdMoeda <> Run.IdMoeda) Then ROUND(Ffn.Valor_Residual * Ffn.Fator_Unificacao * 100, 2) / Run.Subtotal\",\"          Else Ffn.Valor_Residual * 100 / Run.Subtotal\",\"        End * Fun.Total_Pago_Corrente_Unificado / 100, 2) As Numeric(19, 2)) As Total_Pago_Corrente_Unificado\",\"      From\",\"        vis_Logistica_Fatura Lft\",\"      Join\",\"        mov_Fatura_Financeira Ffn On Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro  \",\"      Left Outer Join\",\"        mov_Registro_Financeiro Run On Run.IdRegistro_Financeiro = Ffn.IdRegistro_Unificador\",\"      Left Outer Join\",\"        (Select\",\"          Fun.IdRegistro_Financeiro,\",\"          Fun.Natureza,\",\"          Fun.Situacao,\",\"          MAX(Fun.Data_Pagamento) As Data_Pagamento,\",\"          SUM(Fun.Total_Pago_Corrente) As Total_Pago_Corrente_Unificado\",\"        From\",\"          mov_Fatura_Financeira Fun\",\"        Group BY\",\"          Fun.IdRegistro_Financeiro,\",\"          fun.Situacao,\",\"          fun.Natureza  \",\"        ) As Fun On Fun.IdRegistro_Financeiro = Run.IdRegistro_Financeiro\",\"      ) Ffn\",\"    Group By\",\"      Ffn.IdRegistro_Financeiro,\",\"      Ffn.Situacao,\",\"      Ffn.Natureza\",\"    ) Tfp On Tfp.IdRegistro_Financeiro = Txs.IdRegistro_Pagamento\",\"  Left Outer Join /* Totaliza as faturas de recebimento */\",\"    (Select\",\"      Ffn.IdRegistro_Financeiro,\",\"      MAX(Ffn.Data_Pagamento) As Data_Pagamento,\",\"      SUM(Coalesce(Ffn.Total_Pago_Corrente, 0) + Coalesce(Ffn.Total_Pago_Corrente_Unificado, 0)) As Total_Pago_Corrente\",\"    From\",\"      (Select\",\"        Lft.IdRegistro_Financeiro,\",\"        Ffn.Total_Pago_Corrente,\",\"        Ffn.Situacao,\",\"        Ffn.Natureza,\",\"        Run.IdMoeda,        \",\"        Case\",\"          When Ffn.Data_Pagamento Is NULL Then Fun.Data_Pagamento\",\"          When Fun.Data_Pagamento Is NULL Then Ffn.Data_Pagamento\",\"          When Ffn.Data_Pagamento >= Fun.Data_Pagamento Then Ffn.Data_Pagamento\",\"          Else Fun.Data_Pagamento\",\"        End As Data_Pagamento,\",\"        CAST(ROUND(Case /* Obtêm o Percentual da Fatura Unificada no Registro Unificador */\",\"          When (Run.IdRegistro_Financeiro is NULL) or (Run.Subtotal = 0) Then 0\",\"          When (Lft.IdMoeda <> Run.IdMoeda) Then ROUND(Ffn.Valor_Residual * Ffn.Fator_Unificacao * 100, 2) / Run.Subtotal\",\"          Else Ffn.Valor_Residual * 100 / Run.Subtotal\",\"        End * Fun.Total_Pago_Corrente_Unificado / 100, 2) As Numeric(19, 2)) As Total_Pago_Corrente_Unificado\",\"      From\",\"        vis_Logistica_Fatura Lft\",\"      Join\",\"        mov_Fatura_Financeira Ffn On Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro  \",\"      Left Outer Join\",\"        mov_Registro_Financeiro Run On Run.IdRegistro_Financeiro = Ffn.IdRegistro_Unificador\",\"      Left Outer Join\",\"        (Select\",\"          Fun.IdRegistro_Financeiro,\",\"          Fun.Situacao,\",\"          Fun.Natureza,\",\"          MAX(Fun.Data_Pagamento) As Data_Pagamento,\",\"          SUM(Fun.Total_Pago_Corrente) As Total_Pago_Corrente_Unificado\",\"        From\",\"          mov_Fatura_Financeira Fun\",\"        Group BY\",\"          Fun.IdRegistro_Financeiro,\",\"          Fun.Situacao,\",\"          Fun.Natureza  \",\"        ) As Fun On Fun.IdRegistro_Financeiro = Run.IdRegistro_Financeiro\",\"      ) Ffn\",\"    Group By\",\"      Ffn.IdRegistro_Financeiro,\",\"      Ffn.Situacao,\",\"      Ffn.Natureza\",\"    ) Tfr On Tfr.IdRegistro_Financeiro = Txs.IdRegistro_Recebimento\",\"  ) Lcm\",\"Left Outer Join\",\"  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Lcm.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.IdLogistica_Master\",\"Left Outer Join\",\"  cad_Pessoa Ppg On Ppg.IdPessoa = Lcm.IdPessoa_Pagamento  \",\"Left Outer Join\",\"  cad_Pessoa Prc On Prc.IdPessoa = Lcm.IdPessoa_Recebimento\",\"Left Outer Join\",\"  vis_Logistica_Fatura Ffp on Ffp.IdRegistro_Financeiro = Lcm.IdRegistro_Pagamento\",\"Left Outer Join\",\"  vis_Logistica_Fatura Ffr on Ffr.IdRegistro_Financeiro = Lcm.IdRegistro_Recebimento   \",\"Left Outer Join\",\"  cad_Moeda Mfp on Mfp.IdMoeda = Ffp.IdMoeda\",\"Left Outer Join\",\"  cad_Moeda Mfr on Mfr.IdMoeda = Ffr.IdMoeda\",\"Left Outer Join\",\"  cad_Moeda Mcr On Mcr.Moeda_Corrente = 1\",\"Left Outer Join\",\"  mov_Logistica_Moeda Lmd On Lmd.IdLogistica_House = Lhs.IdLogistica_House And Lmd.IdMoeda = Mcr.IdMoeda\",\"Left Outer Join\",\"  cad_Taxa_Logistica_Classificacao Tlc on Tlc.IdTaxa_Logistica_Classificacao = Lcm.IdTaxa_Logistica_Classificacao\",\"Left Outer Join\",\"  cad_Pessoa Vnd on Vnd.IdPessoa = Lhs.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Ept on Ept.IdPessoa = Lhs.IdExportador\",\"Left Outer Join\",\"  cad_Pessoa Imp on Imp.IdPessoa = Lhs.IdImportador\",/*WHERE*/,\"Order by\",\"  Lcm.IdLogistica_House\"\n\n[Campos]\nCampo[0].FieldName=IdLogistica_Taxa\nCampo[0].Origin=Lcm.IdLogistica_Taxa\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Taxa_Logistica_Exibicao\nCampo[1].Origin=Lcm.Taxa_Logistica_Exibicao\nCampo[1].DisplayLabel=Taxa\nCampo[1].Width=100\nCampo[2].FieldName=Numero_Processo\nCampo[2].Origin=Lhs.Numero_Processo\nCampo[2].DisplayLabel=Processo\nCampo[2].Width=80\nCampo[3].FieldName=Pessoa_Pagamento\nCampo[3].Origin=coalesce(Ppg.Nome_Fantasia,Ppg.Nome)\nCampo[3].DisplayLabel=Pessoa Pgto\nCampo[3].Width=120\nCampo[4].FieldName=Moeda_Pagamento\nCampo[4].Origin=Lcm.Moeda_Pagamento\nCampo[4].DisplayLabel=Moeda Pgto\nCampo[4].Width=40\nCampo[5].FieldName=Valor_Pagamento_Total\nCampo[5].Origin=Lcm.Valor_Pagamento_Total\nCampo[5].DisplayLabel=Valor Pgto\nCampo[5].DisplayFormat=#,0.00\nCampo[5].Width=70\nCampo[6].FieldName=Fator_Pagamento_Dinamico\nCampo[6].Origin=Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End\nCampo[6].DisplayLabel=Fator Pgto\nCampo[6].DisplayFormat=#,0.0000\nCampo[6].Width=70\nCampo[7].FieldName=Valor_Pagamento_Dinamico\nCampo[7].Origin=Lcm.Valor_Pagamento_Dinamico\nCampo[7].DisplayLabel=Valor Pgto BRL\nCampo[7].DisplayFormat=#,0.00\nCampo[7].Width=70\nCampo[8].FieldName=Data_Pagamento\nCampo[8].Origin=Lcm.Data_Pagamento\nCampo[8].DisplayLabel=Data Pgto\nCampo[8].DisplayFormat=dd/mm/yyyy\nCampo[8].Width=70\nCampo[9].FieldName=Pagar_Para\nCampo[9].Origin=Lcm.Pagar_Para\nCampo[9].DisplayLabel=Tipo Pessoa Pagto\nCampo[9].Width=50\nCampo[9].Items=0,1,2,3,13,9,4,5,6,10,11,12,15,14,7,8\nCampo[9].ItemsEx=\"Sem pagamento)\",Agencia,\"Agente Origem\", \"Agente Destino\",\"Associação Internacional\",Cliente, Comissionado, \"Cia Transporte\", Despachante, Exportador, Importador, Representante, \"Representante DF\", Seguradora, Vendedor, Outro\nCampo[9].Alignment=0\nCampo[10].FieldName=Pago\nCampo[10].Origin=case When (Lcm.Valor_Pagamento_Total Is Null) Then 0 When (Lcm.Data_Pagamento Is Null) Then 1 Else 2 End\nCampo[10].DisplayLabel=Pago\nCampo[10].Width=50\nCampo[10].Items=0,1,2\nCampo[10].ItemsEx=\"Sem cobrança\",\"Em aberto\",\"Pago\"\nCampo[10].Alignment=0\nCampo[11].FieldName=Data_Vcto_Pgto\nCampo[11].Origin=Ffp.Data_Referencia\nCampo[11].DisplayLabel=Data Vcto Pgto\nCampo[11].DisplayFormat=dd/mm/yyyy\nCampo[11].Width=70\nCampo[12].FieldName=Moeda_Fat_Pgto\nCampo[12].Origin=Mfp.Sigla\nCampo[12].DisplayLabel=Moeda Fat Pgto\nCampo[12].Width=40\nCampo[13].FieldName=Valor_Fat_Pgto\nCampo[13].Origin=Ffp.Valor_Original\nCampo[13].DisplayLabel=Valor Fat Pgto\nCampo[13].DisplayFormat=#,0.00\nCampo[13].Width=70\nCampo[14].FieldName=Numero_Fat_Pag\nCampo[14].DisplayLabel=Numero_Fat_Pag\nCampo[14].Origin=Lcm.Numero_Fat_Pag\nCampo[14].Width=70\nCampo[15].FieldName=Pessoa_Recebimento\nCampo[15].Origin=coalesce(Prc.Nome_Fantasia,Prc.Nome)\nCampo[15].DisplayLabel=Pessoa Rcbto\nCampo[15].Width=120\nCampo[16].FieldName=Receber_De\nCampo[16].Origin=Lcm.Receber_De\nCampo[16].DisplayLabel=Tipo Pessoa Rcbto\nCampo[16].Width=50\nCampo[16].Items=0,1,2,10,3,4,8,5,6,9,7\nCampo[16].ItemsEx=\"(Sem recebimento)\",\"Agente  Origem\", \"Agente Destino\", Associação, Cliente, Comissionado, \"Cia Transporte\", Exportador, Importador, Notify, Outro\nCampo[16].Alignment=0\nCampo[17].FieldName=Moeda_Recebimento\nCampo[17].Origin=Lcm.Moeda_Recebimento\nCampo[17].DisplayLabel=Moeda Rcbto\nCampo[17].Width=40\nCampo[18].FieldName=Valor_Recebimento_Total\nCampo[18].Origin=Lcm.Valor_Recebimento_Total\nCampo[18].DisplayLabel=Valor Rcbto\nCampo[18].DisplayFormat=#,0.00\nCampo[18].Width=70\nCampo[19].FieldName=Fator_Recebimento_Dinamico\nCampo[19].Origin=Lcm.Fator_Recebimento_Dinamico\nCampo[19].DisplayLabel=Fator Rcbto\nCampo[19].DisplayFormat=#,0.0000\nCampo[19].Width=70\nCampo[20].FieldName=Valor_Recebimento_Dinamico\nCampo[20].Origin=Lcm.Valor_Recebimento_Dinamico\nCampo[20].DisplayLabel=Valor Rcbto BRL\nCampo[20].DisplayFormat=#,0.00\nCampo[20].Width=70\nCampo[21].FieldName=Data_Recebimento\nCampo[21].Origin=Lcm.Data_Recebimento\nCampo[21].DisplayLabel=Data Rcbto\nCampo[21].DisplayFormat=dd/mm/yyyy\nCampo[21].Width=70\nCampo[22].FieldName=Recebido\nCampo[22].Origin=case When (Lcm.Valor_Recebimento_Total Is Null) Then 0 When (Lcm.Data_Recebimento Is Null) Then 1 Else 2 End\nCampo[22].DisplayLabel=Recebido\nCampo[22].Width=50\nCampo[22].Items=0,1,2\nCampo[22].ItemsEx=\"Sem cobrança\",\"Em aberto\",\"Recebido\"\nCampo[22].Alignment=0\nCampo[23].FieldName=Data_Vcto_Rcbto\nCampo[23].Origin=Ffr.Data_Referencia\nCampo[23].DisplayLabel=Data Vcto Rcbto\nCampo[23].DisplayFormat=dd/mm/yyyy\nCampo[23].Width=70\nCampo[24].FieldName=Moeda_Fat_Rcbto\nCampo[24].Origin=Mfr.Sigla\nCampo[24].DisplayLabel=Moeda Fat Rcbto\nCampo[24].Width=40\nCampo[25].FieldName=Valor_Fat_Rcbto\nCampo[25].Origin=Ffr.Valor_Original\nCampo[25].DisplayLabel=Valor Fat Rcbto\nCampo[25].DisplayFormat=#,0.00\nCampo[25].Width=70\nCampo[26].FieldName=Numero_Fat_Rec\nCampo[26].DisplayLabel=Numero_Fat_Rec\nCampo[26].Origin=Lcm.Numero_Fat_Rec\nCampo[26].Width=70\nCampo[27].FieldName=Saldo_Dinamico\nCampo[27].Origin=Coalesce(Lcm.Valor_Recebimento_Dinamico, 0) - Coalesce(Lcm.Valor_Pagamento_Dinamico, 0)\nCampo[27].DisplayLabel=Saldo Estimado Taxa\nCampo[27].DisplayFormat=#,0.00\nCampo[27].Width=70\nCampo[28].FieldName=Saldo_Efetivo\nCampo[28].Origin=Lcm.Saldo_Efetivo\nCampo[28].DisplayLabel=Saldo Efetivo Taxa\nCampo[28].DisplayFormat=#,0.00\nCampo[28].Width=70\nCampo[29].FieldName=Lucro_Processo\nCampo[29].Origin=Lmd.Lucro_Momento\nCampo[29].DisplayLabel=Profit Estimado Processo\nCampo[29].DisplayFormat=#,0.00\nCampo[29].Width=70\nCampo[30].FieldName=Data_Recebimento_Processo\nCampo[30].Origin=Lhs.Data_Recebimento_Local\nCampo[30].DisplayLabel=Data Recebimento Processo\nCampo[30].DisplayFormat=dd/mm/yyyy\nCampo[30].Width=70\nCampo[31].FieldName=Data_Competencia\nCampo[31].Origin=case When Lms.Tipo_Operacao = 1 /*Expo*/ Then Lms.Data_Embarque Else Lms.Data_Desembarque End\nCampo[31].DisplayLabel=Data Competência\nCampo[31].DisplayFormat=dd/mm/yyyy\nCampo[32].FieldName=Taxas_Adiantadas\nCampo[32].Origin=case When (Tlc.IdTaxa_Logistica_Classificacao = 1) And (Lcm.Data_Recebimento Is Null) Then 'Adiantado' Else Null End\nCampo[32].DisplayLabel=Adiantado\nCampo[32].Width=70\nCampo[33].FieldName=Variacao_Cambial\nCampo[33].Origin=Case When ((Lcm.Moeda_Pagamento = Lcm.Moeda_Corrente) And (Lcm.Moeda_Recebimento = Lcm.Moeda_Corrente)) Then 0 /*Tudo em BRL*/ When (Lcm.Moeda_Pagamento <> Lcm.Moeda_Recebimento) Then 0 /*Moedas Diferentes, ignora a variacao*/ Else (coalesce(Lcm.Valor_Pagamento_Total,0) * (Lcm.Fator_Recebimento_Dinamico-(Case When Lcm.Valor_Pagamento_Total = 0 Then 0 When Coalesce(Lcm.Fator_Pagamento_Dinamico,0) = 0 Then (Lcm.Valor_Pagamento_Dinamico/Lcm.Valor_Pagamento_Total) Else Lcm.Fator_Pagamento_Dinamico End))) End\nCampo[33].DisplayLabel=Variacao Cambial\nCampo[33].DisplayFormat=#,0.00\nCampo[33].Width=70\nCampo[34].FieldName=Vendedor\nCampo[34].Origin=Vnd.Nome_Fantasia\nCampo[34].DisplayLabel=Vendedor\nCampo[34].Width=120\nCampo[35].FieldName=Shipper\nCampo[35].Origin=Ept.Nome_Fantasia\nCampo[35].DisplayLabel=Shipper\nCampo[35].Width=120\nCampo[36].FieldName=Consignee\nCampo[36].Origin=Imp.Nome_Fantasia\nCampo[36].DisplayLabel=Consignee\nCampo[36].Width=120\nCampo[37].FieldName=Importador_Exportador\nCampo[37].Origin=case When Lms.Tipo_Operacao = 1 Then Ept.Nome_Fantasia Else Imp.Nome_Fantasia End\nCampo[37].DisplayLabel=Shipper_Consignee\nCampo[37].Width=120\nCampo[38].FieldName=Agenciamento_Carga\nCampo[38].Origin=Lhs.Agenciamento_Carga\nCampo[38].DisplayLabel=Agenciamento\nCampo[38].Width=70\nCampo[39].FieldName=Desembaraco_Aduaneiro\nCampo[39].Origin=Lhs.Desembaraco_Aduaneiro\nCampo[39].DisplayLabel=Desembaraço\nCampo[39].Width=70\nCampo[40].FieldName=Demurrage_Detention\nCampo[40].Origin=Lhs.Demurrage_Detention\nCampo[40].DisplayLabel=Demurrage/Detention\nCampo[40].Width=70\nCampo[41].FieldName=Data_Fechamento_Processo\nCampo[41].Origin=Lhs.Data_Fechamento_Processo\nCampo[41].DisplayLabel=Data Finalizado\nCampo[41].DisplayFormat=dd/mm/yyyy\nCampo[41].Width=70\nCampo[42].FieldName=Data_Acerto_Agente\nCampo[42].Origin=Lhs.Data_Acerto_Agente\nCampo[42].DisplayLabel=Data Acerto Agente\nCampo[42].DisplayFormat=dd/mm/yyyy\nCampo[42].Width=70\nCampo[43].FieldName=Data_Liberado_Faturamento\nCampo[43].Origin=Lhs.Data_Liberado_Faturamento\nCampo[43].DisplayLabel=Data Liberado Faturamento\nCampo[43].DisplayFormat=dd/mm/yyyy\nCampo[43].Width=70\nCampo[44].FieldName=Situacao_Agenciamento\nCampo[44].Origin=Lhs.Situacao_Agenciamento\nCampo[44].DisplayLabel=Situação Agenciamento\nCampo[44].Width=80\nCampo[44].Items=1,2,3,4,5,6,7\nCampo[44].ItemsEx=\"Processo Aberto\",\"Em andamento\",\"Liberado Faturamento \",\"Faturado\",\"Finalizado\",\"Auditado\",Cancelado\nCampo[44].Alignment=0\nCampo[45].FieldName=Data_Faturado\nCampo[45].Origin=Lhs.Data_Faturado\nCampo[45].DisplayLabel=Data Faturado\nCampo[45].DisplayFormat=dd/mm/yyyy\nCampo[45].Width=70\nCampo[46].FieldName=Data_Auditado\nCampo[46].Origin=Lhs.Data_Auditado\nCampo[46].DisplayLabel=Data Auditado\nCampo[46].DisplayFormat=dd/mm/yyyy\nCampo[46].Width=70\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\COMISSÃO VENDEDOR\\Sql consulta comissão vendedor.chd",
        "conteudo": "[Consulta]\nCampos=12\nCommandText=Select,\"ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"Lhs.Numero_Processo,\",\"Lhs.Data_Abertura_Processo,\",\"Case When Lhs.Situacao_Agenciamento = 1 Then 'Processo Aberto' When Lhs.Situacao_Agenciamento = 2 Then 'Em Andamento' When Lhs.Situacao_Agenciamento = 3 Then 'Liberado Faturamento' When Lhs.Situacao_Agenciamento = 4 Then 'Faturado' When Lhs.Situacao_Agenciamento = 5 Then 'Finalizado' When Lhs.Situacao_Agenciamento = 6 Then 'Auditado' When Lhs.Situacao_Agenciamento = 7 Then 'Cancelado' End as Situacao_Agenciamento,\",\"Lft.Numero as Numero_Fatura,\",\"Lft.Data as Data_Insercao_Fatura,\",\"Ffn.Data_Vencimento,\",\"Psa.Nome as Vendedor,\",\"Moe.Sigla as Moeda,\",\"Lft.Valor_Original,\",\"Lft.Fator_Corrente,\",Lft.Valor_Corrente,From,\"  Vis_Logistica_Fatura Lft\",\"Left outer join\",\"  mov_Logistica_House Lhs on Lhs.IdLogistica_House = Lft.IdLogistica_House\",\"Left outer Join\",\"  mov_Fatura_Financeira Ffn on Ffn.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\",\"Left outer join\",\"  cad_Pessoa Psa on Psa.IdPessoa = Lft.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Moe on Moe.IdMoeda = Lft.IdMoeda\",/*WHERE*/,Where,\"  Lft.Tipo_Fatura = 8 /*Vendedor*/ and Lft.Valor_Corrente <> 0\"\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].DisplayLabel=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].Width=50\nCampo[1].FieldName=Numero_Processo\nCampo[1].DisplayLabel=Numero_Processo\nCampo[1].Origin=Lhs.Numero_Processo\nCampo[1].Width=100\nCampo[2].FieldName=Data_Abertura_Processo\nCampo[2].DisplayLabel=Data_Abertura_Processo\nCampo[2].Origin=Lhs.Data_Abertura_Processo\nCampo[2].Width=100\nCampo[3].FieldName=Situacao_Agenciamento\nCampo[3].DisplayLabel=Situacao_Agenciamento\nCampo[3].Origin=Case When Lhs.Situacao_Agenciamento = 1 Then 'Processo Aberto' When Lhs.Situacao_Agenciamento = 2 Then 'Em Andamento' When Lhs.Situacao_Agenciamento = 3 Then 'Liberado Faturamento' When Lhs.Situacao_Agenciamento = 4 Then 'Faturado' When Lhs.Situacao_Agenciamento = 5 Then 'Finalizado' When Lhs.Situacao_Agenciamento = 6 Then 'Auditado' When Lhs.Situacao_Agenciamento = 7 Then 'Cancelado' End\nCampo[3].Width=150\nCampo[4].FieldName=Numero_Fatura\nCampo[4].DisplayLabel=Numero_Fatura\nCampo[4].Origin=Lft.Numero\nCampo[4].Width=100\nCampo[5].FieldName=Data_Insercao_Fatura\nCampo[5].DisplayLabel=Data_Insercao_Fatura\nCampo[5].Origin=Lft.Data\nCampo[5].Width=100\nCampo[6].FieldName=Data_Vencimento\nCampo[6].DisplayLabel=Data_Vencimento\nCampo[6].Origin=Ffn.Data_Vencimento\nCampo[6].Width=100\nCampo[7].FieldName=Vendedor\nCampo[7].DisplayLabel=Vendedor\nCampo[7].Origin=Psa.Nome\nCampo[7].Width=200\nCampo[8].FieldName=Moeda\nCampo[8].DisplayLabel=Moeda\nCampo[8].Origin=Moe.Sigla\nCampo[8].Width=80\nCampo[9].FieldName=Valor_Original\nCampo[9].DisplayLabel=Valor_Original\nCampo[9].Origin=Lft.Valor_Original\nCampo[9].Width=100\nCampo[10].FieldName=Fator_Corrente\nCampo[10].DisplayLabel=Fator_Corrente\nCampo[10].Origin=Lft.Fator_Corrente\nCampo[10].Width=100\nCampo[11].FieldName=Valor_Corrente\nCampo[11].DisplayLabel=Valor_Corrente\nCampo[11].Origin=Lft.Valor_Corrente\nCampo[11].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\CONTAS A PAGAR\\RELATORIO CONTAS A PAGAR OK.chd",
        "conteudo": "[Consulta]\nCampos=15\nCommandText=Select,\"  ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"  Lft.Referencia,\",\"  Lft.Referencia_Externa,\",\"  Lft.Numero AS Numero_Fatura,\",\"  Lft.Data,\",\"  DATEDIFF(day, Getdate(), Lft.Data_Referencia) AS Dias_Vencimento_Vencido,\",\"  Case\",\"    When Lft.Natureza = 0 Then 'DÉBITO'\",\"\tWhen Lft.Natureza = 1 Then 'CRÉDITO'\",\"  End As Natureza,\",\"  Lft.Data_Referencia,\",\"  Ttc.Nome AS Tipo_Transacao,\",\"  Psa.Nome AS Pessoa,\",\"  Case\",\"    When Lft.Situacao = 1 Then 'EM ABERTO'\",\"\tWhen Lft.Situacao = 2 Then 'QUITADA'\",\"\tWhen Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA'\",\"\tWhen Lft.Situacao = 4 Then 'UNIFICADA'\",\"\tWhen Lft.Situacao = 5 Then 'EM COBRANÇA'\",\"\tWhen Lft.Situacao = 6 Then 'CANCELADA'\",\"\tWhen Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL'\",\"\tWhen Lft.Situacao = 8 Then 'NEGATIVADO'\",\"\tWhen Lft.Situacao = 9 Then 'PROTESTADO'\",\"\tWhen Lft.Situacao = 10 Then 'JUNK'\",\"  End As Situacao,\",\"  Case\",\"    When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO'\",\"\tWhen Lft.Tipo_Fatura = 3 Then 'AGENTE'\",\"\tWhen Lft.Tipo_Fatura = 4 Then 'COMISSÃO'\",\"\tWhen Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS'\",\"\tWhen Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO'\",\"\tWhen Lft.Tipo_Fatura = 8 Then 'VENDEDOR'\",\"\tWhen Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE'\",\"\tWhen Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL'\",\"\tWhen Lft.Tipo_Fatura = 13 Then 'SEGURADORA'\",\"\tWhen Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE'\",\"\tWhen Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT'\",\"\tWhen Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE'\",\"\tWhen Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE'\",\"  End As Tipo_Fatura,\",\"  Lft.Data_Pagamento,\",\"  Mda.Sigla AS Moeda,\",\"  FORMAT(Lft.Valor_Total, 'N', 'pt-BR') AS Valor_Total,\",\"  FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR') AS Valor_Residual\",,From,\"  vis_Logistica_Fatura_Totais Lft\",,/*OPERACIONAL*/,\"   \",,/*CADASTRO*/,\"Left Outer Join\",\"  cad_Tipo_Transacao Ttc ON Ttc.IdTipo_Transacao = Lft.IdTipo_Transacao\",\"Left Outer Join\",\"  cad_Pessoa Psa ON Psa.IdPessoa = Lft.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda ON Mda.IdMoeda = Lft.IdMoeda\",Where,\"  Lft.Natureza = 0 /*Débito*/\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Referencia\nCampo[1].DisplayLabel=Referência\nCampo[1].Origin=Lft.Referencia\nCampo[1].Width=100\nCampo[2].FieldName=Numero_Fatura\nCampo[2].DisplayLabel=Número Fatura\nCampo[2].Origin=Lft.Numero_Fatura\nCampo[2].Width=100\nCampo[3].FieldName=Data\nCampo[3].DisplayLabel=Data\nCampo[3].Origin=Lft.Data\nCampo[3].Width=100\nCampo[3].DisplayFormat=dd/mm/yyyy\nCampo[4].FieldName=Dias_Vencimento_Vencido\nCampo[4].DisplayLabel=Dias a Vencer/Vencido\nCampo[4].Origin=DATEDIFF(day, Getdate(), Lft.Data_Referencia)\nCampo[4].Width=50\nCampo[5].FieldName=Natureza\nCampo[5].DisplayLabel=Natureza\nCampo[5].Origin=Case When Lft.Natureza = 0 Then 'DÉBITO' When Lft.Natureza = 1 Then 'CRÉDITO' End\nCampo[5].Width=100\nCampo[6].FieldName=Data_Referencia\nCampo[6].DisplayLabel=Data Referência\nCampo[6].Origin=LFt.Data_Referencia\nCampo[6].Width=100\nCampo[6].DisplayFormat=dd/mm/yyyy\nCampo[7].FieldName=Tipo_Transacao\nCampo[7].DisplayLabel=Tipo de Transação\nCampo[7].Origin=Ttc.Nome\nCampo[7].Width=100\nCampo[8].FieldName=Pessoa\nCampo[8].DisplayLabel=Pessoa\nCampo[8].Origin=Psa.Nome\nCampo[8].Width=150\nCampo[9].FieldName=Situacao\nCampo[9].DisplayLabel=Situação\nCampo[9].Origin=Case When Lft.Situacao = 1 Then 'EM ABERTO' When Lft.Situacao = 2 Then 'QUITADA' When Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA' When Lft.Situacao = 4 Then 'UNIFICADA' When Lft.Situacao = 5 Then 'EM COBRANÇA' When Lft.Situacao = 6 Then 'CANCELADA' When Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL' When Lft.Situacao = 8 Then 'NEGATIVADO' When Lft.Situacao = 9 Then 'PROTESTADO' When Lft.Situacao = 10 Then 'JUNK' End\nCampo[9].Width=100\nCampo[10].FieldName=Tipo_Fatura\nCampo[10].DisplayLabel=Tipo de Fatura\nCampo[10].Origin=Case When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO' When Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO' When Lft.Tipo_Fatura = 3 Then 'AGENTE' When Lft.Tipo_Fatura = 4 Then 'COMISSÃO' When Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS' When Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO' When Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO' When Lft.Tipo_Fatura = 8 Then 'VENDEDOR' When Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE' When Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE' When Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE' When Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL' When Lft.Tipo_Fatura = 13 Then 'SEGURADORA' When Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE' When Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT' When Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE' When Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE' End\nCampo[10].Width=100\nCampo[11].FieldName=Data_Pagamento\nCampo[11].DisplayLabel=Data Pagamento\nCampo[11].Origin=Lft.Data_Pagamento\nCampo[11].Width=100\nCampo[11].DisplayFormat=dd/mm/yyyy\nCampo[12].FieldName=Moeda\nCampo[12].DisplayLabel=Moeda\nCampo[12].Origin=Mda.Sigla\nCampo[12].Width=50\nCampo[13].FieldName=Valor_Total\nCampo[13].DisplayLabel=Valor Total\nCampo[13].Origin=FORMAT(Lft.Valor_Total, 'N', 'pt-BR')\nCampo[13].Width=100\nCampo[14].FieldName=Valor_Residual\nCampo[14].DisplayLabel=Valor Residual\nCampo[14].Origin=FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR')\nCampo[14].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\CONTAS A RECEBER\\RELATORIO CONTAS A RECEBER OK.chd",
        "conteudo": "[Consulta]\nCampos=15\nCommandText=Select,\"  ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"  Lft.Referencia,\",\"  Lft.Referencia_Externa,\",\"  Lft.Numero AS Numero_Fatura,\",\"  Lft.Data,\",\"  DATEDIFF(day, Getdate(), Lft.Data_Referencia) AS Dias_Vencimento_Vencido,\",\"  Case\",\"    When Lft.Natureza = 0 Then 'DÉBITO'\",\"\tWhen Lft.Natureza = 1 Then 'CRÉDITO'\",\"  End As Natureza,\",\"  Lft.Data_Referencia,\",\"  Ttc.Nome AS Tipo_Transacao,\",\"  Psa.Nome AS Pessoa,\",\"  Case\",\"    When Lft.Situacao = 1 Then 'EM ABERTO'\",\"\tWhen Lft.Situacao = 2 Then 'QUITADA'\",\"\tWhen Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA'\",\"\tWhen Lft.Situacao = 4 Then 'UNIFICADA'\",\"\tWhen Lft.Situacao = 5 Then 'EM COBRANÇA'\",\"\tWhen Lft.Situacao = 6 Then 'CANCELADA'\",\"\tWhen Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL'\",\"\tWhen Lft.Situacao = 8 Then 'NEGATIVADO'\",\"\tWhen Lft.Situacao = 9 Then 'PROTESTADO'\",\"\tWhen Lft.Situacao = 10 Then 'JUNK'\",\"  End As Situacao,\",\"  Case\",\"    When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO'\",\"\tWhen Lft.Tipo_Fatura = 3 Then 'AGENTE'\",\"\tWhen Lft.Tipo_Fatura = 4 Then 'COMISSÃO'\",\"\tWhen Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS'\",\"\tWhen Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO'\",\"\tWhen Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO'\",\"\tWhen Lft.Tipo_Fatura = 8 Then 'VENDEDOR'\",\"\tWhen Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE'\",\"\tWhen Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE'\",\"\tWhen Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL'\",\"\tWhen Lft.Tipo_Fatura = 13 Then 'SEGURADORA'\",\"\tWhen Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE'\",\"\tWhen Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT'\",\"\tWhen Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE'\",\"\tWhen Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE'\",\"  End As Tipo_Fatura,\",\"  Lft.Data_Pagamento,\",\"  Mda.Sigla AS Moeda,\",\"  FORMAT(Lft.Valor_Total, 'N', 'pt-BR') AS Valor_Total,\",\"  FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR') AS Valor_Residual\",,From,\"  vis_Logistica_Fatura_Totais Lft\",,/*OPERACIONAL*/,\"   \",,/*CADASTRO*/,\"Left Outer Join\",\"  cad_Tipo_Transacao Ttc ON Ttc.IdTipo_Transacao = Lft.IdTipo_Transacao\",\"Left Outer Join\",\"  cad_Pessoa Psa ON Psa.IdPessoa = Lft.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda ON Mda.IdMoeda = Lft.IdMoeda\",Where,\"  Lft.Natureza = 1 /*Crédito*/\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Referencia\nCampo[1].DisplayLabel=Referência\nCampo[1].Origin=Lft.Referencia\nCampo[1].Width=100\nCampo[2].FieldName=Numero_Fatura\nCampo[2].DisplayLabel=Número Fatura\nCampo[2].Origin=Lft.Numero_Fatura\nCampo[2].Width=100\nCampo[3].FieldName=Data\nCampo[3].DisplayLabel=Data\nCampo[3].Origin=Lft.Data\nCampo[3].Width=100\nCampo[3].DisplayFormat=dd/mm/yyyy\nCampo[4].FieldName=Dias_Vencimento_Vencido\nCampo[4].DisplayLabel=Dias a Vencer/Vencido\nCampo[4].Origin= DATEDIFF(day, Getdate(), Lft.Data_Referencia)\nCampo[4].Width=50\nCampo[5].FieldName=Natureza\nCampo[5].DisplayLabel=Natureza\nCampo[5].Origin=Case When Lft.Natureza = 0 Then 'DÉBITO' When Lft.Natureza = 1 Then 'CRÉDITO' End\nCampo[5].Width=100\nCampo[6].FieldName=Data_Referencia\nCampo[6].DisplayLabel=Data Referência\nCampo[6].Origin=LFt.Data_Referencia\nCampo[6].Width=100\nCampo[6].DisplayFormat=dd/mm/yyyy\nCampo[7].FieldName=Tipo_Transacao\nCampo[7].DisplayLabel=Tipo de Transação\nCampo[7].Origin=Ttc.Nome\nCampo[7].Width=100\nCampo[8].FieldName=Pessoa\nCampo[8].DisplayLabel=Pessoa\nCampo[8].Origin=Psa.Nome\nCampo[8].Width=150\nCampo[9].FieldName=Situacao\nCampo[9].DisplayLabel=Situação\nCampo[9].Origin=Case When Lft.Situacao = 1 Then 'EM ABERTO' When Lft.Situacao = 2 Then 'QUITADA' When Lft.Situacao = 3 Then 'PARCIALMENTE QUITADA' When Lft.Situacao = 4 Then 'UNIFICADA' When Lft.Situacao = 5 Then 'EM COBRANÇA' When Lft.Situacao = 6 Then 'CANCELADA' When Lft.Situacao = 7 Then 'EM COBRANÇA JUDICIAL' When Lft.Situacao = 8 Then 'NEGATIVADO' When Lft.Situacao = 9 Then 'PROTESTADO' When Lft.Situacao = 10 Then 'JUNK' End\nCampo[9].Width=100\nCampo[10].FieldName=Tipo_Fatura\nCampo[10].DisplayLabel=Tipo de Fatura\nCampo[10].Origin=Case When Lft.Tipo_Fatura = 1 Then 'PAGAMENTO' When Lft.Tipo_Fatura = 2 Then 'RECEBIMENTO' When Lft.Tipo_Fatura = 3 Then 'AGENTE' When Lft.Tipo_Fatura = 4 Then 'COMISSÃO' When Lft.Tipo_Fatura = 5 Then 'OUTRAS DESPESAS' When Lft.Tipo_Fatura = 6 Then 'ADIANTAMENTO' When Lft.Tipo_Fatura = 7 Then 'ACERTO DE SALDO' When Lft.Tipo_Fatura = 8 Then 'VENDEDOR' When Lft.Tipo_Fatura = 9 Then 'REPRESENTANTE' When Lft.Tipo_Fatura = 10 Then 'CAUÇÃO DEMURRAGE' When Lft.Tipo_Fatura = 11 Then 'ACERTO DEMURRAGE' When Lft.Tipo_Fatura = 12 Then 'ASSOCIAÇÃO INTERNACIONAL' When Lft.Tipo_Fatura = 13 Then 'SEGURADORA' When Lft.Tipo_Fatura = 14 Then 'RECEBIMENTO DE REPASSE' When Lft.Tipo_Fatura = 15 Then 'ACERTO PROFIT' When Lft.Tipo_Fatura = 16 Then 'PAGAMENTO DESPACHANTE' When Lft.Tipo_Fatura = 17 Then 'RECEBIMENTO DESPACHANTE' End\nCampo[10].Width=100\nCampo[11].FieldName=Data_Pagamento\nCampo[11].DisplayLabel=Data Pagamento\nCampo[11].Origin=Lft.Data_Pagamento\nCampo[11].Width=100\nCampo[11].DisplayFormat=dd/mm/yyyy\nCampo[12].FieldName=Moeda\nCampo[12].DisplayLabel=Moeda\nCampo[12].Origin=Mda.Sigla\nCampo[12].Width=50\nCampo[13].FieldName=Valor_Total\nCampo[13].DisplayLabel=Valor Total\nCampo[13].Origin=FORMAT(Lft.Valor_Total, 'N', 'pt-BR')\nCampo[13].Width=100\nCampo[14].FieldName=Valor_Residual\nCampo[14].DisplayLabel=Valor Residual\nCampo[14].Origin=FORMAT(Lft.Valor_Residual_Fatura, 'N', 'pt-BR')\nCampo[14].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\CONTAS ADMINISTRATIVAS\\CONTAS ADMINISTRATIVAS CONSULTA.chd",
        "conteudo": "[Consulta]\nCampos=10\nCommandText=SELECT,\"Ffn.Numero as Numero_Fatura,\",\"Ffn.Data as Data_Insercao_Fatura,\",\"Ffn.Data_Vencimento,\",\"CASE WHEN Ffn.Situacao = 1 THEN 'Em Aberto' WHEN Ffn.Situacao = 2 THEN 'Quitada' WHEN Ffn.Situacao = 3 THEN 'Parcialmente Quitada' WHEN Ffn.Situacao = 4 THEN 'Unificada' End as Situacao,\",\"CASE WHEN Ffn.Natureza = 0 THEN 'Débito'  WHEN Ffn.Natureza = 1 THEN 'Crédito' End as Natureza,\",\"Moe.Sigla as Moeda,\",\"Ffn.Valor as Valor_Fatura,\",\"Ffn.Valor_Residual,\",\"Psa.Nome as Pessoa_Fatura,\",\"Cpg.Nome as Condicao_Pagamento\",From,\"  mov_Fatura_Financeira Ffn\",\"Left Outer Join\",\"  mov_Logistica_Fatura Lft on Lft.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"Left Outer Join\",\"  mov_Registro_Financeiro Rfn on Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"Left Outer Join\",\"  cad_Pessoa Psa on Psa.IdPessoa = Rfn.IdPessoa\",\"Left Outer Join\",\"  cad_Condicao_Pagamento Cpg on Cpg.IdCondicao_Pagamento = Rfn.IdCondicao_Pagamento\",\"Left Outer Join\",\"  cad_Moeda Moe on Moe.IdMoeda = Rfn.IdMoeda\",/*WHERE*/,Where,\"\tLft.IdRegistro_Financeiro is null\"\n\n[Campos]\nCampo[0].FieldName=Numero_Fatura\nCampo[0].DisplayLabel=Numero_Fatura\nCampo[0].Origin=Ffn.Numero\nCampo[0].Width=80\nCampo[1].FieldName=Data_Insercao_Fatura\nCampo[1].DisplayLabel=Data_Insercao_Fatura\nCampo[1].Origin=Ffn.Data\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=80\nCampo[2].FieldName=Data_Vencimento\nCampo[2].DisplayLabel=Data_Vencimento\nCampo[2].Origin=Ffn.Data_Vencimento\nCampo[2].Width=80\nCampo[3].FieldName=Situacao\nCampo[3].DisplayLabel=Situacao\nCampo[3].Origin=CASE WHEN Ffn.Situacao = 1 THEN 'Em Aberto' WHEN Ffn.Situacao = 2 THEN 'Quitada' WHEN Ffn.Situacao = 3 THEN 'Parcialmente Quitada' WHEN Ffn.Situacao = 4 THEN 'Unificada' End\nCampo[3].Width=100\nCampo[4].FieldName=Natureza\nCampo[4].DisplayLabel=Natureza\nCampo[4].Origin=CASE WHEN Ffn.Natureza = 0 THEN 'Débito'  WHEN Ffn.Natureza = 1 THEN 'Crédito' End\nCampo[4].Width=100\nCampo[5].FieldName=Moeda\nCampo[5].DisplayLabel=Moeda\nCampo[5].Origin=Moe.Sigla\nCampo[5].Width=80\nCampo[6].FieldName=Valor_Fatura\nCampo[6].DisplayLabel=Valor_Fatura\nCampo[6].Origin=Ffn.Valor\nCampo[6].Width=80\nCampo[7].FieldName=Valor_Residual\nCampo[7].DisplayLabel=Valor_Residual\nCampo[7].Origin=Ffn.Valor_Residual\nCampo[7].Width=80\nCampo[8].FieldName=Pessoa_Fatura\nCampo[8].DisplayLabel=Pessoa_Fatura\nCampo[8].Origin=Psa.Nome\nCampo[8].Width=200\nCampo[9].FieldName=Condicao_Pagamento\nCampo[9].DisplayLabel=Condicao_Pagamento\nCampo[9].Origin=Cpg.Nome\nCampo[9].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\CONTATOS CRM\\RELATORIO CONTATOS CRM OK.chd",
        "conteudo": "[Consulta]\nCommandText=Select,\"        ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"\tCli.Codigo,\",\"\tCli.Nome,\",\"\tCli.Cpf_Cnpj,\",\"\tVnd.Nome as Vendedor,\",\"\tPct.Nome as Contato,\",\"\tPct.Fone as Fone_Contato,\",\"\tPct.Email as Email_Contato,\",\"\tCrg.Nome as Cargo_Contato,\",\"\tStr.Nome As Setor_Contato\",\"From \",\"\tvis_Cliente Cli\",\"Left Outer Join\",\"\tcad_Pessoa_Contato Pct on Pct.IdPessoa = Cli.IdPessoa\",\"Left Outer Join\",\"\tcad_Pessoa Vnd on Vnd.IdPessoa = Cli.IdVendedor_Responsavel\",\"Left Outer Join\",\"\tcad_Setor Str on Str.IdSetor = Pct.IdSetor\",\"Left Outer Join\",\"\tcad_Cargo Crg on Crg.IdCargo = Pct.IdCargo\",/*Where*/\nCampos=10\n\n[Campos]\nCampo[0].FieldName=Indice\nCampo[0].Origin=ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT)\nCampo[0].PrimaryKey=1\nCampo[1].FieldName=Codigo\nCampo[1].DisplayLabel=Codigo\nCampo[1].Origin=Cli.Codigo\nCampo[1].Width=100\nCampo[2].FieldName=Nome\nCampo[2].DisplayLabel=Cliente\nCampo[2].Origin=Cli.Nome\nCampo[2].Width=150\nCampo[3].FieldName=Cpf_Cnpj\nCampo[3].DisplayLabel=CNPJ\nCampo[3].Origin=Cli.Cpf_Cnpj\nCampo[3].Width=150\nCampo[4].FieldName=Vendedor\nCampo[4].DisplayLabel=Vendedor\nCampo[4].Origin=Vnd.Nome\nCampo[4].Width=150\nCampo[5].FieldName=Contato\nCampo[5].DisplayLabel=Contato\nCampo[5].Origin=Pct.Nome\nCampo[5].Width=150\nCampo[6].FieldName=Fone_Contato\nCampo[6].DisplayLabel=Fone Contato\nCampo[6].Origin=Pct.Fone\nCampo[6].Width=150\nCampo[7].FieldName=Email_Contato\nCampo[7].DisplayLabel=Email Contato\nCampo[7].Origin=Pct.Email\nCampo[7].Width=200\nCampo[8].FieldName=Cargo_Contato\nCampo[8].DisplayLabel=Cargo Contato\nCampo[8].Origin=Crg.Nome\nCampo[8].Width=150\nCampo[9].FieldName=Setor_Contato\nCampo[9].DisplayLabel=Setor Contato\nCampo[9].Origin=Str.Nome\nCampo[9].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\CONTROLE DE ENVIO DE PROPOSTA\\RELATORIO CONTROLE DE ENVIO DE PROPOSTA OK.chd",
        "conteudo": "[Consulta]\nCampos=13\nCommandText=\"SELECT \",\"  Pfr.Numero_Proposta,\",\"  Pfr.Data_Solicitacao_Cliente,\",\"  CASE WHEN Pfr.Situacao = 1 THEN 'Aguardando Aprovação' WHEN Pfr.Situacao = 2 THEN 'Aprovada' WHEN Pfr.Situacao = 3 THEN 'Não Aprovada' WHEN Pfr.Situacao = 4 THEN 'Não Enviada' WHEN Pfr.Situacao = 5 THEN 'Pré-proposta' WHEN Pfr.Situacao = 6 THEN 'Enviada' END Situacao_Proposta,\",\"  Inc.Nome AS Incoterm,\",\"  Pfc.Tipo_Carga,\",\"  Taf.Descricao AS Atividade,\",\"  Atv.Previsao_Termino,\",\"  Atv.Data_Termino,\",\"  Pes.Nome AS Responsavel,\",\"  CASE WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino < Atv.Data_termino THEN 0 WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino > Atv.Data_termino THEN 1 WHEN Atv.Data_Termino IS NULL THEN 2 END AS Prazo,\",\"  DATEDIFF(day, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) AS Dias,\",\"  DATEDIFF(hour, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 24 AS Horas,\",\"  DATEDIFF(minute, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 60 AS Minutos\",\"FROM \",\"  mov_Proposta_Frete Pfr \",\"left outer join \",\"  mov_Oferta_Frete Ofr on Ofr.IdProposta_Frete = Pfr.IdProposta_Frete\",\"left outer join \",\"  cad_Incoterm Inc on Inc.IdIncoterm = Ofr.IdIncoterm\",\"left outer join \",\"  mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete = Pfr.IdProposta_Frete\",\"left outer join \",\"  mov_Atividade Atv on Atv.IdProjeto_Atividade = Pfr.IdProjeto_Atividade and Atv.IdTarefa = 162\",\"left outer join \",\"  cad_Tarefa Taf on Taf.IdTarefa = Atv.IdTarefa\",\"left outer join \",\"  cad_Pessoa Pes on Pes.IdPessoa = Atv.IdResponsavel\",/*WHERE*/\n\n[Campos]\nCampo[0].FieldName=Numero_Proposta\nCampo[0].DisplayLabel=Número Proposta\nCampo[0].Origin=Pfr.Numero_Proposta\nCampo[0].Width=100\nCampo[1].FieldName=Data_Solicitacao_Cliente\nCampo[1].DisplayLabel=Data Solicitação Cotação\nCampo[1].Origin=Pfr.Data_Solicitacao_Cliente\nCampo[1].Width=100\nCampo[2].FieldName=Incoterm\nCampo[2].DisplayLabel=Incoterm\nCampo[2].Origin=Inc.Nome\nCampo[2].Width=50\nCampo[3].FieldName=Tipo_Carga\nCampo[3].DisplayLabel=Tipo Carga\nCampo[3].Origin=Pfc.Tipo_Carga\nCampo[3].Width=50\nCampo[4].FieldName=Atividade\nCampo[4].DisplayLabel=Atividade\nCampo[4].Origin=Taf.Descricao\nCampo[4].Width=200\nCampo[5].FieldName=Previsao_Termino\nCampo[5].DisplayLabel=Previsão Término\nCampo[5].Origin=Atv.Previsao_Termino\nCampo[5].Width=100\nCampo[6].FieldName=Data_Termino\nCampo[6].DisplayLabel=Data Término\nCampo[6].Origin=Atv.Data_Termino\nCampo[6].Width=100\nCampo[7].FieldName=Prazo\nCampo[7].DisplayLabel=Prazo\nCampo[7].Origin=CASE WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino < Atv.Data_termino THEN 0 WHEN Atv.Data_termino IS NOT NULL AND Atv.Previsao_Termino > Atv.Data_termino THEN 1 WHEN Atv.Data_Termino IS NULL THEN 2 END\nCampo[7].Width=50\nCampo[8].FieldName=Responsavel\nCampo[8].DisplayLabel=Responsável\nCampo[8].Origin=Pes.Nome\nCampo[8].Width=200\nCampo[9].FieldName=Situacao_Proposta\nCampo[9].DisplayLabel=Situação Proposta\nCampo[9].Origin=CASE WHEN Pfr.Situacao = 1 THEN 'Aguardando Aprovação' WHEN Pfr.Situacao = 2 THEN 'Aprovada' WHEN Pfr.Situacao = 3 THEN 'Não Aprovada' WHEN Pfr.Situacao = 4 THEN 'Não Enviada' WHEN Pfr.Situacao = 5 THEN 'Pré-proposta' WHEN Pfr.Situacao = 6 THEN 'Enviada' END\nCampo[9].Width=100\nCampo[10].FieldName=Dias\nCampo[10].DisplayLabel=Dias\nCampo[10].Origin=DATEDIFF(day, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino)\nCampo[10].Width=50\nCampo[11].FieldName=Horas\nCampo[11].DisplayLabel=Horas\nCampo[11].Origin=DATEDIFF(hour, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 24\nCampo[11].Width=50\nCampo[12].FieldName=Minutos\nCampo[12].DisplayLabel=Minutos\nCampo[12].Origin=DATEDIFF(minute, Pfr.Data_Solicitacao_Cliente, Atv.Data_termino) % 60\nCampo[12].Width=50\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\FECHAMENTO VENDEDOR CRM\\RELATORIO FECHAMENTO VENDEDOR OK.chd",
        "conteudo": "[Consulta]\nCaption=Fechamentos\nTabela=mov_Logistica_Moeda\nCampos=35\nCommandText=Select,\"  CASE\",\"    WHEN Tbl30.Situacao_Embarque = 0 THEN 'Pré-processo'\",\"\tWHEN Tbl30.Situacao_Embarque = 1 THEN 'Aguardando embarque'\",\"\tWHEN Tbl30.Situacao_Embarque = 2 THEN 'Embarcado'\",\"\tWHEN Tbl30.Situacao_Embarque = 3 THEN 'Desembarcado'\",\"\tWHEN Tbl30.Situacao_Embarque = 4 THEN 'Cancelado'\",\"\tWHEN Tbl30.Situacao_Embarque = 5 THEN 'Pendente'\",\"\tWHEN Tbl30.Situacao_Embarque = 6 THEN 'Autorizado'\",\"\tWHEN Tbl30.Situacao_Embarque = 7 THEN 'Coletado'\",\"\tWHEN Tbl30.Situacao_Embarque = 8 THEN 'Entregue'\",\"\tWHEN Tbl30.Situacao_Embarque = 9 THEN 'Aguardando prontidão da mercadoria'\",\"\tWHEN Tbl30.Situacao_Embarque = 10 THEN 'Aguardando Booking'\",\"\tWHEN Tbl30.Situacao_Embarque = 11 THEN 'Finalizado'\",\"\tWHEN Tbl30.Situacao_Embarque = 12 THEN 'Aguardando coleta'\",\"\tWHEN Tbl30.Situacao_Embarque = 13 THEN 'Aguardando Entrega'\",\"\tEND AS Tbl30_Situacao_Embarque,\",\"  Tbl1.IdLogistica_Moeda,\",\"  Tbl1.Lucro_Efetivo,\",\"  Tbl1.Lucro_Estimado,\",\"  Tbl1.Comissao_Vendedor_Efetiva,\",\"  Tbl1.Comissao_Vendedor_Estimada,\",\"  Tbl1.Lucro_Efetivo + Coalesce(Tbl1.Comissao_Vendedor_Efetiva, 0) As Profit_Total_Efetivo,\",\"  Tbl1.Lucro_Estimado + Coalesce(Tbl1.Comissao_Vendedor_Estimada, 0) As Profit_Total_Estimado,\",\"  Tbl1.IdLogistica_House,\",\"  Tbl2.Numero_Processo as Tbl2_Numero_Processo,\",\"  Tbl2.Situacao_Agenciamento as Tbl2_Situacao_Agenciamento,\",\"  Tbl2.IdCliente as Tbl2_IdCliente,\",\"  Tbl3.IdPessoa as Tbl3_IdPessoa,\",\"  Tbl7.Nome as Tbl7_Nome,\",\"  Tbl2.IdEmpresa_Sistema as Tbl2_IdEmpresa_Sistema,\",\"  Tbl22.Nome as Tbl22_Nome,\",\"  Tbl22.IdEmpresa_Sistema as Tbl22_IdEmpresa_Sistema,\",\"  Tbl2.IdLogistica_Master as Tbl2_IdLogistica_Master,\",\"  Tbl30.Modalidade_Processo as Tbl30_Modalidade_Processo,\",\"  Tbl30.Tipo_Operacao as Tbl30_Tipo_Operacao,\",\"  Tbl2.IdVendedor as Tbl2_IdVendedor,\",\"  Tbl52.IdPessoa as Tbl52_IdPessoa,\",\"  Tbl56.Nome as Tbl56_Nome,\",\"  Tbl1.IdMoeda,\",\"  Tbl69.Sigla as Tbl69_Sigla,\",\"  Tbl2.Peso_Cubado,\",\"  Lah.Peso_Taxado,\",\"  Tbl2.Peso_Bruto,\",\"  Tbl2.Metros_Cubicos,\",\"  Tbl2.Total_Conhecimentos,\",\"  Tbl2.Quantidade_Volumes,\",\"  Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40, 0) As Total_Equipamentos,\",\"  Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40 * 2, 0) As TEUS,\",\"  Tbl2.Peso_Considerado,\",\"  Case\",\"    When Tbl30.Tipo_Operacao = 2 /* Importação */ Then Coalesce(Tbl30.Data_Desembarque, Tbl30.Data_Previsao_Desembarque)\",\"    Else Coalesce(Tbl30.Data_Embarque, Tbl30.Data_Previsao_Embarque)\",\"  End As Data_Competencia\",From,\"  mov_Logistica_Moeda Tbl1\",Join,\"  cad_Moeda Tbl69 on Tbl69.IdMoeda = Tbl1.IdMoeda And Tbl69.Moeda_Corrente = 1\",Join,\"  mov_Logistica_House Tbl2 on Tbl2.IdLogistica_House = Tbl1.IdLogistica_House\",\"Left Outer Join\",\"  cad_Cliente Tbl3 on Tbl3.IdPessoa = Tbl2.IdCliente\",\"Left Outer Join\",\"  cad_Pessoa Tbl7 on Tbl7.IdPessoa = Tbl3.IdPessoa\",\"Left Outer Join\",\"  sys_Empresa_Sistema Tbl22 on Tbl22.IdEmpresa_Sistema = Tbl2.IdEmpresa_Sistema\",\"Left Outer Join\",\"  mov_Logistica_Master Tbl30 on Tbl30.IdLogistica_Master = Tbl2.IdLogistica_Master\",\"Left Outer Join\",\"  cad_Funcionario Tbl52 on Tbl52.IdPessoa = Tbl2.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Tbl56 on Tbl56.IdPessoa = Tbl52.IdPessoa\",\"Left Outer Join\",\"  mov_Logistica_Maritima_House Lmh On Lmh.IdLogistica_House = Tbl2.IdLogistica_House\",\"Left Outer Join\",\"  mov_Logistica_Aerea_House Lah On Lah.IdLogistica_House = Tbl2.IdLogistica_House\",/*Where*/,Where,\"  Tbl2.Situacao_Agenciamento <> 7\",\n\n[Campos]\nCampo[0].FieldName=IdLogistica_Moeda\nCampo[0].Origin=Tbl1.IdLogistica_Moeda\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Lucro_Efetivo\nCampo[1].Origin=Tbl1.Lucro_Efetivo\nCampo[1].DisplayLabel=Lucro efetivo\nCampo[1].DisplayFormat=#,0.00;-#,0.00\nCampo[1].Alignment=1\nCampo[1].Width=100\nCampo[2].FieldName=Lucro_Estimado\nCampo[2].Origin=Tbl1.Lucro_Estimado\nCampo[2].DisplayLabel=Lucro estimado\nCampo[2].DisplayFormat=#,0.00;-#,0.00\nCampo[2].Alignment=1\nCampo[2].Width=100\nCampo[3].FieldName=Comissao_Vendedor_Efetiva\nCampo[3].Origin=Comissao_Vendedor_Efetiva\nCampo[3].DisplayLabel=Comissão vendedor efetiva\nCampo[3].DisplayFormat=#,0.00\nCampo[3].Width=100\nCampo[4].FieldName=Comissao_Vendedor_Estimada\nCampo[4].Origin=Comissao_Vendedor_Estimada\nCampo[4].DisplayLabel=Comissão vendedor estimada\nCampo[4].DisplayFormat=#,0.00\nCampo[4].Width=100\nCampo[5].FieldName=Profit_Total_Efetivo\nCampo[5].Origin=Tbl1.Lucro_Efetivo + Coalesce(Tbl1.Comissao_Vendedor_Efetiva, 0)\nCampo[5].DisplayLabel=Profit total efetivo\nCampo[5].DisplayFormat=#,0.00\nCampo[5].Width=100\nCampo[6].FieldName=Profit_Total_Estimado\nCampo[6].Origin=Tbl1.Lucro_Estimado + Coalesce(Tbl1.Comissao_Vendedor_Estimada, 0)\nCampo[6].DisplayLabel=Profit total estimado\nCampo[6].DisplayFormat=#,0.00\nCampo[6].Width=100\nCampo[7].FieldName=IdLogistica_House\nCampo[7].Origin=Tbl1.IdLogistica_House\nCampo[7].Foreign.Enabled=1\nCampo[7].Foreign.Divisao=Logistica_House\nCampo[7].Foreign.Campo=IdLogistica_House\nCampo[7].Foreign.Tabela=mov_Logistica_House\nCampo[8].FieldName=Tbl2_Numero_Processo\nCampo[8].Origin=Tbl2.Numero_Processo\nCampo[8].DisplayLabel=Número processo\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Numero_Processo\nCampo[8].Join.Search=IdLogistica_House\nCampo[8].Width=120\nCampo[9].FieldName=Tbl2_Situacao_Agenciamento\nCampo[9].Origin=Tbl2.Situacao_Agenciamento\nCampo[9].DisplayLabel=Situação agenciamento\nCampo[9].Join.Enabled=1\nCampo[9].Join.Result=Situacao_Agenciamento\nCampo[9].Join.Search=IdLogistica_House\nCampo[9].Width=160\nCampo[9].Items=1,2,3,4,6,5,7\nCampo[9].ItemsEx=\"Processo aberto\",\"Em andamento\",\"Liberado faturamento\",Faturado,Auditado,Finalizado,Cancelado\nCampo[9].Alignment=0\nCampo[10].FieldName=Tbl2_IdCliente\nCampo[10].Origin=Tbl2.IdCliente\nCampo[10].Foreign.Enabled=1\nCampo[10].Foreign.Divisao=Cliente\nCampo[10].Foreign.Campo=IdPessoa\nCampo[10].Foreign.Tabela=vis_Cliente\nCampo[10].Join.Enabled=1\nCampo[10].Join.Result=IdCliente\nCampo[10].Join.Search=IdLogistica_House\nCampo[11].FieldName=Tbl3_IdPessoa\nCampo[11].Origin=Tbl3.IdPessoa\nCampo[11].PrimaryKey=1\nCampo[11].Foreign.Enabled=1\nCampo[11].Foreign.Divisao=Pessoa\nCampo[11].Foreign.Campo=IdPessoa\nCampo[11].Foreign.Tabela=cad_Pessoa\nCampo[11].Join.Enabled=1\nCampo[11].Join.Result=IdPessoa\nCampo[11].Join.Search=Tbl2_IdCliente\nCampo[12].FieldName=Tbl7_Nome\nCampo[12].Origin=Tbl7.Nome\nCampo[12].DisplayLabel=Cliente\nCampo[12].Join.Enabled=1\nCampo[12].Join.Result=Nome\nCampo[12].Join.Search=Tbl3_IdPessoa\nCampo[12].Width=200\nCampo[13].FieldName=Tbl2_IdEmpresa_Sistema\nCampo[13].Origin=Tbl2.IdEmpresa_Sistema\nCampo[13].Foreign.Enabled=1\nCampo[13].Foreign.Divisao=Empresa_Sistema\nCampo[13].Foreign.Campo=IdEmpresa_Sistema\nCampo[13].Foreign.Tabela=sys_Empresa_Sistema\nCampo[13].Join.Enabled=1\nCampo[13].Join.Result=IdEmpresa_Sistema\nCampo[13].Join.Search=IdLogistica_House\nCampo[14].FieldName=Tbl22_Nome\nCampo[14].Origin=Tbl22.Nome\nCampo[14].DisplayLabel=Empresa\nCampo[14].Join.Enabled=1\nCampo[14].Join.Result=Nome\nCampo[14].Join.Search=Tbl2_IdEmpresa_Sistema\nCampo[14].Width=304\nCampo[15].FieldName=Tbl22_IdEmpresa_Sistema\nCampo[15].Origin=Tbl22.IdEmpresa_Sistema\nCampo[15].PrimaryKey=1\nCampo[15].Foreign.Enabled=1\nCampo[15].Foreign.Divisao=Empresa\nCampo[15].Foreign.Campo=IdEmpresa_Sistema\nCampo[15].Foreign.Tabela=Empresa\nCampo[15].Join.Enabled=1\nCampo[15].Join.Result=IdEmpresa_Sistema\nCampo[15].Join.Search=Tbl2_IdEmpresa_Sistema\nCampo[16].FieldName=Tbl2_IdLogistica_Master\nCampo[16].Origin=Tbl2.IdLogistica_Master\nCampo[16].Foreign.Enabled=1\nCampo[16].Foreign.Divisao=Logistica_Master\nCampo[16].Foreign.Campo=IdLogistica_Master\nCampo[16].Foreign.Tabela=mov_Logistica_Master\nCampo[16].Join.Enabled=1\nCampo[16].Join.Result=IdLogistica_Master\nCampo[16].Join.Search=IdLogistica_House\nCampo[17].FieldName=Tbl30_Modalidade_Processo\nCampo[17].Origin=Tbl30.Modalidade_Processo\nCampo[17].DisplayLabel=Modalidade processo\nCampo[17].Join.Enabled=1\nCampo[17].Join.Result=Modalidade_Processo\nCampo[17].Join.Search=Tbl2_IdLogistica_Master\nCampo[17].Width=160\nCampo[17].Items=1,2,3\nCampo[17].ItemsEx=Aéreo,Marítimo,Terrestre\nCampo[17].Alignment=0\nCampo[18].FieldName=Tbl30_Situacao_Embarque\nCampo[18].Origin=Tbl30.Situacao_Embarque\nCampo[18].DisplayLabel=Situação embarque\nCampo[18].Join.Enabled=1\nCampo[18].Join.Result=Situacao_Embarque\nCampo[18].Join.Search=Tbl2_IdLogistica_Master\nCampo[18].Width=160\nCampo[18].Items=0,1,2,3,4\nCampo[18].ItemsEx=Pré-processo,\"Aguardando embarque\",Embarcado,Desembarcado,Cancelado\nCampo[18].Alignment=0\nCampo[19].FieldName=Tbl30_Tipo_Operacao\nCampo[19].Origin=Tbl30.Tipo_Operacao\nCampo[19].DisplayLabel=Tipo operação\nCampo[19].Join.Enabled=1\nCampo[19].Join.Result=Tipo_Operacao\nCampo[19].Join.Search=Tbl2_IdLogistica_Master\nCampo[19].Width=160\nCampo[19].Items=1,2,3\nCampo[19].ItemsEx=Exportação,Importação,Nacional\nCampo[19].Alignment=0\nCampo[20].FieldName=Tbl2_IdVendedor\nCampo[20].Origin=Tbl2.IdVendedor\nCampo[20].Foreign.Enabled=1\nCampo[20].Foreign.Divisao=Funcionario\nCampo[20].Foreign.Campo=IdPessoa\nCampo[20].Foreign.Tabela=vis_Funcionario\nCampo[20].Join.Enabled=1\nCampo[20].Join.Result=IdVendedor\nCampo[20].Join.Search=IdLogistica_House\nCampo[21].FieldName=Tbl52_IdPessoa\nCampo[21].Origin=Tbl52.IdPessoa\nCampo[21].PrimaryKey=1\nCampo[21].Foreign.Enabled=1\nCampo[21].Foreign.Divisao=Pessoa\nCampo[21].Foreign.Campo=IdPessoa\nCampo[21].Foreign.Tabela=cad_Pessoa\nCampo[21].Join.Enabled=1\nCampo[21].Join.Result=IdPessoa\nCampo[21].Join.Search=Tbl2_IdVendedor\nCampo[22].FieldName=Tbl56_Nome\nCampo[22].Origin=Tbl56.Nome\nCampo[22].DisplayLabel=Vendedor\nCampo[22].Join.Enabled=1\nCampo[22].Join.Result=Nome\nCampo[22].Join.Search=Tbl52_IdPessoa\nCampo[22].Width=200\nCampo[23].FieldName=IdMoeda\nCampo[23].Origin=Tbl1.IdMoeda\nCampo[23].Foreign.Enabled=1\nCampo[23].Foreign.Divisao=Moeda\nCampo[23].Foreign.Campo=IdMoeda\nCampo[23].Foreign.Tabela=cad_Moeda\nCampo[24].FieldName=Tbl69_Sigla\nCampo[24].Origin=Tbl69.Sigla\nCampo[24].DisplayLabel=Moeda\nCampo[24].Join.Enabled=1\nCampo[24].Join.Result=Sigla\nCampo[24].Join.Search=IdMoeda\nCampo[24].Width=40\nCampo[25].FieldName=Peso_Cubado\nCampo[25].Origin=Tbl2.Peso_Cubado\nCampo[25].DisplayFormat=#,0.00\nCampo[25].Width=80\nCampo[25].DisplayLabel=Peso cubado\nCampo[26].FieldName=Peso_Bruto\nCampo[26].Origin=Tbl2.Peso_Bruto\nCampo[26].DisplayFormat=#,0.00\nCampo[26].Width=80\nCampo[26].DisplayLabel=Peso bruto\nCampo[27].FieldName=Metros_Cubicos\nCampo[27].Origin=Tbl2.Metros_Cubicos\nCampo[27].DisplayFormat=#,0.00\nCampo[27].Width=80\nCampo[27].DisplayLabel=Metros cúbicos\nCampo[28].FieldName=Total_Conhecimentos\nCampo[28].Origin=Tbl2.Total_Conhecimentos\nCampo[28].DisplayFormat=#,0.00\nCampo[28].Width=80\nCampo[28].DisplayLabel=Total conhecimentos\nCampo[29].FieldName=Quantidade_Volumes\nCampo[29].Origin=Tbl2.Quantidade_Volumes\nCampo[29].DisplayFormat=#,0.00\nCampo[29].Width=80\nCampo[29].DisplayLabel=Quantidade volumes\nCampo[30].FieldName=Total_Equipamentos\nCampo[30].Origin=Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40, 0)\nCampo[30].DisplayFormat=#,0.00\nCampo[30].Width=80\nCampo[30].DisplayLabel=Total equipamentos\nCampo[31].FieldName=TEUS\nCampo[31].Origin=Coalesce(Lmh.Total_Container_20, 0) + Coalesce(Lmh.Total_Container_40 * 2, 0)\nCampo[31].DisplayFormat=0\nCampo[31].Width=80\nCampo[31].DisplayLabel=TEUS\nCampo[32].FieldName=Peso_Considerado\nCampo[32].Origin=Tbl2.Peso_Considerado\nCampo[32].DisplayFormat=#,0.00\nCampo[32].Width=80\nCampo[32].DisplayLabel=Peso considerado\nCampo[33].FieldName=Peso_Taxado\nCampo[33].Origin=Lah.Peso_Taxado\nCampo[33].DisplayFormat=#,0.00\nCampo[33].Width=80\nCampo[33].DisplayLabel=Peso taxado\nCampo[34].FieldName=Data_Competencia\nCampo[34].Origin=Case When Tbl30.Tipo_Operacao = 2 /* Importação */ Then Coalesce(Tbl30.Data_Desembarque, Tbl30.Data_Previsao_Desembarque) Else Coalesce(Tbl30.Data_Embarque, Tbl30.Data_Previsao_Embarque) End\nCampo[34].DisplayLabel=Data competência\nCampo[34].DisplayFormat=dd/mm/yyyy\nCampo[34].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\LUCRO MENSAL EMPRESA\\LUCRO MENSAL EMPRESA - FATURAS - CONSULTA.chd",
        "conteudo": "[Consulta]\nCommandText=Select,\"ROW_NUMBER() OVER(PARTITION BY @@ROWCOUNT ORDER BY @@ROWCOUNT) AS Indice,\",\"Ltl.Ano,\",\"Ltl.Mes,\",\"SUM(Ltl.Total_Pago) AS Total_Pago,\",\"SUM(Ltl.Total_Recebido) AS Total_Recebido,\",\"SUM(Ltl.Total_Estimado) as Lucro_Estimado,\",\"SUM(Ltl.Total_Efetivo) as Lucro_Efetivo\",\"From \",\"\tvis_Logistica_Fatura_Totais Lft\",\"Left Outer Join (\",\"    Select\",\"        IdRegistro_Financeiro,\",\"        SUM(Valor_Estimado_Fatura) as Total_Estimado,\",\"        SUM(Valor_Efetivo_Fatura) as Total_Efetivo,\",\"        YEAR(COALESCE(Data_Pagamento, Data_Referencia)) as Ano,\",\"        MONTH(COALESCE(Data_Pagamento, Data_Referencia)) as Mes,\",\"        Case When Natureza = 0 /*Debito*/ and Situacao = 2 /*Finalizada*/ Then SUM(Valor_Efetivo_Fatura) end as Total_Pago,\",\"        Case When Natureza = 1 /*Credito*/ and Situacao = 2 /*Finalizada*/ Then SUM(Valor_Efetivo_Fatura) end as Total_Recebido      \",\"    From vis_Logistica_Fatura_Totais\",\"    Group By IdRegistro_Financeiro, Data_Pagamento, Data_Referencia, Natureza, Situacao\",\") Ltl on Ltl.IdRegistro_Financeiro = Lft.IdRegistro_Financeiro\",\"Group by\",\"    Ltl.Ano,\",\"    Ltl.Mes\"\nCampos=6\n\n[Campos]\nCampo[0].FieldName=Ano\nCampo[0].DisplayLabel=Ano\nCampo[0].Origin=Ltl.Ano\nCampo[0].Width=80\nCampo[1].FieldName=Mes\nCampo[1].DisplayLabel=Mes\nCampo[1].Origin=Ltl.Mes\nCampo[1].Width=70\nCampo[2].FieldName=Total_Pago\nCampo[2].DisplayLabel=Total_Pago\nCampo[2].Origin=SUM(Ltl.Total_Pago)\nCampo[2].Width=80\nCampo[3].FieldName=Total_Recebido\nCampo[3].DisplayLabel=Total_Recebido\nCampo[3].Origin=SUM(Ltl.Total_Recebido)\nCampo[3].Width=80\nCampo[4].FieldName=Lucro_Estimado\nCampo[4].DisplayLabel=Lucro_Estimado\nCampo[4].Origin=SUM(Ltl.Total_Estimado)\nCampo[4].Width=80\nCampo[5].FieldName=Lucro_Efetivo\nCampo[5].DisplayLabel=Lucro_Efetivo\nCampo[5].Origin=SUM(Ltl.Total_Efetivo)\nCampo[5].Width=80\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\LUCRO MENSAL EMPRESA\\RELATORIO LUCRO MENSAL EMPRESA OK.chd",
        "conteudo": "[Consulta]\nCampos=6\nCommandText=\"select \",\"  /*Lhs.Numero_Processo,\",\"  Lhs.Data_Abertura_Processo,\",\"  Lhs.Referencia_Cliente,*/\",\"  SUM(Lgm.Total_Pago) AS TOTAL_PAGO, \",\"  SUM(Lgm.Total_Recebido) AS TOTAL_RECEBIDO,\",\"  SUM(Lgm.Lucro_Estimado) AS LUCRO_ESTIMADO,\",\"  SUM(Lgm.Lucro_Efetivo) AS LUCRO_EFETIVO,\",\"  MONTH(Lhs.Data_Abertura_Processo) AS MES,\",\"  YEAR (Lhs.Data_Abertura_Processo) AS ANO\",\"from \",\"mov_Logistica_House Lhs \",\"  LEFT OUTER JOIN \",\"mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Lhs.IdLogistica_House and Lgm.IdMoeda = 20 /* REAL */\",\"WHERE \",\"  Lhs.Data_Abertura_Processo between '2023-01-01' and '2024-12-31'\",\"GROUP BY \",\"   MONTH(Lhs.Data_Abertura_Processo),\",\"   YEAR (Lhs.Data_Abertura_Processo)\",\"ORDER BY \",\"  ANO, MES\"\n\n[Campos]\nCampo[0].FieldName=TOTAL_PAGO\nCampo[0].DisplayLabel=TOTAL_PAGO\nCampo[0].Origin=SUM(Lgm.Total_Pago)\nCampo[0].Width=100\nCampo[1].FieldName=TOTAL_RECEBIDO\nCampo[1].DisplayLabel=TOTAL_RECEBIDO\nCampo[1].Origin=SUM(Lgm.Total_Recebido)\nCampo[1].Width=120\nCampo[2].FieldName=LUCRO_ESTIMADO\nCampo[2].DisplayLabel=LUCRO_ESTIMADO\nCampo[2].Origin=SUM(Lgm.Lucro_Estimado)\nCampo[2].Width=120\nCampo[3].FieldName=LUCRO_EFETIVO\nCampo[3].DisplayLabel=LUCRO_EFETIVO\nCampo[3].Origin=SUM(Lgm.Lucro_Efetivo)\nCampo[3].Width=100\nCampo[4].FieldName=MES\nCampo[4].DisplayLabel=MES\nCampo[4].Origin=MONTH(Lhs.Data_Abertura_Processo)\nCampo[4].Width=50\nCampo[5].FieldName=ANO\nCampo[5].DisplayLabel=ANO\nCampo[5].Origin=YEAR (Lhs.Data_Abertura_Processo)\nCampo[5].Width=70\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\LUCRO POR PROCESSO\\RELATORIO LUCRO POR PROCESSO OK.chd",
        "conteudo": "[Consulta]\nCommandText=\"select \",\"  Lhs.Numero_Processo,\",\"  SUM(Lgm.Total_Pago) AS TOTAL_PAGO, \",\"  SUM(Lgm.Total_Recebido) AS TOTAL_RECEBIDO,\",\"  SUM(Lgm.Lucro_Estimado) AS LUCRO_ESTIMADO,\",\"  SUM(Lgm.Lucro_Efetivo) AS LUCRO_EFETIVO\",from,\"mov_Logistica_House Lhs \",\"  LEFT OUTER JOIN \",\"mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Lhs.IdLogistica_House\",\"group by\",Numero_Processo\nCampos=5\n\n[Campos]\nCampo[0].FieldName=Numero_Processo\nCampo[0].DisplayLabel=Numero_Processo\nCampo[0].Origin=Lhs.Numero_Processo\nCampo[0].Width=70\nCampo[1].FieldName=TOTAL_PAGO\nCampo[1].DisplayLabel=TOTAL_PAGO\nCampo[1].Origin=SUM(Lgm.Total_Pago)\nCampo[1].Width=80\nCampo[2].FieldName=TOTAL_RECEBIDO\nCampo[2].DisplayLabel=TOTAL_RECEBIDO\nCampo[2].Origin=SUM(Lgm.Total_Recebido)\nCampo[2].Width=80\nCampo[3].FieldName=LUCRO_ESTIMADO\nCampo[3].DisplayLabel=LUCRO_ESTIMADO\nCampo[3].Origin=SUM(Lgm.Lucro_Estimado)\nCampo[3].Width=80\nCampo[4].FieldName=LUCRO_EFETIVO\nCampo[4].DisplayLabel=LUCRO_EFETIVO\nCampo[4].Origin=SUM(Lgm.Lucro_Efetivo)\nCampo[4].Width=80\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\LUCRO POR PROCESSO MENSAL\\RELATORIO LUCRO POR PROCESSO MENSAL OK.chd",
        "conteudo": "[Consulta]\nCampos=16\nCommandText=\"SELECT \",\"  COUNT(Lhs.IdLogistica_House) AS Qta_Processos,\",\"  CASE WHEN SUM(Lgm.Lucro_Efetivo) > 0 THEN 1 WHEN SUM(Lgm.Lucro_Efetivo) < 0 THEN 2 WHEN SUM(Lgm.Lucro_Efetivo) = 0 THEN 3 END AS Situacao_Lucro,\",\"  CASE WHEN SUM(Lgm.Lucro_Momento) > 0 THEN 1 WHEN SUM(Lgm.Lucro_Momento) < 0 THEN 2 WHEN SUM(Lgm.Lucro_Momento) = 0 THEN 3 END AS Situacao_Momento,\",\"  CASE WHEN SUM(Lgm.Lucro_Estimado) > 0 THEN 1 WHEN SUM(Lgm.Lucro_Estimado) < 0 THEN 2 WHEN SUM(Lgm.Lucro_Estimado) = 0 THEN 3 END AS Situacao_Lucro_Est,\",\"  CASE WHEN (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) > 0 THEN 1 WHEN (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) < 0 THEN 2 WHEN (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) = 0 THEN 3 END AS Situacao_Profit,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 1 THEN 1 END) AS Processo_Aberto,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 2 THEN 1 END) AS Em_Andamento,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 3 THEN 1 END) AS Lib_Faturamento,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 4 THEN 1 END) AS Faturado,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 5 THEN 1 END) AS Auditado,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 6 THEN 1 END) AS Finalizado,\",\"  COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 7 THEN 1 END) AS Cancelado,\",\"  SUM(Lgm.Lucro_Estimado) AS Lucro_Estimado,\",\"  SUM(Lgm.Lucro_Efetivo) AS Lucro_Efetivo,\",\"  SUM(Lgm.Lucro_Momento) AS Lucro_Momento,\",\"  SUM(Lgm.Total_Pagamento) AS Pagamento,  \",\"  SUM(Lgm.Total_Recebimento) AS Recebimento,\",\"  (SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento)) AS Total_Profit,\",\"  DATEPART(MONTH,Lhs.Data_Abertura_Processo) AS Mes,\",\"  DATEPART(YEAR,Lhs.Data_Abertura_Processo) AS Ano\",\"FROM \",\"  mov_Logistica_House Lhs \",\"left outer join \",\"  mov_Logistica_Moeda Lgm on Lgm.IdLogistica_House = Lhs.IdLogistica_House and Lgm.IdMoeda = 20 /* REAL */\",\"GROUP BY \",\"  DATEPART(MONTH,Lhs.Data_Abertura_Processo),\",\"  DATEPART(YEAR,Lhs.Data_Abertura_Processo)\"\n\n[Campos]\nCampo[0].FieldName=Qta_Processos\nCampo[0].DisplayLabel=Quantidade Processos\nCampo[0].Origin=COUNT(Lhs.IdLogistica_House)\nCampo[0].Width=100\nCampo[1].FieldName=Processo_Aberto\nCampo[1].DisplayLabel=Processo Aberto\nCampo[1].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 1 THEN 1 END)\nCampo[1].Width=100\nCampo[2].FieldName=Em_Andamento\nCampo[2].DisplayLabel=Em Andamento\nCampo[2].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 2 THEN 1 END)\nCampo[2].Width=100\nCampo[3].FieldName=Lib_Faturamento\nCampo[3].DisplayLabel=Liberado Faturamento\nCampo[3].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 3 THEN 1 END)\nCampo[3].Width=100\nCampo[4].FieldName=Faturado\nCampo[4].DisplayLabel=Faturado\nCampo[4].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 4 THEN 1 END)\nCampo[4].Width=100\nCampo[5].FieldName=Auditado\nCampo[5].DisplayLabel=Auditado\nCampo[5].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 5 THEN 1 END)\nCampo[5].Width=100\nCampo[6].FieldName=Finalizado\nCampo[6].DisplayLabel=Finalizado\nCampo[6].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 6 THEN 1 END)\nCampo[6].Width=100\nCampo[7].FieldName=Cancelado\nCampo[7].DisplayLabel=Cancelado\nCampo[7].Origin=COUNT(CASE WHEN Lhs.Situacao_Agenciamento = 7 THEN 1 END)\nCampo[7].Width=100\nCampo[8].FieldName=Lucro_Estimado\nCampo[8].DisplayLabel=Lucro Estimado\nCampo[8].Origin=SUM(Lgm.Lucro_Estimado)\nCampo[8].Width=100\nCampo[8].DisplayFormat=#,0.00\nCampo[9].FieldName=Lucro_Momento\nCampo[9].DisplayLabel=Lucro Momento\nCampo[9].Origin=SUM(Lgm.Lucro_Momento)\nCampo[9].Width=100\nCampo[9].DisplayFormat=#,0.00\nCampo[10].FieldName=Lucro_Efetivo\nCampo[10].DisplayLabel=Lucro Efetivo\nCampo[10].Origin=SUM(Lgm.Lucro_Efetivo)\nCampo[10].Width=100\nCampo[10].DisplayFormat=#,0.00\nCampo[11].FieldName=Pagamento\nCampo[11].DisplayLabel=Pagamento\nCampo[11].Origin=SUM(Lgm.Total_Pagamento)\nCampo[11].Width=100\nCampo[11].DisplayFormat=#,0.00\nCampo[12].FieldName=Recebimento\nCampo[12].DisplayLabel=Recebimento\nCampo[12].Origin=SUM(Lgm.Total_Recebimento)\nCampo[12].Width=100\nCampo[12].DisplayFormat=#,0.00\nCampo[13].FieldName=Total_Profit\nCampo[13].DisplayLabel=Profit\nCampo[13].Origin=(SUM(Lgm.Total_Recebimento) - SUM(Lgm.Total_Pagamento))\nCampo[13].Width=100\nCampo[13].DisplayFormat=#,0.00\nCampo[14].FieldName=Mes\nCampo[14].DisplayLabel=Mês\nCampo[14].Origin=DATEPART(MONTH,Lhs.Data_Abertura_Processo)\nCampo[14].Width=100\nCampo[15].FieldName=Ano\nCampo[15].DisplayLabel=Ano\nCampo[15].Origin=DATEPART(YEAR,Lhs.Data_Abertura_Processo)\nCampo[15].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\MAPA DE EMBARQUE\\RELATORIO MAPA DE EMBARQUE OK.chd",
        "conteudo": "[Consulta]\nCaption=Mapa de embarque\nTabela=mov_Frete_Transbordo\nCampos=35\nCommandText=Select,\"  Lhs.IdLogistica_House,\",\"  CASE \",\"    WHEN Lms.Data_Embarque IS NOT NULL THEN 1 \",\"    WHEN (Lms.Data_Previsao_Embarque >= getdate() AND Lms.Data_Embarque IS NULL) THEN 2 \",\"    WHEN (Lms.Data_Previsao_Embarque < getdate() AND Lms.Data_Embarque IS NULL) THEN 3\",\"  ELSE 4 END BIT_1,\",,\"  Lms.Data_Previsao_Embarque as Data_Previsao_Embarque,\",\"  Lms.Data_Embarque as Data_Embarque,\",\"  coalesce (Lms.Data_Embarque,Lms.Data_Previsao_Embarque) as Embarque, \",,\"  CASE \",\"    WHEN Lms.Data_Desembarque IS NOT NULL THEN 1 \",\"    WHEN (Lms.Data_Previsao_Desembarque >= getdate() AND Lms.Data_Desembarque IS NULL) THEN 2 \",\"    WHEN (Lms.Data_Previsao_Desembarque < getdate() AND Lms.Data_Desembarque IS NULL) THEN 3\",\"  ELSE 4 END BIT_2,\",,\"  Lms.Data_Previsao_Desembarque as Data_Previsao_Desembarque,\",\"  Lms.Data_Desembarque as Data_Desembarque,\",\"  coalesce (Lms.Data_Desembarque,Lms.Data_Previsao_Desembarque) as Desembarque,\",,\"  Lms.Modalidade_Processo,\",\"  Lms.Tipo_Operacao,\",\"  Lhs.Numero_Processo,\",\"  Lhs.Conhecimentos,\",\"  Lmh.Containers,\",\"  Lmh.Equipamentos,\",\"  Lms.Numero_Reserva as Numero_Booking,\",\"  Lhs.Referencia_Cliente as Referencia_Cliente,\",\"  coalesce(Lmm.Viagem_Navio,Vnv.Numero) as Viagem_Navio,\",\"  Cln.Nome as Cliente,\",\"  Cln.Cpf_Cnpj As CNPJ_Cliente,\",\"  Exp.Nome as Exportador,\",\"  Imp.Nome as Importador,\",\"  Nvi.Nome as Navio,\",\"  Org.Nome as Origem,\",\"  Dst.Nome as Destino,\",\"  Nty.Nome as Notify,\",\"  Ctr.Nome as Cia_Trasporte,\",\"  Trb.Viagem,\",,\"  CASE \",\"    WHEN Trb.Data_Chegada IS NOT NULL THEN 1 \",\"    WHEN (Trb.Data_Previsao_Chegada >= getdate() AND Trb.Data_Chegada IS NULL) THEN 2 \",\"    WHEN (Trb.Data_Previsao_Chegada < getdate() AND Trb.Data_Chegada IS NULL) THEN 3\",\"  ELSE 4 END BIT_3,\",,\"  Trb.Data_Previsao_Chegada AS Prev_Chegada_Transbordo,\",\"  Trb.Data_Chegada AS Data_Chegada_Transbordo,\",\"  COALESCE (Trb.Data_Chegada, Trb.Data_Previsao_Chegada) AS Prev_Confir_Chegada_Transbordo,\",,\"  CASE \",\"    WHEN Trb.Data_Embarque IS NOT NULL THEN 1 \",\"    WHEN (Trb.Data_Previsao_Embarque >= getdate() AND Trb.Data_Embarque IS NULL) THEN 2 \",\"    WHEN (Trb.Data_Previsao_Embarque < getdate() AND Trb.Data_Embarque IS NULL) THEN 3\",\"  ELSE 4 END BIT_4,\",,\"  Trb.Data_Previsao_Embarque AS Prev_Saida_Transbordo,\",\"  Trb.Data_Embarque AS Data_Saida_Transbordo,\",\"  COALESCE (Trb.Data_Embarque, Trb.Data_Previsao_Embarque) AS Prev_Confir_Saida_Transbordo,\",,\"  Trb.Porto_Transbordo,\",\"  Trb.Porto_Desembarque,\",\"  Trb.Navio_Transbordo\",From,\"  mov_Logistica_House Lhs\",\"Left Outer Join\",\"  mov_Logistica_Master Lms on Lms.IdLogistica_Master = Lhs.Idlogistica_Master\",\"Left Outer Join\",\"  mov_Logistica_Maritima_Master Lmm on Lmm.IdLogistica_Master = Lms.IdLogistica_Master\",\"Left Outer Join\",\"  mov_Logistica_Maritima_House Lmh on Lmh.IdLogistica_House= Lhs.IdLogistica_House\",\"Left Outer Join\",\"  vis_Cliente Cln on Cln.IdPessoa = Lhs.IdCliente\",\"Left Outer Join\",\"  vis_Cliente Exp on Exp.IdPessoa = Lhs.IdExportador\",\"Left Outer Join\",\"  vis_Cliente Imp on Imp.IdPessoa = Lhs.IdImportador\",\"Left Outer Join\",\"  vis_Cliente Nty on Nty.IdPessoa = Lhs.IdNotify\",\"Left Outer Join\",\"  vis_Companhia_Transporte Ctr on Ctr.IdPessoa = Lms.IdCompanhia_Transporte\",\"Left Outer Join\",\"  cad_Navio Nvi on Nvi.IdNavio = Lmm.IdNavio\",\"Left Outer Join\",\"  cad_Origem_Destino Lrc on Lrc.IdOrigem_Destino = Lms.IdLocal_Recebimento\",\"Left Outer Join\",\"  cad_Origem_Destino Org on Org.IdOrigem_Destino = Lms.IdOrigem\",\"Left Outer Join\",\"  cad_Origem_Destino Dst on Dst.IdOrigem_Destino = Lms.IdDestino\",\"Left Outer Join\",\"  cad_Origem_Destino Dsf on Dsf.IdOrigem_Destino = Lms.IdDestino_Final\",\"Left Outer Join\",\"  mov_Viagem_Navio Vnv on Vnv.IdViagem_Navio = Lmm.IdViagem_Navio\",\"Left Outer Join\",\"  (Select\",\"    Lmt.IdLogistica_Master,\",\"    Lmt.Viagem,\",\"    Lmt.Data_Desembarque,\",\"\tLmt.Data_Previsao_Chegada,\",\"\tLmt.Data_Previsao_Embarque,\",\"    Lmt.Data_Embarque,\",\"    Lmt.Data_Chegada,\",\"    Ptr.Nome As Porto_Transbordo,\",\"    Pds.Nome As Porto_Desembarque,\",\"    Nvi.Nome As Navio_Transbordo,\",\"    Rank() Over (Partition By Lmt.IdLogistica_Master Order By Lmt.IdLogistica_Master, Lmt.Data_Previsao_Chegada, Lmt.IdLogistica_Maritima_Transbordo)As Ranking\",\"  From\",\"    mov_Logistica_Maritima_Transbordo Lmt\",\"  Left Outer Join\",\"    cad_Origem_Destino Ptr on Ptr.IdOrigem_Destino = Lmt.IdPorto_Transbordo\",\"  Left Outer Join\",\"    cad_Origem_Destino Pds on Pds.IdOrigem_Destino = Lmt.IdPorto_Desembarque\",\"  Left Outer Join\",\"    cad_Navio Nvi on Nvi.IdNavio = Lmt.IdNavio\",\"  ) As Trb On (Trb.IdLogistica_Master = Lhs.IdLogistica_Master) And (Trb.Ranking = 1)\",/*where*/\n\n[Campos]\nCampo[0].FieldName=IdLogistica_House\nCampo[0].Origin=Lhs.IdLogistica_House\nCampo[0].PrimaryKey=1\nCampo[1].FieldName=Data_Previsao_Embarque\nCampo[1].Origin=Lms.Data_Previsao_Embarque\nCampo[1].DisplayLabel=Data Previsão Embarque\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=-1\nCampo[2].FieldName=Data_Embarque\nCampo[2].Origin=Lms.Data_Embarque\nCampo[2].DisplayLabel=Data Embarque\nCampo[2].DisplayFormat=dd/mm/yyyy\nCampo[2].Width=-1\nCampo[3].FieldName=Embarque\nCampo[3].Origin=coalesce (Lms.Data_Embarque,Lms.Data_Previsao_Embarque)\nCampo[3].DisplayLabel=Embarque\nCampo[3].DisplayFormat=dd/mm/yyyy\nCampo[3].Width=-1\nCampo[4].FieldName=Data_Previsao_Desembarque\nCampo[4].Origin=Lms.Data_Previsao_Desembarque\nCampo[4].DisplayLabel=Data Previsão Desembarque\nCampo[4].DisplayFormat=dd/mm/yyyy\nCampo[4].Width=-1\nCampo[5].FieldName=Data_Desembarque\nCampo[5].Origin=Lms.Data_Desembarque\nCampo[5].DisplayLabel=Data Desembarque\nCampo[5].DisplayFormat=dd/mm/yyyy\nCampo[5].Width=-1\nCampo[6].FieldName=Desembarque\nCampo[6].Origin=coalesce (Lms.Data_Desembarque,Lms.Data_Previsao_Desembarque)\nCampo[6].DisplayLabel=Desembarque\nCampo[6].DisplayFormat=dd/mm/yyyy\nCampo[6].Width=-1\nCampo[7].FieldName=Modalidade_Processo\nCampo[7].Origin=Lms.Modalidade_Processo\nCampo[7].DisplayLabel=Modalidade Processo\nCampo[7].Width=50\nCampo[8].FieldName=Tipo_Operacao\nCampo[8].Origin=Lms.Tipo_Operacao\nCampo[8].DisplayLabel=Tipo Operação\nCampo[8].Width=50\nCampo[9].FieldName=Numero_Processo\nCampo[9].DisplayLabel=Número Processo\nCampo[9].Origin=Lhs.Numero_Processo\nCampo[9].Width=100\nCampo[10].FieldName=Conhecimentos\nCampo[10].DisplayLabel=Conhecimentos\nCampo[10].Origin=Lhs.Conhecimentos\nCampo[10].Width=100\nCampo[11].FieldName=Containers\nCampo[11].DisplayLabel=Containers\nCampo[11].Origin=Lmh.Containers\nCampo[11].Width=100\nCampo[12].FieldName=Equipamentos\nCampo[12].DisplayLabel=Equipamentos\nCampo[12].Origin=Lmh.Equipamentos\nCampo[12].Width=100\nCampo[13].FieldName=Numero_Booking\nCampo[13].DisplayLabel=Número Booking\nCampo[13].Origin=Lms.Numero_Reserva\nCampo[13].Width=100\nCampo[14].FieldName=Referencia_Cliente\nCampo[14].DisplayLabel=Referência Cliente\nCampo[14].Origin=Lhs.Referencia_Cliente\nCampo[14].Width=100\nCampo[15].FieldName=Viagem_Navio\nCampo[15].DisplayLabel=Viagem Navio\nCampo[15].Origin=coalesce(Lmm.Viagem_Navio,Vnv.Numero)\nCampo[15].Width=100\nCampo[16].FieldName=Cliente\nCampo[16].DisplayLabel=Cliente\nCampo[16].Origin=Cln.Nome\nCampo[16].Width=300\nCampo[17].FieldName=CNPJ_Cliente\nCampo[17].DisplayLabel=CNPJ Cliente\nCampo[17].Origin=Cln.Cpf_Cnpj\nCampo[17].Width=100\nCampo[18].FieldName=Exportador\nCampo[18].DisplayLabel=Exportador\nCampo[18].Origin=Exp.Nome\nCampo[18].Width=300\nCampo[19].FieldName=Importador\nCampo[19].DisplayLabel=Importador\nCampo[19].Origin=Imp.Nome\nCampo[19].Width=300\nCampo[20].FieldName=Navio\nCampo[20].DisplayLabel=Navio\nCampo[20].Origin=Nvi.Nome\nCampo[20].Width=100\nCampo[21].FieldName=Origem\nCampo[21].DisplayLabel=Origem\nCampo[21].Origin=Org.Nome\nCampo[21].Width=100\nCampo[22].FieldName=Destino\nCampo[22].DisplayLabel=Destino\nCampo[22].Origin=Dst.Nome\nCampo[22].Width=100\nCampo[23].FieldName=Notify\nCampo[23].DisplayLabel=Notify\nCampo[23].Origin=Nty.Nome\nCampo[23].Width=300\nCampo[24].FieldName=Cia_Trasporte\nCampo[24].DisplayLabel=Cia_Trasporte\nCampo[24].Origin=Ctr.Nome\nCampo[24].Width=200\nCampo[25].FieldName=Viagem\nCampo[25].DisplayLabel=Viagem\nCampo[25].Origin=Trb.Viagem\nCampo[25].Width=100\nCampo[26].FieldName=Prev_Chegada_Transbordo\nCampo[26].DisplayLabel=Previsão Chegada Transbordo\nCampo[26].Origin=Trb.Data_Previsao_Chegada\nCampo[26].Width=-1\nCampo[26].DisplayFormat=dd/mm/yyyy\nCampo[27].FieldName=Data_Chegada_Transbordo\nCampo[27].DisplayLabel=Data Chegada Transbordo\nCampo[27].Origin=Trb.Data_Chegada\nCampo[27].Width=-1\nCampo[27].DisplayFormat=dd/mm/yyyy\nCampo[28].FieldName=Prev_Confir_Chegada_Transbordo\nCampo[28].DisplayLabel=Previsão Confirmação Chegada Transbordo\nCampo[28].Origin=COALESCE (Trb.Data_Chegada, Trb.Data_Previsao_Chegada)\nCampo[28].Width=-1\nCampo[28].DisplayFormat=dd/mm/yyyy\nCampo[29].FieldName=Prev_Saida_Transbordo\nCampo[29].DisplayLabel=Previsão Saída Transbordo\nCampo[29].Origin=Trb.Data_Previsao_Embarque\nCampo[29].Width=-1\nCampo[29].DisplayFormat=dd/mm/yyyy\nCampo[30].FieldName=Data_Saida_Transbordo\nCampo[30].DisplayLabel=Data Saída Transbordo\nCampo[30].Origin=Trb.Data_Embarque\nCampo[30].Width=-1\nCampo[30].DisplayFormat=dd/mm/yyyy\nCampo[31].FieldName=Prev_Confir_Saida_Transbordo\nCampo[31].DisplayLabel=Previsão Confirmção Saída Transbordo\nCampo[31].Origin=COALESCE (Trb.Data_Embarque, Trb.Data_Previsao_Embarque)\nCampo[31].Width=-1\nCampo[31].DisplayFormat=dd/mm/yyyy\nCampo[32].FieldName=Porto_Transbordo\nCampo[32].DisplayLabel=Porto Transbordo\nCampo[32].Origin=Trb.Porto_Transbordo\nCampo[32].Width=100\nCampo[33].FieldName=Porto_Desembarque\nCampo[33].DisplayLabel=Porto Desembarque\nCampo[33].Origin=Trb.Porto_Desembarque\nCampo[33].Width=100\nCampo[34].FieldName=Navio_Transbordo\nCampo[34].DisplayLabel=Navio Transbordo\nCampo[34].Origin=Trb.Navio_Transbordo\nCampo[34].Width=100\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\PROPOSTA NAO ENVIADA - NAO APROVADA\\RELATORIO PROPOSTAS NAO APROVADAS OK.chd",
        "conteudo": "[Consulta]\nCaption=NAO APROVADAS - MOTIVO\nTabela=mov_Proposta_Frete\nCampos=12\nCommandText=Select,\"  Tbl1.IdProposta_Frete,\",\"  Tbl1.Data_Proposta,\",\"  Tbl1.Numero_Proposta,\",\"case \",\"\tWhen Tbl1.Situacao = 3 Then 'Não Aprovada' \",\"\tWhen Tbl1.Situacao = 4 Then 'Não Enviada' \",\"End as Situacao,\",\"  Tbl1.IdCliente,\",\"  Tbl2.IdPessoa as Tbl2_IdPessoa,\",\"  Tbl6.Nome as Tbl6_Nome,\",\"  Tbl1.IdMotivo_Nao_Aprovacao_Proposta,\",\"  Tbl21.Descricao as Tbl21_Descricao,\",\"  Tbl1.IdVendedor,\",\"  Tbl25.IdPessoa as Tbl25_IdPessoa,\",\"  Tbl29.Nome as Tbl29_Nome\",From,\"  mov_Proposta_Frete Tbl1\",\"Left Outer Join\",\"  cad_Cliente Tbl2 on Tbl2.IdPessoa = Tbl1.IdCliente\",\"Left Outer Join\",\"  cad_Pessoa Tbl6 on Tbl6.IdPessoa = Tbl2.IdPessoa\",\"Left Outer Join\",\"  cad_Motivo_Nao_Aprovacao_Proposta Tbl21 on Tbl21.IdMotivo_Nao_Aprovacao_Proposta = Tbl1.IdMotivo_Nao_Aprovacao_Proposta\",\"Left Outer Join\",\"  cad_Funcionario Tbl25 on Tbl25.IdPessoa = Tbl1.IdVendedor\",\"Left Outer Join\",\"  cad_Pessoa Tbl29 on Tbl29.IdPessoa = Tbl25.IdPessoa\",,Where,\"Tbl1.Situacao in (3 /*Não Aprovada*/, 4 /* Não Enviada*/)\"\n\n[Campos]\nCampo[0].FieldName=IdProposta_Frete\nCampo[0].Origin=Tbl1.IdProposta_Frete\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Data_Proposta\nCampo[1].Origin=Tbl1.Data_Proposta\nCampo[1].DisplayLabel=Data proposta\nCampo[1].DisplayFormat=dd/mm/yyyy\nCampo[1].Width=80\nCampo[2].FieldName=Numero_Proposta\nCampo[2].Origin=Tbl1.Numero_Proposta\nCampo[2].DisplayLabel=Número proposta\nCampo[2].Width=120\nCampo[3].FieldName=Situacao\nCampo[3].Origin=case When Tbl1.Situacao = 3 Then 'Não Aprovada' When Tbl1.Situacao = 4 Then 'Não Enviada' End as Situacao,\nCampo[3].DisplayLabel=Situação\nCampo[3].Width=160\nCampo[4].FieldName=IdCliente\nCampo[4].Origin=Tbl1.IdCliente\nCampo[4].Foreign.Enabled=1\nCampo[4].Foreign.Divisao=Cliente\nCampo[4].Foreign.Campo=IdPessoa\nCampo[4].Foreign.Tabela=vis_Cliente\nCampo[5].FieldName=Tbl2_IdPessoa\nCampo[5].Origin=Tbl2.IdPessoa\nCampo[5].PrimaryKey=1\nCampo[5].Foreign.Enabled=1\nCampo[5].Foreign.Divisao=Pessoa\nCampo[5].Foreign.Campo=IdPessoa\nCampo[5].Foreign.Tabela=cad_Pessoa\nCampo[5].Join.Enabled=1\nCampo[5].Join.Result=IdPessoa\nCampo[5].Join.Search=IdCliente\nCampo[6].FieldName=Tbl6_Nome\nCampo[6].Origin=Tbl6.Nome\nCampo[6].DisplayLabel=Cliente\nCampo[6].Join.Enabled=1\nCampo[6].Join.Result=Nome\nCampo[6].Join.Search=Tbl2_IdPessoa\nCampo[6].Width=200\nCampo[7].FieldName=IdMotivo_Nao_Aprovacao_Proposta\nCampo[7].Origin=Tbl1.IdMotivo_Nao_Aprovacao_Proposta\nCampo[7].Foreign.Enabled=1\nCampo[7].Foreign.Divisao=Motivo_Nao_Aprovacao_Proposta\nCampo[7].Foreign.Campo=IdMotivo_Nao_Aprovacao_Proposta\nCampo[7].Foreign.Tabela=cad_Motivo_Nao_Aprovacao_Proposta\nCampo[8].FieldName=Tbl21_Descricao\nCampo[8].Origin=Tbl21.Descricao\nCampo[8].DisplayLabel=Descrição / Motivo da não aprovação\nCampo[8].Join.Enabled=1\nCampo[8].Join.Result=Descricao\nCampo[8].Join.Search=IdMotivo_Nao_Aprovacao_Proposta\nCampo[8].Width=220\nCampo[9].FieldName=IdVendedor\nCampo[9].Origin=Tbl1.IdVendedor\nCampo[9].Foreign.Enabled=1\nCampo[9].Foreign.Divisao=Funcionario\nCampo[9].Foreign.Campo=IdPessoa\nCampo[9].Foreign.Tabela=vis_Funcionario\nCampo[10].FieldName=Tbl25_IdPessoa\nCampo[10].Origin=Tbl25.IdPessoa\nCampo[10].PrimaryKey=1\nCampo[10].Foreign.Enabled=1\nCampo[10].Foreign.Divisao=Pessoa\nCampo[10].Foreign.Campo=IdPessoa\nCampo[10].Foreign.Tabela=cad_Pessoa\nCampo[10].Join.Enabled=1\nCampo[10].Join.Result=IdPessoa\nCampo[10].Join.Search=IdVendedor\nCampo[11].FieldName=Tbl29_Nome\nCampo[11].Origin=Tbl29.Nome\nCampo[11].DisplayLabel=Comercial\nCampo[11].Join.Enabled=1\nCampo[11].Join.Result=Nome\nCampo[11].Join.Search=Tbl25_IdPessoa\nCampo[11].Width=200\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\SALDO DEVEDOR CLIENTE\\RELATORIO SALDO DEVEDOR CLIENTE OK.chd",
        "conteudo": "[Consulta]\nCampos=9\nCommandText=Declare,\"  @IdMoeda IdCurto,\",\"  @IdConversao_Moeda IdCurto\",,\"Set @IdMoeda = 20 /* REAL */\",\"Set @IdConversao_Moeda = 1\",,Select,\"  Fts.IdPessoa,\",\"  Psa.Nome As Pessoa,\",\"  Mda.Sigla As Moeda,\",\"  SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Atual,\",\"  SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_1_30,\",\"  SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_31_60,\",\"  SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_61_90,\",\"  SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_91,\",\"  SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Total\",From,\"  (Select\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda,\",\"    SUM(Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End) As Total,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) <= 0 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Atual,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 1 And 30 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_1_30,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 31 And 60 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_31_60,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 61 And 90 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_61_90,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) >= 91 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_91\",\"  From\",\"    mov_Fatura_Financeira Ffn\",\"  Join\",\"    mov_Registro_Financeiro Rfn On Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"  Join\",\"    vis_cliente Cln on Cln.IdPessoa = Rfn.IdPessoa\",\"  Where\",\"    Not Ffn.Situacao In (2, 4, 6)\",\"  Group By\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda\",\"  ) Fts\",\"Left Outer Join\",\"  cad_Pessoa Psa On Psa.IdPessoa = Fts.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda On Mda.IdMoeda = @IdMoeda\",\"Left Outer Join\",\"  (Select\",\"    Cmf.IdMoeda_Origem,\",\"    Cmf.IdMoeda_Destino,\",\"    Cmf.Fator,\",\"    Rank() Over(Partition By Cmf.IdMoeda_Origem, Cmf.IdMoeda_Destino Order By Cmf.Data Desc) As Ranking\",\"  From\",\"    cad_Conversao_Moeda_Fator Cmf\",\"  Where\",\"    Cmf.IdConversao_Moeda = @IdConversao_Moeda\",\"  ) Ftr On Ftr.Ranking = 1\",\"    And ((Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda)\",\"      Or (Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda))\",\"Group By\",\"  Fts.IdPessoa,\",\"  Psa.Nome,\",\"  Mda.Sigla\",\"Order By\",\"  Psa.Nome\"\n\n[Campos]\nCampo[0].FieldName=IdPessoa\nCampo[0].Origin=Fts.IdPessoa\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Pessoa\nCampo[1].Origin=Psa.Nome\nCampo[1].DisplayLabel=Pessoa\nCampo[1].Width=80\nCampo[2].FieldName=Moeda\nCampo[2].Origin=Mda.Sigla\nCampo[2].DisplayLabel=Moeda\nCampo[2].Width=80\nCampo[3].FieldName=Atual\nCampo[3].Origin=SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[3].DisplayLabel=Atual\nCampo[3].Width=80\nCampo[3].DisplayFormat=#,0.00\nCampo[4].FieldName=Periodo_1_30\nCampo[4].Origin=SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[4].DisplayLabel=Até 30 dias\nCampo[4].Width=80\nCampo[4].DisplayFormat=#,0.00\nCampo[5].FieldName=Periodo_31_60\nCampo[5].Origin=SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[5].DisplayLabel=31 a 60 dias\nCampo[5].Width=80\nCampo[5].DisplayFormat=#,0.00\nCampo[6].FieldName=Periodo_61_90\nCampo[6].Origin=SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[6].DisplayLabel=De 61 a 90 dias\nCampo[6].Width=80\nCampo[6].DisplayFormat=#,0.00\nCampo[7].FieldName=Periodo_91\nCampo[7].Origin=SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[7].DisplayLabel=+ 90 dias\nCampo[7].Width=80\nCampo[7].displayFormat=#,0.00\nCampo[8].FieldName=Total\nCampo[8].Origin=SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[8].DisplayLabel=Total\nCampo[8].Width=80\nCampo[8].DisplayFormat=#,0.00\n\n"
    },
    {
        "caminho": "Scripts\\Script_One_Driver\\RELATORIOS - CONSULTAS + PDF\\SALDO DEVEDOR FORNECEDOR\\RELATORIO SALDO DEVEDOR FORNECEDOR OK.chd",
        "conteudo": "[Consulta]\nCampos=9\nCommandText=Declare,\"  @IdMoeda IdCurto,\",\"  @IdConversao_Moeda IdCurto\",,\"Set @IdMoeda = 20 /* REAL */\",\"Set @IdConversao_Moeda = 1\",,Select,\"  Fts.IdPessoa,\",\"  Psa.Nome As Pessoa,\",\"  Mda.Sigla As Moeda,\",\"  SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Atual,\",\"  SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_1_30,\",\"  SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_31_60,\",\"  SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_61_90,\",\"  SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Periodo_91,\",\"  SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2)) As Total\",From,\"  (Select\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda,\",\"    SUM(Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End) As Total,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) <= 0 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Atual,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 1 And 30 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_1_30,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 31 And 60 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_31_60,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) Between 61 And 90 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_61_90,\",\"    SUM(Case\",\"      When DATEDIFF(DAY, Ffn.Data_Vencimento, CONVERT(date, GETDATE())) >= 91 Then Case When Ffn.Natureza = 0 Then -Ffn.Valor_Residual Else Ffn.Valor_Residual End\",\"      Else 0\",\"    End) As Periodo_91\",\"  From\",\"    mov_Fatura_Financeira Ffn\",\"  Join\",\"    mov_Registro_Financeiro Rfn On Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\",\"  Left Outer Join\",\"    vis_cliente Cln on Cln.IdPessoa = Rfn.IdPessoa\",\"  Where\",\"    Not Ffn.Situacao In (2, 4, 6)\",\"  And\",\"    (Cln.IdPessoa Is Null)\",\"  Group By\",\"    Rfn.IdPessoa,\",\"    Rfn.IdMoeda\",\"  ) Fts\",\"Left Outer Join\",\"  cad_Pessoa Psa On Psa.IdPessoa = Fts.IdPessoa\",\"Left Outer Join\",\"  cad_Moeda Mda On Mda.IdMoeda = @IdMoeda\",\"Left Outer Join\",\"  (Select\",\"    Cmf.IdMoeda_Origem,\",\"    Cmf.IdMoeda_Destino,\",\"    Cmf.Fator,\",\"    Rank() Over(Partition By Cmf.IdMoeda_Origem, Cmf.IdMoeda_Destino Order By Cmf.Data Desc) As Ranking\",\"  From\",\"    cad_Conversao_Moeda_Fator Cmf\",\"  Where\",\"    Cmf.IdConversao_Moeda = @IdConversao_Moeda\",\"  ) Ftr On Ftr.Ranking = 1\",\"    And ((Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda)\",\"      Or (Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda))\",\"Group By\",\"  Fts.IdPessoa,\",\"  Psa.Nome,\",\"  Mda.Sigla\",\"Order By\",\"  Psa.Nome\"\n\n[Campos]\nCampo[0].FieldName=IdPessoa\nCampo[0].Origin=Fts.IdPessoa\nCampo[0].PrimaryKey=1\nCampo[0].Width=0\nCampo[1].FieldName=Pessoa\nCampo[1].Origin=Psa.Nome\nCampo[1].DisplayLabel=Pessoa\nCampo[1].Width=80\nCampo[2].FieldName=Moeda\nCampo[2].Origin=Mda.Sigla\nCampo[2].DisplayLabel=Moeda\nCampo[2].Width=80\nCampo[3].FieldName=Atual\nCampo[3].Origin=SUM(ROUND(Fts.Atual * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[3].DisplayLabel=Atual\nCampo[3].Width=80\nCampo[3].DisplayFormat=#,0.00\nCampo[4].FieldName=Periodo_1_30\nCampo[4].Origin=SUM(ROUND(Fts.Periodo_1_30 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[4].DisplayLabel=Até 30 dias\nCampo[4].Width=80\nCampo[4].DisplayFormat=#,0.00\nCampo[5].FieldName=Periodo_31_60\nCampo[5].Origin=SUM(ROUND(Fts.Periodo_31_60 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[5].DisplayLabel=31 a 60 dias\nCampo[5].Width=80\nCampo[5].DisplayFormat=#,0.00\nCampo[6].FieldName=Periodo_61_90\nCampo[6].Origin=SUM(ROUND(Fts.Periodo_61_90 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[6].DisplayLabel=De 61 a 90 dias\nCampo[6].Width=80\nCampo[6].DisplayFormat=#,0.00\nCampo[7].FieldName=Periodo_91\nCampo[7].Origin=SUM(ROUND(Fts.Periodo_91 * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[7].DisplayLabel=+ 90 dias\nCampo[7].Width=80\nCampo[7].displayFormat=#,0.00\nCampo[8].FieldName=Total\nCampo[8].Origin=SUM(ROUND(Fts.Total * Case When Fts.IdMoeda = @IdMoeda Then 1 When Ftr.IdMoeda_Origem = Fts.IdMoeda And Ftr.IdMoeda_Destino = @IdMoeda Then Ftr.Fator When Ftr.IdMoeda_Origem = @IdMoeda And Ftr.IdMoeda_Destino = Fts.IdMoeda And COALESCE(Ftr.Fator, 0) <> 0 Then ROUND(1 / Ftr.Fator, 6) End, 2))\nCampo[8].DisplayLabel=Total\nCampo[8].Width=80\nCampo[8].DisplayFormat=#,0.00\n\n"
    },
    {
        "caminho": "Scripts\\Uteis\\Desvincular NF do Processo.sql",
        "conteudo": "--Desvincular NF do Processo\n \nSELECT *\nFROM\n   aux_Nota_Fiscal_Servico_Fatura\nWHERE\n   IdNota_Fiscal_Servico = 10507\n\n--Delete\nFROM\n   aux_Nota_Fiscal_Servico_Fatura\nWHERE\nIdNota_Fiscal_Servico = 454\n\n/*UPDATE aux_Nota_Fiscal_Servico_Fatura\nSET IdRegistro_Financeiro = 84644 /*id do registro financeiro do processo antigo*/\nWHERE IdNota_Fiscal_Servico = 10507*/  /*id da nf que vai ser desvinculada*/\n\n\nPrecisa ir no processo que vai ser desconvinculado\n'Faturas' --> 'Notas fiscais' --> '*' --> id. nota fiscal serviço\nvamos vincular esse id em um processo antigo pelo id. registro financeiro\npara pegar id. registro financeiro 'Faturas' --> '*'\n"
    },
    {
        "caminho": "Scripts\\Uteis\\Erro Fatura valor ou valor corrente de registro financeiro.sql",
        "conteudo": " \n  SELECT\n    Ffn.Valor_Corrente,\n    ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Fatura_Financeira Ffn\n  JOIN\n    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\n  WHERE\n    ISNULL(Ffn.Valor_Corrente, 0) <> ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n\n  \n\n  /*UPDATE mov_Fatura_Financeira\n  SET\n    Valor_Corrente = ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Fatura_Financeira Ffn\n  JOIN\n    mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro\n  WHERE\n    ISNULL(Ffn.Valor_Corrente, 0) <> ROUND(Ffn.Valor_Original * Rfn.Fator_Corrente, 2)*/\n\n  \n  \n\n  SELECT\n    Rfn.IdRegistro_Financeiro,\n    Rfn.Valor_Corrente,\n    ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Registro_Financeiro Rfn\n  WHERE\n    Rfn.Valor_Corrente <> ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)\n\n\n  /*UPDATE mov_Registro_Financeiro\n  SET\n    Valor_Corrente = ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)\n  FROM\n    mov_Registro_Financeiro Rfn\n  WHERE\n    Rfn.Valor_Corrente <> ROUND(Rfn.Valor_Original * Rfn.Fator_Corrente, 2)*/"
    },
    {
        "caminho": "Scripts\\Uteis\\hackear usuario.txt",
        "conteudo": "UPDATE\nsys_Usuario\nset Senha='e8d95a51f3af4a3b134bf6bb680a213a' /*<-- HASH = SENHA*/\nwhere Nome LIKE 'THIAGO.SOEIRO' /*<-- USUÁRIO*/ \n\n\n UPDATE\n sys_Usuario\n set Senha='eef2805e4c0c2e9ab4f0f4b00ba4e3d4'/*<--- HASH DA SENHA DO USUÁRIO*/\n where Nome LIKE 'THIAGO.SOEIRO' /*<-- INSERIR USUÁRIO*/\t\n\n\nSelect\nNome,\nSenha\nFROM\nsys_Usuario\nWHERE\nNome like '%THIAGO.SOEIRO%' /*Usuário para pegar a senha*/\t"
    },
    {
        "caminho": "Scripts\\Uteis\\Logs de tabela.sql",
        "conteudo": "DECLARE @Tabela     VARCHAR(MAX) = 'cad_Projeto_Tarefa_Monitor'\nDECLARE @PK1_Nome   VARCHAR(200) = 'IdProjeto_Tarefa_Monitor'\nDECLARE @PK1_Valor  VARCHAR(MAX) = ''\n\n-- Opcionais, use apenas quando precisar se não, deixe-os em branco!\nDECLARE @PK2_Nome   VARCHAR(200) = ''\nDECLARE @PK2_Valor  VARCHAR(MAX) = ''\nDECLARE @PK3_Nome   VARCHAR(200) = ''\nDECLARE @PK3_Valor  VARCHAR(MAX) = ''\n\nDECLARE @Data_Inicio_Texto  VARCHAR(20) = '01/01/2026' -- dd/MM/yyyy\nDECLARE @Usar_Hoje_Termino  BIT         = 1            -- 1 = usar GETDATE(); 0 = usar @Data_Termino_Texto\nDECLARE @Data_Termino_Texto VARCHAR(20) = ''           -- dd/MM/yyyy (use se @Usar_Hoje_Termino = 0)\n\n-- ?? OUTROS FILTROS\nDECLARE @IdUsuario IdCurto  = 0  -- 0 = Todos\nDECLARE @Tipo      TipoFixo = 0  -- 0 = Todos | 1=Inserção | 2=Exclusão | 3=Alteração\n\n/* -----------------------------------\n   ?? Variáveis internas\n----------------------------------- */\nDECLARE\n  @Primary_Keys  XML,\n  @Data_Inicio   DATETIME,\n  @Data_Termino  DATETIME,\n  @SQL           NVARCHAR(MAX),\n  @Filtro_Tabela VARCHAR(MAX),\n  @Filtro_Campo  VARCHAR(MAX),\n  @Filtro_Tipo   VARCHAR(MAX),\n  @IdExprList    NVARCHAR(MAX),\n  @IdExprCount   INT,\n  @ExprId        NVARCHAR(MAX),\n  @OrderBy       NVARCHAR(MAX)\n\n-- Normaliza entradas\nSET @PK1_Nome  = NULLIF(LTRIM(RTRIM(@PK1_Nome)) , '')\nSET @PK1_Valor = NULLIF(LTRIM(RTRIM(@PK1_Valor)), '')\nSET @PK2_Nome  = NULLIF(LTRIM(RTRIM(@PK2_Nome)) , '')\nSET @PK2_Valor = NULLIF(LTRIM(RTRIM(@PK2_Valor)), '')\nSET @PK3_Nome  = NULLIF(LTRIM(RTRIM(@PK3_Nome)) , '')\nSET @PK3_Valor = NULLIF(LTRIM(RTRIM(@PK3_Valor)), '')\n\nSET @Data_Inicio_Texto  = NULLIF(LTRIM(RTRIM(@Data_Inicio_Texto)) , '')\nSET @Data_Termino_Texto = NULLIF(LTRIM(RTRIM(@Data_Termino_Texto)), '')\nSET @Tabela             = NULLIF(LTRIM(RTRIM(@Tabela))            , '')\n\n-- Monta a lista de PKs\nDECLARE @PK_Input TABLE (Nome VARCHAR(200), Valor VARCHAR(MAX))\nIF @PK1_Nome IS NOT NULL AND @PK1_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK1_Nome, @PK1_Valor)\nIF @PK2_Nome IS NOT NULL AND @PK2_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK2_Nome, @PK2_Valor)\nIF @PK3_Nome IS NOT NULL AND @PK3_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK3_Nome, @PK3_Valor)\n\n-- Constrói o XML <PrimaryKeys>\nSET @Primary_Keys = (\n  SELECT Nome AS [@Nome], Valor AS [@Value]\n  FROM @PK_Input\n  FOR XML PATH('Item'), ROOT('PrimaryKeys'), TYPE\n)\n\n-- Converte Data_Inicio\nSET @Data_Inicio =\n  COALESCE(\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 103),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 120),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto)\n  )\n\n-- Define Data_Termino (fim do dia quando informar texto)\nIF @Usar_Hoje_Termino = 1\n  SET @Data_Termino = GETDATE()\nELSE\n  SET @Data_Termino =\n    DATEADD(SECOND, 86399,\n      COALESCE(\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 103),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 120),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto)\n      )\n    )\n\n-- ?? Agrupar múltiplos valores por campo\nDECLARE @FiltroXml TABLE (Nome VARCHAR(MAX), VALUE VARCHAR(MAX))\nINSERT INTO @FiltroXml\nSELECT\n  Pks.value('@Nome',  'VARCHAR(MAX)') AS Nome,\n  Pks.value('@Value', 'VARCHAR(MAX)') AS Value\nFROM\n  @Primary_Keys.nodes('/PrimaryKeys/Item') AS PrimaryKeys(Pks)\n\n-- ?? Filtros dinâmicos\nSET @Filtro_Tabela = ''\nIF @Tabela IS NOT NULL\n  SET @Filtro_Tabela = '[@Nome=\"'+@Tabela+'\"]'\n\nSET @Filtro_Campo = ''\nSELECT @Filtro_Campo = @Filtro_Campo +\n  '[Campo[@Nome=\"'+Nome+'\" and (' +\n  STRING_AGG('@Value=\"'+VALUE+'\"', ' or ') +\n  ')]]'\nFROM @FiltroXml\nGROUP BY Nome\n\nSET @Filtro_Tipo = ''\nIF @Tipo <> 0\n  SET @Filtro_Tipo = '[@Tipo=\"'+CAST(@Tipo AS VARCHAR(MAX))+'\"]'\n\n/* ?? Expressão de Id segura (numérica) */\nSET @IdExprList  = ''\nSET @IdExprCount = 0\n\nIF @PK1_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK2_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK3_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @IdExprCount = 0\n  SET @ExprId = 'NULL'\nELSE IF @IdExprCount = 1\n  SET @ExprId = @IdExprList\nELSE\n  SET @ExprId = 'COALESCE(' + @IdExprList + ')'\n\n-- ORDER BY: Definido fixo para Data Ascendente conforme solicitado\nSET @OrderBy = 'ORDER BY Ltb.Data_Inicio ASC'\n\n-- ?? Consulta dinâmica\nSET @SQL = '\nSELECT\n    Usr.Nome AS Usuario,\n    CONVERT(VARCHAR(10), Ltb.Data_Inicio , 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Inicio , 108) AS Data_Inicio_Transacao,\n    CONVERT(VARCHAR(10), Ltb.Data_Termino, 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Termino, 108) AS Data_Termino_Transacao,\n    DATEDIFF(SECOND, Ltb.Data_Inicio, Ltb.Data_Termino) AS Tempo_Transacao,\n    Dlg.value(''../@WindowsUser'',  ''VARCHAR(MAX)'') AS Usuario_Windows,\n    Dlg.value(''../@ComputerName'', ''VARCHAR(MAX)'') AS Computador,\n    Dlg.value(''@Nome'',            ''VARCHAR(MAX)'')  AS Tabela,\n    ' + @ExprId + ' AS Id,\n    CASE Dlg.value(''@Tipo'', ''SMALLINT'')\n         WHEN 1 THEN ''INSERÇÃO''\n         WHEN 2 THEN ''EXCLUSÃO''\n         WHEN 3 THEN ''ALTERAÇÃO''\n         ELSE CAST(Dlg.value(''@Tipo'', ''SMALLINT'') AS VARCHAR(10))\n    END AS Tipo,\n    CONVERT(VARCHAR(10), CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 103)\n      + '' '' +\n    CONVERT(VARCHAR(8),  CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 108) AS Data,\n    Dlg.query(''<Campos>{Campo}</Campos>'') AS Campos\nFROM\n    sys_Log_Tabela Ltb\nCROSS APPLY\n    Ltb.Dados_Log.nodes(''/Log/Tabela' + @Filtro_Tabela + @Filtro_Tipo + @Filtro_Campo + ''') AS DadosLog(Dlg)\nJOIN\n    sys_Usuario Usr ON Usr.IdUsuario = Ltb.IdUsuario\nWHERE\n    ((@IdUsuario = 0) OR (Ltb.IdUsuario = @IdUsuario))\n    AND (\n        ((@Data_Inicio IS NULL) AND (@Data_Termino IS NULL)) OR\n        (Ltb.Data_Inicio  BETWEEN @Data_Inicio AND @Data_Termino) OR\n        (Ltb.Data_Termino BETWEEN @Data_Inicio AND @Data_Termino)\n    )\n    \n' + @OrderBy + '\n'\n\n-- ?? Execução\nEXEC sp_executesql \n  @SQL, \n  N'@Data_Inicio DATETIME, @Data_Termino DATETIME, @IdUsuario IdCurto',\n  @Data_Inicio  = @Data_Inicio,\n  @Data_Termino = @Data_Termino,\n  @IdUsuario    = @IdUsuario"
    },
    {
        "caminho": "Scripts\\Uteis\\Pegar usuario logado.html",
        "conteudo": "<DataSet><CommandText>Select\n  Fnc.IdPessoa,\n  Fnc.Nome as Funcionario,\n  Fnc.EMail\nFrom\n  sys_Usuario Usr\nJoin\n  #Global_Var Gvr on Gvr.Variavel Like 'IdUsuario' And Usr.IdUsuario = Gvr.Valor\nJoin\n  vis_Funcionario Fnc on Fnc.IdUsuario_Correspondente = Usr.IdUsuario\n</CommandText></DataSet>"
    },
    {
        "caminho": "Scripts\\Uteis\\REFORMA TRIBUTÁRIA.txt",
        "conteudo": "=========================================\nRESUMO TÉCNICO: REFORMA TRIBUTÁRIA\n=========================================\n\n[O QUE SAI - IMPOSTOS EXTINTOS]\nA reforma elimina 5 tributos atuais:\n1. PIS (Federal)\n2. COFINS (Federal)\n3. IPI (Federal)\n4. ICMS (Estadual)\n5. ISS (Municipal)\n\n-----------------------------------------\n\n[O QUE ENTRA - NOVOS TRIBUTOS (IVA DUAL)]\nO sistema passa a ser baseado no IVA (Imposto sobre Valor Agregado) dividido em dois:\n\n1. CBS (Contribuição sobre Bens e Serviços)\n   -> Substitui: PIS, COFINS e IPI.\n   -> Quem cobra: Governo Federal.\n\n2. IBS (Imposto sobre Bens e Serviços)\n   -> Substitui: ICMS e ISS.\n   -> Quem cobra: Estados e Municípios (juntos).\n\n3. IS (Imposto Seletivo / \"Imposto do Pecado\")\n   -> Função: Sobretaxa para desestimular consumo de produtos nocivos (cigarro, álcool, poluentes).\n   -> Incide junto com os outros impostos.\n\n-----------------------------------------\n\n[CRONOGRAMA TÉCNICO]\n- 2026: Início dos testes (0,9% CBS + 0,1% IBS).\n- 2027: Fim do PIS e COFINS. Entrada total da CBS.\n- 2029 a 2032: Transição gradual (ICMS/ISS diminuem, IBS aumenta).\n- 2033: Sistema antigo extinto. Vigência total do novo sistema.\n\n=========================================\nNOTA PARA DESENVOLVIMENTO:\nO cálculo do imposto passa a ser \"por fora\" (não embutido no preço) e a base de cálculo será a mesma para bens e serviços.\n========================================="
    },
    {
        "caminho": "Scripts\\Uteis\\senhas.txt",
        "conteudo": "Kauanlauer2026@"
    },
    {
        "caminho": "Scripts\\Uteis\\Usuário\\Criar usuário(antigo).sql",
        "conteudo": "SET NOCOUNT ON  \nDeclare  \n  @Usuario_Origem NomeCurto,  \n  @Usuario_Destino NomeCurto,  \n  @Copiar_Consultas Boleano,  \n  @Copiar_Modulos Boleano,  \n  @Copiar_Papeis Boleano,  \n  @Copiar_Persistencias Boleano  \n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */  \nSet @Usuario_Origem = 'flauvi.headsoft'  \nSet @Usuario_Destino = 'kauan.headsoft'  \nSet @Copiar_Consultas = 1  \nSet @Copiar_Modulos = 1  \nSet @Copiar_Papeis = 1  \nSet @Copiar_Persistencias = 0  \n/* FINAL */  \nDeclare  \n  @IdUsuario_Origem IdCurto,  \n  @IdUsuario_Destino IdCurto,  \n  @Max IdCurto\n\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)  \nIf @IdUsuario_Origem Is Null  \nBegin  \n  Print 'Usuário origem não encontrado para a cópia.'  \n  Return  \nEnd\n\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)  \nIf @IdUsuario_Destino Is Null  \nBegin  \n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)  \n  Begin  \n    Print 'É necessário especificar um nome de usuário destino para a cópia.'  \n    Return  \n  End\n\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1  \n  Insert Into sys_Usuario (  \n    IdUsuario,  \n    Nome,  \n    Senha,  \n    Data_Criacao,  \n    Ativo  \n  )  \n  Values (  \n    @IdUsuario_Destino,  \n    @Usuario_Destino,  \n    LOWER(CONVERT(VARCHAR(32), HashBytes('MD5', (LOWER(SUBSTRING(@Usuario_Destino, 1,1)+SUBSTRING(@Usuario_Destino, (CASE WHEN CHARINDEX('.', @Usuario_Destino) != 0 THEN CHARINDEX('.', @Usuario_Destino)+1 WHEN CHARINDEX(' ', @Usuario_Destino) != 0 THEN CHARINDEX(' ', @Usuario_Destino)+1 ELSE -1 END) , 1)+CAST(YEAR(GETDATE()) as VARCHAR(10))))), 2)),  \n    GetDate(),  \n    1  \n  )\n\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n\n  print 'Usuário criado.'  \nEnd\n\nIf @Copiar_Consultas = 1  \nBegin  \n  Delete From sys_Consulta_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Consulta_Usuario (  \n    IdConsulta,  \n    IdUsuario,  \n    Permissao_Imprimir,  \n    Permissao_Exportar  \n  )  \n  Select  \n    IdConsulta,  \n    @IdUsuario_Destino,  \n    Permissao_Imprimir,  \n    Permissao_Exportar  \n  From  \n    sys_Consulta_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Origem\n\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))  \nEnd\n\nIf @Copiar_Modulos = 1  \nBegin  \n  Delete From sys_Modulo_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Modulo_Usuario (  \n    IdModulo,  \n    IdUsuario  \n  )  \n  Select  \n    IdModulo,  \n    @IdUsuario_Destino as IdUsuario  \n  From  \n    sys_Modulo_Usuario  \n  Where  \n    IdUsuario = @IdUsuario_Origem  \n  and  \n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n\n  print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))  \nEnd\n\nIf @Copiar_Papeis = 1  \nBegin  \n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n\n  Delete From sys_Papel_Membro  \n  Where  \n    IdUsuario = @IdUsuario_Destino\n\n  Insert Into sys_Papel_Membro (  \n    IdPapel_Membro,  \n    IdPapel_Superior,  \n    IdUsuario,  \n    IdPapel  \n  )  \n  Select  \n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,  \n    IdPapel_Superior,  \n    @IdUsuario_Destino as IdUsuario,  \n    IdPapel  \n  From  \n    sys_Papel_Membro  \n  Where  \n    IdUsuario = @IdUsuario_Origem  \n  and  \n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n  If @@ROWCOUNT > 0  \n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'  \nEnd\n\nIf @Copiar_Persistencias = 1  \nBegin  \n  Update Dst Set  \n    Dados = Src.Dados  \n  From  \n    sys_Persistencia Src  \n  Join  \n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia  \n  and  \n    Dst.IdUsuario = @IdUsuario_Destino  \n  Where    \n    Src.IdUsuario = @IdUsuario_Origem\n\n  if @@ROWCOUNT > 0  \n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n\n  Insert Into sys_Persistencia (  \n    IdPersistencia,  \n    IdUsuario,  \n    Dados  \n  )  \n  Select  \n    IdPersistencia,  \n    @IdUsuario_Destino as IdUsuario,  \n    Dados  \n  From  \n    sys_Persistencia  \n  Where  \n    IdUsuario = @IdUsuario_Origem  \n  and  \n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n\n  If @@ROWCOUNT > 0  \n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))  \nEnd\n\nSET NOCOUNT OFF"
    },
    {
        "caminho": "Scripts\\Uteis\\Usuário\\Criar usuário(novo).sql",
        "conteudo": "SET NOCOUNT ON\nDeclare\n  @Usuario_Origem NomeCurto,\n  @Usuario_Destino NomeCurto,\n  @Copiar_Consultas Boleano,\n  @Copiar_Modulos Boleano,\n  @Copiar_Papeis Boleano,\n  @Copiar_Persistencias Boleano\n/* CONFIGURAÇÕES DA CÓPIA DE USUÁRIO */\nSet @Usuario_Origem = 'flauvi.headsoft'\nSet @Usuario_Destino = 'kauan.headsoft'\nSet @Copiar_Consultas = 1\nSet @Copiar_Modulos = 1\nSet @Copiar_Papeis = 1\nSet @Copiar_Persistencias = 0\n/* FINAL */\nDeclare\n  @IdUsuario_Origem IdCurto,\n  @IdUsuario_Destino IdCurto,\n  @Max IdLongo\nSet @IdUsuario_Origem = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Origem)\nIf @IdUsuario_Origem Is Null\nBegin\n  Print 'Usuário origem não encontrado para a cópia.'\n  Return\nEnd\nSet @IdUsuario_Destino = (Select IdUsuario From sys_Usuario Where Nome Like @Usuario_Destino)\nIf @IdUsuario_Destino Is Null\nBegin\n  If (LTrim(@Usuario_Destino) = '') or (@Usuario_Destino Is Null)\n  Begin\n    Print 'É necessário especificar um nome de usuário destino para a cópia.'\n    Return\n  End\n  Set @IdUsuario_Destino = Coalesce((Select Max(IdUsuario) From sys_Usuario), 0) + 1\n  Insert Into sys_Usuario (\n    IdUsuario,\n    Nome,\n    Senha,\n    Data_Criacao,\n    Ativo,\n    Alterar_Senha,\n    Bloqueado\n  )\n  Values (\n    @IdUsuario_Destino,\n    @Usuario_Destino,\n    LOWER(CONVERT(VARCHAR(32), HashBytes('MD5', (LOWER(SUBSTRING(@Usuario_Destino, 1,1)+SUBSTRING(@Usuario_Destino, (CASE WHEN CHARINDEX('.', @Usuario_Destino) != 0 THEN CHARINDEX('.', @Usuario_Destino)+1 WHEN CHARINDEX(' ', @Usuario_Destino) != 0 THEN CHARINDEX(' ', @Usuario_Destino)+1 ELSE -1 END) , 1)+CAST(YEAR(GETDATE()) as VARCHAR(10))))), 2)),\n    GetDate(),\n    1, 0, 0\n  )\n  Update sys_Campo_Incremento Set Codigo = @IdUsuario_Destino Where Divisao Like 'sys_Usuario' and IdCampo_Incremento Like 'IdUsuario'\n  print 'Usuário criado.'\nEnd\nIf @Copiar_Consultas = 1\nBegin\n  Delete From sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n  Insert Into sys_Consulta_Usuario (\n    IdConsulta,\n    IdUsuario,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  )\n  Select\n    IdConsulta,\n    @IdUsuario_Destino,\n    Permissao_Imprimir,\n    Permissao_Exportar\n  From\n    sys_Consulta_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n  print 'Consultas copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\nIf @Copiar_Modulos = 1\nBegin\n  Delete From sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Destino\n  Insert Into sys_Modulo_Usuario (\n    IdModulo,\n    IdUsuario\n  )\n  Select\n    IdModulo,\n    @IdUsuario_Destino as IdUsuario\n  From\n    sys_Modulo_Usuario\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdModulo Not In (Select IdModulo From sys_Modulo_Usuario Where IdUsuario = @IdUsuario_Destino)\n   print 'Módulos copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\nIf @Copiar_Papeis = 1\nBegin\n  Set @Max = Coalesce((Select Max(IdPapel_Membro) From sys_Papel_Membro), 0)\n   Delete From sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Destino\n   Insert Into sys_Papel_Membro (\n    IdPapel_Membro,\n    IdPapel_Superior,\n    IdUsuario,\n    IdPapel\n  )\n  Select\n    Rank() Over (Order By IdPapel_Membro) + @Max as IdPapel_Membro,\n    IdPapel_Superior,\n    @IdUsuario_Destino as IdUsuario,\n    IdPapel\n  From\n    sys_Papel_Membro\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPapel_Superior Not In (Select IdPapel_Superior From sys_Papel_Membro Where IdUsuario = @IdUsuario_Destino)\n  print 'Papéis copiados: ' + Cast(@@ROWCOUNT as VarChar(Max))\n  If @@ROWCOUNT > 0\n    Update sys_Campo_Incremento Set Codigo = (Select Max(IdConsulta) From sys_Consulta) Where Divisao Like 'sys_Consulta' and IdCampo_Incremento Like 'IdConsulta'\nEnd\nIf @Copiar_Persistencias = 1\nBegin\n  Update Dst Set\n    Dados = Src.Dados\n  From\n    sys_Persistencia Src\n  Join\n    sys_Persistencia Dst on Dst.IdPersistencia Like Src.IdPersistencia\n  and\n    Dst.IdUsuario = @IdUsuario_Destino\n  Where  \n    Src.IdUsuario = @IdUsuario_Origem\n  if @@ROWCOUNT > 0\n    print 'Persistências atualizadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\n  Insert Into sys_Persistencia (\n    IdPersistencia,\n    IdUsuario,\n    Dados\n  )\n  Select\n    IdPersistencia,\n    @IdUsuario_Destino as IdUsuario,\n    Dados\n  From\n    sys_Persistencia\n  Where\n    IdUsuario = @IdUsuario_Origem\n  and\n    IdPersistencia Not In (Select IdPersistencia From sys_Persistencia Where IdUsuario = @IdUsuario_Destino)\n  If @@ROWCOUNT > 0\n    print 'Persistencias copiadas: ' + Cast(@@ROWCOUNT as VarChar(Max))\nEnd\nSET NOCOUNT OFF"
    },
    {
        "caminho": "Scripts\\Uteis\\Usuário\\Script para trocar a senha do usuario pelo banco.sql",
        "conteudo": "UPDATE\nsys_Usuario\nset Senha='e8d95a51f3af4a3b134bf6bb680a213a' /*<-- HASH = SENHA*/\nwhere Nome LIKE '%prime%' /*<-- USUÁRIO*/ \n\n\n UPDATE\n sys_Usuario\n set Senha=''/*<--- HASH DA SENHA DO USUÁRIO*/\n where Nome LIKE '' /*<-- INSERIR USUÁRIO*/\t\n\nSelect\nNome,\nSenha\nFROM\nsys_Usuario\nWHERE\nNome like '%Prime%' /*Usuário para pegar a senha*/\t\n\n"
    },
    {
        "caminho": "SQL Server Management Studio 22\\SQLQuery45.sql",
        "conteudo": "DECLARE @Tabela     VARCHAR(MAX) = 'mov_Logistica_Viagem'\nDECLARE @PK1_Nome   VARCHAR(200) = 'IdLogistica_House'\nDECLARE @PK1_Valor  VARCHAR(MAX) = '108360'\n\n-- Opcionais, use apenas quando precisar se não, deixe-os em branco!\nDECLARE @PK2_Nome   VARCHAR(200) = ''\nDECLARE @PK2_Valor  VARCHAR(MAX) = ''\nDECLARE @PK3_Nome   VARCHAR(200) = ''\nDECLARE @PK3_Valor  VARCHAR(MAX) = ''\n\nDECLARE @Data_Inicio_Texto  VARCHAR(20) = '24/09/2025' -- dd/MM/yyyy\nDECLARE @Usar_Hoje_Termino  BIT         = 1            -- 1 = usar GETDATE(); 0 = usar @Data_Termino_Texto\nDECLARE @Data_Termino_Texto VARCHAR(20) = ''           -- dd/MM/yyyy (use se @Usar_Hoje_Termino = 0)\n\n-- ?? OUTROS FILTROS\nDECLARE @IdUsuario IdCurto  = 0  -- 0 = Todos\nDECLARE @Tipo      TipoFixo = 0  -- 0 = Todos | 1=Inserção | 2=Exclusão | 3=Alteração\n\n/* -----------------------------------\n   ?? Variáveis internas\n----------------------------------- */\nDECLARE\n  @Primary_Keys  XML,\n  @Data_Inicio   DATETIME,\n  @Data_Termino  DATETIME,\n  @SQL           NVARCHAR(MAX),\n  @Filtro_Tabela VARCHAR(MAX),\n  @Filtro_Campo  VARCHAR(MAX),\n  @Filtro_Tipo   VARCHAR(MAX),\n  @IdExprList    NVARCHAR(MAX),\n  @IdExprCount   INT,\n  @ExprId        NVARCHAR(MAX),\n  @OrderBy       NVARCHAR(MAX)\n\n-- Normaliza entradas\nSET @PK1_Nome  = NULLIF(LTRIM(RTRIM(@PK1_Nome)) , '')\nSET @PK1_Valor = NULLIF(LTRIM(RTRIM(@PK1_Valor)), '')\nSET @PK2_Nome  = NULLIF(LTRIM(RTRIM(@PK2_Nome)) , '')\nSET @PK2_Valor = NULLIF(LTRIM(RTRIM(@PK2_Valor)), '')\nSET @PK3_Nome  = NULLIF(LTRIM(RTRIM(@PK3_Nome)) , '')\nSET @PK3_Valor = NULLIF(LTRIM(RTRIM(@PK3_Valor)), '')\n\nSET @Data_Inicio_Texto  = NULLIF(LTRIM(RTRIM(@Data_Inicio_Texto)) , '')\nSET @Data_Termino_Texto = NULLIF(LTRIM(RTRIM(@Data_Termino_Texto)), '')\nSET @Tabela             = NULLIF(LTRIM(RTRIM(@Tabela))            , '')\n\n-- Monta a lista de PKs\nDECLARE @PK_Input TABLE (Nome VARCHAR(200), Valor VARCHAR(MAX))\nIF @PK1_Nome IS NOT NULL AND @PK1_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK1_Nome, @PK1_Valor)\nIF @PK2_Nome IS NOT NULL AND @PK2_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK2_Nome, @PK2_Valor)\nIF @PK3_Nome IS NOT NULL AND @PK3_Valor IS NOT NULL INSERT INTO @PK_Input VALUES (@PK3_Nome, @PK3_Valor)\n\n-- Constrói o XML <PrimaryKeys>\nSET @Primary_Keys = (\n  SELECT Nome AS [@Nome], Valor AS [@Value]\n  FROM @PK_Input\n  FOR XML PATH('Item'), ROOT('PrimaryKeys'), TYPE\n)\n\n-- Converte Data_Inicio\nSET @Data_Inicio =\n  COALESCE(\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 103),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto, 120),\n    TRY_CONVERT(DATETIME, @Data_Inicio_Texto)\n  )\n\n-- Define Data_Termino (fim do dia quando informar texto)\nIF @Usar_Hoje_Termino = 1\n  SET @Data_Termino = GETDATE()\nELSE\n  SET @Data_Termino =\n    DATEADD(SECOND, 86399,\n      COALESCE(\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 103),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto, 120),\n        TRY_CONVERT(DATETIME, @Data_Termino_Texto)\n      )\n    )\n\n-- ?? Agrupar múltiplos valores por campo\nDECLARE @FiltroXml TABLE (Nome VARCHAR(MAX), VALUE VARCHAR(MAX))\nINSERT INTO @FiltroXml\nSELECT\n  Pks.value('@Nome',  'VARCHAR(MAX)') AS Nome,\n  Pks.value('@Value', 'VARCHAR(MAX)') AS Value\nFROM\n  @Primary_Keys.nodes('/PrimaryKeys/Item') AS PrimaryKeys(Pks)\n\n-- ?? Filtros dinâmicos\nSET @Filtro_Tabela = ''\nIF @Tabela IS NOT NULL\n  SET @Filtro_Tabela = '[@Nome=\"'+@Tabela+'\"]'\n\nSET @Filtro_Campo = ''\nSELECT @Filtro_Campo = @Filtro_Campo +\n  '[Campo[@Nome=\"'+Nome+'\" and (' +\n  STRING_AGG('@Value=\"'+VALUE+'\"', ' or ') +\n  ')]]'\nFROM @FiltroXml\nGROUP BY Nome\n\nSET @Filtro_Tipo = ''\nIF @Tipo <> 0\n  SET @Filtro_Tipo = '[@Tipo=\"'+CAST(@Tipo AS VARCHAR(MAX))+'\"]'\n\n/* ?? Expressão de Id segura (numérica) */\nSET @IdExprList  = ''\nSET @IdExprCount = 0\n\nIF @PK1_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK1_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK2_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK2_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @PK3_Nome IS NOT NULL\nBEGIN\n  SET @IdExprList  = @IdExprList + CASE WHEN @IdExprCount > 0 THEN ', ' ELSE '' END +\n    'TRY_CONVERT(INT,\n       CASE\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@Value)[1]'',''VARCHAR(MAX)'')\n         WHEN Dlg.exist(''Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue'')=1\n           THEN Dlg.value(''(Campo[@Nome=\"' + @PK3_Nome + '\"]/@OldValue)[1]'',''VARCHAR(MAX)'')\n         ELSE NULL\n       END\n     )'\n  SET @IdExprCount = @IdExprCount + 1\nEND\n\nIF @IdExprCount = 0\n  SET @ExprId = 'NULL'\nELSE IF @IdExprCount = 1\n  SET @ExprId = @IdExprList\nELSE\n  SET @ExprId = 'COALESCE(' + @IdExprList + ')'\n\n-- ORDER BY: Definido fixo para Data Ascendente conforme solicitado\nSET @OrderBy = 'ORDER BY Ltb.Data_Inicio ASC'\n\n-- ?? Consulta dinâmica\nSET @SQL = '\nSELECT\n    Usr.Nome AS Usuario,\n    CONVERT(VARCHAR(10), Ltb.Data_Inicio , 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Inicio , 108) AS Data_Inicio_Transacao,\n    CONVERT(VARCHAR(10), Ltb.Data_Termino, 103) + '' '' + CONVERT(VARCHAR(8), Ltb.Data_Termino, 108) AS Data_Termino_Transacao,\n    DATEDIFF(SECOND, Ltb.Data_Inicio, Ltb.Data_Termino) AS Tempo_Transacao,\n    Dlg.value(''../@WindowsUser'',  ''VARCHAR(MAX)'') AS Usuario_Windows,\n    Dlg.value(''../@ComputerName'', ''VARCHAR(MAX)'') AS Computador,\n    Dlg.value(''@Nome'',            ''VARCHAR(MAX)'')  AS Tabela,\n    ' + @ExprId + ' AS Id,\n    CASE Dlg.value(''@Tipo'', ''SMALLINT'')\n         WHEN 1 THEN ''INSERÇÃO''\n         WHEN 2 THEN ''EXCLUSÃO''\n         WHEN 3 THEN ''ALTERAÇÃO''\n         ELSE CAST(Dlg.value(''@Tipo'', ''SMALLINT'') AS VARCHAR(10))\n    END AS Tipo,\n    CONVERT(VARCHAR(10), CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 103)\n      + '' '' +\n    CONVERT(VARCHAR(8),  CONVERT(DATETIME, Dlg.value(''@Data'', ''VARCHAR(MAX)''), 101), 108) AS Data,\n    Dlg.query(''<Campos>{Campo}</Campos>'') AS Campos\nFROM\n    sys_Log_Tabela Ltb\nCROSS APPLY\n    Ltb.Dados_Log.nodes(''/Log/Tabela' + @Filtro_Tabela + @Filtro_Tipo + @Filtro_Campo + ''') AS DadosLog(Dlg)\nJOIN\n    sys_Usuario Usr ON Usr.IdUsuario = Ltb.IdUsuario\nWHERE\n    ((@IdUsuario = 0) OR (Ltb.IdUsuario = @IdUsuario))\n    AND (\n        ((@Data_Inicio IS NULL) AND (@Data_Termino IS NULL)) OR\n        (Ltb.Data_Inicio  BETWEEN @Data_Inicio AND @Data_Termino) OR\n        (Ltb.Data_Termino BETWEEN @Data_Inicio AND @Data_Termino)\n    )\n    \n' + @OrderBy + '\n'\n\n-- ?? Execução\nEXEC sp_executesql \n  @SQL, \n  N'@Data_Inicio DATETIME, @Data_Termino DATETIME, @IdUsuario IdCurto',\n  @Data_Inicio  = @Data_Inicio,\n  @Data_Termino = @Data_Termino,\n  @IdUsuario    = @IdUsuario"
    }
]