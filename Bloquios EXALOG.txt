Nome_Papel	Dados_Registro	Mensagem_Bloqueio
BLC_005_CONTAINER_SEM_TIPO_ITEM_CARGA	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Favor preencher Tipo item carga no itens de carga do conhecimento.'     Else NULL   END as VARCHAR(MAX)) FROM     (     SELECT         CAST(CASE             WHEN                  Prm.Tipo_Item_Carga NOT IN(1,2,3,4) THEN 1             Else 0         END as Bit) as Bloqueado     FROM         (     SELECT         Prm.value('Item[@Nome="IdLogistica_Maritima_Container"][1]/@Value', 'int') as IdLogistica_Maritima_Container,         Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House,         Prm.value('Item[@Nome="Tipo_Item_Carga"][1]/@Value', 'int') as Tipo_Item_Carga     FROM         @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm     JOIN      mov_Logistica_Maritima_Container Lmc ON Lmc.IdLogistica_Maritima_Container = Prm.IdLogistica_Maritima_Container     LEFT OUTER JOIN      mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Lmc.IdLogistica_House ) Blq 	Favor preencher Tipo item carga no itens de carga do conhecimento.
BLC_NAO_FINALIZA_PROCESSO	 SELECT   @Acao = CASE WHEN Bloqueado = 1 THEN 5 Else 0 END, /* 5 = Bloquear e exibir aviso */    @Mensagem = CAST(CASE Bloqueado     WHEN 1 THEN 'Não permissão para finalizar o processo.'     Else NULL   END as VARCHAR(MAX)) FROM   (   SELECT     CASE         WHEN Prm.Situacao_Agenciamento in (5) /*Finalizado*/ THEN 1       ELSE 0     END as Bloqueado   FROM     (     SELECT        Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House,        Prm.value('Item[@Nome="Situacao_Agenciamento"][1]/@Value', 'int') as Situacao_Agenciamento     FROM         @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm ) Blq   /*REQ #31253*/	Não permissão para finalizar o processo.
02 - BLQ_CONFERIR_OPE_FATURA_FINAN_OPERACIONAL	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueia e exibe aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN '[#02] Seu usuário não tem permissão para conferir/desconferir faturas.'     Else NULL   END as VARCHAR(MAX)) FROM   (   SELECT     CAST(CASE       WHEN Prm.IdRegistro_Financeiro IS NOT NULL AND  (Prm.Conferido_Operacional = 1 AND Lft.Conferido_Operacional = 0 /*DESCONFERIR*/) THEN 1       WHEN Prm.IdRegistro_Financeiro IS NOT NULL AND  (Prm.Conferido_Operacional = 0 AND Lft.Conferido_Operacional = 1 /*CONFERIR*/) THEN 1       ELSE 0      END as Bit) as Bloqueado   FROM     (     SELECT       Prm.value('Item[@Nome="IdRegistro_Financeiro"][1]/@Value', 'int') as IdRegistro_Financeiro,       Prm.value('Item[@Nome="Conferido_Operacional"][1]/@Value', 'int') as Conferido_Operacional,       Prm.value('Item[@Nome="Conferido"][1]/@Value', 'int') as Conferido      FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)     ) Prm   JOIN     mov_Logistica_Fatura Lft ON Lft.IdRegistro_Financeiro = Prm.IdRegistro_Financeiro   JOIN     mov_Fatura_Financeira Ffn ON Ffn.IdRegistro_Financeiro = Prm.IdRegistro_Financeiro   ) Blq 	[#02] Seu usuário não tem permissão para conferir/desconferir faturas.
BLC_001_N_ALTERA_COM_BAIXA_CONCILIADA	 SELECT   @Acao = CASE WHEN Bloqueado = 1 THEN 5 /* bloqueado */ ELSE 0 END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN '[#BLC001] Não é possível alterar/excluir com baixa já conciliada!'     ELSE NULL   END as VARCHAR(MAX)) FROM (   SELECT     CAST(CASE       WHEN Mfn.Conciliada = 1 THEN 1       ELSE 0     END as BIT) as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdMovimentacao_Financeira"][1]/@Value', 'int') as IdMovimentacao_Financeira     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm left outer join mov_Movimentacao_Financeira mfn on mfn.IdMovimentacao_Financeira = prm.IdMovimentacao_Financeira  ) Blq 	[#BLC001] Não é possível alterar/excluir com baixa já conciliada!
BLC_003_N_INSERE_ALTERA_DEADLINE_ARMADOR	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN '[003] Proibido inserir ou alterar as datas de deadline do armador.'     Else NULL   END as VARCHAR(MAX)) FROM (   SELECT      CASE        WHEN Dda.IdCampo_Livre = Prm.IdCampo_Livre OR Dda.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Vgm.IdCampo_Livre = Prm.IdCampo_Livre OR Vgm.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Dma.IdCampo_Livre = Prm.IdCampo_Livre OR Dma.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Dla.IdCampo_Livre = Prm.IdCampo_Livre OR Dla.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1     ELSE 0      END as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdCampo_Livre"][1]/@Value', 'int') as IdCampo_Livre,       Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm Left Outer Join   mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House Left Outer Join   vis_logistica_prazo Dda ON Dda.Identificador = 'DeadLine_Draft_Armador' AND Dda.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Vgm ON Vgm.Identificador = 'DeadLine_VGM_Armador' AND Vgm.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Dma ON Dma.Identificador = 'DeadLine_MDGF_Armador' AND Dma.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Dla ON Dla.Identificador = 'DeadLine_Lashing_Armador' AND Dla.IdLogistica_House = Lhs.IdLogistica_House ) Bloq 	[003] Proibido inserir ou alterar as datas de deadline do armador.
BLC_004_N_INSERE_ALTERA_DEADLINE_CLIENTE	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN '[004] Proibido inserir ou alterar as datas de deadline do cliente.'     Else NULL   END as VARCHAR(MAX)) FROM (   SELECT      CASE        WHEN Ddc.IdCampo_Livre = Prm.IdCampo_Livre OR Ddc.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Vgm.IdCampo_Livre = Prm.IdCampo_Livre OR Vgm.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Dmc.IdCampo_Livre = Prm.IdCampo_Livre OR Dmc.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Dlc.IdCampo_Livre = Prm.IdCampo_Livre OR Dlc.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Dde.IdCampo_Livre = Prm.IdCampo_Livre OR Dde.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1       WHEN Vge.IdCampo_Livre = Prm.IdCampo_Livre OR Vge.IdCampo_Livre IS NULL AND Prm.IdCampo_Livre IS NOT NULL THEN 1     ELSE 0      END as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdCampo_Livre"][1]/@Value', 'int') as IdCampo_Livre,       Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm Left Outer Join   mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House Left Outer Join   vis_logistica_prazo Ddc ON Ddc.Identificador = 'Deadline_Draft_Cliente' AND Ddc.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Vgm ON Vgm.Identificador = 'Deadline_VGM_Cliente' AND Vgm.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Dmc ON Dmc.Identificador = 'DeadLine_MDGF_Cliente' AND Dmc.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Dlc ON Dlc.Identificador = 'DeadLine_Lashing_Cliente' AND Dlc.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Dde ON Dde.Identificador = 'Deadline_Draft_Estendido' AND Dde.IdLogistica_House = Lhs.IdLogistica_House Left Outer Join   vis_logistica_prazo Vge ON Vge.Identificador = 'Deadline_VGM_Estendido' AND Vge.IdLogistica_House = Lhs.IdLogistica_House  ) Bloq 	[004] Proibido inserir ou alterar as datas de deadline do cliente.
BLC_001_N_ALTERA_COM_BAIXA_CONCILIADA	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* Bloqueado */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN  '[#BLC001] Não é possível alterar/excluir com baixa já conciliada!'     Else NULL   END as VARCHAR(MAX)) FROM   (SELECT     CAST(CASE       WHEN (Mfn.Conciliada = 1) THEN 1       ELSE 0     END as Bit) as Bloqueado   FROM     (SELECT       Prm.value('Item[@Nome="IdFatura_Financeira_Baixa"][1]/@Value', 'int') as IdFatura_Financeira_Baixa     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)     )Prm LEFT OUTER JOIN   mov_Fatura_Financeira_Baixa Ffb ON Ffb.IdFatura_Financeira_Baixa = Prm.IdFatura_Financeira_Baixa LEFT OUTER JOIN   mov_Fatura_Financeira Ffn ON Ffn.IdFatura_Financeira = Ffb.IdFatura_Financeira LEFT OUTER JOIN   mov_Logistica_Fatura Lft ON Lft.IdRegistro_Financeiro = Ffn.IdRegistro_Financeiro LEFT OUTER JOIN   mov_Movimentacao_Financeira Mfn ON Mfn.IdMovimentacao_Financeira = Ffb.IdMovimentacao_Financeira LEFT OUTER JOIN   mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Lft.IdLogistica_House ) Blq 	[#BLC001] Não é possível alterar/excluir com baixa já conciliada!
BLC_EFETUA_BAIXA_APENAS_EM_TITULOS	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* Bloqueado */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'A fatura deve ser título para realização da baixa!'     Else NULL   END as VARCHAR(MAX)) FROM   (SELECT     CAST(CASE       WHEN Ftf.Tipo = 1 THEN 1       ELSE 0     END as Bit) as Bloqueado   FROM     (SELECT       Prm.value('Item[@Nome="IdFatura_Financeira_Baixa"][1]/@Value', 'int') as IdFatura_Financeira_Baixa,       Prm.value('Item[@Nome="IdFatura_Financeira"][1]/@Value', 'int') as IdFatura_Financeira     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)     )Prm LEFT OUTER JOIN   mov_Fatura_Financeira Ftf ON Ftf.IdFatura_Financeira = Prm.IdFatura_Financeira ) Blq 	A fatura deve ser título para realização da baixa!
BLC_NaO_INSERE_TAXA_PROCESSO_FINALIZADO	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'BLOQUEIO FATURA JA FINALIZADA'     Else NULL   END as VARCHAR(MAX)) FROM   (   SELECT     CAST(CASE          WHEN Prm.IdLogistica_Taxa IS NOT NULL AND Lhs.Situacao_Agenciamento = 5 /*Finalizado*/ THEN 1       ELSE 0     END as VARCHAR(200)) as Bloqueado   FROM     (      SELECT     Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House,     Prm.value('Item[@Nome="IdLogistica_Taxa"][1]/@Value', 'int') as IdLogistica_Taxa      FROM     @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm   LEFT OUTER JOIN     mov_Logistica_House Lhs on Lhs.IdLogistica_House = Prm.IdLogistica_House ) Blq 	BLOQUEIO FATURA JA FINALIZADA
BLC_006_BLOQEADO_FATURA_COM_CONDICAO_30_60_90	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /*Bloqueado*/     Else 0   END,   @Mensagem = CAST(CASE     WHEN        Bloqueado = 1 THEN '[006]ATENÇÃO! Não é permitido fatura com a condição de pagamento de 30/60/90 dias.'     Else NULL   END as VARCHAR(MAX)) FROM (   SELECT    CAST(CASE                       When (Prm.IdCondicao_Pagamento IN (6 /*30/60/90*/)) THEN 1                       Else 0               END As int) as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdRegistro_Financeiro"][1]/@Value', 'int') as IdRegistro_Financeiro,       Prm.value('Item[@Nome="IdCondicao_Pagamento"][1]/@Value', 'int') as IdCondicao_Pagamento     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm LEFT OUTER JOIN   mov_Registro_Financeiro Rfn ON Rfn.IdRegistro_Financeiro = Prm.IdRegistro_Financeiro ) Blq 	[006]ATENÇÃO! Não é permitido fatura com a condição de pagamento de 30/60/90 dias.
BLC_NAO_ALTERA_VENDEDOR_RESPONSAVEL_CRM	SELECT   @Acao = CASE         WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */         Else 0     END,   @Mensagem = CAST(CASE         WHEN Bloqueado = 1 THEN 'Você não tem permissão para alterar o vendedor!'     Else NULL     END as VARCHAR(MAX)) FROM   (SELECT     CAST(CASE             WHEN (Prm.IdVendedor_Responsavel  <> Cln.IdVendedor_Responsavel ) Then 1             WHEN (Prm.IdVendedor_Responsavel_Old IS NOT NULL AND Prm.IdVendedor_Responsavel  IS NULL AND Cln.IdVendedor_Responsavel IS NOT NULL ) Then 1            ELSE 0         END as Bit) as Bloqueado   FROM     (SELECT       Prm.value('Item[@Nome="IdPessoa"][1]/@Value', 'int') as IdPessoa,       Prm.value('Item[@Nome="Tipo_Cliente"][1]/@Value', 'int') as Tipo_Cliente,       Prm.value('Item[@Nome="IdVendedor_Responsavel"][1]/@OldValue', 'int') as IdVendedor_Responsavel_Old,       Prm.value('Item[@Nome="IdVendedor_Responsavel"][1]/@Value', 'int') as IdVendedor_Responsavel     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)         ) Prm     LEFT OUTER JOIN       cad_Cliente Cln On Cln.IdPessoa = Prm.IdPessoa     ) Blq                       	Você não tem permissão para alterar o vendedor!
BLC_BL5_EMPRESA_MATRIZ_E_FILIAL	NULL	NULL
BLC_NAO_INSERE_TAXA_LOGISTICA_E_EXIBICAO	TFaturaFinanceira SELECT   @Acao = 5,   @Mensagem =  'Você não tem permissão para inserir dados em Taxa Logistica.'  	Você não tem permissão para inserir dados em Taxa Logistica.
BLC_NAO_INSERE_TAXA_LOGISTICA_E_EXIBICAO	TFaturaFinanceira SELECT   @Acao = 5,   @Mensagem =  'Você não tem permissão para inserir dados em Taxa Logistica Exibição.'  	Você não tem permissão para inserir dados em Taxa Logistica Exibição.
004 - BLC_BL5_N_PERMITE_CLIENTE_INATIVO	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* BLOQUEIA */     Else 0   END,     @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Cliente "INATIVO", não é permitido inserir esse contato.'     Else NULL   END as VARCHAR(MAX)) FROM   (SELECT     CAST(CASE       WHEN          (Prm.IdLogistica_House IS NOT NULL) AND (Prm.IdCliente IS NOT NULL) AND (Cli.Tipo_Cliente =4 /*INATIVO*/) THEN 1       Else 0     END as Bit) as Bloqueado   FROM     (     SELECT       Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House,       Prm.value('Item[@Nome="IdCliente"][1]/@Value', 'int') as IdCliente     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)     ) Prm   LEFT OUTER JOIN     mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House   LEFT OUTER JOIN     vis_Cliente Cli ON Cli.IdPessoa = Prm.IdCliente   ) Blq 	Cliente "INATIVO", não é permitido inserir esse contato.
004 - BLC_BL5_N_PERMITE_CLIENTE_INATIVO	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* BLOQUEIA */     Else 0   END,     @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Cliente "INATIVO", não é permitido inserir esse contato.'     Else NULL   END as VARCHAR(MAX)) FROM   (SELECT     CAST(CASE       WHEN          (Prm.IdProposta_Frete IS NOT NULL) AND (Prm.IdCliente IS NOT NULL) AND (Cli.Tipo_Cliente =4 /*INATIVO*/) THEN 1       Else 0     END as Bit) as Bloqueado   FROM     (     SELECT       Prm.value('Item[@Nome="IdProposta_Frete"][1]/@Value', 'int') as IdProposta_Frete,       Prm.value('Item[@Nome="IdOferta_Frete"][1]/@Value', 'int') as IdOferta_Frete,       Prm.value('Item[@Nome="IdCliente"][1]/@Value', 'int') as IdCliente     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)     ) Prm   LEFT OUTER JOIN     mov_Proposta_Frete Pft ON Pft.IdProposta_Frete = Prm.IdProposta_Frete   LEFT OUTER JOIN     mov_Oferta_Frete Oft ON Oft.IdOferta_Frete = Prm.IdOferta_Frete   LEFT OUTER JOIN     vis_Cliente Cli ON Cli.IdPessoa = Prm.IdCliente   ) Blq 	Cliente "INATIVO", não é permitido inserir esse contato.
003 - BLC_BL5_N_PERMITE_RETIRAR_CLIENTE_DE_INATIVO	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Atenção! Usuário sem permissão para alterar tipo de cliente!'     Else NULL   END as VARCHAR(MAX)) FROM    (     SELECT       CAST(CASE          WHEN Prm.Tipo_Cliente in (1,2,3,5,6,7,8,9,10,11,12) /*não inativo*/ AND Prm.IdPessoa in (53598) THEN 1            ELSE 0         END as Bit) as Bloqueado   FROM     (SELECT       Prm.value('Item[@Nome="IdPessoa"][1]/@Value', 'int') as IdPessoa,       Prm.value('Item[@Nome="Tipo_Cliente"][1]/@Value', 'int') as Tipo_Cliente     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)         ) Prm Left Outer Join     cad_Cliente Cli on Cli.IdPessoa = Prm.IdPessoa     ) Blq                       	Atenção! Usuário sem permissão para alterar tipo de cliente!
BLC_EDICAO_CAMPO_LIVRE_COMISSAO	 SELECT    @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /*BLOQUEADO*/     ELSE 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN '[#44024] Você não possui permissão para alterar este campo!'     ELSE null   END as varchar(MAX)) FROM (   SELECT      CAST(CASE        WHEN COALESCE(Prm.IdConfiguracao_Campo_Livre, 0) = 192 /*Comissao_Paga*/ THEN 1        ELSE 0      END as int) as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdCampo_Livre"][1]/@Value', 'int') as IdCampo_Livre,       Prm.value('Item[@Nome="IdConfiguracao_Campo_Livre"][1]/@Value', 'int') as IdConfiguracao_Campo_Livre,       Prm.value('Item[@Nome="Valor_Data"][1]/@Value', 'Date') as Valor_Data     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm ) Blq 	[#44024] Você não possui permissão para alterar este campo!
BLC_BL5_CLIENTE_BLOQUEADO	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'ATENÇÃO! Proibido inserir oferta com tipo cliente bloqueado.'   END as VARCHAR(MAX)) FROM (   SELECT     CASE       WHEN Prm.IdProposta_Frete IS NOT NULL AND Ofr.Valor_Boleano = 1 THEN 1       Else 0     END as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdProposta_Frete"][1]/@Value', 'int') as IdProposta_Frete,       Prm.value('Item[@Nome="IdCliente"][1]/@Value', 'int') as IdCliente     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm LEFT OUTER JOIN   cad_Cliente Cli ON Cli.IdPessoa = Prm.IdCliente LEFT OUTER JOIN   vis_Pessoa_Campo_Livre Ofr ON Ofr.IdPessoa = Cli.IdPessoa AND Ofr.IdConfiguracao_Campo_Livre = 195 /*Cliente Bloqueado*/  )Blq 	ATENÇÃO! Proibido inserir oferta com tipo cliente bloqueado.
BLC_ALTERACAO_GRUPO_PESSOA	SELECT   @Acao = CASE        WHEN Bloqueado = 1 THEN 5 /* Bloquear*/         Else 0     END,   @Mensagem = CAST(CASE         WHEN Bloqueado = 1 THEN 'Atenção! Você não tem permissão para selecionar o grupo: Cadastro Ativo.'      Else NULL     END as VARCHAR(MAX)) FROM   (SELECT     CAST(CASE            WHEN (Prm.IdPessoa_Grupo <> COALESCE(Pes.IdPessoa_Grupo,0)) AND Prm.IdPessoa_Grupo = 11 /*Cadastro ativo*/ THEN 1            ELSE 0         END as int) as Bloqueado   FROM     (SELECT       Prm.value('Item[@Nome="IdPessoa"][1]/@Value', 'int') as IdPessoa,       Prm.value('Item[@Nome="IdPessoa_Grupo"][1]/@Value', 'int') as IdPessoa_Grupo,       Prm.value('Item[@Nome="IdPessoa_Grupo"][1]/@OldValue', 'int') as IdPessoa_Grupo_Old     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)         ) Prm    LEFT OUTER JOIN       cad_Pessoa Pes on Pes.IdPessoa = Prm.IdPessoa      ) Blq 	Atenção! Você não tem permissão para selecionar o grupo: Cadastro Ativo.
BLC_CADASTRO_ATIVO_COMERCIAL	 SELECT   @Acao = CASE     WHEN Bloqueado IN (1, 2, 3) THEN 5 /* Bloquear*/     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Atenção! Companhia de Transporte não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.' +CHAR(10)+CHAR(13)+ +CHAR(10)+CHAR(13)+ 'Email: raphael.oliveira@exalog.com.br - Tel: (13) 98138-8386'     WHEN Bloqueado = 2 THEN 'Atenção! Seguradora não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.'  +CHAR(10)+CHAR(13)+ +CHAR(10)+CHAR(13)+ 'Email: raphael.oliveira@exalog.com.br - Tel: (13) 98138-8386'     WHEN Bloqueado = 3 THEN 'Atenção! Despachante Aduaneiro não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.'  +CHAR(10)+CHAR(13)+ +CHAR(10)+CHAR(13)+ 'Email: raphael.oliveira@exalog.com.br - Tel: (13) 98138-8386'   END as VARCHAR(MAX)) FROM (   SELECT     CAST(CASE       WHEN Prm.IdOferta_Frete IS NOT NULL AND (Prm.IdCompanhia_Transporte <> COALESCE(IdCompanhia_Transporte_Old, 0)) AND (Prm.IdCompanhia_Transporte NOT IN (SELECT IdPessoa FROM cad_Pessoa WHERE IdPessoa_Grupo = 9 /*Cadastro Ativo*/))  THEN 1       WHEN Prm.IdOferta_Frete IS NOT NULL AND (Prm.IdSeguradora <> COALESCE(Prm.IdSeguradora_Old, 0) ) AND (Prm.IdSeguradora NOT IN (SELECT IdPessoa FROM cad_Pessoa WHERE IdPessoa_Grupo = 9 /*Cadastro Ativo*/))  THEN 2       WHEN Prm.IdOferta_Frete IS NOT NULL AND (Prm.IdDespachante_Aduaneiro <> COALESCE(Prm.IdDespachante_Aduaneiro_Old, 0)) AND (Prm.IdDespachante_Aduaneiro NOT IN (SELECT IdPessoa FROM cad_Pessoa WHERE IdPessoa_Grupo = 9 /*Cadastro Ativo*/))  THEN 3       Else 0     END as Int) as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdOferta_Frete"][1]/@Value', 'int') as IdOferta_Frete,       Prm.value('Item[@Nome="IdProposta_Frete"][1]/@Value', 'int') as IdProposta_Frete,       Prm.value('Item[@Nome="IdCompanhia_Transporte"][1]/@Value', 'int') as IdCompanhia_Transporte,       Prm.value('Item[@Nome="IdCompanhia_Transporte"][1]/@OldValue', 'int') as IdCompanhia_Transporte_Old,       Prm.value('Item[@Nome="IdSeguradora"][1]/@Value', 'int') as IdSeguradora,       Prm.value('Item[@Nome="IdSeguradora"][1]/@OldValue', 'int') as IdSeguradora_Old,       Prm.value('Item[@Nome="IdDespachante_Aduaneiro"][1]/@Value', 'int') as IdDespachante_Aduaneiro,       Prm.value('Item[@Nome="IdDespachante_Aduaneiro"][1]/@OldValue', 'int') as IdDespachante_Aduaneiro_Old     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm LEFT OUTER JOIN       mov_Oferta_Frete Ofr on Ofr.IdOferta_Frete = Prm.IdOferta_Frete LEFT OUTER JOIN      cad_Pessoa Ctr ON COALESCE(Prm.IdCompanhia_Transporte, Prm.IdDespachante_Aduaneiro, Prm.IdSeguradora) = Ctr.IdPessoa  ) Blq 	Atenção! Companhia de Transporte não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.
BLC_CADASTRO_ATIVO_OPERACIONAL1	 SELECT   @Acao = CASE     WHEN Bloqueado = 1  THEN 5 /* Bloquear*/     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Atenção! Companhia de Transporte não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.' +CHAR(10)+CHAR(13)+ +CHAR(10)+CHAR(13)+ 'Email: raphael.oliveira@exalog.com.br - Tel: (13) 98138-8386'   END as VARCHAR(MAX)) FROM (   SELECT     CAST(CASE       WHEN Prm.IdLogistica_Master IS NOT NULL AND (Prm.IdCompanhia_Transporte NOT IN (SELECT IdPessoa FROM cad_Pessoa WHERE IdPessoa_Grupo = 9 /*Cadastro Ativo*/))  THEN 1       Else 0     END as Int) as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdLogistica_Master"][1]/@Value', 'int') as IdLogistica_Master,       Prm.value('Item[@Nome="IdCompanhia_Transporte"][1]/@Value', 'int') as IdCompanhia_Transporte     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm  ) Blq 	Atenção! Companhia de Transporte não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.
BLC_CADASTRO_ATIVO_OPERACIONAL2	 SELECT   @Acao = CASE     WHEN Bloqueado IN (1, 2)  THEN 5 /* Bloquear*/     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Atenção! Seguradora não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.'  +CHAR(10)+CHAR(13)+ +CHAR(10)+CHAR(13)+ 'Email: raphael.oliveira@exalog.com.br - Tel: (13) 98138-8386'     WHEN Bloqueado = 2 THEN 'Atenção! Despachante Aduaneiro não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.'  +CHAR(10)+CHAR(13)+ +CHAR(10)+CHAR(13)+ 'Email: raphael.oliveira@exalog.com.br - Tel: (13) 98138-8386'   END as VARCHAR(MAX)) FROM (   SELECT     CAST(CASE       WHEN Prm.IdLogistica_House IS NOT NULL AND (Prm.IdSeguradora NOT IN (SELECT IdPessoa FROM cad_Pessoa WHERE IdPessoa_Grupo = 9 /*Cadastro Ativo*/))  THEN 1       WHEN Prm.IdLogistica_House IS NOT NULL AND (Prm.IdDespachante_Aduaneiro NOT IN (SELECT IdPessoa FROM cad_Pessoa WHERE IdPessoa_Grupo = 9 /*Cadastro Ativo*/))  THEN 2       Else 0     END as Int) as Bloqueado   FROM   (     SELECT       Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House,       Prm.value('Item[@Nome="IdSeguradora"][1]/@Value', 'int') as IdSeguradora,       Prm.value('Item[@Nome="IdDespachante_Aduaneiro"][1]/@Value', 'int') as IdDespachante_Aduaneiro     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm  ) Blq 	Atenção! Seguradora não pertence ao grupo de: Cadastro Ativo. Procure os  responsáveis pela gestão de grupos de cadastros para dar continuidade.
BLC_N_GERA_PROCESSO_SEM_VALOR_MERCADORIA	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* bloqueado exibir aviso */     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Atenção! É preciso preencher o valor da mercadoria para gerar o Processo.'     Else NULL   END as VARCHAR(MAX)) FROM   (   SELECT     CAST(CASE       WHEN (Prm.IdLogistica_House IS NOT NULL) AND ((Prm.Valor_Mercadoria IS NULL) OR (Prm.Valor_Mercadoria <= 0)) THEN 1       ELSE 0     END as int) as Bloqueado   FROM     (     SELECT       Prm.value('Item[@Nome="IdLogistica_House"][1]/@Value', 'int') as IdLogistica_House,       Prm.value('Item[@Nome="Valor_Mercadoria"][1]/@Value', 'numeric') as Valor_Mercadoria     FROM       @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)     ) Prm   JOIN      mov_Logistica_House Lhs ON Lhs.IdLogistica_House = Prm.IdLogistica_House   LEFT OUTER JOIN     mov_Logistica_Master Lms ON Lms.IdLogistica_Master = Lhs.IdLogistica_Master   ) Blq 	Atenção! É preciso preencher o valor da mercadoria para gerar o Processo.
BLC_CONTRATO_LOG_PADRAO	 SELECT   @Acao = CASE     WHEN Bloqueado in (1) THEN 5 /*Bloquear*/     Else 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'Atenção: Seu acesso não permite definir contratos padrões.'   END as VARCHAR(MAX)) FROM     (     SELECT         CAST(CASE             WHEN Prm.Padrao IS NOT NULL THEN 1             Else 0         END as Int) as Bloqueado     FROM         (     SELECT         Prm.value('Item[@Nome="Padrao"][1]/@Value', 'Bit') as Padrao     FROM         @Parametros.nodes('/Parametros/Evento/Campos') as Parametros(Prm)   ) Prm ) Blq 	Atenção: Seu acesso não permite definir contratos padrões.
BLC_INVOICE_COMERCIAL_SUPERIOR_5_MILHOES	 SELECT   @Acao = CASE     WHEN CampoNaoPreenchido = 1 THEN 5 /* Bloqueia */     WHEN InvoiceSuperior = 1 THEN 4 /* Solicita senha*/     ELSE 0   END,   @Mensagem = CAST(CASE     WHEN CampoNaoPreenchido = 1 THEN        'Atenção! O campo "Invoice Comercial superior a R$ 5.000.000,00?" não foi preenchido.' + CHAR(13) + CHAR(10) +       'Por favor, preencher este campo obrigatório em: Proposta > Informações adicionais > Invoice Comercial superior a R$ 5.000.000,00?'     WHEN InvoiceSuperior = 1 THEN        'Favor contactar Thiago Vasques para verificação e aprovação deste embarque'     ELSE NULL   END AS VARCHAR(MAX)) FROM (   SELECT     CAST(CASE       WHEN (Ofr.Situacao <> 2 AND Prm.Situacao = 2 /*aprovada*/) AND Coalesce(Cpl.Valor_Tipo_Fixo, 0) = 0 THEN 1       ELSE 0     END AS Bit) AS CampoNaoPreenchido,     CAST(CASE       WHEN  (Ofr.Situacao <> 2 AND Prm.Situacao = 2 /*aprovada*/) AND Coalesce(Cpl.Valor_Tipo_Fixo, 0) = 1 THEN 1       ELSE 0     END AS Bit) AS InvoiceSuperior   FROM   (     SELECT       Prm.value('Item[@Nome="IdOferta_Frete"][1]/@Value', 'int') AS IdOferta_Frete,       Prm.value('Item[@Nome="IdProposta_Frete"][1]/@Value', 'int') AS IdProposta_Frete,       Prm.value('Item[@Nome="Situacao"][1]/@Value', 'int') AS Situacao     FROM       @Parametros.nodes('/Parametros/Evento/Campos') AS Parametros(Prm)   ) Prm    Left Outer Join      mov_Oferta_Frete Ofr ON Ofr.IdProposta_Frete = Prm.IdProposta_Frete   Left Outer Join      mov_Oferta_Frete_Campo_Livre Ofl ON Ofl.IdOferta_Frete = Ofr.IdOferta_Frete   Left Outer Join      mov_Campo_Livre Cpl ON Cpl.IdCampo_Livre = Ofl.IdCampo_Livre  AND Cpl.IdConfiguracao_Campo_Livre = 202 /* Invoice Comercial*/ ) Blq 	Atenção! O campo "Invoice Comercial superior a R$ 5.000.000,00?" não foi preenchido.
BLC_APROVAR_PROCESSO_SEM_EXP_INC_AGT-ORG_TIPO_EMB	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* Bloqueia e exibe aviso */     ELSE 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'ATENÇÃO! Obrigatório preencher os campos: Exportador, Agente Origem, Incoterm e Tipo Carga  para processos de Importação AÉREA ou MARÍTIMA.'     ELSE NULL   END AS VARCHAR(MAX)) FROM (     SELECT         CAST(CASE             WHEN (Ofr.Situacao <> 2 AND Prm.Situacao = 2 /*aprovada*/)             AND (Prm.Tipo_Operacao = 2 /*Importação*/)             AND (Prm.Modalidade_Processo IN (1,2) /*Aéreo ou Marítimo*/)             AND (Ofr.IdIncoterm IS NULL                  OR Ofr.IdExportador IS NULL                  OR Ofr.IdAgente_Origem IS NULL                 OR Pfc.Tipo_Carga = 0) THEN 1             ELSE 0         END AS BIT) AS Bloqueado     FROM         (             SELECT                 Prm.value('Item[@Nome="IdOferta_Frete"][1]/@Value', 'int') AS IdOferta_Frete,                 Prm.value('Item[@Nome="IdProposta_Frete"][1]/@Value', 'int') AS IdProposta_Frete,                 Prm.value('Item[@Nome="Modalidade_Processo"][1]/@Value', 'int') AS Modalidade_Processo,                 Prm.value('Item[@Nome="Tipo_Operacao"][1]/@Value', 'int') AS Tipo_Operacao,                 Prm.value('Item[@Nome="Situacao"][1]/@Value', 'int') AS Situacao             FROM                 @Parametros.nodes('/Parametros/Evento/Campos') AS Parametros(Prm)         ) Prm     LEFT OUTER JOIN         mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Prm.IdOferta_Frete     LEFT OUTER JOIN         mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete = Ofr.IdProposta_Frete ) Blq 	ATENÇÃO! Obrigatório preencher os campos: Exportador, Agente Origem, Incoterm e Tipo Carga  para processos de Importação AÉREA ou MARÍTIMA.
BLC_APROVAR_PROCESSO_EXP_SEM__INC_TIPO_EMB	 SELECT   @Acao = CASE     WHEN Bloqueado = 1 THEN 5 /* Bloqueia e exibe aviso */     ELSE 0   END,   @Mensagem = CAST(CASE     WHEN Bloqueado = 1 THEN 'ATENÇÃO! Obrigatório preencher os campos: Incoterm e Tipo de Carga para processos de EXPORTAÇÃO  AÉREA ou MARÍTIMA.'     ELSE NULL   END AS VARCHAR(MAX)) FROM (     SELECT         CAST(CASE             WHEN (Ofr.Situacao <> 2 AND Prm.Situacao = 2 /*aprovada*/)             AND (Prm.Tipo_Operacao = 1 /*Exportação*/)             AND (Prm.Modalidade_Processo In (1,2) /*Aéreo ou Marítimo*/)             AND (Ofr.IdIncoterm IS NULL OR Pfc.Tipo_Carga = 0) THEN 1             ELSE 0         END AS BIT) AS Bloqueado     FROM         (             SELECT                 Prm.value('Item[@Nome="IdOferta_Frete"][1]/@Value', 'int') AS IdOferta_Frete,                 Prm.value('Item[@Nome="IdProposta_Frete"][1]/@Value', 'int') AS IdProposta_Frete,                 Prm.value('Item[@Nome="Modalidade_Processo"][1]/@Value', 'int') AS Modalidade_Processo,                 Prm.value('Item[@Nome="Tipo_Operacao"][1]/@Value', 'int') AS Tipo_Operacao,                 Prm.value('Item[@Nome="Situacao"][1]/@Value', 'int') AS Situacao             FROM                 @Parametros.nodes('/Parametros/Evento/Campos') AS Parametros(Prm)         ) Prm     LEFT OUTER JOIN         mov_Oferta_Frete Ofr ON Ofr.IdOferta_Frete = Prm.IdOferta_Frete     LEFT OUTER JOIN         mov_Proposta_Frete_Carga Pfc on Pfc.IdProposta_Frete = Ofr.IdProposta_Frete ) Blq 	ATENÇÃO! Obrigatório preencher os campos: Incoterm e Tipo de Carga para processos de EXPORTAÇÃO  AÉREA ou MARÍTIMA.